---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
title: Design para sobreviver a falhas (criando aplicativos de nuvem do mundo real com o Azure) | Microsoft Docs
author: MikeWasson
description: A criação de aplicativos de nuvem do mundo real com o livro eletrônico do Azure é baseada em uma apresentação desenvolvida por Scott Guthrie. Ele explica 13 padrões e práticas que podem...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: 364ce84e-5af8-4e08-afc9-75a512b01f84
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
msc.type: authoredcontent
ms.openlocfilehash: 348232af531b5d53dc3cb46d6d2c7931d95a572d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78617722"
---
# <a name="design-to-survive-failures-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="43e3d-104">Design para sobreviver a falhas (criando aplicativos de nuvem do mundo real com o Azure)</span><span class="sxs-lookup"><span data-stu-id="43e3d-104">Design to Survive Failures (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="43e3d-105">por [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="43e3d-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="43e3d-106">[Baixar o projeto de ti](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) ou [baixar o livro eletrônico](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="43e3d-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="43e3d-107">A **criação de aplicativos de nuvem do mundo real com** o livro eletrônico do Azure é baseada em uma apresentação desenvolvida por Scott Guthrie.</span><span class="sxs-lookup"><span data-stu-id="43e3d-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="43e3d-108">Ele explica 13 padrões e práticas que podem ajudá-lo a desenvolver com sucesso aplicativos Web para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="43e3d-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="43e3d-109">Para obter informações sobre o livro eletrônico, consulte [o primeiro capítulo](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="43e3d-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="43e3d-110">Uma das coisas que você precisa pensar ao criar qualquer tipo de aplicativo, mas especialmente um que será executado na nuvem em que muitas pessoas vão usá-lo, é como projetar o aplicativo para que ele possa lidar normalmente com falhas e continuar a fornecer valor tanto quanto possível.</span><span class="sxs-lookup"><span data-stu-id="43e3d-110">One of the things you have to think about when you build any type of application, but especially one that will run in the cloud where lots of people will be using it, is how to design the app so that it can gracefully handle failures and continue to deliver value as much as possible.</span></span> <span data-ttu-id="43e3d-111">Com tempo suficiente, as coisas vão incorretas em qualquer ambiente ou em qualquer sistema de software.</span><span class="sxs-lookup"><span data-stu-id="43e3d-111">Given enough time, things are going to go wrong in any environment or any software system.</span></span> <span data-ttu-id="43e3d-112">O modo como seu aplicativo lida com essas situações determina o quanto os clientes terão e quanto tempo você terá para passar a analisar e corrigir problemas.</span><span class="sxs-lookup"><span data-stu-id="43e3d-112">How your app handles those situations determines how upset your customers will get and how much time you have to spend analyzing and fixing problems.</span></span>

## <a name="types-of-failures"></a><span data-ttu-id="43e3d-113">Tipos de falhas</span><span class="sxs-lookup"><span data-stu-id="43e3d-113">Types of failures</span></span>

<span data-ttu-id="43e3d-114">Há duas categorias básicas de falhas que você desejará manipular de maneira diferente:</span><span class="sxs-lookup"><span data-stu-id="43e3d-114">There are two basic categories of failures that you'll want to handle differently:</span></span>

- <span data-ttu-id="43e3d-115">Falhas transitórias e de auto-recuperação, como problemas intermitentes de conectividade de rede.</span><span class="sxs-lookup"><span data-stu-id="43e3d-115">Transient, self-healing failures such as intermittent network connectivity issues.</span></span>
- <span data-ttu-id="43e3d-116">Ocorreram falhas que exigem intervenção.</span><span class="sxs-lookup"><span data-stu-id="43e3d-116">Enduring failures that require intervention.</span></span>

<span data-ttu-id="43e3d-117">Para falhas transitórias, você pode implementar uma política de repetição para garantir que a maior parte do tempo que o aplicativo recupera de forma rápida e automática.</span><span class="sxs-lookup"><span data-stu-id="43e3d-117">For transient failures, you can implement a retry policy to ensure that most of the time the app recovers quickly and automatically.</span></span> <span data-ttu-id="43e3d-118">Seus clientes podem notar um tempo de resposta um pouco mais longo, mas, caso contrário, eles não serão afetados.</span><span class="sxs-lookup"><span data-stu-id="43e3d-118">Your customers might notice slightly longer response time, but otherwise they won't be affected.</span></span> <span data-ttu-id="43e3d-119">Mostraremos algumas maneiras de lidar com esses erros no [capítulo tratamento de falhas transitórias](transient-fault-handling.md).</span><span class="sxs-lookup"><span data-stu-id="43e3d-119">We'll show some ways to handle these errors in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

<span data-ttu-id="43e3d-120">Em caso de falhas, você pode implementar a funcionalidade de monitoramento e registro em log que notifica você imediatamente quando surgirem problemas e facilitar a análise da causa raiz.</span><span class="sxs-lookup"><span data-stu-id="43e3d-120">For enduring failures, you can implement monitoring and logging functionality that notifies you promptly when issues arise and that facilitates root cause analysis.</span></span> <span data-ttu-id="43e3d-121">Mostraremos algumas maneiras de ajudá-lo a se manter em cima desses tipos de erros no [capítulo monitoramento e telemetria](monitoring-and-telemetry.md).</span><span class="sxs-lookup"><span data-stu-id="43e3d-121">We'll show some ways to help you stay on top of these kinds of errors in the [Monitoring and Telemetry chapter](monitoring-and-telemetry.md).</span></span>

## <a name="failure-scope"></a><span data-ttu-id="43e3d-122">Escopo de falha</span><span class="sxs-lookup"><span data-stu-id="43e3d-122">Failure scope</span></span>

<span data-ttu-id="43e3d-123">Você também precisa pensar sobre o escopo de falha – se um único computador é afetado, um serviço inteiro, como banco de dados SQL ou armazenamento, ou uma região inteira.</span><span class="sxs-lookup"><span data-stu-id="43e3d-123">You also have to think about failure scope – whether a single machine is affected, a whole service such as SQL Database or Storage, or an entire region.</span></span>

![Escopo de falha](design-to-survive-failures/_static/image1.png)

### <a name="machine-failures"></a><span data-ttu-id="43e3d-125">Falhas de máquina</span><span class="sxs-lookup"><span data-stu-id="43e3d-125">Machine failures</span></span>

<span data-ttu-id="43e3d-126">No Azure, um servidor com falha é substituído automaticamente por um novo e um aplicativo de nuvem bem projetado se recupera desse tipo de falha de forma automática e rápida.</span><span class="sxs-lookup"><span data-stu-id="43e3d-126">In Azure, a failed server is automatically replaced by a new one, and a well-designed cloud app recovers from this kind of failure automatically and quickly.</span></span> <span data-ttu-id="43e3d-127">Anteriormente, analisamos os benefícios de escalabilidade de uma camada da Web sem estado, e a facilidade de recuperação de um servidor com falha é outro benefício do sem estado.</span><span class="sxs-lookup"><span data-stu-id="43e3d-127">Earlier we stressed the scalability benefits of a stateless web tier, and ease of recovery from a failed server is another benefit of statelessness.</span></span> <span data-ttu-id="43e3d-128">A facilidade de recuperação também é um dos benefícios dos recursos de PaaS (plataforma como serviço), como o banco de dados SQL e os aplicativos Web do serviço de Azure App.</span><span class="sxs-lookup"><span data-stu-id="43e3d-128">Ease of recovery is also one of the benefits of platform-as-a-service (PaaS) features such as SQL Database and Azure App Service Web Apps.</span></span> <span data-ttu-id="43e3d-129">As falhas de hardware são raras, mas quando ocorrem, esses serviços os manipulam automaticamente; Você nem precisa escrever código para lidar com falhas de máquina quando estiver usando um desses serviços.</span><span class="sxs-lookup"><span data-stu-id="43e3d-129">Hardware failures are rare, but when they occur these services handle them automatically; you don't even have to write code to handle machine failures when you're using one of these services.</span></span>

### <a name="service-failures"></a><span data-ttu-id="43e3d-130">Falhas de serviço</span><span class="sxs-lookup"><span data-stu-id="43e3d-130">Service failures</span></span>

<span data-ttu-id="43e3d-131">Os aplicativos de nuvem normalmente usam vários serviços.</span><span class="sxs-lookup"><span data-stu-id="43e3d-131">Cloud apps typically use multiple services.</span></span> <span data-ttu-id="43e3d-132">Por exemplo, o aplicativo corrigir ti usa o serviço de banco de dados SQL, o serviço de armazenamento e o aplicativo Web é implantado no serviço Azure App.</span><span class="sxs-lookup"><span data-stu-id="43e3d-132">For example, the Fix It app uses the SQL Database service, the Storage service, and the web app is deployed to Azure App Service.</span></span> <span data-ttu-id="43e3d-133">O que o seu aplicativo fará se um dos serviços dos quais você depende falhar?</span><span class="sxs-lookup"><span data-stu-id="43e3d-133">What will your app do if one of the services you depend on fails?</span></span> <span data-ttu-id="43e3d-134">Para algumas falhas de serviço, uma mensagem amigável "Desculpe, tentar novamente mais tarde" pode ser o melhor que você pode fazer.</span><span class="sxs-lookup"><span data-stu-id="43e3d-134">For some service failures a friendly "sorry, try again later" message might be the best you can do.</span></span> <span data-ttu-id="43e3d-135">Mas, em muitos cenários, você pode fazer melhor.</span><span class="sxs-lookup"><span data-stu-id="43e3d-135">But in many scenarios you can do better.</span></span> <span data-ttu-id="43e3d-136">Por exemplo, quando o armazenamento de dados de back-end está inativo, você pode aceitar a entrada do usuário, exibir "sua solicitação foi recebida" e armazenar a entrada em outro lugar temporariamente; em seguida, quando o serviço de que você precisa estiver operacional novamente, você poderá recuperar a entrada e processá-la.</span><span class="sxs-lookup"><span data-stu-id="43e3d-136">For example, when your back-end data store is down, you can accept user input, display "your request has been received," and store the input someplace else temporarily; then when the service you need is operational again, you can retrieve the input and process it.</span></span>

<span data-ttu-id="43e3d-137">O capítulo de [padrão de trabalho centrado em fila](queue-centric-work-pattern.md) mostra uma maneira de lidar com esse cenário.</span><span class="sxs-lookup"><span data-stu-id="43e3d-137">The [Queue-centric Work Pattern](queue-centric-work-pattern.md) chapter shows one way to handle this scenario.</span></span> <span data-ttu-id="43e3d-138">O aplicativo corrigir ti armazena tarefas no banco de dados SQL, mas não precisa fechar o trabalho quando o banco de dados SQL está inoperante.</span><span class="sxs-lookup"><span data-stu-id="43e3d-138">The Fix It app stores tasks in SQL Database, but it doesn't have to quit working when SQL Database is down.</span></span> <span data-ttu-id="43e3d-139">Nesse capítulo, veremos como armazenar a entrada do usuário para uma tarefa em uma fila e usar um processo de trabalho para ler a fila e atualizar a tarefa.</span><span class="sxs-lookup"><span data-stu-id="43e3d-139">In that chapter we'll see how to store user input for a task in a queue, and use a worker process to read the queue and update the task.</span></span> <span data-ttu-id="43e3d-140">Se o SQL estiver inativo, a capacidade de criar as tarefas de correção de ti não será afetada; o processo de trabalho pode aguardar e processar novas tarefas quando o banco de dados SQL está disponível.</span><span class="sxs-lookup"><span data-stu-id="43e3d-140">If SQL is down, the ability to create Fix It tasks is unaffected; the worker process can wait and process new tasks when SQL Database is available.</span></span>

### <a name="region-failures"></a><span data-ttu-id="43e3d-141">Falhas de região</span><span class="sxs-lookup"><span data-stu-id="43e3d-141">Region failures</span></span>

<span data-ttu-id="43e3d-142">Regiões inteiras podem falhar.</span><span class="sxs-lookup"><span data-stu-id="43e3d-142">Entire regions may fail.</span></span> <span data-ttu-id="43e3d-143">Um desastre natural pode destruir um data center, ele pode ser nivelado por um Meteor, a linha de tronco no datacenter pode ser recortada por um pecuarista que está disparando um vaca com um escavadeira, etc. Se seu aplicativo estiver hospedado no datacenter do stricken, o que você faz?</span><span class="sxs-lookup"><span data-stu-id="43e3d-143">A natural disaster might destroy a data center, it might get flattened by a meteor, the trunk line into the datacenter could be cut by a farmer burying a cow with a backhoe, etc. If your app is hosted in the stricken datacenter what do you do?</span></span> <span data-ttu-id="43e3d-144">É possível configurar seu aplicativo no Azure para ser executado em várias regiões simultaneamente para que, se houver um desastre em um, você continue executando em outra região.</span><span class="sxs-lookup"><span data-stu-id="43e3d-144">It's possible to set up your app in Azure to run in multiple regions simultaneously so that if there's a disaster in one, you continue running in another region.</span></span> <span data-ttu-id="43e3d-145">Essas falhas são ocorrências extremamente raras e a maioria dos aplicativos não percorre os arcos necessários para garantir o serviço ininterrupto por meio de falhas desse tipo.</span><span class="sxs-lookup"><span data-stu-id="43e3d-145">Such failures are extremely rare occurrences, and most apps don't jump through the hoops necessary to ensure uninterrupted service through failures of this sort.</span></span> <span data-ttu-id="43e3d-146">Consulte a seção recursos no final do capítulo para obter informações sobre como manter seu aplicativo disponível mesmo por meio de uma falha de região.</span><span class="sxs-lookup"><span data-stu-id="43e3d-146">See the Resources section at the end of the chapter for information about how to keep your app available even through a region failure.</span></span>

<span data-ttu-id="43e3d-147">Uma meta do Azure é tornar a manipulação de todos esses tipos de falhas muito mais fácil, e você verá alguns exemplos de como estamos fazendo isso nos capítulos a seguir.</span><span class="sxs-lookup"><span data-stu-id="43e3d-147">A goal of Azure is to make handling all of these kinds of failures a lot easier, and you'll see some examples of how we're doing that in the following chapters.</span></span>

## <a name="slas"></a><span data-ttu-id="43e3d-148">SLAs</span><span class="sxs-lookup"><span data-stu-id="43e3d-148">SLAs</span></span>

<span data-ttu-id="43e3d-149">As pessoas geralmente ouvem os SLAs (contratos de nível de serviço) no ambiente de nuvem.</span><span class="sxs-lookup"><span data-stu-id="43e3d-149">People often hear about service-level agreements (SLAs) in the cloud environment.</span></span> <span data-ttu-id="43e3d-150">Basicamente, essas são as promessas de que as empresas fazem sobre a confiabilidade de seu serviço.</span><span class="sxs-lookup"><span data-stu-id="43e3d-150">Basically these are promises that companies make about how reliable their service is.</span></span> <span data-ttu-id="43e3d-151">Um SLA de 99,9% significa que você deve esperar que o serviço esteja funcionando corretamente 99,9% do tempo.</span><span class="sxs-lookup"><span data-stu-id="43e3d-151">A 99.9% SLA means you should expect the service to be working correctly 99.9% of the time.</span></span> <span data-ttu-id="43e3d-152">Esse é um valor bastante típico para um SLA e parece ser um número muito alto, mas você pode não perceber quanto tempo de 0,1% realmente vale para.</span><span class="sxs-lookup"><span data-stu-id="43e3d-152">That's a fairly typical value for an SLA and it sounds like a very high number, but you might not realize how much down time .1% actually amounts to.</span></span> <span data-ttu-id="43e3d-153">Aqui está uma tabela que mostra quanto tempo de inatividade vários percentuais de SLA valem para mais de um ano, um mês e uma semana.</span><span class="sxs-lookup"><span data-stu-id="43e3d-153">Here's a table that shows how much downtime various SLA percentages amount to over a year, a month, and a week.</span></span>

![Tabela SLA](design-to-survive-failures/_static/image2.png)

<span data-ttu-id="43e3d-155">Portanto, um SLA de 99,9% significa que seu serviço pode estar inoperante em 8,76 horas por ano ou 43,2 minutos por mês.</span><span class="sxs-lookup"><span data-stu-id="43e3d-155">So a 99.9% SLA means your service could be down 8.76 hours a year or 43.2 minutes a month.</span></span> <span data-ttu-id="43e3d-156">É mais tempo do que a maioria das pessoas percebe.</span><span class="sxs-lookup"><span data-stu-id="43e3d-156">That's more down time than most people realize.</span></span> <span data-ttu-id="43e3d-157">Assim, como um desenvolvedor, você deseja estar ciente de que uma determinada quantidade de tempo de inatividade é possível e tratá-lo de uma maneira normal.</span><span class="sxs-lookup"><span data-stu-id="43e3d-157">So as a developer you want to be aware that a certain amount of down time is possible and handle it in a graceful way.</span></span> <span data-ttu-id="43e3d-158">Em algum momento, alguém vai usar seu aplicativo, e um serviço será desativado e você desejará minimizar o impacto negativo disso no cliente.</span><span class="sxs-lookup"><span data-stu-id="43e3d-158">At some point someone is going to be using your app, and a service is going to be down, and you want to minimize the negative impact of that on the customer.</span></span>

<span data-ttu-id="43e3d-159">Uma coisa que você deve saber sobre um SLA é a qual período ele se refere: o relógio é redefinido toda semana, todos os meses ou todos os anos?</span><span class="sxs-lookup"><span data-stu-id="43e3d-159">One thing you should know about an SLA is what time-frame it refers to: does the clock get reset every week, every month, or every year?</span></span> <span data-ttu-id="43e3d-160">No Azure, redefinimos o relógio todos os meses, o que é melhor para você do que um SLA anual, uma vez que um SLA anual pode ocultar meses incorretos, escondendo-os com uma série de bons meses.</span><span class="sxs-lookup"><span data-stu-id="43e3d-160">In Azure we reset the clock every month, which is better for you than a yearly SLA, since a yearly SLA could hide bad months by offsetting them with a series of good months.</span></span>

<span data-ttu-id="43e3d-161">É claro que sempre almeje a fazer melhor do que o SLA; Normalmente, você ficará muito menor do que isso.</span><span class="sxs-lookup"><span data-stu-id="43e3d-161">Of course we always aspire to do better than the SLA; usually you'll be down much less than that.</span></span> <span data-ttu-id="43e3d-162">A promessa é que, se estivermos sempre inativo por mais tempo do que o máximo, você poderá pedir dinheiro de volta.</span><span class="sxs-lookup"><span data-stu-id="43e3d-162">The promise is that if we're ever down for longer than the maximum down time you can ask for money back.</span></span> <span data-ttu-id="43e3d-163">A quantidade de dinheiro que você obtém, provavelmente, não comprometerá totalmente o impacto nos negócios do excesso de tempo de inatividade, mas esse aspecto do SLA atua como uma política de imposição e permite que você saiba que levamos muito a sério.</span><span class="sxs-lookup"><span data-stu-id="43e3d-163">The amount of money you get back probably wouldn't fully compensate you for the business impact of the excess down time, but that aspect of the SLA acts as an enforcement policy and lets you know that we do take it very seriously.</span></span>

### <a name="composite-slas"></a><span data-ttu-id="43e3d-164">SLAs compostos</span><span class="sxs-lookup"><span data-stu-id="43e3d-164">Composite SLAs</span></span>

<span data-ttu-id="43e3d-165">Um aspecto importante a ser pensado quando você está olhando para os SLAs é o impacto de usar vários serviços em um aplicativo, sendo que cada serviço tem um SLA separado.</span><span class="sxs-lookup"><span data-stu-id="43e3d-165">An important thing to think about when you're looking at SLAs is the impact of using multiple services in an app, with each service having a separate SLA.</span></span> <span data-ttu-id="43e3d-166">Por exemplo, o aplicativo corrigir ti usa Azure App aplicativos Web do serviço, o armazenamento do Azure e o banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="43e3d-166">For example, the Fix It app uses Azure App Service Web Apps, Azure Storage, and SQL Database.</span></span> <span data-ttu-id="43e3d-167">Aqui estão seus números de SLA a partir da data em que este e-book está sendo gravado em dezembro de 2013:</span><span class="sxs-lookup"><span data-stu-id="43e3d-167">Here are their SLA numbers as of the date this e-book is being written in December, 2013:</span></span>

![Site de SLA, armazenamento, banco de dados SQL](design-to-survive-failures/_static/image3.png)

<span data-ttu-id="43e3d-169">Qual é o tempo máximo de inatividade que você esperaria para o aplicativo com base nesses SLAs de serviço?</span><span class="sxs-lookup"><span data-stu-id="43e3d-169">What is the maximum down time you would expect for the app based on these service SLAs?</span></span> <span data-ttu-id="43e3d-170">Você pode imaginar que o tempo de inatividade seria igual ao pior percentual de SLA, ou 99,9% nesse caso.</span><span class="sxs-lookup"><span data-stu-id="43e3d-170">You might think that your down time would be equal to the worst SLA percentage, or 99.9% in this case.</span></span> <span data-ttu-id="43e3d-171">Isso seria verdadeiro se todos os três serviços sempre falharem ao mesmo tempo, mas isso não é necessariamente o que realmente acontece.</span><span class="sxs-lookup"><span data-stu-id="43e3d-171">That would be true if all three services always failed at the same time, but that isn't necessarily what actually happens.</span></span> <span data-ttu-id="43e3d-172">Cada serviço pode falhar de forma independente em momentos diferentes, portanto, você precisa calcular o SLA composto multiplicando os números de SLA individuais.</span><span class="sxs-lookup"><span data-stu-id="43e3d-172">Each service may fail independently at different times, so you have to calculate the composite SLA by multiplying the individual SLA numbers.</span></span>

![SLA composto](design-to-survive-failures/_static/image4.png)

<span data-ttu-id="43e3d-174">Portanto, seu aplicativo pode ficar inoperante não apenas 43,2 minutos por mês, mas 3 vezes esse valor, 108 minutos por mês, e ainda estar dentro dos limites de SLA do Azure.</span><span class="sxs-lookup"><span data-stu-id="43e3d-174">So your app could be down not just 43.2 minutes a month but 3 times that amount, 108 minutes a month – and still be within the Azure SLA limits.</span></span>

<span data-ttu-id="43e3d-175">Esse problema não é exclusivo do Azure.</span><span class="sxs-lookup"><span data-stu-id="43e3d-175">This issue is not unique to Azure.</span></span> <span data-ttu-id="43e3d-176">Na verdade, fornecemos os melhores SLAs de nuvem de qualquer serviço de nuvem disponível, e você terá problemas semelhantes para lidar se usar os serviços de nuvem de qualquer fornecedor.</span><span class="sxs-lookup"><span data-stu-id="43e3d-176">We actually provide the best cloud SLAs of any cloud service available, and you'll have similar issues to deal with if you use any vendor's cloud services.</span></span> <span data-ttu-id="43e3d-177">O que esses destaques é a importância de pensar sobre como você pode projetar seu aplicativo para lidar com as falhas de serviço inevitáveis normalmente, porque elas podem ocorrer com frequência suficiente para afetar seus clientes ou usuários.</span><span class="sxs-lookup"><span data-stu-id="43e3d-177">What this highlights is the importance of thinking about how you can design your app to handle the inevitable service failures gracefully, because they might happen often enough to impact your customers or users.</span></span>

### <a name="cloud-slas-compared-to-enterprise-down-time-experience"></a><span data-ttu-id="43e3d-178">SLAs de nuvem em comparação com a experiência de tempo de vida empresarial</span><span class="sxs-lookup"><span data-stu-id="43e3d-178">Cloud SLAs compared to enterprise down-time experience</span></span>

<span data-ttu-id="43e3d-179">Às vezes, as pessoas dizem, "em meu aplicativo empresarial, nunca tenho esses problemas".</span><span class="sxs-lookup"><span data-stu-id="43e3d-179">People sometimes say, "In my enterprise app I never have these problems."</span></span> <span data-ttu-id="43e3d-180">Se você perguntar quanto tempo de inatividade um mês realmente tem, eles geralmente dizem, "bem, isso acontece ocasionalmente".</span><span class="sxs-lookup"><span data-stu-id="43e3d-180">If you ask how much down time a month they actually have, they usually say, "Well, it happens occasionally."</span></span> <span data-ttu-id="43e3d-181">E se você perguntar com que frequência, eles admitirão que "às vezes, precisamos fazer backup ou instalar um novo servidor ou atualizar o software".</span><span class="sxs-lookup"><span data-stu-id="43e3d-181">And if you ask how often, they admit that "Sometimes we do need to back up or install a new server or update software."</span></span> <span data-ttu-id="43e3d-182">É claro que isso conta como tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="43e3d-182">Of course, that counts as down time.</span></span> <span data-ttu-id="43e3d-183">A maioria dos aplicativos empresariais, a menos que sejam especialmente críticos, estão na verdade por mais tempo do que os SLAs de serviço.</span><span class="sxs-lookup"><span data-stu-id="43e3d-183">Most enterprise apps unless they are especially mission-critical are actually down for more than the amount of time allowed by our service SLAs.</span></span> <span data-ttu-id="43e3d-184">Mas, quando é o seu servidor e sua infraestrutura e você é responsável por ele e, no controle, você tende a sentir menos comoção sobre os tempos de inatividade.</span><span class="sxs-lookup"><span data-stu-id="43e3d-184">But when it's your server and your infrastructure and you're responsible for it and in control of it, you tend to feel less angst about down times.</span></span> <span data-ttu-id="43e3d-185">Em um ambiente de nuvem, você depende de outra pessoa e não sabe o que está acontecendo, portanto, talvez você queira se preocupar mais com ela.</span><span class="sxs-lookup"><span data-stu-id="43e3d-185">In a cloud environment you're dependent on someone else and you don't know what's going on, so you might tend to get more worried about it.</span></span>

<span data-ttu-id="43e3d-186">Quando uma empresa atinge uma porcentagem maior de tempo de inversão do que você obtém de um SLA de nuvem, ele faz isso gastando muito mais dinheiro em hardware.</span><span class="sxs-lookup"><span data-stu-id="43e3d-186">When an enterprise achieves a greater up-time percentage than you get from a cloud SLA, they do it by spending a lot more money on hardware.</span></span> <span data-ttu-id="43e3d-187">Um serviço de nuvem poderia fazer isso, mas teria de cobrar muito mais por seus serviços.</span><span class="sxs-lookup"><span data-stu-id="43e3d-187">A cloud service could do that but would have to charge much more for its services.</span></span> <span data-ttu-id="43e3d-188">Em vez disso, você tira proveito de um serviço econômico e cria seu software para que as falhas inevitáveis causem interrupção mínima para seus clientes.</span><span class="sxs-lookup"><span data-stu-id="43e3d-188">Instead, you take advantage of a cost-effective service and design your software so that the inevitable failures cause minimum disruption to your customers.</span></span> <span data-ttu-id="43e3d-189">Seu trabalho como um designer de aplicativo de nuvem não é muito para evitar uma falha ao evitar catástrofe e você faz isso concentrando-se em software, não em hardware.</span><span class="sxs-lookup"><span data-stu-id="43e3d-189">Your job as a cloud app designer is not so much to avoid failure as to avoid catastrophe, and you do that by focusing on software, not on hardware.</span></span> <span data-ttu-id="43e3d-190">Enquanto os aplicativos empresariais se esforçam para maximizar o tempo médio entre falhas, os aplicativos de nuvem se esforçam para minimizar o tempo médio de recuperação.</span><span class="sxs-lookup"><span data-stu-id="43e3d-190">Whereas enterprise apps strive to maximize mean time between failures, cloud apps strive to minimize mean time to recover.</span></span>

### <a name="not-all-cloud-services-have-slas"></a><span data-ttu-id="43e3d-191">Nem todos os serviços de nuvem têm SLAs</span><span class="sxs-lookup"><span data-stu-id="43e3d-191">Not all cloud services have SLAs</span></span>

<span data-ttu-id="43e3d-192">Lembre-se também de que nem todos os serviços de nuvem têm um SLA.</span><span class="sxs-lookup"><span data-stu-id="43e3d-192">Be aware also that not every cloud service even has an SLA.</span></span> <span data-ttu-id="43e3d-193">Se seu aplicativo for dependente de um serviço sem garantia de tempo de atividade, você poderá estar muito mais demorado do que você imagina.</span><span class="sxs-lookup"><span data-stu-id="43e3d-193">If your app is dependent on a service with no up-time guarantee, you could be down far longer than you might imagine.</span></span> <span data-ttu-id="43e3d-194">Por exemplo, se você habilitar o logon em seu site usando um provedor social, como o Facebook ou o Twitter, verifique com o provedor de serviços se há um SLA, e você pode descobrir que não há um.</span><span class="sxs-lookup"><span data-stu-id="43e3d-194">For example, if you enable log-in to your site using a social provider such as Facebook or Twitter, check with the service provider to find out if there is an SLA, and you might find out there isn't one.</span></span> <span data-ttu-id="43e3d-195">Mas se o serviço de autenticação ficar inativo ou não puder dar suporte ao volume de solicitações que você lança, seus clientes serão bloqueados de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="43e3d-195">But if the authentication service goes down or is unable to support the volume of requests you throw at it, your customers are locked out of your app.</span></span> <span data-ttu-id="43e3d-196">Você pode estar inoperante por dias ou mais.</span><span class="sxs-lookup"><span data-stu-id="43e3d-196">You could be down for days or longer.</span></span> <span data-ttu-id="43e3d-197">Os criadores de um novo aplicativo esperavam centenas de milhões de downloads e tiveram uma dependência na autenticação do Facebook – mas não conversava com o Facebook antes de ficar em tempo real e descoberto muito tarde que não havia nenhum SLA para esse serviço.</span><span class="sxs-lookup"><span data-stu-id="43e3d-197">The creators of one new app expected hundreds of millions of downloads and took a dependency on Facebook authentication – but didn't talk to Facebook before going live and discovered too late that there was no SLA for that service.</span></span>

### <a name="not-all-downtime-counts-toward-slas"></a><span data-ttu-id="43e3d-198">Nem todas as contagens de tempo de inatividade para SLAs</span><span class="sxs-lookup"><span data-stu-id="43e3d-198">Not all downtime counts toward SLAs</span></span>

<span data-ttu-id="43e3d-199">Alguns serviços de nuvem podem negar deliberadamente o serviço se seu aplicativo o utiliza.</span><span class="sxs-lookup"><span data-stu-id="43e3d-199">Some cloud services may deliberately deny service if your app over-uses them.</span></span> <span data-ttu-id="43e3d-200">Isso é chamado de *limitação*.</span><span class="sxs-lookup"><span data-stu-id="43e3d-200">This is called *throttling*.</span></span> <span data-ttu-id="43e3d-201">Se um serviço tiver um SLA, ele deverá declarar as condições sob as quais você pode ser limitado, e o design do aplicativo deverá evitar essas condições e reagir adequadamente à limitação se isso acontecer.</span><span class="sxs-lookup"><span data-stu-id="43e3d-201">If a service has an SLA, it should state the conditions under which you might be throttled, and your app design should avoid those conditions and react appropriately to the throttling if it happens.</span></span> <span data-ttu-id="43e3d-202">Por exemplo, se as solicitações para um serviço começarem a falhar quando você exceder um determinado número por segundo, você deseja garantir que as tentativas automáticas não ocorram tão rapidamente que façam com que a limitação continue.</span><span class="sxs-lookup"><span data-stu-id="43e3d-202">For example, if requests to a service start to fail when you exceed a certain number per second, you want to make sure automatic retries don't happen so fast that they cause the throttling to continue.</span></span> <span data-ttu-id="43e3d-203">Teremos mais a dizer sobre a limitação no capítulo de [tratamento de falhas transitórias](transient-fault-handling.md).</span><span class="sxs-lookup"><span data-stu-id="43e3d-203">We'll have more to say about throttling in the [Transient Fault Handling chapter](transient-fault-handling.md).</span></span>

## <a name="summary"></a><span data-ttu-id="43e3d-204">Resumo</span><span class="sxs-lookup"><span data-stu-id="43e3d-204">Summary</span></span>

<span data-ttu-id="43e3d-205">Este capítulo tentou ajudá-lo a perceber por que um aplicativo de nuvem real precisa ser projetado para sobreviver a falhas normalmente.</span><span class="sxs-lookup"><span data-stu-id="43e3d-205">This chapter has tried to help you realize why a real world cloud app has to be designed to survive failures gracefully.</span></span> <span data-ttu-id="43e3d-206">A partir do [próximo capítulo](monitoring-and-telemetry.md), os padrões restantes desta série entram em mais detalhes sobre algumas estratégias que você pode usar para fazer isso:</span><span class="sxs-lookup"><span data-stu-id="43e3d-206">Starting with the [next chapter](monitoring-and-telemetry.md), the remaining patterns in this series go into more detail about some strategies you can use to do that:</span></span>

- <span data-ttu-id="43e3d-207">Tenha bom [monitoramento e telemetria](monitoring-and-telemetry.md), para que você descubra rapidamente as falhas que exigem intervenção, e você tem informações suficientes para resolvê-las.</span><span class="sxs-lookup"><span data-stu-id="43e3d-207">Have good [monitoring and telemetry](monitoring-and-telemetry.md), so that you find out quickly about failures that require intervention, and you have sufficient information to resolve them.</span></span>
- <span data-ttu-id="43e3d-208">[Manipule falhas transitórias](transient-fault-handling.md) implementando a lógica de repetição inteligente, para que seu aplicativo seja recuperado automaticamente quando puder e retorne à lógica do [disjuntor](transient-fault-handling.md#circuitbreakers) quando não puder.</span><span class="sxs-lookup"><span data-stu-id="43e3d-208">[Handle transient faults](transient-fault-handling.md) by implementing intelligent retry logic, so that your app recovers automatically when it can and falls back to [circuit breaker](transient-fault-handling.md#circuitbreakers) logic when it can't.</span></span>
- <span data-ttu-id="43e3d-209">Use o [Caching distribuído](distributed-caching.md) para minimizar problemas de taxa de transferência, latência e conexão com acesso ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="43e3d-209">Use [distributed caching](distributed-caching.md) in order to minimize throughput, latency, and connection problems with database access.</span></span>
- <span data-ttu-id="43e3d-210">Implemente o acoplamento flexível por meio do [padrão de trabalho centrado em fila](queue-centric-work-pattern.md), para que o front-end do aplicativo possa continuar funcionando quando o back-end estiver inativo.</span><span class="sxs-lookup"><span data-stu-id="43e3d-210">Implement loose coupling via the [queue-centric work pattern](queue-centric-work-pattern.md), so that your app front end can continue to work when the back end is down.</span></span>

## <a name="resources"></a><span data-ttu-id="43e3d-211">Recursos</span><span class="sxs-lookup"><span data-stu-id="43e3d-211">Resources</span></span>

<span data-ttu-id="43e3d-212">Para obter mais informações, consulte os capítulos posteriores neste livro eletrônico e os recursos a seguir.</span><span class="sxs-lookup"><span data-stu-id="43e3d-212">For more information, see later chapters in this e-book and the following resources.</span></span>

<span data-ttu-id="43e3d-213">Documentação:</span><span class="sxs-lookup"><span data-stu-id="43e3d-213">Documentation:</span></span>

- <span data-ttu-id="43e3d-214">[FailSafe: Diretrizes para arquiteturas de nuvem resilientes](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-214">[Failsafe: Guidance for Resilient Cloud Architectures](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span></span> <span data-ttu-id="43e3d-215">White Paper por Marc Mercuri, Ulrich Homann e Andrew TOWNHILL.</span><span class="sxs-lookup"><span data-stu-id="43e3d-215">White paper by Marc Mercuri, Ulrich Homann, and Andrew Townhill.</span></span> <span data-ttu-id="43e3d-216">Versão da página da Web da série de vídeos FailSafe.</span><span class="sxs-lookup"><span data-stu-id="43e3d-216">Web page version of the FailSafe video series.</span></span>
- <span data-ttu-id="43e3d-217">[Práticas recomendadas para o design de serviços em grande escala nos serviços de nuvem do Azure](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-217">[Best Practices for the Design of Large-Scale Services on Azure Cloud Services](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span></span> <span data-ttu-id="43e3d-218">White Paper por Mark Simms e Michael Thomassy.</span><span class="sxs-lookup"><span data-stu-id="43e3d-218">White paper by Mark Simms and Michael Thomassy.</span></span>
- <span data-ttu-id="43e3d-219">[Diretrizes técnicas de continuidade de negócios do Azure](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-219">[Azure Business Continuity Technical Guidance](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx).</span></span> <span data-ttu-id="43e3d-220">White Paper de Patrick Wickline e Jason Roth.</span><span class="sxs-lookup"><span data-stu-id="43e3d-220">White paper by Patrick Wickline and Jason Roth.</span></span>
- <span data-ttu-id="43e3d-221">[Recuperação de desastre e alta disponibilidade para aplicativos do Azure](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-221">[Disaster Recovery and High Availability for Azure Applications](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx).</span></span> <span data-ttu-id="43e3d-222">White Paper de Michael McKeown, Hanu Kommalapati e Jason Roth.</span><span class="sxs-lookup"><span data-stu-id="43e3d-222">White paper by Michael McKeown, Hanu Kommalapati, and Jason Roth.</span></span>
- <span data-ttu-id="43e3d-223">[Práticas e padrões da Microsoft – diretrizes do Azure](https://msdn.microsoft.com/library/dn568099.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-223">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="43e3d-224">Consulte Diretrizes de implantação de vários data centers, padrão de disjuntor.</span><span class="sxs-lookup"><span data-stu-id="43e3d-224">See Multi Data Center Deployment guidance, Circuit breaker pattern.</span></span>
- <span data-ttu-id="43e3d-225">[Suporte do Azure-contratos de nível de serviço](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="43e3d-225">[Azure Support - Service Level Agreements](https://azure.microsoft.com/support/legal/sla/).</span></span>
- <span data-ttu-id="43e3d-226">[Continuidade de negócios no banco de dados SQL do Azure](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-226">[Business Continuity in Azure SQL Database](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx).</span></span> <span data-ttu-id="43e3d-227">Documentação sobre recursos de alta disponibilidade e recuperação de desastre do banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="43e3d-227">Documentation about SQL Database high availability and disaster recovery features.</span></span>
- <span data-ttu-id="43e3d-228">[Alta disponibilidade e recuperação de desastre para SQL Server em máquinas virtuais do Azure](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx).</span><span class="sxs-lookup"><span data-stu-id="43e3d-228">[High Availability and Disaster Recovery for SQL Server in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx).</span></span>

<span data-ttu-id="43e3d-229">Vídeos:</span><span class="sxs-lookup"><span data-stu-id="43e3d-229">Videos:</span></span>

- <span data-ttu-id="43e3d-230">[FailSafe: criando serviços de nuvem escalonáveis e resilientes](https://channel9.msdn.com/Series/FailSafe).</span><span class="sxs-lookup"><span data-stu-id="43e3d-230">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="43e3d-231">Série de nove partes de Ulrich Homann, Marc Mercuri e de Mark Simms.</span><span class="sxs-lookup"><span data-stu-id="43e3d-231">Nine-part series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="43e3d-232">Apresenta conceitos de alto nível e princípios arquitetônicos de uma maneira muito acessível e interessante, com histórias extraídas da experiência CAT (equipe de consultoria para clientes) da Microsoft com os clientes reais.</span><span class="sxs-lookup"><span data-stu-id="43e3d-232">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="43e3d-233">Os episódios 1 e 8 se aprofundam nos motivos para criar aplicativos de nuvem a fim de sobreviver a falhas.</span><span class="sxs-lookup"><span data-stu-id="43e3d-233">Episodes 1 and 8 go in depth into the reasons for designing cloud apps to survive failures.</span></span> <span data-ttu-id="43e3d-234">Veja também a discussão de acompanhamento de limitação no episódio 2 a partir de 49:57, a discussão sobre pontos de falha e modos de falha no episódio 2 a partir de 56:05, e a discussão de separadores de circuito no episódio 3 a partir de 40:55.</span><span class="sxs-lookup"><span data-stu-id="43e3d-234">See also the follow-up discussion of throttling in episode 2 starting at 49:57, the discussion of failure points and failure modes in episode 2 starting at 56:05, and the discussion of circuit breakers in episode 3 starting at 40:55.</span></span>
- <span data-ttu-id="43e3d-235">[Criando Big: lições aprendidas de clientes do Azure-parte II](https://channel9.msdn.com/Events/Build/2012/3-030).</span><span class="sxs-lookup"><span data-stu-id="43e3d-235">[Building Big: Lessons learned from Azure customers - Part II](https://channel9.msdn.com/Events/Build/2012/3-030).</span></span> <span data-ttu-id="43e3d-236">Mark Simms fala sobre o design de falhas e instrumentação de tudo.</span><span class="sxs-lookup"><span data-stu-id="43e3d-236">Mark Simms talks about designing for failure and instrumenting everything.</span></span> <span data-ttu-id="43e3d-237">Semelhante à série FailSafe, mas apresenta detalhes mais detalhados.</span><span class="sxs-lookup"><span data-stu-id="43e3d-237">Similar to the Failsafe series but goes into more how-to details.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="43e3d-238">[Anterior](unstructured-blob-storage.md)
> [Próximo](monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="43e3d-238">[Previous](unstructured-blob-storage.md)
[Next](monitoring-and-telemetry.md)</span></span>
