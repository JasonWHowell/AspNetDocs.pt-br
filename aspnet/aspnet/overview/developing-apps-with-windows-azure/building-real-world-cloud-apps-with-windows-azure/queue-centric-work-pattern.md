---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/queue-centric-work-pattern
title: Padrão de trabalho centrado em fila (criando aplicativos de nuvem do mundo real com o Azure) | Microsoft Docs
author: MikeWasson
description: A criação de aplicativos de nuvem do mundo real com o livro eletrônico do Azure é baseada em uma apresentação desenvolvida por Scott Guthrie. Ele explica 13 padrões e práticas que podem...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: cc1ad51b-40c3-4c68-8620-9aaa0fd1f6cf
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/queue-centric-work-pattern
msc.type: authoredcontent
ms.openlocfilehash: 1177336b25479c06706227e5c8ff4d027cdaebb8
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/19/2020
ms.locfileid: "77456979"
---
# <a name="queue-centric-work-pattern-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="f914d-104">Padrão de trabalho centrado em fila (criando aplicativos de nuvem do mundo real com o Azure)</span><span class="sxs-lookup"><span data-stu-id="f914d-104">Queue-Centric Work Pattern (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="f914d-105">por [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="f914d-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="f914d-106">[Baixar o projeto de ti](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) ou [baixar o livro eletrônico](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="f914d-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="f914d-107">A **criação de aplicativos de nuvem do mundo real com** o livro eletrônico do Azure é baseada em uma apresentação desenvolvida por Scott Guthrie.</span><span class="sxs-lookup"><span data-stu-id="f914d-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="f914d-108">Ele explica 13 padrões e práticas que podem ajudá-lo a desenvolver com sucesso aplicativos Web para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="f914d-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="f914d-109">Para obter informações sobre o livro eletrônico, consulte [o primeiro capítulo](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="f914d-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="f914d-110">Anteriormente, vimos que o uso de vários serviços pode resultar em um SLA "composto", no qual o SLA efetivo do aplicativo é o *produto* dos SLAs individuais.</span><span class="sxs-lookup"><span data-stu-id="f914d-110">Earlier, we saw that using multiple services can result in a "composite" SLA, where the app's effective SLA is the *product* of the individual SLAs.</span></span> <span data-ttu-id="f914d-111">Por exemplo, o aplicativo corrigir ti usa sites da Web, armazenamento e banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="f914d-111">For example, the Fix It app uses Web Sites, Storage, and SQL Database.</span></span> <span data-ttu-id="f914d-112">Se qualquer um desses serviços falhar, o aplicativo retornará um erro ao usuário.</span><span class="sxs-lookup"><span data-stu-id="f914d-112">If any one of these services fails, the app will return an error to the user.</span></span>

<span data-ttu-id="f914d-113">O Caching é uma boa maneira de lidar com falhas transitórias para conteúdo somente leitura.</span><span class="sxs-lookup"><span data-stu-id="f914d-113">Caching is a good way to handle transient failures for read-only content.</span></span> <span data-ttu-id="f914d-114">Mas e se seu aplicativo precisar fazer o trabalho?</span><span class="sxs-lookup"><span data-stu-id="f914d-114">But what if your application needs to do work?</span></span> <span data-ttu-id="f914d-115">Por exemplo, quando o usuário envia uma nova tarefa corrigir ti, o aplicativo não pode simplesmente colocar a tarefa no cache.</span><span class="sxs-lookup"><span data-stu-id="f914d-115">For example, when the user submits a new Fix It task, the app can't just put the task into the cache.</span></span> <span data-ttu-id="f914d-116">O aplicativo precisa gravar a tarefa corrigir em um repositório de dados persistente, para que possa ser processada.</span><span class="sxs-lookup"><span data-stu-id="f914d-116">The app needs to write the Fix It task into a persistent data store, so it can be processed.</span></span>

<span data-ttu-id="f914d-117">É aí que entra o padrão de trabalho centrado na fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-117">That's where the queue-centric work pattern comes in.</span></span> <span data-ttu-id="f914d-118">Esse padrão permite um acoplamento flexível entre uma camada da Web e um serviço de back-end.</span><span class="sxs-lookup"><span data-stu-id="f914d-118">This pattern enables loose coupling between a web tier and a backend service.</span></span>

<span data-ttu-id="f914d-119">Veja como o padrão funciona.</span><span class="sxs-lookup"><span data-stu-id="f914d-119">Here's how the pattern works.</span></span> <span data-ttu-id="f914d-120">Quando o aplicativo recebe uma solicitação, ele coloca um item de trabalho em uma fila e retorna imediatamente a resposta.</span><span class="sxs-lookup"><span data-stu-id="f914d-120">When the application gets a request, it puts a work item onto a queue and immediately returns the response.</span></span> <span data-ttu-id="f914d-121">Em seguida, um processo de back-end separado extrai itens de trabalho da fila e faz o trabalho.</span><span class="sxs-lookup"><span data-stu-id="f914d-121">Then a separate backend process pulls work items from the queue and does the work.</span></span>

<span data-ttu-id="f914d-122">O padrão de trabalho centrado em fila é útil para:</span><span class="sxs-lookup"><span data-stu-id="f914d-122">The queue-centric work pattern is useful for:</span></span>

- <span data-ttu-id="f914d-123">Trabalho que é demorado (alta latência).</span><span class="sxs-lookup"><span data-stu-id="f914d-123">Work that is time consuming (high latency).</span></span>
- <span data-ttu-id="f914d-124">Trabalho que requer um serviço externo que talvez nem sempre esteja disponível.</span><span class="sxs-lookup"><span data-stu-id="f914d-124">Work that requires an external service that might not always be available.</span></span>
- <span data-ttu-id="f914d-125">Trabalhe com uso intensivo de recursos (alta CPU).</span><span class="sxs-lookup"><span data-stu-id="f914d-125">Work that is resource-intensive (high CPU).</span></span>
- <span data-ttu-id="f914d-126">O trabalho que se beneficiaria do nivelamento de taxa (sujeito a picos de carga repentinos).</span><span class="sxs-lookup"><span data-stu-id="f914d-126">Work that would benefit from rate leveling (subject to sudden load bursts).</span></span>

## <a name="reduced-latency"></a><span data-ttu-id="f914d-127">Latência reduzida</span><span class="sxs-lookup"><span data-stu-id="f914d-127">Reduced Latency</span></span>

<span data-ttu-id="f914d-128">As filas são úteis sempre que você estiver realizando trabalho demorado.</span><span class="sxs-lookup"><span data-stu-id="f914d-128">Queues are useful any time you are doing time-consuming work.</span></span> <span data-ttu-id="f914d-129">Se uma tarefa levar alguns segundos ou mais, em vez de bloquear o usuário final, coloque o item de trabalho em uma fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-129">If a task takes a few seconds or longer, instead of blocking the end user, put the work item into a queue.</span></span> <span data-ttu-id="f914d-130">Diga ao usuário "Estamos trabalhando nele" e, em seguida, use um ouvinte de fila para processar a tarefa em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="f914d-130">Tell the user "We're working on it," and then use a queue listener to process the task in the background.</span></span>

<span data-ttu-id="f914d-131">Por exemplo, quando você compra algo em um varejista online, o site confirma seu pedido imediatamente.</span><span class="sxs-lookup"><span data-stu-id="f914d-131">For example, when you purchase something at an online retailer, the web site confirms your order immediately.</span></span> <span data-ttu-id="f914d-132">Mas isso não significa que suas coisas já estão em um caminhão sendo entregue.</span><span class="sxs-lookup"><span data-stu-id="f914d-132">But that doesn't mean your stuff is already in a truck being delivered.</span></span> <span data-ttu-id="f914d-133">Eles colocam uma tarefa em uma fila e, em segundo plano, estão fazendo a verificação de crédito, preparando seus itens para envio e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f914d-133">They put a task in a queue, and in the background they are doing the credit check, preparing your items for shipping, and so forth.</span></span>

<span data-ttu-id="f914d-134">Para cenários com latência curta, o tempo total de ponta a ponta pode ser mais usado em uma fila, comparada com a execução da tarefa de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="f914d-134">For scenarios with short latency, the total end-to-end time might be longer using a queue, compared with doing the task synchronously.</span></span> <span data-ttu-id="f914d-135">Mas mesmo assim, os outros benefícios podem superar essa desvantagem.</span><span class="sxs-lookup"><span data-stu-id="f914d-135">But even then, the other benefits can outweigh that disadvantage.</span></span>

## <a name="increased-reliability"></a><span data-ttu-id="f914d-136">Maior confiabilidade</span><span class="sxs-lookup"><span data-stu-id="f914d-136">Increased Reliability</span></span>

<span data-ttu-id="f914d-137">Na versão do Fix it que temos examinado até agora, o front-end da Web está rigidamente acoplado ao back-end do banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="f914d-137">In the version of Fix It that we've been looking at so far, the web front-end is tightly coupled with the SQL Database back-end.</span></span> <span data-ttu-id="f914d-138">Se o serviço do banco de dados SQL não estiver disponível, o usuário receberá um erro.</span><span class="sxs-lookup"><span data-stu-id="f914d-138">If the SQL database service is unavailable, the user gets an error.</span></span> <span data-ttu-id="f914d-139">Se as repetições não funcionarem (ou seja, a falha é mais do que transitória), a única coisa que você pode fazer é mostrar um erro e pedir que o usuário tente novamente mais tarde.</span><span class="sxs-lookup"><span data-stu-id="f914d-139">If retries don't work (that is, the failure is more than transient), the only thing you can do is show an error and ask the user to try again later.</span></span>

![Diagrama mostrando a falha de front-end da Web quando o back-end do banco de dados SQL falha](queue-centric-work-pattern/_static/image1.png)

<span data-ttu-id="f914d-141">Usando filas, quando um usuário envia uma tarefa corrigir, o aplicativo grava uma mensagem na fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-141">Using queues, when a user submits a Fix It task, the app writes a message to the queue.</span></span> <span data-ttu-id="f914d-142">A carga da mensagem é uma representação [JSON](http://json.org/) da tarefa.</span><span class="sxs-lookup"><span data-stu-id="f914d-142">The message payload is a [JSON](http://json.org/) representation of the task.</span></span> <span data-ttu-id="f914d-143">Assim que a mensagem for gravada na fila, o aplicativo retornará e mostrará imediatamente uma mensagem de êxito ao usuário.</span><span class="sxs-lookup"><span data-stu-id="f914d-143">As soon as the message is written to the queue, the app returns and immediately shows a success message to the user.</span></span>

<span data-ttu-id="f914d-144">Se qualquer um dos serviços de back-end, como o banco de dados SQL ou o ouvinte de fila, ficar offline, os usuários ainda poderão enviar novas tarefas de correção de ti.</span><span class="sxs-lookup"><span data-stu-id="f914d-144">If any of the backend services – such as the SQL database or the queue listener -- go offline, users can still submit new Fix It tasks.</span></span> <span data-ttu-id="f914d-145">As mensagens só serão colocadas em fila até que os serviços de back-end estejam disponíveis novamente.</span><span class="sxs-lookup"><span data-stu-id="f914d-145">The messages will just queue up until the backend services are available again.</span></span> <span data-ttu-id="f914d-146">Nesse ponto, os serviços de back-end se acumularão na pendência.</span><span class="sxs-lookup"><span data-stu-id="f914d-146">At that point, the backend services will catch up on the backlog.</span></span>

![Diagrama mostrando o front-end da Web continuando a funcionar quando há um erro de banco de dados SQL](queue-centric-work-pattern/_static/image2.png)

<span data-ttu-id="f914d-148">Além disso, agora você pode adicionar mais lógica de back-end sem se preocupar com a resiliência do front-end.</span><span class="sxs-lookup"><span data-stu-id="f914d-148">Moreover, now you can add more backend logic without worrying about the resiliency of the front end.</span></span> <span data-ttu-id="f914d-149">Por exemplo, talvez você queira enviar uma mensagem de email ou SMS para o proprietário sempre que uma nova correção for atribuída.</span><span class="sxs-lookup"><span data-stu-id="f914d-149">For example, you might want to send an email or SMS message to the owner whenever a new Fix It is assigned.</span></span> <span data-ttu-id="f914d-150">Se o email ou o serviço SMS ficar indisponível, você poderá processar todo o resto e, em seguida, colocar uma mensagem em uma fila separada para enviar mensagens de email/SMS.</span><span class="sxs-lookup"><span data-stu-id="f914d-150">If the email or SMS service becomes unavailable, you can process everything else, and then put a message into a separate queue for sending email/SMS messages.</span></span>

<span data-ttu-id="f914d-151">Anteriormente, nosso SLA eficaz era aplicativos Web &times; armazenamento &times; banco de dados SQL = 99,7%.</span><span class="sxs-lookup"><span data-stu-id="f914d-151">Previously, our effective SLA was Web Apps &times; Storage &times; SQL Database = 99.7%.</span></span> <span data-ttu-id="f914d-152">(Consulte [design para sobreviver a falhas](design-to-survive-failures.md).)</span><span class="sxs-lookup"><span data-stu-id="f914d-152">(See [Design to Survive Failures](design-to-survive-failures.md).)</span></span>

<span data-ttu-id="f914d-153">Quando alteramos o aplicativo para usar uma fila, o front-end da Web depende apenas de aplicativos Web e armazenamento, para um SLA composto de 99,8%.</span><span class="sxs-lookup"><span data-stu-id="f914d-153">When we change the app to use a queue, the web front end depends only on Web Apps and Storage, for a composite SLA of 99.8%.</span></span> <span data-ttu-id="f914d-154">(Observe que as filas fazem parte do serviço de armazenamento do Azure, para que elas sejam incluídas no mesmo SLA que o armazenamento de BLOBs.)</span><span class="sxs-lookup"><span data-stu-id="f914d-154">(Note that queues are part of the Azure storage service, so they are included in the same SLA as blob storage.)</span></span>

<span data-ttu-id="f914d-155">Se você precisar de maneira ainda melhor do que 99,8%, poderá criar duas filas em duas regiões diferentes.</span><span class="sxs-lookup"><span data-stu-id="f914d-155">If you need even better than 99.8%, you can create two queues in two different regions.</span></span> <span data-ttu-id="f914d-156">Designe um como o primário e o outro como o secundário.</span><span class="sxs-lookup"><span data-stu-id="f914d-156">Designate one as the primary, and the other as the secondary.</span></span> <span data-ttu-id="f914d-157">Em seu aplicativo, faça failover para a fila secundária se a fila primária não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="f914d-157">In your app, fail over to the secondary queue if the primary queue is not available.</span></span> <span data-ttu-id="f914d-158">A possibilidade de ambos estarem indisponíveis ao mesmo tempo é muito pequena.</span><span class="sxs-lookup"><span data-stu-id="f914d-158">The chance of both being unavailable at the same time is very small.</span></span>

## <a name="rate-leveling-and-independent-scaling"></a><span data-ttu-id="f914d-159">Nivelamento de taxa e dimensionamento independente</span><span class="sxs-lookup"><span data-stu-id="f914d-159">Rate Leveling and Independent Scaling</span></span>

<span data-ttu-id="f914d-160">As filas também são úteis para algo chamado *nivelamento de taxa* ou *nivelamento de carga*.</span><span class="sxs-lookup"><span data-stu-id="f914d-160">Queues are also useful for something called *rate leveling* or *load leveling*.</span></span>

<span data-ttu-id="f914d-161">Os aplicativos Web geralmente são suscetíveis a picos repentinos no tráfego.</span><span class="sxs-lookup"><span data-stu-id="f914d-161">Web apps are often susceptible to sudden bursts in traffic.</span></span> <span data-ttu-id="f914d-162">Embora você possa usar o dimensionamento automático para adicionar automaticamente servidores Web para lidar com o aumento do tráfego da Web, a autoescala pode não ser capaz de reagir rapidamente o suficiente para lidar com picos repentinos na carga.</span><span class="sxs-lookup"><span data-stu-id="f914d-162">While you can use autoscaling to automatically add web servers to handle increased web traffic, autoscaling might not be able to react quickly enough to handle abrupt spikes in load.</span></span> <span data-ttu-id="f914d-163">Se os servidores Web puderem descarregar parte do trabalho que precisam fazer gravando uma mensagem em uma fila, eles poderão lidar com mais tráfego.</span><span class="sxs-lookup"><span data-stu-id="f914d-163">If the web servers can offload some of the work they have to do by writing a message to a queue, they can handle more traffic.</span></span> <span data-ttu-id="f914d-164">Um serviço de back-end pode ler mensagens da fila e processá-las.</span><span class="sxs-lookup"><span data-stu-id="f914d-164">A backend service can then read messages from the queue and process them.</span></span> <span data-ttu-id="f914d-165">A profundidade da fila aumentará ou diminuirá conforme a carga de entrada varia.</span><span class="sxs-lookup"><span data-stu-id="f914d-165">The depth of the queue will grow or shrink as the incoming load varies.</span></span>

<span data-ttu-id="f914d-166">Com a maior parte de seu trabalho demorado, carregado para um serviço de back-end, a camada da Web pode responder mais facilmente a picos repentinos no tráfego.</span><span class="sxs-lookup"><span data-stu-id="f914d-166">With much of its time-consuming work off-loaded to a backend service, the web tier can more easily respond to sudden spikes in traffic.</span></span> <span data-ttu-id="f914d-167">E você economiza dinheiro porque qualquer quantidade determinada de tráfego pode ser tratada por menos servidores Web.</span><span class="sxs-lookup"><span data-stu-id="f914d-167">And you save money because any given amount of traffic can be handled by fewer web servers.</span></span>

<span data-ttu-id="f914d-168">Você pode dimensionar a camada da Web e o serviço de back-end independentemente.</span><span class="sxs-lookup"><span data-stu-id="f914d-168">You can scale the web tier and backend service independently.</span></span> <span data-ttu-id="f914d-169">Por exemplo, você pode precisar de três servidores Web, mas apenas um servidor processa mensagens da fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-169">For example, you might need three web servers but only one server processing queue messages.</span></span> <span data-ttu-id="f914d-170">Ou, se você estiver executando uma tarefa de computação intensiva em segundo plano, talvez precise de mais servidores back-end.</span><span class="sxs-lookup"><span data-stu-id="f914d-170">Or if you're running a compute-intensive task in the background, you might need more backend servers.</span></span>

![](queue-centric-work-pattern/_static/image3.png)

<span data-ttu-id="f914d-171">O dimensionamento automático funciona com os serviços de back-end, bem como com a camada da Web.</span><span class="sxs-lookup"><span data-stu-id="f914d-171">Autoscaling works with backend services as well as with the web tier.</span></span> <span data-ttu-id="f914d-172">Você pode escalar ou reduzir verticalmente o número de VMs que estão processando as tarefas na fila, com base no uso da CPU das VMs de back-end.</span><span class="sxs-lookup"><span data-stu-id="f914d-172">You can scale up or scale down the number of VMs that are processing the tasks in the queue, based on the CPU usage of the backend VMs.</span></span> <span data-ttu-id="f914d-173">Ou, você pode dimensionar automaticamente com base em quantos itens estão em uma fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-173">Or, you can autoscale based on how many items are in a queue.</span></span> <span data-ttu-id="f914d-174">Por exemplo, você pode informar ao dimensionamento automático para tentar manter no máximo 10 itens na fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-174">For example, you can tell autoscale to try to keep no more than 10 items in the queue.</span></span> <span data-ttu-id="f914d-175">Se a fila tiver mais de 10 itens, o dimensionamento automático adicionará VMs.</span><span class="sxs-lookup"><span data-stu-id="f914d-175">If the queue has more than 10 items, autoscale will add VMs.</span></span> <span data-ttu-id="f914d-176">Quando eles forem atualizados, o dimensionamento automático subdividirá as VMs extras.</span><span class="sxs-lookup"><span data-stu-id="f914d-176">When they catch up, autoscale will tear down the extra VMs.</span></span>

## <a name="adding-queues-to-the-fix-it-application"></a><span data-ttu-id="f914d-177">Adicionando filas ao aplicativo corrigir ti</span><span class="sxs-lookup"><span data-stu-id="f914d-177">Adding Queues to the Fix It Application</span></span>

<span data-ttu-id="f914d-178">Para implementar o padrão de fila, precisamos fazer duas alterações no aplicativo Fix it.</span><span class="sxs-lookup"><span data-stu-id="f914d-178">To implement the queue pattern, we need to make two changes to the Fix It app.</span></span>

- <span data-ttu-id="f914d-179">Quando um usuário envia uma nova tarefa corrigir ti, coloca a tarefa na fila, em vez de gravá-la no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f914d-179">When a user submits a new Fix It task, put the task in the queue, instead of writing it to the database.</span></span>
- <span data-ttu-id="f914d-180">Crie um serviço de back-end que processa mensagens na fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-180">Create a back-end service that processes messages in the queue.</span></span>

<span data-ttu-id="f914d-181">Para a fila, usaremos o serviço de [armazenamento de filas do Azure](https://www.windowsazure.com/develop/net/how-to-guides/queue-service/).</span><span class="sxs-lookup"><span data-stu-id="f914d-181">For the queue, we'll use the [Azure Queue Storage Service](https://www.windowsazure.com/develop/net/how-to-guides/queue-service/).</span></span> <span data-ttu-id="f914d-182">Outra opção é usar o [barramento de serviço do Azure](https://docs.microsoft.com/azure/service-bus/).</span><span class="sxs-lookup"><span data-stu-id="f914d-182">Another option is to use [Azure Service Bus](https://docs.microsoft.com/azure/service-bus/).</span></span>

<span data-ttu-id="f914d-183">Para decidir qual serviço de fila usar, considere como seu aplicativo precisa enviar e receber as mensagens na fila:</span><span class="sxs-lookup"><span data-stu-id="f914d-183">To decide which queue service to use, consider how your app needs to send and receive the messages in the queue:</span></span>

- <span data-ttu-id="f914d-184">Se você tiver produtores de cooperação e consumidores concorrentes, considere usar o serviço de armazenamento de filas do Azure.</span><span class="sxs-lookup"><span data-stu-id="f914d-184">If you have cooperating producers and competing consumers, consider using Azure Queue Storage Service.</span></span> <span data-ttu-id="f914d-185">"Produtores de cooperação" significa que vários processos estão adicionando mensagens a uma fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-185">"Cooperating producers" means multiple processes are adding messages to a queue.</span></span> <span data-ttu-id="f914d-186">"Consumidores concorrentes" significa que vários processos estão extraindo as mensagens da fila para processá-las, mas qualquer mensagem pode ser processada apenas por um "consumidor".</span><span class="sxs-lookup"><span data-stu-id="f914d-186">"Competing consumers" means multiple processes are pulling messages off the queue to process them, but any given message can only be processed by one "consumer."</span></span> <span data-ttu-id="f914d-187">Se você precisar de mais taxa de transferência do que pode obter com uma única fila, use filas adicionais e/ou contas de armazenamento adicionais.</span><span class="sxs-lookup"><span data-stu-id="f914d-187">If you need more throughput than you can get with a single queue, use additional queues and/or additional storage accounts.</span></span>
- <span data-ttu-id="f914d-188">Se você precisar de um [modelo de publicação/assinatura](http://en.wikipedia.org/wiki/Publish/subscribe), considere o uso de filas do barramento de serviço do Azure.</span><span class="sxs-lookup"><span data-stu-id="f914d-188">If you need a [publish/subscribe model](http://en.wikipedia.org/wiki/Publish/subscribe), consider using Azure Service Bus Queues.</span></span>

<span data-ttu-id="f914d-189">O aplicativo corrigir ti se ajusta aos produtores de cooperação e aos consumidores concorrentes.</span><span class="sxs-lookup"><span data-stu-id="f914d-189">The Fix It app fits the cooperating producers and competing consumers model.</span></span>

<span data-ttu-id="f914d-190">Outra consideração é a disponibilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f914d-190">Another consideration is application availability.</span></span> <span data-ttu-id="f914d-191">O serviço de armazenamento de filas faz parte do mesmo serviço que estamos usando para armazenamento de BLOBs, portanto, usá-lo não tem nenhum efeito sobre nosso SLA.</span><span class="sxs-lookup"><span data-stu-id="f914d-191">The Queue Storage Service is part of the same service that we're using for blob storage, so using it has no effect on our SLA.</span></span> <span data-ttu-id="f914d-192">O barramento de serviço do Azure é um serviço separado com seu próprio SLA.</span><span class="sxs-lookup"><span data-stu-id="f914d-192">Azure Service Bus is a separate service with its own SLA.</span></span> <span data-ttu-id="f914d-193">Se utilizamos filas do barramento de serviço, teríamos que considerar uma porcentagem adicional de SLA, e nosso SLA de composição seria menor.</span><span class="sxs-lookup"><span data-stu-id="f914d-193">If we used Service Bus Queues, we would have to factor in an additional SLA percentage, and our composite SLA would be lower.</span></span> <span data-ttu-id="f914d-194">Quando você estiver escolhendo um serviço fila, certifique-se de entender o impacto de sua escolha na disponibilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f914d-194">When you're choosing a queue service, make sure you understand the impact of your choice on application availability.</span></span> <span data-ttu-id="f914d-195">Para obter mais informações, consulte a seção [recursos](#resources) .</span><span class="sxs-lookup"><span data-stu-id="f914d-195">For more information, see the [Resources](#resources) section.</span></span>

## <a name="creating-queue-messages"></a><span data-ttu-id="f914d-196">Criando mensagens da fila</span><span class="sxs-lookup"><span data-stu-id="f914d-196">Creating Queue Messages</span></span>

<span data-ttu-id="f914d-197">Para colocar uma tarefa corrigir na fila, o front-end da Web executa as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="f914d-197">To put a Fix It task on the queue, the web front end performs the following steps:</span></span>

1. <span data-ttu-id="f914d-198">Crie uma instância de [CloudQueueClient](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueueclient.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f914d-198">Create a [CloudQueueClient](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueueclient.aspx) instance.</span></span> <span data-ttu-id="f914d-199">A instância de `CloudQueueClient` é usada para executar solicitações no serviço fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-199">The `CloudQueueClient` instance is used to execute requests against the Queue Service.</span></span>
2. <span data-ttu-id="f914d-200">Crie a fila, caso ela ainda não exista.</span><span class="sxs-lookup"><span data-stu-id="f914d-200">Create the queue, if it doesn't exist yet.</span></span>
3. <span data-ttu-id="f914d-201">Serialize a tarefa corrigir ti.</span><span class="sxs-lookup"><span data-stu-id="f914d-201">Serialize the Fix It task.</span></span>
4. <span data-ttu-id="f914d-202">Chame [CloudQueue. AddMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.addmessageasync.aspx) para colocar a mensagem na fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-202">Call [CloudQueue.AddMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.addmessageasync.aspx) to put the message onto the queue.</span></span>

<span data-ttu-id="f914d-203">Faremos esse trabalho no construtor e `SendMessageAsync` método de uma nova classe `FixItQueueManager`.</span><span class="sxs-lookup"><span data-stu-id="f914d-203">We'll do this work in the constructor and `SendMessageAsync` method of a new `FixItQueueManager` class.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample1.cs?highlight=11-12,16,18-25)]

<span data-ttu-id="f914d-204">Aqui estamos usando a biblioteca [JSON.net](https://github.com/JamesNK/Newtonsoft.Json) para serializar o FixIt para o formato JSON.</span><span class="sxs-lookup"><span data-stu-id="f914d-204">Here we are using the [Json.NET](https://github.com/JamesNK/Newtonsoft.Json) library to serialize the fixit to JSON format.</span></span> <span data-ttu-id="f914d-205">Você pode usar qualquer abordagem de serialização que preferir.</span><span class="sxs-lookup"><span data-stu-id="f914d-205">You can use whatever serialization approach you prefer.</span></span> <span data-ttu-id="f914d-206">O JSON tem a vantagem de ser legível, embora seja menos detalhado do que XML.</span><span class="sxs-lookup"><span data-stu-id="f914d-206">JSON has the advantage of being human-readable, while being less verbose than XML.</span></span>

<span data-ttu-id="f914d-207">Código de qualidade de produção adicionaria lógica de tratamento de erros, pausar se o banco de dados ficou indisponível, tratar a recuperação mais corretamente, criar a fila na inicialização do aplicativo e gerenciar[mensagens "suspeitas"](https://msdn.microsoft.com/library/ms789028(v=vs.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="f914d-207">Production-quality code would add error handling logic, pause if the database became unavailable, handle recovery more cleanly, create the queue on application start-up, and manage "[poison" messages](https://msdn.microsoft.com/library/ms789028(v=vs.110).aspx).</span></span> <span data-ttu-id="f914d-208">(Uma mensagem suspeita é uma mensagem que não pode ser processada por algum motivo.</span><span class="sxs-lookup"><span data-stu-id="f914d-208">(A poison message is a message that cannot be processed for some reason.</span></span> <span data-ttu-id="f914d-209">Você não quer que as mensagens suspeitas estejam na fila, em que a função de trabalho tentará processá-las continuamente, falhar, tentar novamente, falhar e assim por diante.)</span><span class="sxs-lookup"><span data-stu-id="f914d-209">You don't want poison messages to sit in the queue, where the worker role will continually try to process them, fail, try again, fail, and so on.)</span></span>

<span data-ttu-id="f914d-210">No aplicativo MVC de front-end, precisamos atualizar o código que cria uma nova tarefa.</span><span class="sxs-lookup"><span data-stu-id="f914d-210">In the front-end MVC application, we need to update the code that creates a new task.</span></span> <span data-ttu-id="f914d-211">Em vez de colocar a tarefa no repositório, chame o método `SendMessageAsync` mostrado acima.</span><span class="sxs-lookup"><span data-stu-id="f914d-211">Instead of putting the task into the repository, call the `SendMessageAsync` method shown above.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample2.cs?highlight=10)]

## <a name="processing-queue-messages"></a><span data-ttu-id="f914d-212">Processando mensagens da fila</span><span class="sxs-lookup"><span data-stu-id="f914d-212">Processing Queue Messages</span></span>

<span data-ttu-id="f914d-213">Para processar mensagens na fila, criaremos um serviço de back-end.</span><span class="sxs-lookup"><span data-stu-id="f914d-213">To process messages in the queue, we'll create a backend service.</span></span> <span data-ttu-id="f914d-214">O serviço de back-end executará um loop infinito que executa as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="f914d-214">The backend service will run an infinite loop that performs the following steps:</span></span>

1. <span data-ttu-id="f914d-215">Obter a próxima mensagem da fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-215">Get the next message from the queue.</span></span>
2. <span data-ttu-id="f914d-216">Desserializar a mensagem para uma tarefa corrigir ti.</span><span class="sxs-lookup"><span data-stu-id="f914d-216">Deserialize the message to a Fix It task.</span></span>
3. <span data-ttu-id="f914d-217">Grave a tarefa corrigir ti no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f914d-217">Write the Fix It task to the database.</span></span>

<span data-ttu-id="f914d-218">Para hospedar o serviço de back-end, criaremos um serviço de nuvem do Azure que contém uma *função de trabalho*.</span><span class="sxs-lookup"><span data-stu-id="f914d-218">To host the backend service, we'll create an Azure Cloud Service that contains a *worker role*.</span></span> <span data-ttu-id="f914d-219">Uma função de trabalho consiste em uma ou mais VMs que podem fazer o processamento de back-end.</span><span class="sxs-lookup"><span data-stu-id="f914d-219">A worker role consists of one or more VMs that can do backend processing.</span></span> <span data-ttu-id="f914d-220">O código que é executado nessas VMs efetuará pull das mensagens da fila à medida que elas forem disponibilizadas.</span><span class="sxs-lookup"><span data-stu-id="f914d-220">The code that runs in these VMs will pull messages from the queue as they become available.</span></span> <span data-ttu-id="f914d-221">Para cada mensagem, desserializaremos a carga JSON e Gravaremos uma instância da entidade de tarefa corrigir ti no banco de dados, usando o mesmo repositório que usamos anteriormente na camada da Web.</span><span class="sxs-lookup"><span data-stu-id="f914d-221">For each message, we'll deserialize the JSON payload and write an instance of the Fix It Task entity to the database, using the same repository that we used earlier in the web tier.</span></span>

<span data-ttu-id="f914d-222">As etapas a seguir mostram como adicionar um projeto de função de trabalho a uma solução que tem um projeto Web padrão.</span><span class="sxs-lookup"><span data-stu-id="f914d-222">The following steps show how to add a worker role project to a solution that has a standard web project.</span></span> <span data-ttu-id="f914d-223">Essas etapas já foram feitas no projeto Fix it que você pode baixar.</span><span class="sxs-lookup"><span data-stu-id="f914d-223">These steps have already been done in the Fix It project that you can download.</span></span>

<span data-ttu-id="f914d-224">Primeiro, adicione um projeto de serviço de nuvem à solução do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f914d-224">First add a Cloud Service project to the Visual Studio solution.</span></span> <span data-ttu-id="f914d-225">Clique com o botão direito do mouse na solução e selecione **Adicionar**e **novo projeto**.</span><span class="sxs-lookup"><span data-stu-id="f914d-225">Right-click the solution and select **Add**, then **New Project**.</span></span> <span data-ttu-id="f914d-226">No painel esquerdo, expanda **Visual C#**  e selecione **nuvem**.</span><span class="sxs-lookup"><span data-stu-id="f914d-226">In the left pane, expand **Visual C#** and select **Cloud**.</span></span>

[![](queue-centric-work-pattern/_static/image5.png)](queue-centric-work-pattern/_static/image4.png)

<span data-ttu-id="f914d-227">Na caixa de diálogo **novo serviço de nuvem do Azure** , expanda o nó **Visual C#**  no painel esquerdo.</span><span class="sxs-lookup"><span data-stu-id="f914d-227">In the **New Azure Cloud Service** dialog, expand the **Visual C#** node on the left pane.</span></span> <span data-ttu-id="f914d-228">Selecione **função de trabalho** e clique no ícone de seta para a direita.</span><span class="sxs-lookup"><span data-stu-id="f914d-228">Select **Worker Role** and click the right-arrow icon.</span></span>

![](queue-centric-work-pattern/_static/image6.png)

<span data-ttu-id="f914d-229">(Observe que você também pode adicionar uma *função Web*.</span><span class="sxs-lookup"><span data-stu-id="f914d-229">(Notice that you can also add a *web role*.</span></span> <span data-ttu-id="f914d-230">Poderíamos executar a correção de front-end no mesmo serviço de nuvem em vez de executá-lo em um site do Azure.</span><span class="sxs-lookup"><span data-stu-id="f914d-230">We could run the Fix It front-end in the same Cloud Service instead of running it in an Azure Web Site.</span></span> <span data-ttu-id="f914d-231">Isso tem algumas vantagens em tornar as conexões entre front-end e back-end mais fáceis de coordenar.</span><span class="sxs-lookup"><span data-stu-id="f914d-231">That has some advantages in making connections between front-end and back-end easier to coordinate.</span></span> <span data-ttu-id="f914d-232">No entanto, para manter essa demonstração simples, estamos mantendo o front-end em um aplicativo Web de Azure App serviço e apenas executando o back-end em um serviço de nuvem.)</span><span class="sxs-lookup"><span data-stu-id="f914d-232">However, to keep this demo simple, we're keeping the front-end in an Azure App Service Web App and only running the back-end in a Cloud Service.)</span></span>

<span data-ttu-id="f914d-233">Um nome padrão é atribuído à função de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f914d-233">A default name is assigned to the worker role.</span></span> <span data-ttu-id="f914d-234">Para alterar o nome, passe o mouse sobre a função de trabalho no painel direito e clique no ícone de lápis.</span><span class="sxs-lookup"><span data-stu-id="f914d-234">To change the name, hover the mouse over the worker role in the right pane, then click the pencil icon.</span></span>

![](queue-centric-work-pattern/_static/image7.png)

<span data-ttu-id="f914d-235">Clique em **OK** para concluir a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="f914d-235">Click **OK** to complete the dialog.</span></span> <span data-ttu-id="f914d-236">Isso adiciona dois projetos à solução do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f914d-236">This adds two projects to the Visual Studio solution.</span></span>

- <span data-ttu-id="f914d-237">um projeto do Azure que define o serviço de nuvem, incluindo informações de configuração.</span><span class="sxs-lookup"><span data-stu-id="f914d-237">an Azure project that defines the cloud service, including configuration information.</span></span>
- <span data-ttu-id="f914d-238">Um projeto de função de trabalho que define a função de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f914d-238">A worker role project that defines the worker role.</span></span>

![](queue-centric-work-pattern/_static/image8.png)

<span data-ttu-id="f914d-239">Para obter mais informações, consulte [criando um projeto do Azure com o Visual Studio.](https://msdn.microsoft.com/library/windowsazure/ee405487.aspx)</span><span class="sxs-lookup"><span data-stu-id="f914d-239">For more information, see [Creating an Azure Project with Visual Studio.](https://msdn.microsoft.com/library/windowsazure/ee405487.aspx)</span></span>

<span data-ttu-id="f914d-240">Dentro da função de trabalho, pesquisamos mensagens chamando o método `ProcessMessageAsync` da classe `FixItQueueManager` que vimos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="f914d-240">Inside the worker role, we poll for messages by calling the `ProcessMessageAsync` method of the `FixItQueueManager` class that we saw earlier.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample3.cs?highlight=25)]

<span data-ttu-id="f914d-241">O método `ProcessMessagesAsync` verifica se há uma mensagem aguardando.</span><span class="sxs-lookup"><span data-stu-id="f914d-241">The `ProcessMessagesAsync` method checks if there's a message waiting.</span></span> <span data-ttu-id="f914d-242">Se houver um, ele desserializa a mensagem em uma entidade `FixItTask` e salva a entidade no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f914d-242">If there is one, it deserializes the message into a `FixItTask` entity and saves the entity in the database.</span></span> <span data-ttu-id="f914d-243">Ele executa um loop até que a fila esteja vazia.</span><span class="sxs-lookup"><span data-stu-id="f914d-243">It loops until the queue is empty.</span></span>

[!code-csharp[Main](queue-centric-work-pattern/samples/sample4.cs)]

<span data-ttu-id="f914d-244">A sondagem de mensagens da fila gera um pequeno encargo de transação, portanto, quando não há nenhuma mensagem aguardando para ser processada, o método `RunAsync` da função de trabalho aguarda um segundo antes de fazer a sondagem novamente chamando `Task.Delay(1000)`.</span><span class="sxs-lookup"><span data-stu-id="f914d-244">Polling for queue messages incurs a small transaction charge, so when there's no message waiting to be processed, the worker role's `RunAsync` method waits a second before polling again by calling `Task.Delay(1000)`.</span></span>

<span data-ttu-id="f914d-245">Em um projeto Web, a adição de código assíncrono pode melhorar o desempenho automaticamente, pois o IIS gerencia um pool de threads limitado.</span><span class="sxs-lookup"><span data-stu-id="f914d-245">In a web project, adding asynchronous code can automatically improve performance because IIS manages a limited thread pool.</span></span> <span data-ttu-id="f914d-246">Esse não é o caso em um projeto de função de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f914d-246">That is not the case in a worker role project.</span></span> <span data-ttu-id="f914d-247">Para melhorar a escalabilidade da função de trabalho, você pode escrever código multi-threaded ou usar código assíncrono para implementar a [programação paralela](https://msdn.microsoft.com/library/ff963553.aspx).</span><span class="sxs-lookup"><span data-stu-id="f914d-247">To improve scalability of the worker role, you can write multi-threaded code or use asynchronous code to implement [parallel programming](https://msdn.microsoft.com/library/ff963553.aspx).</span></span> <span data-ttu-id="f914d-248">O exemplo não implementa a programação paralela, mas mostra como tornar o código assíncrono para que você possa implementar a programação paralela.</span><span class="sxs-lookup"><span data-stu-id="f914d-248">The sample doesn't implement parallel programming but shows how to make the code asynchronous so you can implement parallel programming.</span></span>

## <a name="summary"></a><span data-ttu-id="f914d-249">Resumo</span><span class="sxs-lookup"><span data-stu-id="f914d-249">Summary</span></span>

<span data-ttu-id="f914d-250">Neste capítulo, você viu como melhorar a capacidade de resposta, a confiabilidade e a escalabilidade do aplicativo implementando o padrão de trabalho centrado em fila.</span><span class="sxs-lookup"><span data-stu-id="f914d-250">In this chapter you've seen how to improve application responsiveness, reliability, and scalability by implementing the queue-centric work pattern.</span></span>

<span data-ttu-id="f914d-251">Este é o último dos 13 padrões abordados neste livro eletrônico, mas há, naturalmente, muitos outros padrões e práticas que podem ajudá-lo a criar aplicativos de nuvem bem-sucedidos.</span><span class="sxs-lookup"><span data-stu-id="f914d-251">This is the last of the 13 patterns covered in this e-book, but there are of course many other patterns and practices that can help you build successful cloud apps.</span></span> <span data-ttu-id="f914d-252">O [capítulo final](more-patterns-and-guidance.md) fornece links para recursos para tópicos que não foram abordados nesses 13 padrões.</span><span class="sxs-lookup"><span data-stu-id="f914d-252">The [final chapter](more-patterns-and-guidance.md) provides links to resources for topics that haven't been covered in these 13 patterns.</span></span>

<a id="resources"></a>
## <a name="resources"></a><span data-ttu-id="f914d-253">Recursos</span><span class="sxs-lookup"><span data-stu-id="f914d-253">Resources</span></span>

<span data-ttu-id="f914d-254">Para obter mais informações sobre filas, consulte os recursos a seguir.</span><span class="sxs-lookup"><span data-stu-id="f914d-254">For more information about queues, see the following resources.</span></span>

<span data-ttu-id="f914d-255">Documentação:</span><span class="sxs-lookup"><span data-stu-id="f914d-255">Documentation:</span></span>

- <span data-ttu-id="f914d-256">[Armazenamento do Microsoft Azure filas parte 1: introdução](https://www.red-gate.com/simple-talk/cloud/platform-as-a-service/microsoft-azure-storage-queues-part-1-getting-started/).</span><span class="sxs-lookup"><span data-stu-id="f914d-256">[Microsoft Azure Storage Queues Part 1: Getting Started](https://www.red-gate.com/simple-talk/cloud/platform-as-a-service/microsoft-azure-storage-queues-part-1-getting-started/).</span></span> <span data-ttu-id="f914d-257">Artigo por Roman Schacherl.</span><span class="sxs-lookup"><span data-stu-id="f914d-257">Article by Roman Schacherl.</span></span>
- <span data-ttu-id="f914d-258">[Executando tarefas em segundo plano](https://msdn.microsoft.com/library/ff803365.aspx), o capítulo 5 da [movimentação de aplicativos para a nuvem, a 3ª edição](https://msdn.microsoft.com/library/ff728592.aspx) de padrões e práticas da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="f914d-258">[Executing Background Tasks](https://msdn.microsoft.com/library/ff803365.aspx), chapter 5 of [Moving Applications to the Cloud, 3rd Edition](https://msdn.microsoft.com/library/ff728592.aspx) from Microsoft Patterns and Practices.</span></span> <span data-ttu-id="f914d-259">(Em particular, a seção ["usando filas de armazenamento do Azure"](https://msdn.microsoft.com/library/ff803365.aspx#sec7).)</span><span class="sxs-lookup"><span data-stu-id="f914d-259">(In particular, the section ["Using Azure Storage Queues"](https://msdn.microsoft.com/library/ff803365.aspx#sec7).)</span></span>
- <span data-ttu-id="f914d-260">[Práticas recomendadas para maximizar a escalabilidade e a eficiência de custo de soluções de mensagens baseadas em fila no Azure](https://msdn.microsoft.com/library/windowsazure/hh697709.aspx).</span><span class="sxs-lookup"><span data-stu-id="f914d-260">[Best Practices for Maximizing Scalability and Cost Effectiveness of Queue-Based Messaging Solutions on Azure](https://msdn.microsoft.com/library/windowsazure/hh697709.aspx).</span></span> <span data-ttu-id="f914d-261">White Paper de Valery Mizonov.</span><span class="sxs-lookup"><span data-stu-id="f914d-261">White paper by Valery Mizonov.</span></span>
- <span data-ttu-id="f914d-262">[Comparando filas do Azure e filas do barramento de serviço](https://msdn.microsoft.com/magazine/jj159884.aspx).</span><span class="sxs-lookup"><span data-stu-id="f914d-262">[Comparing Azure Queues and Service Bus Queues](https://msdn.microsoft.com/magazine/jj159884.aspx).</span></span> <span data-ttu-id="f914d-263">O artigo da MSDN Magazine fornece informações adicionais que podem ajudá-lo a escolher qual serviço de fila usar.</span><span class="sxs-lookup"><span data-stu-id="f914d-263">MSDN Magazine article, provides additional information that can help you choose which queue service to use.</span></span> <span data-ttu-id="f914d-264">O artigo menciona que o barramento de serviço depende do ACS para autenticação, o que significa que as filas do SB não estarão disponíveis quando o ACS não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="f914d-264">The article mentions that Service Bus is dependent on ACS for authentication, which means your SB queues would be unavailable when ACS is unavailable.</span></span> <span data-ttu-id="f914d-265">No entanto, como o artigo foi escrito, o SB foi alterado para permitir que você use [tokens SAS](https://msdn.microsoft.com/library/windowsazure/dn170477.aspx) como uma alternativa ao ACS.</span><span class="sxs-lookup"><span data-stu-id="f914d-265">However, since the article was written, SB was changed to enable you to use [SAS tokens](https://msdn.microsoft.com/library/windowsazure/dn170477.aspx) as an alternative to ACS.</span></span>
- <span data-ttu-id="f914d-266">[Práticas e padrões da Microsoft – diretrizes do Azure](https://msdn.microsoft.com/library/dn568099.aspx).</span><span class="sxs-lookup"><span data-stu-id="f914d-266">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="f914d-267">Consulte primer de mensagens assíncronas, padrões de pipes e filtros, padrão de transação de compensação, padrão de consumidores concorrentes, padrão CQRS.</span><span class="sxs-lookup"><span data-stu-id="f914d-267">See Asynchronous Messaging primer, Pipes and Filters pattern, Compensating Transaction pattern, Competing Consumers pattern, CQRS pattern.</span></span>
- <span data-ttu-id="f914d-268">[Jornada de CQRS](https://msdn.microsoft.com/library/jj554200).</span><span class="sxs-lookup"><span data-stu-id="f914d-268">[CQRS Journey](https://msdn.microsoft.com/library/jj554200).</span></span> <span data-ttu-id="f914d-269">Livro eletrônico sobre o CQRS por padrões e práticas da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="f914d-269">E-book about CQRS by Microsoft Patterns and Practices.</span></span>

<span data-ttu-id="f914d-270">Vídeo:</span><span class="sxs-lookup"><span data-stu-id="f914d-270">Video:</span></span>

- <span data-ttu-id="f914d-271">[FailSafe: criando serviços de nuvem escalonáveis e resilientes](https://channel9.msdn.com/Series/FailSafe).</span><span class="sxs-lookup"><span data-stu-id="f914d-271">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="f914d-272">Série de vídeos de nove partes por Ulrich Homann, Marc Mercuri e marcas Simms.</span><span class="sxs-lookup"><span data-stu-id="f914d-272">Nine-part video series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="f914d-273">Apresenta conceitos de alto nível e princípios arquitetônicos de uma maneira muito acessível e interessante, com histórias extraídas da experiência CAT (equipe de consultoria para clientes) da Microsoft com os clientes reais.</span><span class="sxs-lookup"><span data-stu-id="f914d-273">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="f914d-274">Para obter uma introdução ao serviço de armazenamento do Azure e filas, consulte Episódio 5 a partir de 35:13.</span><span class="sxs-lookup"><span data-stu-id="f914d-274">For an introduction to the Azure Storage service and queues, see episode 5 starting at 35:13.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f914d-275">[Anterior](distributed-caching.md)
> [Próximo](more-patterns-and-guidance.md)</span><span class="sxs-lookup"><span data-stu-id="f914d-275">[Previous](distributed-caching.md)
[Next](more-patterns-and-guidance.md)</span></span>
