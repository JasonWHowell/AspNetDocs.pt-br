---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: Criando classes de modelo com o Quadro de Entidades (C#) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, você aprende a usar ASP.NET MVC com o Microsoft Entity Framework. Você aprende a usar o Assistente de Entidade para criar uma entidade ADO.NET Da...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 716d34167258b1005b25b1cd11bfaa6d80763320
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542658"
---
# <a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="a2c26-104">Criação de classes de modelo com o Entity Framework (C#)</span><span class="sxs-lookup"><span data-stu-id="a2c26-104">Creating Model Classes with the Entity Framework (C#)</span></span>

<span data-ttu-id="a2c26-105">pela [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="a2c26-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="a2c26-106">Neste tutorial, você aprende a usar ASP.NET MVC com o Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a2c26-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="a2c26-107">Você aprende a usar o Assistente de Entidade para criar um ADO.NET Modelo de Dados de Entidade.</span><span class="sxs-lookup"><span data-stu-id="a2c26-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="a2c26-108">Ao longo deste tutorial, construímos um aplicativo web que ilustra como selecionar, inserir, atualizar e excluir dados de banco de dados usando o Framework de entidades.</span><span class="sxs-lookup"><span data-stu-id="a2c26-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>

<span data-ttu-id="a2c26-109">O objetivo deste tutorial é explicar como você pode criar classes de acesso a dados usando o Microsoft Entity Framework ao criar um aplicativo mvc ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a2c26-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="a2c26-110">Este tutorial não pressupõe nenhum conhecimento prévio do Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a2c26-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="a2c26-111">Ao final deste tutorial, você entenderá como usar o Framework de entidades para selecionar, inserir, atualizar e excluir registros de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="a2c26-112">O Microsoft Entity Framework é uma ferramenta De mapeamento relacional de objetos (O/RM) que permite gerar uma camada de acesso a dados a partir de um banco de dados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="a2c26-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="a2c26-113">O Quadro de Entidades permite evitar o trabalho tedioso de construir suas classes de acesso de dados manualmente.</span><span class="sxs-lookup"><span data-stu-id="a2c26-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="a2c26-114">Para ilustrar como você pode usar o Microsoft Entity Framework com ASP.NET MVC, vamos criar um aplicativo de exemplo simples.</span><span class="sxs-lookup"><span data-stu-id="a2c26-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="a2c26-115">Criaremos um aplicativo de banco de dados de filmes que permite que você exiba e edite registros de banco de dados de filmes.</span><span class="sxs-lookup"><span data-stu-id="a2c26-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="a2c26-116">Este tutorial pressupõe que você tenha o Visual Studio 2008 ou visual Web Developer 2008 com o Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="a2c26-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="a2c26-117">Você precisa do Service Pack 1 para usar o Quadro de Entidades.</span><span class="sxs-lookup"><span data-stu-id="a2c26-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="a2c26-118">Você pode baixar o Visual Studio 2008 Service Pack 1 ou o Visual Web Developer com o Service Pack 1 a partir do seguinte endereço:</span><span class="sxs-lookup"><span data-stu-id="a2c26-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)

> [!NOTE] 
> 
> <span data-ttu-id="a2c26-119">Não há conexão essencial entre ASP.NET MVC e o Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a2c26-119">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="a2c26-120">Existem várias alternativas para o Quadro de Entidades que você pode usar com ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="a2c26-120">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="a2c26-121">Por exemplo, você pode construir suas classes mvc model usando outras ferramentas de O/RM, como Microsoft LINQ para SQL, NHibernate ou SubSonic.</span><span class="sxs-lookup"><span data-stu-id="a2c26-121">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>

## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="a2c26-122">Criando o banco de dados de amostras de filmes</span><span class="sxs-lookup"><span data-stu-id="a2c26-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="a2c26-123">O aplicativo Movie Database usa uma tabela de banco de dados chamada Filmes que contém as seguintes colunas:</span><span class="sxs-lookup"><span data-stu-id="a2c26-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="a2c26-124">Nome da coluna</span><span class="sxs-lookup"><span data-stu-id="a2c26-124">Column Name</span></span> | <span data-ttu-id="a2c26-125">Tipo de Dados</span><span class="sxs-lookup"><span data-stu-id="a2c26-125">Data Type</span></span> | <span data-ttu-id="a2c26-126">Permitir nulos?</span><span class="sxs-lookup"><span data-stu-id="a2c26-126">Allow Nulls?</span></span> | <span data-ttu-id="a2c26-127">É a chave primária?</span><span class="sxs-lookup"><span data-stu-id="a2c26-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="a2c26-128">ID</span><span class="sxs-lookup"><span data-stu-id="a2c26-128">Id</span></span> | <span data-ttu-id="a2c26-129">INT</span><span class="sxs-lookup"><span data-stu-id="a2c26-129">int</span></span> | <span data-ttu-id="a2c26-130">Falso</span><span class="sxs-lookup"><span data-stu-id="a2c26-130">False</span></span> | <span data-ttu-id="a2c26-131">True</span><span class="sxs-lookup"><span data-stu-id="a2c26-131">True</span></span> |
| <span data-ttu-id="a2c26-132">Title</span><span class="sxs-lookup"><span data-stu-id="a2c26-132">Title</span></span> | <span data-ttu-id="a2c26-133">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="a2c26-133">nvarchar(100)</span></span> | <span data-ttu-id="a2c26-134">Falso</span><span class="sxs-lookup"><span data-stu-id="a2c26-134">False</span></span> | <span data-ttu-id="a2c26-135">Falso</span><span class="sxs-lookup"><span data-stu-id="a2c26-135">False</span></span> |
| <span data-ttu-id="a2c26-136">Diretor</span><span class="sxs-lookup"><span data-stu-id="a2c26-136">Director</span></span> | <span data-ttu-id="a2c26-137">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="a2c26-137">nvarchar(100)</span></span> | <span data-ttu-id="a2c26-138">Falso</span><span class="sxs-lookup"><span data-stu-id="a2c26-138">False</span></span> | <span data-ttu-id="a2c26-139">Falso</span><span class="sxs-lookup"><span data-stu-id="a2c26-139">False</span></span> |

<span data-ttu-id="a2c26-140">Você pode adicionar esta tabela a um projeto mVC ASP.NET seguindo estas etapas:</span><span class="sxs-lookup"><span data-stu-id="a2c26-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="a2c26-141">Clique com o\_botão direito do mouse na pasta Dados do aplicativo na janela Do Explorador de soluções e selecione a opção de menu **Adicionar, Novo Item.**</span><span class="sxs-lookup"><span data-stu-id="a2c26-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="a2c26-142">Na caixa de diálogo **Adicionar novo item,** selecione **SQL Server Database**, dê ao banco de dados o nome MoviesDB.mdf e clique no botão **Adicionar.**</span><span class="sxs-lookup"><span data-stu-id="a2c26-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="a2c26-143">Clique duas vezes no arquivo MoviesDB.mdf para abrir a janela Server Explorer/Database Explorer.</span><span class="sxs-lookup"><span data-stu-id="a2c26-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="a2c26-144">Expanda a conexão de banco de dados MoviesDB.mdf, clique com o botão direito do mouse na pasta Tabelas e selecione a opção de menu **Adicionar nova tabela**.</span><span class="sxs-lookup"><span data-stu-id="a2c26-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="a2c26-145">No Table Designer, adicione as colunas Id, Title e Director.</span><span class="sxs-lookup"><span data-stu-id="a2c26-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="a2c26-146">Clique no botão **Salvar** (ele tem o ícone do disquete) para salvar a nova tabela com o nome Filmes.</span><span class="sxs-lookup"><span data-stu-id="a2c26-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="a2c26-147">Depois de criar a tabela de banco de dados Filmes, você deve adicionar alguns dados de amostra à tabela.</span><span class="sxs-lookup"><span data-stu-id="a2c26-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="a2c26-148">Clique com o botão direito do mouse na tabela Filmes e selecione a opção menu **Mostrar dados da tabela**.</span><span class="sxs-lookup"><span data-stu-id="a2c26-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="a2c26-149">Você pode inserir dados falsos de filmes na grade que aparece.</span><span class="sxs-lookup"><span data-stu-id="a2c26-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="a2c26-150">Criando o modelo de dados da entidade ADO.NET</span><span class="sxs-lookup"><span data-stu-id="a2c26-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="a2c26-151">Para usar o Quadro de Entidades, você precisa criar um Modelo de Dados de Entidade.</span><span class="sxs-lookup"><span data-stu-id="a2c26-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="a2c26-152">Você pode aproveitar o Visual Studio *Entity Data Model Wizard* para gerar um modelo de dados de entidade a partir de um banco de dados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="a2c26-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="a2c26-153">Siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="a2c26-153">Follow these steps:</span></span>

1. <span data-ttu-id="a2c26-154">Clique com o botão direito do mouse na pasta Modelos na janela Do Explorador de soluções e selecione a opção de menu **Adicionar, Novo Item**.</span><span class="sxs-lookup"><span data-stu-id="a2c26-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="a2c26-155">Na **caixa de diálogo Adicionar novo item,** selecione a categoria Dados (ver Figura 1).</span><span class="sxs-lookup"><span data-stu-id="a2c26-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="a2c26-156">Selecione o modelo **de ADO.NET Modelo de Dados da Entidade,** dê ao Modelo de Dados da Entidade o nome MoviesDBModel.edmx e clique no botão **Adicionar.**</span><span class="sxs-lookup"><span data-stu-id="a2c26-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="a2c26-157">Clicar no botão **Adicionar** inicia o Assistente de Modelo de Dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="a2c26-158">Na etapa **Escolher conteúdo de modelo,** escolha a **opção Gerar em uma** opção de banco de dados e clique no botão **Seguinte** (consulte Figura 2).</span><span class="sxs-lookup"><span data-stu-id="a2c26-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="a2c26-159">Na etapa **Escolher sua conexão de dados,** selecione a conexão de banco de dados MoviesDB.mdf, digite as configurações de conexão de entidades chamada MoviesDBEntities e clique no botão **Seguinte** (consulte Figura 3).</span><span class="sxs-lookup"><span data-stu-id="a2c26-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="a2c26-160">Na etapa **Escolher objetos do banco de dados,** selecione a tabela de banco de dados De filme e clique no botão **Concluir** (consulte Figura 4).</span><span class="sxs-lookup"><span data-stu-id="a2c26-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="a2c26-161">Depois de concluir essas etapas, o ADO.NET Entity Data Model Designer (Entity Designer) é aberto.</span><span class="sxs-lookup"><span data-stu-id="a2c26-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="a2c26-162">**Figura 1 – Criação de um novo modelo de dados de entidades**</span><span class="sxs-lookup"><span data-stu-id="a2c26-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="a2c26-164">**Figura 2 – Escolha a etapa de conteúdo do modelo**</span><span class="sxs-lookup"><span data-stu-id="a2c26-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="a2c26-166">**Figura 3 – Escolha sua conexão de dados**</span><span class="sxs-lookup"><span data-stu-id="a2c26-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="a2c26-168">**Figura 4 – Escolha seus objetos de banco de dados**</span><span class="sxs-lookup"><span data-stu-id="a2c26-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="a2c26-170">Modificando o modelo de dados da entidade ADO.NET</span><span class="sxs-lookup"><span data-stu-id="a2c26-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="a2c26-171">Depois de criar um Modelo de Dados de Entidade, você pode modificar o modelo aproveitando o Entity Designer (ver Figura 5).</span><span class="sxs-lookup"><span data-stu-id="a2c26-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="a2c26-172">Você pode abrir o Entity Designer a qualquer momento clicando duas vezes no arquivo MoviesDBModel.edmx contido na pasta Models na janela Solution Explorer.</span><span class="sxs-lookup"><span data-stu-id="a2c26-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="a2c26-173">**Figura 5 – O designer de modelo suidiário de dados ADO.NET**</span><span class="sxs-lookup"><span data-stu-id="a2c26-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="a2c26-175">Por exemplo, você pode usar o Entity Designer para alterar os nomes das classes que o Assistente de Dados do Modelo de Entidade gera.</span><span class="sxs-lookup"><span data-stu-id="a2c26-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="a2c26-176">O Assistente criou uma nova classe de acesso a dados chamada Filmes.</span><span class="sxs-lookup"><span data-stu-id="a2c26-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="a2c26-177">Em outras palavras, o Assistente deu à classe o mesmo nome da tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="a2c26-178">Como usaremos essa classe para representar uma instância de filme em particular, devemos renomear a classe de Filmes para Filme.</span><span class="sxs-lookup"><span data-stu-id="a2c26-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="a2c26-179">Se você quiser renomear uma classe de entidade, você pode clicar duas vezes no nome da classe no Entity Designer e inserir um novo nome (ver Figura 6).</span><span class="sxs-lookup"><span data-stu-id="a2c26-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="a2c26-180">Alternativamente, você pode alterar o nome de uma entidade na janela Propriedades depois de selecionar uma entidade no Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="a2c26-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="a2c26-181">**Figura 6 – Mudar o nome de uma entidade**</span><span class="sxs-lookup"><span data-stu-id="a2c26-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="a2c26-183">Lembre-se de salvar seu Modelo de Dados de Entidade depois de fazer uma modificação clicando no botão Salvar (o ícone do disquete).</span><span class="sxs-lookup"><span data-stu-id="a2c26-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="a2c26-184">Nos bastidores, o Entity Designer gera um conjunto de classes C#.</span><span class="sxs-lookup"><span data-stu-id="a2c26-184">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="a2c26-185">Você pode visualizar essas classes abrindo o arquivo MoviesDBModel.Designer.cs da janela Solution Explorer.</span><span class="sxs-lookup"><span data-stu-id="a2c26-185">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>

<span data-ttu-id="a2c26-186">Não modifique o código no arquivo Designer.cs, pois suas alterações serão substituídas na próxima vez que você usar o Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="a2c26-186">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="a2c26-187">Se você quiser estender a funcionalidade das classes de entidade definidas no arquivo Designer.cs, então você pode criar *classes parciais* em arquivos separados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-187">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>

#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="a2c26-188">Selecionando registros de banco de dados com o Framework da entidade</span><span class="sxs-lookup"><span data-stu-id="a2c26-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="a2c26-189">Vamos começar a construir nosso aplicativo de banco de dados de filmes criando uma página que exibe uma lista de registros de filmes.</span><span class="sxs-lookup"><span data-stu-id="a2c26-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="a2c26-190">O controlador Home na Listagem 1 expõe uma ação chamada Index().</span><span class="sxs-lookup"><span data-stu-id="a2c26-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="a2c26-191">A ação Index() retorna todos os registros de filmes da tabela de banco de dados Movie aproveitando o Quadro de Entidades.</span><span class="sxs-lookup"><span data-stu-id="a2c26-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="a2c26-192">**Listagem 1 – Controladores\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="a2c26-192">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="a2c26-193">Observe que o controlador na Listagem 1 inclui um construtor.</span><span class="sxs-lookup"><span data-stu-id="a2c26-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="a2c26-194">O construtor inicia um campo de \_nível de classe chamado db.</span><span class="sxs-lookup"><span data-stu-id="a2c26-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="a2c26-195">O \_campo db representa as entidades de banco de dados geradas pelo Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a2c26-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="a2c26-196">O \_campo db é uma instância da classe MoviesDBEntities que foi gerada pelo Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="a2c26-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="a2c26-197">Para usar a classeMoviesDBEntities no controlador Home, você deve importar o namespace MovieEntityApp.Models *(MVCProjectName).* Modelos).</span><span class="sxs-lookup"><span data-stu-id="a2c26-197">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>

<span data-ttu-id="a2c26-198">O \_campo db é usado dentro da ação Index() para recuperar os registros da tabela de banco de dados Filmes.</span><span class="sxs-lookup"><span data-stu-id="a2c26-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="a2c26-199">A \_expressão db. MovieSet representa todos os registros da tabela de banco de dados Filmes.</span><span class="sxs-lookup"><span data-stu-id="a2c26-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="a2c26-200">O método ToList() é usado para converter o conjunto de&lt;filmes&gt;em uma coleção genérica de objetos de filme (List Movie ).</span><span class="sxs-lookup"><span data-stu-id="a2c26-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="a2c26-201">Os registros do filme são recuperados com a ajuda de LINQ para Entidades.</span><span class="sxs-lookup"><span data-stu-id="a2c26-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="a2c26-202">A ação Index() na Listagem 1 usa *sintaxe do método* LINQ para recuperar o conjunto de registros de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="a2c26-203">Se preferir, você pode usar *a sintaxe de consulta* LINQ.</span><span class="sxs-lookup"><span data-stu-id="a2c26-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="a2c26-204">As duas seguintes declarações fazem a mesma coisa:</span><span class="sxs-lookup"><span data-stu-id="a2c26-204">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="a2c26-205">Use qualquer sintaxe LINQ – sintaxe de método ou sintaxe de consulta – que você achar mais intuitiva.</span><span class="sxs-lookup"><span data-stu-id="a2c26-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="a2c26-206">Não há diferença de desempenho entre as duas abordagens – a única diferença é o estilo.</span><span class="sxs-lookup"><span data-stu-id="a2c26-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="a2c26-207">A exibição na Lista 2 é usada para exibir os registros do filme.</span><span class="sxs-lookup"><span data-stu-id="a2c26-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="a2c26-208">**Listagem 2 – Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="a2c26-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="a2c26-209">A exibição na Lista 2 contém um loop **foreach** que itera através de cada registro de filme e exibe os valores das propriedades título e diretor do registro do filme.</span><span class="sxs-lookup"><span data-stu-id="a2c26-209">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="a2c26-210">Observe que um link Editar e Excluir é exibido ao lado de cada registro.</span><span class="sxs-lookup"><span data-stu-id="a2c26-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="a2c26-211">Além disso, um link Adicionar filme é exibido na parte inferior da exibição (ver Figura 7).</span><span class="sxs-lookup"><span data-stu-id="a2c26-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="a2c26-212">**Figura 7 – A visão do Índice**</span><span class="sxs-lookup"><span data-stu-id="a2c26-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="a2c26-214">A exibição Índice é uma *exibição digitada*.</span><span class="sxs-lookup"><span data-stu-id="a2c26-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="a2c26-215">A exibição Índice &lt;inclui uma&gt; diretiva %@ Page % com um atributo *Herdado* que lança a&lt;propriedade Model para uma coleção de lista genérica fortemente digitada de objetos de filme (Filme de lista).</span><span class="sxs-lookup"><span data-stu-id="a2c26-215">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="a2c26-216">Inserindo registros de banco de dados com o Framework da entidade</span><span class="sxs-lookup"><span data-stu-id="a2c26-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="a2c26-217">Você pode usar o Framework entity para facilitar a inserção de novos registros em uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="a2c26-218">A listagem 3 contém duas novas ações adicionadas à classe controlador a casa que você pode usar para inserir novos registros na tabela de banco de dados Movie.</span><span class="sxs-lookup"><span data-stu-id="a2c26-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="a2c26-219">**Listagem 3 – Controladores\HomeController.cs (Adicionar métodos)**</span><span class="sxs-lookup"><span data-stu-id="a2c26-219">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="a2c26-220">A primeira ação Add() simplesmente retorna uma exibição.</span><span class="sxs-lookup"><span data-stu-id="a2c26-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="a2c26-221">A exibição contém um formulário para adicionar um novo registro de banco de dados de filmes (ver Figura 8).</span><span class="sxs-lookup"><span data-stu-id="a2c26-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="a2c26-222">Quando você envia o formulário, a segunda ação Add() é invocada.</span><span class="sxs-lookup"><span data-stu-id="a2c26-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="a2c26-223">Observe que a segunda ação Add() é decorada com o atributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="a2c26-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="a2c26-224">Esta ação só pode ser invocada ao realizar uma operação HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="a2c26-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="a2c26-225">Em outras palavras, esta ação só pode ser invocada ao postar um formulário HTML.</span><span class="sxs-lookup"><span data-stu-id="a2c26-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="a2c26-226">A segunda ação Add() cria uma nova instância da classe Entity Framework Movie com a ajuda do método ASP.NET MVC TryUpdateModel().</span><span class="sxs-lookup"><span data-stu-id="a2c26-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="a2c26-227">O método TryUpdateModel() leva os campos no FormCollection passados para o método Add() e atribui os valores desses campos de formulário HTML à classe Movie.</span><span class="sxs-lookup"><span data-stu-id="a2c26-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>

<span data-ttu-id="a2c26-228">Ao usar o Quadro de Entidades, você deve fornecer uma "lista branca" de propriedades ao usar os métodos TryUpdateModel ou UpdateModel para atualizar as propriedades de uma classe de entidade.</span><span class="sxs-lookup"><span data-stu-id="a2c26-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>

<span data-ttu-id="a2c26-229">Em seguida, a ação Adicionar () realiza algumas validaçãos de formulário simples.</span><span class="sxs-lookup"><span data-stu-id="a2c26-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="a2c26-230">A ação verifica se as propriedades Título e Diretor possuem valores.</span><span class="sxs-lookup"><span data-stu-id="a2c26-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="a2c26-231">Se houver um erro de validação, uma mensagem de erro de validação será adicionada ao ModelState.</span><span class="sxs-lookup"><span data-stu-id="a2c26-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="a2c26-232">Se não houver erros de validação, um novo registro de filme será adicionado à tabela de banco de dados Filmes com a ajuda do Framework entity.</span><span class="sxs-lookup"><span data-stu-id="a2c26-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="a2c26-233">O novo registro é adicionado ao banco de dados com as seguintes duas linhas de código:</span><span class="sxs-lookup"><span data-stu-id="a2c26-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="a2c26-234">A primeira linha de código adiciona a nova entidade Movie ao conjunto de filmes que estão sendo rastreados pelo Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a2c26-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="a2c26-235">A segunda linha de código salva quaisquer alterações que tenham sido feitas nos filmes que estão sendo rastreados de volta ao banco de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="a2c26-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="a2c26-236">**Figura 8 – A exibição adicionar**</span><span class="sxs-lookup"><span data-stu-id="a2c26-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="a2c26-238">Atualizando registros de banco de dados com o Framework da entidade</span><span class="sxs-lookup"><span data-stu-id="a2c26-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="a2c26-239">Você pode seguir quase a mesma abordagem para editar um registro de banco de dados com o Framework entity como a abordagem que acabamos de seguir para inserir um novo registro de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="a2c26-240">A lista 4 contém duas novas ações do controlador denominadas Edit().</span><span class="sxs-lookup"><span data-stu-id="a2c26-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="a2c26-241">A primeira ação Editar() retorna um formulário HTML para editar um registro de filme.</span><span class="sxs-lookup"><span data-stu-id="a2c26-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="a2c26-242">A segunda ação Editar() tenta atualizar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="a2c26-243">**Listagem 4 – Controladores\HomeController.cs (Métodos de edição)**</span><span class="sxs-lookup"><span data-stu-id="a2c26-243">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="a2c26-244">A segunda ação Edit() começa recuperando o registro de filme do banco de dados que corresponde ao Id do filme que está sendo editado.</span><span class="sxs-lookup"><span data-stu-id="a2c26-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="a2c26-245">A seguinte declaração LINQ to Entities captura o primeiro registro de banco de dados que corresponde a um ID específico:</span><span class="sxs-lookup"><span data-stu-id="a2c26-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="a2c26-246">Em seguida, o método TryUpdateModel() é usado para atribuir os valores dos campos de formulário HTML às propriedades da entidade de filme.</span><span class="sxs-lookup"><span data-stu-id="a2c26-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="a2c26-247">Observe que uma lista branca é fornecida para especificar as propriedades exatas a serem atualizadas.</span><span class="sxs-lookup"><span data-stu-id="a2c26-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="a2c26-248">Em seguida, algumas validações simples são realizadas para verificar se as propriedades do Título do Filme e do Diretor têm valores.</span><span class="sxs-lookup"><span data-stu-id="a2c26-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="a2c26-249">Se uma propriedade estiver perdendo um valor, então uma mensagem de erro de validação será adicionada ao ModelState e ao ModelState.IsValid retorna o valor falso.</span><span class="sxs-lookup"><span data-stu-id="a2c26-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="a2c26-250">Finalmente, se não houver erros de validação, a tabela de banco de dados De filmes subjacente saem atualizada sem alterações, chamando o método SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="a2c26-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="a2c26-251">Ao editar registros de banco de dados, você precisa passar o Id do registro que está sendo editado para a ação do controlador que realiza a atualização do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="a2c26-252">Caso contrário, a ação do controlador não saberá qual registro atualizar no banco de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="a2c26-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="a2c26-253">A exibição Editar, contida na Lista 5, inclui um campo de formulário oculto que representa o Id do registro de banco de dados que está sendo editado.</span><span class="sxs-lookup"><span data-stu-id="a2c26-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="a2c26-254">**Listagem 5 – Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="a2c26-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="a2c26-255">Excluindo registros de banco de dados com o Framework da entidade</span><span class="sxs-lookup"><span data-stu-id="a2c26-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="a2c26-256">A operação final do banco de dados, que precisamos abordar neste tutorial, é a exclusão de registros de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="a2c26-257">Você pode usar a ação do controlador na Listagem 6 para excluir um registro de banco de dados específico.</span><span class="sxs-lookup"><span data-stu-id="a2c26-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="a2c26-258">**Lista 6 -- \Controllers\HomeController.cs (Exclua ação)**</span><span class="sxs-lookup"><span data-stu-id="a2c26-258">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="a2c26-259">A ação Excluir() primeiro recupera a entidade Movie que corresponde ao Id passado para a ação.</span><span class="sxs-lookup"><span data-stu-id="a2c26-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="a2c26-260">Em seguida, o filme é excluído do banco de dados chamando o método DeleteObject() seguido pelo método SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="a2c26-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="a2c26-261">Finalmente, o usuário é redirecionado de volta para a exibição Índice.</span><span class="sxs-lookup"><span data-stu-id="a2c26-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="a2c26-262">Resumo</span><span class="sxs-lookup"><span data-stu-id="a2c26-262">Summary</span></span>

<span data-ttu-id="a2c26-263">O objetivo deste tutorial foi demonstrar como você pode construir aplicativos web orientados por banco de dados aproveitando ASP.NET MVC e o Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a2c26-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="a2c26-264">Você aprendeu como criar um aplicativo que permite selecionar, inserir, atualizar e excluir registros de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="a2c26-265">Primeiro, discutimos como você pode usar o Assistente de Modelo de Dados de Entidade para gerar um Modelo de Dados de Entidade de dentro do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a2c26-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="a2c26-266">Em seguida, você aprende como usar o LINQ para entidades para recuperar um conjunto de registros de banco de dados de uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="a2c26-267">Finalmente, usamos o Framework de entidades para inserir, atualizar e excluir registros de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="a2c26-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="a2c26-268">Avançar</span><span class="sxs-lookup"><span data-stu-id="a2c26-268">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)
