---
uid: mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-cs
title: Autenticação de usuários com autenticação de formulários (C#) | Microsoft Docs
author: rick-anderson
description: Saiba como usar o atributo [Autorizar] para proteger por senha páginas específicas em seu aplicativo MVC. Você aprende a usar a administração do site também...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 239fd3ca-5630-4b8d-bc4b-2f906b1d3504
msc.legacyurl: /mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-cs
msc.type: authoredcontent
ms.openlocfilehash: f14f996c0b3a438647b5d181675457735e473354
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/17/2020
ms.locfileid: "81540968"
---
# <a name="authenticating-users-with-forms-authentication-c"></a><span data-ttu-id="41c4a-104">Autenticar usuários com a autenticação de formulários (C#)</span><span class="sxs-lookup"><span data-stu-id="41c4a-104">Authenticating Users with Forms Authentication (C#)</span></span>

<span data-ttu-id="41c4a-105">pela [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="41c4a-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="41c4a-106">Saiba como usar o atributo [Autorizar] para proteger por senha páginas específicas em seu aplicativo MVC.</span><span class="sxs-lookup"><span data-stu-id="41c4a-106">Learn how to use the [Authorize] attribute to password protect particular pages in your MVC application.</span></span> <span data-ttu-id="41c4a-107">Você aprende a usar a Ferramenta de Administração de Sites para criar e gerenciar usuários e funções.</span><span class="sxs-lookup"><span data-stu-id="41c4a-107">You learn how to use the Web Site Administration Tool to create and manage users and roles.</span></span> <span data-ttu-id="41c4a-108">Você também aprende a configurar onde as informações da conta do usuário e da função são armazenadas.</span><span class="sxs-lookup"><span data-stu-id="41c4a-108">You also learn how to configure where user account and role information is stored.</span></span>

<span data-ttu-id="41c4a-109">O objetivo deste tutorial é explicar como você pode usar a autenticação de Formulários para proteger por senha as visualizações em seus aplicativos mvc ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="41c4a-109">The goal of this tutorial is to explain how you can use Forms authentication to password protect the views in your ASP.NET MVC applications.</span></span> <span data-ttu-id="41c4a-110">Você aprende a usar a Ferramenta de Administração de Sites para criar usuários e funções.</span><span class="sxs-lookup"><span data-stu-id="41c4a-110">You learn how to use the Web Site Administration Tool to create users and roles.</span></span> <span data-ttu-id="41c4a-111">Você também aprende como evitar que usuários não autorizados inudigam ações do controlador.</span><span class="sxs-lookup"><span data-stu-id="41c4a-111">You also learn how to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="41c4a-112">Finalmente, você aprende a configurar onde os nomes de usuário e senhas são armazenados.</span><span class="sxs-lookup"><span data-stu-id="41c4a-112">Finally, you learn how to configure where user names and passwords are stored.</span></span>

#### <a name="using-the-web-site-administration-tool"></a><span data-ttu-id="41c4a-113">Usando a ferramenta de administração de sites</span><span class="sxs-lookup"><span data-stu-id="41c4a-113">Using the Web Site Administration Tool</span></span>

<span data-ttu-id="41c4a-114">Antes de fazer qualquer outra coisa, devemos começar criando alguns usuários e funções.</span><span class="sxs-lookup"><span data-stu-id="41c4a-114">Before we do anything else, we should start by creating some users and roles.</span></span> <span data-ttu-id="41c4a-115">A maneira mais fácil de criar novos usuários e funções é aproveitar a Ferramenta de Administração de Sites do Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="41c4a-115">The easiest way to create new users and roles is to take advantage of the Visual Studio 2008 Web Site Administration Tool.</span></span> <span data-ttu-id="41c4a-116">Você pode iniciar esta ferramenta selecionando a opção menu **Projeto, configuração ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="41c4a-116">You can launch this tool by selecting the menu option **Project, ASP.NET Configuration**.</span></span> <span data-ttu-id="41c4a-117">Alternativamente, você pode iniciar a Ferramenta de Administração de Sites clicando no ícone (um tanto assustador) do martelo que atinge o mundo que aparece no topo da janela do Solution Explorer (ver Figura 1).</span><span class="sxs-lookup"><span data-stu-id="41c4a-117">Alternatively, you can launch the Web Site Administration Tool by clicking the (somewhat scary) icon of the hammer hitting the world that appears at the top of the Solution Explorer window (see Figure 1).</span></span>

<span data-ttu-id="41c4a-118">**Figura 1 – Lançamento da Ferramenta de Administração de Sites**</span><span class="sxs-lookup"><span data-stu-id="41c4a-118">**Figure 1 – Launching the Web Site Administration Tool**</span></span>

![clip_image002](authenticating-users-with-forms-authentication-cs/_static/image1.jpg)

<span data-ttu-id="41c4a-120">Dentro da Ferramenta de Administração de Sites da Web, você cria novos usuários e funções selecionando a guia Segurança. Clique no link **Criar usuário** para criar um novo usuário chamado Stephen (ver Figura 2).</span><span class="sxs-lookup"><span data-stu-id="41c4a-120">Within the Web Site Administration Tool, you create new users and roles by selecting the Security tab. Click the **Create user** link to create a new user named Stephen (see Figure 2).</span></span> <span data-ttu-id="41c4a-121">Forneça ao usuário stephen qualquer senha que você quiser (por exemplo, *secreta).*</span><span class="sxs-lookup"><span data-stu-id="41c4a-121">Provide the Stephen user with any password that you want (for example, *secret*).</span></span>

<span data-ttu-id="41c4a-122">**Figura 2 – Criação de um novo usuário**</span><span class="sxs-lookup"><span data-stu-id="41c4a-122">**Figure 2 – Creating a new user**</span></span>

![clip_image004](authenticating-users-with-forms-authentication-cs/_static/image2.jpg)

<span data-ttu-id="41c4a-124">Você cria novos papéis, permitindo primeiro funções e definindo um ou mais papéis.</span><span class="sxs-lookup"><span data-stu-id="41c4a-124">You create new roles by first enabling roles and defining one or more roles.</span></span> <span data-ttu-id="41c4a-125">Habilite funções clicando no link **Ativar funções.**</span><span class="sxs-lookup"><span data-stu-id="41c4a-125">Enable roles by clicking the **Enable roles** link.</span></span> <span data-ttu-id="41c4a-126">Em seguida, crie uma função chamada *Administradores* clicando no link **Criar ou Gerenciar funções** (consulte Figura 3).</span><span class="sxs-lookup"><span data-stu-id="41c4a-126">Next, create a role named *Administrators* by clicking the **Create or Manage roles** link (see Figure 3).</span></span>

<span data-ttu-id="41c4a-127">**Figura 3 – Criação de um novo papel**</span><span class="sxs-lookup"><span data-stu-id="41c4a-127">**Figure 3 – Creating a new role**</span></span>

![clip_image006](authenticating-users-with-forms-authentication-cs/_static/image3.jpg)

<span data-ttu-id="41c4a-129">Finalmente, crie um novo usuário chamado Sally e associe Sally à função Administradores clicando no link Criar usuário e selecionando Administradores ao criar Sally (ver Figura 4).</span><span class="sxs-lookup"><span data-stu-id="41c4a-129">Finally, create a new user named Sally and associate Sally with the Administrators role by clicking the Create User link and selecting Administrators when creating Sally (see Figure 4).</span></span>

<span data-ttu-id="41c4a-130">**Figura 4 – Adicionar um usuário a uma função**</span><span class="sxs-lookup"><span data-stu-id="41c4a-130">**Figure 4 – Adding a user to a role**</span></span>

![clip_image008](authenticating-users-with-forms-authentication-cs/_static/image4.jpg)

<span data-ttu-id="41c4a-132">Quando tudo estiver dito e feito, você deve ter dois novos usuários chamados Stephen e Sally.</span><span class="sxs-lookup"><span data-stu-id="41c4a-132">When all is said and done, you should have two new users named Stephen and Sally.</span></span> <span data-ttu-id="41c4a-133">Você também deve ter uma nova função chamada Administradores.</span><span class="sxs-lookup"><span data-stu-id="41c4a-133">You should also have a new role named Administrators.</span></span> <span data-ttu-id="41c4a-134">Sally é um membro do papel de Administradores e Stephen não.</span><span class="sxs-lookup"><span data-stu-id="41c4a-134">Sally is a member of the Administrators role and Stephen is not.</span></span>

#### <a name="requiring-authorization"></a><span data-ttu-id="41c4a-135">Exigindo autorização</span><span class="sxs-lookup"><span data-stu-id="41c4a-135">Requiring Authorization</span></span>

<span data-ttu-id="41c4a-136">Você pode exigir que um usuário seja autenticado antes que o usuário invoque uma ação do controlador adicionando o atributo [Autorizar] à ação.</span><span class="sxs-lookup"><span data-stu-id="41c4a-136">You can require a user to be authenticated before the user invokes a controller action by adding the [Authorize] attribute to the action.</span></span> <span data-ttu-id="41c4a-137">Você pode aplicar o atributo [Autorizar] a uma ação de controlador individual ou pode aplicar esse atributo a toda uma classe de controlador.</span><span class="sxs-lookup"><span data-stu-id="41c4a-137">You can apply the [Authorize] attribute to an individual controller action or you can apply this attribute to an entire controller class.</span></span>

<span data-ttu-id="41c4a-138">Por exemplo, o controlador na Listagem 1 expõe uma ação chamada CompanySecrets().</span><span class="sxs-lookup"><span data-stu-id="41c4a-138">For example, the controller in Listing 1 exposes an action named CompanySecrets().</span></span> <span data-ttu-id="41c4a-139">Como essa ação é decorada com o atributo [Autorizar], essa ação não pode ser invocada a menos que um usuário seja autenticado.</span><span class="sxs-lookup"><span data-stu-id="41c4a-139">Because this action is decorated with the [Authorize] attribute, this action cannot be invoked unless a user is authenticated.</span></span>

<span data-ttu-id="41c4a-140">**Listagem 1 – Controladores\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="41c4a-140">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](authenticating-users-with-forms-authentication-cs/samples/sample1.cs)]

<span data-ttu-id="41c4a-141">Se você invocar a ação CompanySecrets() inserindo a URL /Home/CompanySecrets na barra de endereços do seu navegador e você não for um usuário autenticado, então você será redirecionado automaticamente para a exibição Login (ver Figura 5).</span><span class="sxs-lookup"><span data-stu-id="41c4a-141">If you invoke the CompanySecrets() action by entering the URL /Home/CompanySecrets in the address bar of your browser, and you are not an authenticated user, then you will be redirected to the Login view automatically (see Figure 5).</span></span>

<span data-ttu-id="41c4a-142">**Figura 5 – A visualização de login**</span><span class="sxs-lookup"><span data-stu-id="41c4a-142">**Figure 5 – The Login view**</span></span>

![clip_image010](authenticating-users-with-forms-authentication-cs/_static/image5.jpg)

<span data-ttu-id="41c4a-144">Você pode usar a exibição Login para inserir seu nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="41c4a-144">You can use the Login view to enter your user name and password.</span></span> <span data-ttu-id="41c4a-145">Se você não é um usuário registrado, então você pode clicar no link **de registro** para navegar até a exibição Registrar (ver Figura 6).</span><span class="sxs-lookup"><span data-stu-id="41c4a-145">If you are not a registered user then you can click the **register** link to navigate to the Register view (see Figure 6).</span></span> <span data-ttu-id="41c4a-146">Você pode usar a exibição Registrar para criar uma nova conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="41c4a-146">You can use the Register view to create a new user account.</span></span>

<span data-ttu-id="41c4a-147">**Figura 6 – A visualização do Registro**</span><span class="sxs-lookup"><span data-stu-id="41c4a-147">**Figure 6 – The Register view**</span></span>

![clip_image012](authenticating-users-with-forms-authentication-cs/_static/image6.jpg)

<span data-ttu-id="41c4a-149">Depois de fazer login com sucesso, você pode ver a exibição CompanySecrets (ver Figura 7).</span><span class="sxs-lookup"><span data-stu-id="41c4a-149">After you successfully log in, you can see the CompanySecrets view (see Figure 7).</span></span> <span data-ttu-id="41c4a-150">Por padrão, você continuará a ser conectado até fechar a janela do seu navegador.</span><span class="sxs-lookup"><span data-stu-id="41c4a-150">By default, you will continue to be logged in until you close your browser window.</span></span>

<span data-ttu-id="41c4a-151">**Figura 7 – A visão CompanySecrets**</span><span class="sxs-lookup"><span data-stu-id="41c4a-151">**Figure 7 – The CompanySecrets view**</span></span>

![clip_image014](authenticating-users-with-forms-authentication-cs/_static/image7.jpg)

#### <a name="authorizing-by-user-name-or-user-role"></a><span data-ttu-id="41c4a-153">Autorizando pelo nome do usuário ou função do usuário</span><span class="sxs-lookup"><span data-stu-id="41c4a-153">Authorizing by User Name or User Role</span></span>

<span data-ttu-id="41c4a-154">Você pode usar o atributo [Autorizar] para restringir o acesso a uma ação do controlador a um determinado conjunto de usuários ou a um determinado conjunto de funções do usuário.</span><span class="sxs-lookup"><span data-stu-id="41c4a-154">You can use the [Authorize] attribute to restrict access to a controller action to a particular set of users or a particular set of user roles.</span></span> <span data-ttu-id="41c4a-155">Por exemplo, o controlador home modificado na Listagem 2 contém duas novas ações chamadas StephenSecrets() e AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="41c4a-155">For example, the modified Home controller in Listing 2 contains two new actions named StephenSecrets() and AdministratorSecrets().</span></span>

<span data-ttu-id="41c4a-156">**Listagem 2 – Controladores\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="41c4a-156">**Listing 2 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](authenticating-users-with-forms-authentication-cs/samples/sample2.cs)]

<span data-ttu-id="41c4a-157">Apenas um usuário com o nome de usuário Stephen pode invocar a ação StephenSecrets().</span><span class="sxs-lookup"><span data-stu-id="41c4a-157">Only a user with the user name Stephen can invoke the StephenSecrets() action.</span></span> <span data-ttu-id="41c4a-158">Todos os outros usuários são redirecionados para a exibição Login.</span><span class="sxs-lookup"><span data-stu-id="41c4a-158">All other users get redirected to the Login view.</span></span> <span data-ttu-id="41c4a-159">A propriedade Usuários aceita uma lista separada de comma de nomes de conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="41c4a-159">The Users property accepts a comma separated list of user account names.</span></span>

<span data-ttu-id="41c4a-160">Somente os usuários na função Administradores podem invocar a ação AdministradorSecrets().</span><span class="sxs-lookup"><span data-stu-id="41c4a-160">Only users in the Administrators role can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="41c4a-161">Por exemplo, como Sally é membro do grupo Administradores, ela pode invocar a ação AdministradorSecrets().</span><span class="sxs-lookup"><span data-stu-id="41c4a-161">For example, because Sally is a member of the Administrators group, she can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="41c4a-162">Todos os outros usuários são redirecionados para a exibição Login.</span><span class="sxs-lookup"><span data-stu-id="41c4a-162">All other users get redirected to the Login view.</span></span> <span data-ttu-id="41c4a-163">A propriedade Roles aceita uma lista separada de comma de nomes de funções.</span><span class="sxs-lookup"><span data-stu-id="41c4a-163">The Roles property accepts a comma separated list of role names.</span></span>

#### <a name="configuring-authentication"></a><span data-ttu-id="41c4a-164">Configuração de autenticação</span><span class="sxs-lookup"><span data-stu-id="41c4a-164">Configuring Authentication</span></span>

<span data-ttu-id="41c4a-165">Neste ponto, você pode estar se perguntando onde a conta de usuário e as informações da função estão sendo armazenadas.</span><span class="sxs-lookup"><span data-stu-id="41c4a-165">At this point, you might be wondering where the user account and role information is being stored.</span></span> <span data-ttu-id="41c4a-166">Por padrão, as informações são armazenadas em um banco de dados SQL Express (RANU) chamado\_ASPNETDB.mdf localizado na pasta Dados do aplicativo do aplicativo MVC.</span><span class="sxs-lookup"><span data-stu-id="41c4a-166">By default, the information is stored in a (RANU) SQL Express database named ASPNETDB.mdf located in your MVC application's App\_Data folder.</span></span> <span data-ttu-id="41c4a-167">Esse banco de dados é gerado pela ASP.NET framework automaticamente quando você começa a usar a adesão.</span><span class="sxs-lookup"><span data-stu-id="41c4a-167">This database is generated by the ASP.NET framework automatically when you start using membership.</span></span>

<span data-ttu-id="41c4a-168">Para ver o banco de dados ASPNETDB.mdf na janela Solution Explorer, primeiro você precisa selecionar a opção de menu Projeto, Mostrar todos os arquivos.</span><span class="sxs-lookup"><span data-stu-id="41c4a-168">In order to see the ASPNETDB.mdf database in the Solution Explorer window, you first need to select the menu option Project, Show All Files.</span></span>

<span data-ttu-id="41c4a-169">Usar o banco de dados SQL Express padrão é bom ao desenvolver um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="41c4a-169">Using the default SQL Express database is fine when developing an application.</span></span> <span data-ttu-id="41c4a-170">Provavelmente, no entanto, você não vai querer usar o banco de dados ASPNETDB.mdf padrão para um aplicativo de produção.</span><span class="sxs-lookup"><span data-stu-id="41c4a-170">Most likely, however, you won't want to use the default ASPNETDB.mdf database for a production application.</span></span> <span data-ttu-id="41c4a-171">Nesse caso, você pode alterar onde as informações da conta de usuário são armazenadas completando as duas etapas seguintes:</span><span class="sxs-lookup"><span data-stu-id="41c4a-171">In that case, you can change where user account information is stored by completing the following two steps:</span></span>

1. <span data-ttu-id="41c4a-172">Adicione os objetos de banco de dados do Application Services ao seu banco de dados de produção - Altere sua seqüência de conexões de aplicativos para apontar para o banco de dados de produção</span><span class="sxs-lookup"><span data-stu-id="41c4a-172">Add the Application Services database objects to your production database - Change your application connection string to point to your production database</span></span>

<span data-ttu-id="41c4a-173">O primeiro passo é adicionar todos os objetos de banco de dados necessários (tabelas e procedimentos armazenados) ao seu banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="41c4a-173">The first step is to add all of the necessary database objects (tables and stored procedures) to your production database.</span></span> <span data-ttu-id="41c4a-174">A maneira mais fácil de adicionar esses objetos a um novo banco de dados é aproveitar o ASP.NET Assistente de Configuração do Servidor SQL (ver Figura 8).</span><span class="sxs-lookup"><span data-stu-id="41c4a-174">The easiest way to add these objects to a new database is to take advantage of the ASP.NET SQL Server Setup Wizard (see Figure 8).</span></span> <span data-ttu-id="41c4a-175">Você pode iniciar esta ferramenta abrindo o Prompt de Comando Visual Studio 2008 do grupo de programas Microsoft Visual Studio 2008 e executando o seguinte comando a partir do prompt de comando:</span><span class="sxs-lookup"><span data-stu-id="41c4a-175">You can launch this tool by opening the Visual Studio 2008 Command Prompt from the Microsoft Visual Studio 2008 program group and executing the following command from the command prompt:</span></span>

<span data-ttu-id="41c4a-176">aspnet\_regsql</span><span class="sxs-lookup"><span data-stu-id="41c4a-176">aspnet\_regsql</span></span>

<span data-ttu-id="41c4a-177">**Figura 8 – O assistente de configuração do servidor SQL ASP.NET**</span><span class="sxs-lookup"><span data-stu-id="41c4a-177">**Figure 8 – The ASP.NET SQL Server Setup Wizard**</span></span>

![clip_image016](authenticating-users-with-forms-authentication-cs/_static/image8.jpg)

<span data-ttu-id="41c4a-179">O ASP.NET SQL Server Setup Wizard permite selecionar um banco de dados SQL Server em sua rede e instalar todos os objetos de banco de dados exigidos pelos serviços de aplicativo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="41c4a-179">The ASP.NET SQL Server Setup Wizard enables you to select a SQL Server database on your network and install all of the database objects required by the ASP.NET application services.</span></span> <span data-ttu-id="41c4a-180">O servidor de banco de dados não é necessário para ser localizado em sua máquina local.</span><span class="sxs-lookup"><span data-stu-id="41c4a-180">The database server is not required to be located on your local machine.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="41c4a-181">Se você não quiser usar o ASP.NET Assistente de configuração do servidor SQL, então você poderá encontrar scripts SQL para adicionar os objetos do banco de dados de serviços de aplicativos na seguinte pasta:</span><span class="sxs-lookup"><span data-stu-id="41c4a-181">If you don't want to use the ASP.NET SQL Server Setup Wizard, then you can find SQL scripts for adding the application services database objects in the following folder:</span></span>
> 
> > <span data-ttu-id="41c4a-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span><span class="sxs-lookup"><span data-stu-id="41c4a-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span></span>

<span data-ttu-id="41c4a-183">Depois de criar os objetos de banco de dados necessários, você precisa modificar a conexão de banco de dados usada pelo aplicativo MVC.</span><span class="sxs-lookup"><span data-stu-id="41c4a-183">After you create the necessary database objects, you need to modify the database connection used by your MVC application.</span></span> <span data-ttu-id="41c4a-184">Modifique a seqüência de conexão ApplicationServices no seu arquivo de configuração web (web.config) para que ele aponte para o banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="41c4a-184">Modify the ApplicationServices connection string in your web configuration (web.config) file so that it points to the production database.</span></span> <span data-ttu-id="41c4a-185">Por exemplo, a conexão modificada na Listagem 3 pontos para um banco de dados chamado MyProductionDB (a seqüência de conexão ApplicationServices original foi comentada).</span><span class="sxs-lookup"><span data-stu-id="41c4a-185">For example, the modified connection in Listing 3 points to a database named MyProductionDB (the original ApplicationServices connection string has been commented out).</span></span>

<span data-ttu-id="41c4a-186">**Listagem 3 – Web.config**</span><span class="sxs-lookup"><span data-stu-id="41c4a-186">**Listing 3 – Web.config**</span></span>

[!code-xml[Main](authenticating-users-with-forms-authentication-cs/samples/sample3.xml)]

#### <a name="configuring-database-permissions"></a><span data-ttu-id="41c4a-187">Configuração de permissões de banco de dados</span><span class="sxs-lookup"><span data-stu-id="41c4a-187">Configuring Database Permissions</span></span>

<span data-ttu-id="41c4a-188">Se você usar o Integrated Security para se conectar ao seu banco de dados, então você precisará adicionar a conta de usuário correta do Windows como um login ao seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="41c4a-188">If you use Integrated Security to connect to your database then you will need to add the correct Windows user account as a login to your database.</span></span> <span data-ttu-id="41c4a-189">A conta correta depende se você está usando o ASP.NET Development Server ou os Serviços de Informações da Internet como seu servidor web.</span><span class="sxs-lookup"><span data-stu-id="41c4a-189">The correct account depends on whether you are using the ASP.NET Development Server or Internet Information Services as your web server.</span></span> <span data-ttu-id="41c4a-190">A conta de usuário correta também depende do seu sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="41c4a-190">The correct user account also depends on your operating system.</span></span>

<span data-ttu-id="41c4a-191">Se você estiver usando o ASP.NET Development Server (o servidor web padrão usado pelo Visual Studio) então seu aplicativo será executado dentro do contexto da sua conta de usuário do Windows.</span><span class="sxs-lookup"><span data-stu-id="41c4a-191">If you are using the ASP.NET Development Server (the default web server used by Visual Studio) then your application executes within the context of your Windows user account.</span></span> <span data-ttu-id="41c4a-192">Nesse caso, você precisa adicionar sua conta de usuário do Windows como um login de servidor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="41c4a-192">In that case, you need to add your Windows user account as a database server login.</span></span>

<span data-ttu-id="41c4a-193">Alternativamente, se você estiver usando serviços de informações da Internet, você precisa adicionar a conta ASPNET ou a conta NT AUTHORITY/NETWORK SERVICE como um login de servidor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="41c4a-193">Alternatively, if you are using Internet Information Services then you need to add either the ASPNET account or the NT AUTHORITY/NETWORK SERVICE account as a database server login.</span></span> <span data-ttu-id="41c4a-194">Se você estiver usando o Windows XP, adicione a conta ASPNET como um login ao seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="41c4a-194">If you are using Windows XP then add the ASPNET account as a login to your database.</span></span> <span data-ttu-id="41c4a-195">Se você estiver usando um sistema operacional mais recente, como o Windows Vista ou o Windows Server 2008, adicione a conta NT AUTHORITY/NETWORK SERVICE como login de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="41c4a-195">If you are using a more recent operating system, such as Windows Vista or Windows Server 2008, then add the NT AUTHORITY/NETWORK SERVICE account as the database login.</span></span>

<span data-ttu-id="41c4a-196">Você pode adicionar uma nova conta de usuário ao seu banco de dados usando o Microsoft SQL Server Management Studio (ver Figura 9).</span><span class="sxs-lookup"><span data-stu-id="41c4a-196">You can add a new user account to your database by using Microsoft SQL Server Management Studio (see Figure 9).</span></span>

<span data-ttu-id="41c4a-197">**Figura 9 – Criação de um novo login do Microsoft SQL Server**</span><span class="sxs-lookup"><span data-stu-id="41c4a-197">**Figure 9 – Creating a new Microsoft SQL Server login**</span></span>

![clip_image018](authenticating-users-with-forms-authentication-cs/_static/image9.jpg)

<span data-ttu-id="41c4a-199">Depois de criar o login necessário, você precisa mapear o login para um usuário de banco de dados com as funções de banco de dados certas.</span><span class="sxs-lookup"><span data-stu-id="41c4a-199">After you create the required login, you need to map the login to a database user with the right database roles.</span></span> <span data-ttu-id="41c4a-200">Clique duas vezes no login e selecione a guia Mapeamento do usuário. Selecione uma ou mais funções de banco de dados de serviços de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="41c4a-200">Double-click the login and select the User Mapping tab. Select one or more application services database roles.</span></span> <span data-ttu-id="41c4a-201">Por exemplo, para autenticar usuários, você precisa ativar\_a\_função de banco de dados Aspnet Membership BasicAccess.</span><span class="sxs-lookup"><span data-stu-id="41c4a-201">For example, in order to authenticate users, you need to enable the aspnet\_Membership\_BasicAccess database role.</span></span> <span data-ttu-id="41c4a-202">Para criar novos usuários, você precisa ativar\_a\_função de banco de dados Aspnet Membership FullAccess (ver Figura 10).</span><span class="sxs-lookup"><span data-stu-id="41c4a-202">In order to create new users, you need to enable the aspnet\_Membership\_FullAccess database role (see Figure 10).</span></span>

<span data-ttu-id="41c4a-203">**Figura 10 – Adicionar funções de banco de dados de serviços de aplicativos**</span><span class="sxs-lookup"><span data-stu-id="41c4a-203">**Figure 10 – Adding Application Services database roles**</span></span>

![clip_image020](authenticating-users-with-forms-authentication-cs/_static/image10.jpg)

#### <a name="summary"></a><span data-ttu-id="41c4a-205">Resumo</span><span class="sxs-lookup"><span data-stu-id="41c4a-205">Summary</span></span>

<span data-ttu-id="41c4a-206">Neste tutorial, você aprendeu a usar a autenticação de Formulários ao construir um aplicativo mvc ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="41c4a-206">In this tutorial, you learned how to use Forms authentication when building an ASP.NET MVC application.</span></span> <span data-ttu-id="41c4a-207">Primeiro, você aprendeu a criar novos usuários e funções aproveitando a Ferramenta de Administração de Sites.</span><span class="sxs-lookup"><span data-stu-id="41c4a-207">First, you learned how to create new users and roles by taking advantage of the Web Site Administration Tool.</span></span> <span data-ttu-id="41c4a-208">Em seguida, você aprendeu como usar o atributo [Autorizar] para evitar que usuários não autorizados invocassem ações do controlador.</span><span class="sxs-lookup"><span data-stu-id="41c4a-208">Next, you learned how to use the [Authorize] attribute to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="41c4a-209">Finalmente, você aprendeu como configurar seu aplicativo MVC para armazenar informações de usuário e função em um banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="41c4a-209">Finally, you learned how to configure your MVC application to store user and role information in a production database.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="41c4a-210">Avançar</span><span class="sxs-lookup"><span data-stu-id="41c4a-210">Next</span></span>](authenticating-users-with-windows-authentication-cs.md)
