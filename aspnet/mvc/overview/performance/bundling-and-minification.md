---
uid: mvc/overview/performance/bundling-and-minification
title: Agrupamento e Minificação | Microsoft Docs
author: Rick-Anderson
description: O agrupamento e o minificação são duas técnicas que podem ser usadas no ASP.NET 4,5 para melhorar o tempo de carregamento da solicitação. O agrupamento e o minificação melhora o tempo de carregamento por reducin...
ms.author: riande
ms.date: 08/23/2012
ms.assetid: 5894dc13-5d45-4dad-8096-136499120f1d
msc.legacyurl: /mvc/overview/performance/bundling-and-minification
msc.type: authoredcontent
ms.openlocfilehash: 239980d747c6e0d6be1e9b4fe0371e276e37cf21
ms.sourcegitcommit: 88fc80e3f65aebdf61ec9414810ddbc31c543f04
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/22/2020
ms.locfileid: "76519278"
---
# <a name="bundling-and-minification"></a><span data-ttu-id="cca7c-104">Empacotamento e minimização</span><span class="sxs-lookup"><span data-stu-id="cca7c-104">Bundling and Minification</span></span>

<span data-ttu-id="cca7c-105">por [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="cca7c-105">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="cca7c-106">O agrupamento e o minificação são duas técnicas que podem ser usadas no ASP.NET 4,5 para melhorar o tempo de carregamento da solicitação.</span><span class="sxs-lookup"><span data-stu-id="cca7c-106">Bundling and minification are two techniques you can use in ASP.NET 4.5 to improve request load time.</span></span> <span data-ttu-id="cca7c-107">O agrupamento e a minificação melhora o tempo de carregamento, reduzindo o número de solicitações para o servidor e reduzindo o tamanho dos ativos solicitados (como CSS e JavaScript).</span><span class="sxs-lookup"><span data-stu-id="cca7c-107">Bundling and minification improves load time by reducing the number of requests to the server and reducing the size of requested assets (such as CSS and JavaScript.)</span></span>

<span data-ttu-id="cca7c-108">A maioria dos principais navegadores atuais limita o número de [conexões simultâneas](http://www.browserscope.org/?category=network) por cada nome de host a seis.</span><span class="sxs-lookup"><span data-stu-id="cca7c-108">Most of the current major browsers limit the number of [simultaneous connections](http://www.browserscope.org/?category=network) per each hostname to six.</span></span> <span data-ttu-id="cca7c-109">Isso significa que, enquanto seis solicitações estão sendo processadas, as solicitações adicionais de ativos em um host serão enfileiradas pelo navegador.</span><span class="sxs-lookup"><span data-stu-id="cca7c-109">That means that while six requests are being processed, additional requests for assets on a host will be queued by the browser.</span></span> <span data-ttu-id="cca7c-110">Na imagem abaixo, as guias de rede de ferramentas de desenvolvedor F12 do IE mostram o tempo dos ativos exigidos pela exibição sobre de um aplicativo de exemplo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-110">In the image below, the IE F12 developer tools network tabs shows the timing for assets required by the About view of a sample application.</span></span>

![B/M](bundling-and-minification/_static/image1.png)

<span data-ttu-id="cca7c-112">As barras cinzas mostram a hora em que a solicitação é enfileirada pelo navegador aguardando o limite de seis conexões.</span><span class="sxs-lookup"><span data-stu-id="cca7c-112">The gray bars show the time the request is queued by the browser waiting on the six connection limit.</span></span> <span data-ttu-id="cca7c-113">A barra amarela é o tempo de solicitação para o primeiro byte, ou seja, o tempo necessário para enviar a solicitação e receber a primeira resposta do servidor.</span><span class="sxs-lookup"><span data-stu-id="cca7c-113">The yellow bar is the request time to first byte, that is, the time taken to send the request and receive the first response from the server.</span></span> <span data-ttu-id="cca7c-114">As barras azuis mostram o tempo necessário para receber os dados de resposta do servidor.</span><span class="sxs-lookup"><span data-stu-id="cca7c-114">The blue bars show the time taken to receive the response data from the server.</span></span> <span data-ttu-id="cca7c-115">Você pode clicar duas vezes em um ativo para obter informações detalhadas de tempo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-115">You can double-click on an asset to get detailed timing information.</span></span> <span data-ttu-id="cca7c-116">Por exemplo, a imagem a seguir mostra os detalhes de tempo para carregar o arquivo */scripts/MyScripts/JavaScript6.js* .</span><span class="sxs-lookup"><span data-stu-id="cca7c-116">For example, the following image shows the timing details for loading the */Scripts/MyScripts/JavaScript6.js* file.</span></span>

![](bundling-and-minification/_static/image2.png)

<span data-ttu-id="cca7c-117">A imagem anterior mostra o evento **Iniciar** , que fornece a hora em que a solicitação foi enfileirada devido ao navegador limitar o número de conexões simultâneas.</span><span class="sxs-lookup"><span data-stu-id="cca7c-117">The preceding image shows the **Start** event, which gives the time the request was queued because of the browser limit the number of simultaneous connections.</span></span> <span data-ttu-id="cca7c-118">Nesse caso, a solicitação foi enfileirada por 46 milissegundos aguardando a conclusão de outra solicitação.</span><span class="sxs-lookup"><span data-stu-id="cca7c-118">In this case, the request was queued for 46 milliseconds waiting for another request to complete.</span></span>

## <a name="bundling"></a><span data-ttu-id="cca7c-119">Reagrupamento</span><span class="sxs-lookup"><span data-stu-id="cca7c-119">Bundling</span></span>

<span data-ttu-id="cca7c-120">O agrupamento é um novo recurso do ASP.NET 4,5 que torna mais fácil combinar ou agrupar vários arquivos em um único arquivo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-120">Bundling is a new feature in ASP.NET 4.5 that makes it easy to combine or bundle multiple files into a single file.</span></span> <span data-ttu-id="cca7c-121">Você pode criar CSS, JavaScript e outros pacotes.</span><span class="sxs-lookup"><span data-stu-id="cca7c-121">You can create CSS, JavaScript and other bundles.</span></span> <span data-ttu-id="cca7c-122">Menos arquivos significa menos solicitações HTTP e que podem melhorar o desempenho de carregamento da primeira página.</span><span class="sxs-lookup"><span data-stu-id="cca7c-122">Fewer files means fewer HTTP requests and that can improve first page load performance.</span></span>

<span data-ttu-id="cca7c-123">A imagem a seguir mostra a mesma exibição de tempo da exibição sobre mostrada anteriormente, mas desta vez com o agrupamento e o minificação habilitados.</span><span class="sxs-lookup"><span data-stu-id="cca7c-123">The following image shows the same timing view of the About view shown previously, but this time with bundling and minification enabled.</span></span>

![](bundling-and-minification/_static/image3.png)

## <a name="minification"></a><span data-ttu-id="cca7c-124">Minificação</span><span class="sxs-lookup"><span data-stu-id="cca7c-124">Minification</span></span>

<span data-ttu-id="cca7c-125">O minificação executa uma variedade de otimizações de código diferentes para scripts ou CSS, como remover espaços em branco e comentários desnecessários e encurtar nomes de variáveis para um caractere.</span><span class="sxs-lookup"><span data-stu-id="cca7c-125">Minification performs a variety of different code optimizations to scripts or css, such as removing unnecessary white space and comments and shortening variable names to one character.</span></span> <span data-ttu-id="cca7c-126">Considere a seguinte função JavaScript.</span><span class="sxs-lookup"><span data-stu-id="cca7c-126">Consider the following JavaScript function.</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample1.js)]

<span data-ttu-id="cca7c-127">Após minificação, a função é reduzida para o seguinte:</span><span class="sxs-lookup"><span data-stu-id="cca7c-127">After minification, the function is reduced to the following:</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample2.js)]

<span data-ttu-id="cca7c-128">Além de remover os comentários e o espaço em branco desnecessário, os seguintes parâmetros e nomes de variáveis foram renomeados (reduzidos) da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="cca7c-128">In addition to removing the comments and unnecessary whitespace, the following parameters and variable names were renamed (shortened) as follows:</span></span>

| <span data-ttu-id="cca7c-129">**Original**</span><span class="sxs-lookup"><span data-stu-id="cca7c-129">**Original**</span></span> | <span data-ttu-id="cca7c-130">**Renomeado**</span><span class="sxs-lookup"><span data-stu-id="cca7c-130">**Renamed**</span></span> |
| --- | --- |
| <span data-ttu-id="cca7c-131">imageTagAndImageID</span><span class="sxs-lookup"><span data-stu-id="cca7c-131">imageTagAndImageID</span></span> | <span data-ttu-id="cca7c-132">{1&gt;n&lt;1}</span><span class="sxs-lookup"><span data-stu-id="cca7c-132">n</span></span> |
| <span data-ttu-id="cca7c-133">imageContext</span><span class="sxs-lookup"><span data-stu-id="cca7c-133">imageContext</span></span> | <span data-ttu-id="cca7c-134">t</span><span class="sxs-lookup"><span data-stu-id="cca7c-134">t</span></span> |
| <span data-ttu-id="cca7c-135">imageElement</span><span class="sxs-lookup"><span data-stu-id="cca7c-135">imageElement</span></span> | <span data-ttu-id="cca7c-136">{1&gt;i&lt;1}</span><span class="sxs-lookup"><span data-stu-id="cca7c-136">i</span></span> |

## <a name="impact-of-bundling-and-minification"></a><span data-ttu-id="cca7c-137">Impacto do agrupamento e Minificação</span><span class="sxs-lookup"><span data-stu-id="cca7c-137">Impact of Bundling and Minification</span></span>

<span data-ttu-id="cca7c-138">A tabela a seguir mostra várias diferenças importantes entre a listagem de todos os ativos individualmente e o uso de agrupamento e minificação (B/M) no programa de exemplo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-138">The following table shows several important differences between listing all the assets individually and using bundling and minification (B/M) in the sample program.</span></span>

|  | <span data-ttu-id="cca7c-139">**Usando B/M**</span><span class="sxs-lookup"><span data-stu-id="cca7c-139">**Using B/M**</span></span> | <span data-ttu-id="cca7c-140">**Sem B/M**</span><span class="sxs-lookup"><span data-stu-id="cca7c-140">**Without B/M**</span></span> | <span data-ttu-id="cca7c-141">**Alteração**</span><span class="sxs-lookup"><span data-stu-id="cca7c-141">**Change**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="cca7c-142">**Solicitações de arquivo**</span><span class="sxs-lookup"><span data-stu-id="cca7c-142">**File Requests**</span></span> | <span data-ttu-id="cca7c-143">9</span><span class="sxs-lookup"><span data-stu-id="cca7c-143">9</span></span> | <span data-ttu-id="cca7c-144">34</span><span class="sxs-lookup"><span data-stu-id="cca7c-144">34</span></span> | <span data-ttu-id="cca7c-145">256%</span><span class="sxs-lookup"><span data-stu-id="cca7c-145">256%</span></span> |
| <span data-ttu-id="cca7c-146">**KB enviados**</span><span class="sxs-lookup"><span data-stu-id="cca7c-146">**KB Sent**</span></span> | <span data-ttu-id="cca7c-147">3.26</span><span class="sxs-lookup"><span data-stu-id="cca7c-147">3.26</span></span> | <span data-ttu-id="cca7c-148">11.92</span><span class="sxs-lookup"><span data-stu-id="cca7c-148">11.92</span></span> | <span data-ttu-id="cca7c-149">266%</span><span class="sxs-lookup"><span data-stu-id="cca7c-149">266%</span></span> |
| <span data-ttu-id="cca7c-150">**KB recebidos**</span><span class="sxs-lookup"><span data-stu-id="cca7c-150">**KB Received**</span></span> | <span data-ttu-id="cca7c-151">388.51</span><span class="sxs-lookup"><span data-stu-id="cca7c-151">388.51</span></span> | <span data-ttu-id="cca7c-152">530</span><span class="sxs-lookup"><span data-stu-id="cca7c-152">530</span></span> | <span data-ttu-id="cca7c-153">36%</span><span class="sxs-lookup"><span data-stu-id="cca7c-153">36%</span></span> |
| <span data-ttu-id="cca7c-154">**Tempo de carregamento**</span><span class="sxs-lookup"><span data-stu-id="cca7c-154">**Load Time**</span></span> | <span data-ttu-id="cca7c-155">510 MS</span><span class="sxs-lookup"><span data-stu-id="cca7c-155">510 MS</span></span> | <span data-ttu-id="cca7c-156">780 MS</span><span class="sxs-lookup"><span data-stu-id="cca7c-156">780 MS</span></span> | <span data-ttu-id="cca7c-157">53%</span><span class="sxs-lookup"><span data-stu-id="cca7c-157">53%</span></span> |

<span data-ttu-id="cca7c-158">Os bytes enviados tiveram uma redução significativa com o agrupamento, uma vez que os navegadores são bastante detalhados com os cabeçalhos HTTP que eles aplicam nas solicitações.</span><span class="sxs-lookup"><span data-stu-id="cca7c-158">The bytes sent had a significant reduction with bundling as browsers are fairly verbose with the HTTP headers they apply on requests.</span></span> <span data-ttu-id="cca7c-159">A redução de bytes recebidos não é tão grande porque os maiores arquivos (*Scripts\\jQuery-UI-1.8.11. min. js* e *scripts\\jQuery-1.7.1. min. js*) já são reduzidos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-159">The received bytes reduction is not as large because the largest files (*Scripts\\jquery-ui-1.8.11.min.js* and *Scripts\\jquery-1.7.1.min.js*) are already minified.</span></span> <span data-ttu-id="cca7c-160">Observação: os intervalos no programa de exemplo usaram a ferramenta [Fiddler](http://www.fiddler2.com/fiddler2/) para simular uma rede lenta.</span><span class="sxs-lookup"><span data-stu-id="cca7c-160">Note: The timings on the sample program used the [Fiddler](http://www.fiddler2.com/fiddler2/) tool to simulate a slow network.</span></span> <span data-ttu-id="cca7c-161">(No menu **regras** Fiddler, selecione **desempenho** e, em seguida, **simular velocidades de modem**.)</span><span class="sxs-lookup"><span data-stu-id="cca7c-161">(From the Fiddler **Rules** menu, select **Performance** then **Simulate Modem Speeds**.)</span></span>

## <a name="debugging-bundled-and-minified-javascript"></a><span data-ttu-id="cca7c-162">Depurando o JavaScript agrupado e reduzidos</span><span class="sxs-lookup"><span data-stu-id="cca7c-162">Debugging Bundled and Minified JavaScript</span></span>

<span data-ttu-id="cca7c-163">É fácil depurar o JavaScript em um ambiente de desenvolvimento (em que o [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) no arquivo *Web. config* é definido como `debug="true"`) porque os arquivos JavaScript não estão agrupados ou reduzidos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-163">It's easy to debug your JavaScript in a development environment (where the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx) in the *Web.config* file is set to `debug="true"` ) because the JavaScript files are not bundled or minified.</span></span> <span data-ttu-id="cca7c-164">Você também pode depurar uma compilação de versão onde os arquivos JavaScript são agrupados e reduzidos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-164">You can also debug a release build where your JavaScript files are bundled and minified.</span></span> <span data-ttu-id="cca7c-165">Usando as ferramentas de desenvolvedor F12 do IE, você depura uma função JavaScript incluída em um pacote reduzidos usando a seguinte abordagem:</span><span class="sxs-lookup"><span data-stu-id="cca7c-165">Using the IE F12 developer tools, you debug a JavaScript function included in a minified bundle using the following approach:</span></span>

1. <span data-ttu-id="cca7c-166">Selecione a guia **script** e, em seguida, selecione o botão **Iniciar Depuração** .</span><span class="sxs-lookup"><span data-stu-id="cca7c-166">Select the **Script** tab and then select the **Start debugging** button.</span></span>
2. <span data-ttu-id="cca7c-167">Selecione o pacote que contém a função JavaScript que você deseja depurar usando o botão ativos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-167">Select the bundle containing the JavaScript function you want to debug using the assets button.</span></span>  
    ![](bundling-and-minification/_static/image4.png)
3. <span data-ttu-id="cca7c-168">Formate o JavaScript reduzidos selecionando o **botão configuração** ![](bundling-and-minification/_static/image5.png)e, em seguida, selecionando **Formatar JavaScript**.</span><span class="sxs-lookup"><span data-stu-id="cca7c-168">Format the minified JavaScript by selecting the **Configuration button** ![](bundling-and-minification/_static/image5.png), and then selecting **Format JavaScript**.</span></span>
4. <span data-ttu-id="cca7c-169">Na caixa de entrada do **script de pesquisa** , selecione o nome da função que você deseja depurar.</span><span class="sxs-lookup"><span data-stu-id="cca7c-169">In the **Search Script** input box, select the name of the function you want to debug.</span></span> <span data-ttu-id="cca7c-170">Na imagem a seguir, **AddAltToImg** foi inserido na caixa de entrada do **script de pesquisa** .</span><span class="sxs-lookup"><span data-stu-id="cca7c-170">In the following image, **AddAltToImg** was entered in the **Search Script** input box.</span></span>  
    ![](bundling-and-minification/_static/image6.png)

<span data-ttu-id="cca7c-171">Para obter mais informações sobre a depuração com as ferramentas de desenvolvedor F12, consulte o artigo do MSDN [usando o ferramentas para desenvolvedores F12 para depurar erros de JavaScript](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-171">For more information on debugging with the F12 developer tools, see the MSDN article [Using the F12 Developer Tools to Debug JavaScript Errors](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span></span>

## <a name="controlling-bundling-and-minification"></a><span data-ttu-id="cca7c-172">Controlando o agrupamento e o Minificação</span><span class="sxs-lookup"><span data-stu-id="cca7c-172">Controlling Bundling and Minification</span></span>

<span data-ttu-id="cca7c-173">O agrupamento e o minificação são habilitados ou desabilitados pela definição do valor do atributo debug no [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) no arquivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="cca7c-173">Bundling and minification is enabled or disabled by setting the value of the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file.</span></span> <span data-ttu-id="cca7c-174">No XML a seguir, `debug` é definido como true para que o agrupamento e o minificação sejam desabilitados.</span><span class="sxs-lookup"><span data-stu-id="cca7c-174">In the following XML, `debug` is set to true so bundling and minification is disabled.</span></span>

[!code-xml[Main](bundling-and-minification/samples/sample3.xml?highlight=2)]

<span data-ttu-id="cca7c-175">Para habilitar o agrupamento e o minificação, defina o valor de `debug` como "false".</span><span class="sxs-lookup"><span data-stu-id="cca7c-175">To enable bundling and minification, set the `debug` value to "false".</span></span> <span data-ttu-id="cca7c-176">Você pode substituir a configuração *Web. config* pela propriedade `EnableOptimizations` na classe `BundleTable`.</span><span class="sxs-lookup"><span data-stu-id="cca7c-176">You can override the *Web.config* setting with the `EnableOptimizations` property on the `BundleTable` class.</span></span> <span data-ttu-id="cca7c-177">O código a seguir habilita o agrupamento e o minificação e substitui qualquer configuração no arquivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="cca7c-177">The following code enables bundling and minification and overrides any setting in the *Web.config* file.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample4.cs?highlight=7)]

> [!NOTE]
> <span data-ttu-id="cca7c-178">A menos que `EnableOptimizations` seja `true` ou o atributo debug no [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) no arquivo *Web. config* esteja definido como `false`, os arquivos não serão agrupados ou reduzidos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-178">Unless `EnableOptimizations` is `true` or the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file is set to `false`, files will not be bundled or minified.</span></span> <span data-ttu-id="cca7c-179">Além disso, a versão. min de arquivos não será usada, as versões de depuração completas serão selecionadas.</span><span class="sxs-lookup"><span data-stu-id="cca7c-179">Additionally, the .min version of files will not be used, the full debug versions will be selected.</span></span> <span data-ttu-id="cca7c-180">`EnableOptimizations` substitui o atributo debug no [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) do arquivo *Web. config*</span><span class="sxs-lookup"><span data-stu-id="cca7c-180">`EnableOptimizations` overrides the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file</span></span>

## <a name="using-bundling-and-minification-with-aspnet-web-forms-and-web-pages"></a><span data-ttu-id="cca7c-181">Usando agrupamento e Minificação com ASP.NET Web Forms e páginas da Web</span><span class="sxs-lookup"><span data-stu-id="cca7c-181">Using Bundling and Minification with ASP.NET Web Forms and Web Pages</span></span>

- <span data-ttu-id="cca7c-182">Para páginas da Web, consulte a entrada de blog [adicionando otimização da Web a um site de páginas da Web](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span><span class="sxs-lookup"><span data-stu-id="cca7c-182">For Web Pages, see the blog entry [Adding Web Optimization to a Web Pages Site](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span></span>
- <span data-ttu-id="cca7c-183">Para Web Forms, consulte a entrada de blog [adicionando agrupamento e minificação a Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span><span class="sxs-lookup"><span data-stu-id="cca7c-183">For Web Forms, see the blog entry [Adding Bundling and Minification to Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span></span>

## <a name="using-bundling-and-minification-with-aspnet-mvc"></a><span data-ttu-id="cca7c-184">Usando o agrupamento e o Minificação com o ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="cca7c-184">Using Bundling and Minification with ASP.NET MVC</span></span>

<span data-ttu-id="cca7c-185">Nesta seção, criaremos um projeto MVC do ASP.NET para examinar o agrupamento e o minificação.</span><span class="sxs-lookup"><span data-stu-id="cca7c-185">In this section we will create an ASP.NET MVC project to examine bundling and minification.</span></span> <span data-ttu-id="cca7c-186">Primeiro, crie um novo projeto de Internet do ASP.NET MVC chamado **MvcBM** sem alterar nenhum dos padrões.</span><span class="sxs-lookup"><span data-stu-id="cca7c-186">First, create a new ASP.NET MVC internet project named **MvcBM** without changing any of the defaults.</span></span>

<span data-ttu-id="cca7c-187">Abra o *aplicativo\\\_iniciar\\arquivo BundleConfig.cs* e examine o método `RegisterBundles` que é usado para criar, registrar e configurar pacotes.</span><span class="sxs-lookup"><span data-stu-id="cca7c-187">Open the *App\\\_Start\\BundleConfig.cs* file and examine the `RegisterBundles` method which is used to create, register and configure bundles.</span></span> <span data-ttu-id="cca7c-188">O código a seguir mostra uma parte do método `RegisterBundles`.</span><span class="sxs-lookup"><span data-stu-id="cca7c-188">The following code shows a portion of the `RegisterBundles` method.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample5.cs)]

<span data-ttu-id="cca7c-189">O código anterior cria um novo pacote JavaScript chamado *~/Bundles/jQuery* que inclui todos os apropriados (que é debug ou reduzidos, mas não. *vsdoc*) arquivos na pasta *scripts* que correspondem à cadeia de caracteres curinga "~/scripts/jQuery-{Version}.js".</span><span class="sxs-lookup"><span data-stu-id="cca7c-189">The  preceding code creates a new JavaScript bundle named *~/bundles/jquery* that includes all the appropriate (that is debug or minified but not .*vsdoc*) files in the *Scripts* folder that match the wild card string "~/Scripts/jquery-{version}.js".</span></span> <span data-ttu-id="cca7c-190">Para o ASP.NET MVC 4, isso significa que, com uma configuração de depuração, o arquivo *jQuery-1.7.1. js* será adicionado ao pacote.</span><span class="sxs-lookup"><span data-stu-id="cca7c-190">For ASP.NET MVC 4, this means with a debug configuration, the file *jquery-1.7.1.js* will be added to the bundle.</span></span> <span data-ttu-id="cca7c-191">Em uma configuração de versão, *jQuery-1.7.1. min. js* será adicionado.</span><span class="sxs-lookup"><span data-stu-id="cca7c-191">In a release configuration, *jquery-1.7.1.min.js* will be added.</span></span> <span data-ttu-id="cca7c-192">A estrutura de agrupamento segue várias convenções comuns, como:</span><span class="sxs-lookup"><span data-stu-id="cca7c-192">The bundling framework follows several common conventions such as:</span></span>

- <span data-ttu-id="cca7c-193">Selecionando o arquivo ". min" para liberação quando *FileX. min. js* e *FileX. js* existirem.</span><span class="sxs-lookup"><span data-stu-id="cca7c-193">Selecting ".min" file for release when *FileX.min.js* and *FileX.js* exist.</span></span>
- <span data-ttu-id="cca7c-194">Selecionando a versão não ". min" para depuração.</span><span class="sxs-lookup"><span data-stu-id="cca7c-194">Selecting the non ".min" version for debug.</span></span>
- <span data-ttu-id="cca7c-195">Ignorando arquivos "-vsdoc" (como *jQuery-1.7.1-vsdoc. js*), que são usados somente pelo IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="cca7c-195">Ignoring "-vsdoc" files (such as *jquery-1.7.1-vsdoc.js*), which are used only by IntelliSense.</span></span>

<span data-ttu-id="cca7c-196">A correspondência de curingas `{version}` mostrada acima é usada para criar automaticamente um pacote do jQuery com a versão apropriada do jQuery na sua pasta de *scripts* .</span><span class="sxs-lookup"><span data-stu-id="cca7c-196">The `{version}` wild card matching shown above is used to automatically create a jQuery bundle with the appropriate version of jQuery in your *Scripts* folder.</span></span> <span data-ttu-id="cca7c-197">Neste exemplo, o uso de um curinga oferece os seguintes benefícios:</span><span class="sxs-lookup"><span data-stu-id="cca7c-197">In this example, using a wild card provides the following benefits:</span></span>

- <span data-ttu-id="cca7c-198">Permite que você use o NuGet para atualizar para uma versão mais recente do jQuery sem alterar o código de agrupamento ou as referências jQuery anteriores em suas páginas de exibição.</span><span class="sxs-lookup"><span data-stu-id="cca7c-198">Allows you to use NuGet to update to a newer jQuery version without changing the preceding bundling code or jQuery references in your view pages.</span></span>
- <span data-ttu-id="cca7c-199">Seleciona automaticamente a versão completa para as configurações de depuração e a versão ". min" para compilações de versão.</span><span class="sxs-lookup"><span data-stu-id="cca7c-199">Automatically selects the full version for debug configurations and the ".min" version for release builds.</span></span>

## <a name="using-a-cdn"></a><span data-ttu-id="cca7c-200">Usando uma CDN</span><span class="sxs-lookup"><span data-stu-id="cca7c-200">Using a CDN</span></span>

 <span data-ttu-id="cca7c-201">O código a seguir substitui o grupo local do jQuery por um pacote da CDN do jQuery.</span><span class="sxs-lookup"><span data-stu-id="cca7c-201">The follow code replaces the local jQuery bundle with a CDN jQuery bundle.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample6.cs)]

<span data-ttu-id="cca7c-202">No código acima, o jQuery será solicitado da CDN enquanto estiver no modo de liberação e a versão de depuração do jQuery será buscada localmente no modo de depuração.</span><span class="sxs-lookup"><span data-stu-id="cca7c-202">In the code above, jQuery will be requested from the CDN while in release mode and the debug version of jQuery will be fetched locally in debug mode.</span></span> <span data-ttu-id="cca7c-203">Ao usar uma CDN, você deve ter um mecanismo de fallback caso a solicitação da CDN falhe.</span><span class="sxs-lookup"><span data-stu-id="cca7c-203">When using a CDN, you should have a fallback mechanism in case the CDN request fails.</span></span> <span data-ttu-id="cca7c-204">O fragmento de marcação a seguir do final do arquivo de layout mostra o script adicionado para solicitar o jQuery caso a CDN falhe.</span><span class="sxs-lookup"><span data-stu-id="cca7c-204">The following markup fragment from the end of the layout file shows script added to request jQuery should the CDN fail.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample7.cshtml?highlight=5-13)]

## <a name="creating-a-bundle"></a><span data-ttu-id="cca7c-205">Criando um pacote</span><span class="sxs-lookup"><span data-stu-id="cca7c-205">Creating a Bundle</span></span>

<span data-ttu-id="cca7c-206">A classe [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `Include` método usa uma matriz de cadeias de caracteres, em que cada cadeia de caracteres é um caminho virtual para o recurso.</span><span class="sxs-lookup"><span data-stu-id="cca7c-206">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `Include` method takes an array of strings, where each string is a virtual path to resource.</span></span> <span data-ttu-id="cca7c-207">O código a seguir do método `RegisterBundles` no *\\de aplicativo \_iniciar\\arquivo BundleConfig.cs* mostra como vários arquivos são adicionados a um pacote:</span><span class="sxs-lookup"><span data-stu-id="cca7c-207">The following code from the `RegisterBundles` method in the *App\\\_Start\\BundleConfig.cs* file shows how multiple files are added to a bundle:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample8.cs)]

<span data-ttu-id="cca7c-208">A classe [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `IncludeDirectory` método é fornecido para adicionar todos os arquivos em um diretório (e, opcionalmente, todos os subdiretórios) que correspondem a um padrão de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="cca7c-208">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` method is provided to add all the files in a directory (and optionally all subdirectories) which match a search pattern.</span></span> <span data-ttu-id="cca7c-209">A classe de [pacote](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `IncludeDirectory` API é mostrada abaixo:</span><span class="sxs-lookup"><span data-stu-id="cca7c-209">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` API is shown below:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample9.cs)]

<span data-ttu-id="cca7c-210">Os grupos são referenciados em exibições usando o método Render, (`Styles.Render` para CSS e `Scripts.Render` para JavaScript).</span><span class="sxs-lookup"><span data-stu-id="cca7c-210">Bundles are referenced in views using the Render method, (`Styles.Render` for CSS and `Scripts.Render` for JavaScript).</span></span> <span data-ttu-id="cca7c-211">A marcação a seguir do arquivo *views\\compartilhado\\\_layout. cshtml* mostra como os modos de exibição padrão do projeto de Internet ASP.net referenciam os pacotes CSS e JavaScript.</span><span class="sxs-lookup"><span data-stu-id="cca7c-211">The following markup from the *Views\\Shared\\\_Layout.cshtml* file shows how the default ASP.NET internet project views reference CSS and JavaScript bundles.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample10.cshtml?highlight=5-6,11)]

<span data-ttu-id="cca7c-212">Observe que os métodos render assumem uma matriz de cadeias de caracteres, para que você possa adicionar vários pacotes em uma linha de código.</span><span class="sxs-lookup"><span data-stu-id="cca7c-212">Notice the Render methods takes an array of strings, so you can add multiple bundles in one line of code.</span></span> <span data-ttu-id="cca7c-213">Geralmente, você desejará usar os métodos render que criam o HTML necessário para referenciar o ativo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-213">You will generally want to use the Render methods which create the necessary HTML to reference the asset.</span></span> <span data-ttu-id="cca7c-214">Você pode usar o método `Url` para gerar a URL para o ativo sem a marcação necessária para fazer referência ao ativo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-214">You can use the `Url` method to generate the URL to the asset without the markup needed to reference the asset.</span></span> <span data-ttu-id="cca7c-215">Suponha que você quisesse usar o novo atributo [Async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) do HTML5.</span><span class="sxs-lookup"><span data-stu-id="cca7c-215">Suppose you wanted to use the new HTML5 [async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) attribute.</span></span> <span data-ttu-id="cca7c-216">O código a seguir mostra como referenciar o Modernizr usando o método `Url`.</span><span class="sxs-lookup"><span data-stu-id="cca7c-216">The following code shows how to reference modernizr using the `Url` method.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample11.cshtml?highlight=11)]

## <a name="using-the--wildcard-character-to-select-files"></a><span data-ttu-id="cca7c-217">Usando o caractere curinga "\*" para selecionar arquivos</span><span class="sxs-lookup"><span data-stu-id="cca7c-217">Using the "\*" Wildcard Character to Select Files</span></span>

<span data-ttu-id="cca7c-218">O caminho virtual especificado no método `Include` e o padrão de pesquisa no método `IncludeDirectory` podem aceitar um caractere curinga "\*" como prefixo ou sufixo para no último segmento de caminho.</span><span class="sxs-lookup"><span data-stu-id="cca7c-218">The virtual path specified in the `Include` method and the search pattern in the `IncludeDirectory` method can accept one "\*" wildcard character as a prefix or suffix to in the last path segment.</span></span> <span data-ttu-id="cca7c-219">A cadeia de caracteres de pesquisa não diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="cca7c-219">The search string is case insensitive.</span></span> <span data-ttu-id="cca7c-220">O método `IncludeDirectory` tem a opção de Pesquisar subdiretórios.</span><span class="sxs-lookup"><span data-stu-id="cca7c-220">The `IncludeDirectory` method has the option of searching subdirectories.</span></span>

<span data-ttu-id="cca7c-221">Considere um projeto com os seguintes arquivos JavaScript:</span><span class="sxs-lookup"><span data-stu-id="cca7c-221">Consider a project with the following JavaScript files:</span></span>

- <span data-ttu-id="cca7c-222">*Scripts\\Common\\AddAltToImg.js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-222">*Scripts\\Common\\AddAltToImg.js*</span></span>
- <span data-ttu-id="cca7c-223">*Scripts\\Common\\ToggleDiv. js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-223">*Scripts\\Common\\ToggleDiv.js*</span></span>
- <span data-ttu-id="cca7c-224">*Scripts\\Common\\ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-224">*Scripts\\Common\\ToggleImg.js*</span></span>
- <span data-ttu-id="cca7c-225">*Scripts\\Common\\Sub1\\ToggleLinks.js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-225">*Scripts\\Common\\Sub1\\ToggleLinks.js*</span></span>

![Dir imagem](bundling-and-minification/_static/image7.png)

<span data-ttu-id="cca7c-227">A tabela a seguir mostra os arquivos adicionados a um pacote usando o caractere curinga, conforme mostrado:</span><span class="sxs-lookup"><span data-stu-id="cca7c-227">The following table shows the files added to a bundle using the wildcard as shown:</span></span>

| <span data-ttu-id="cca7c-228">**Call**</span><span class="sxs-lookup"><span data-stu-id="cca7c-228">**Call**</span></span> | <span data-ttu-id="cca7c-229">**Arquivos adicionados ou gerados pela exceção**</span><span class="sxs-lookup"><span data-stu-id="cca7c-229">**Files Added or Exception Raised**</span></span> |
| --- | --- |
| <span data-ttu-id="cca7c-230">Include("~/Scripts/Common/\*.js")</span><span class="sxs-lookup"><span data-stu-id="cca7c-230">Include("~/Scripts/Common/\*.js")</span></span> | <span data-ttu-id="cca7c-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="cca7c-232">Include("~/Scripts/Common/T\*.js")</span><span class="sxs-lookup"><span data-stu-id="cca7c-232">Include("~/Scripts/Common/T\*.js")</span></span> | <span data-ttu-id="cca7c-233">Exceção de padrão inválida.</span><span class="sxs-lookup"><span data-stu-id="cca7c-233">Invalid pattern exception.</span></span> <span data-ttu-id="cca7c-234">O caractere curinga só é permitido no prefixo ou sufixo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-234">The wildcard character is only allowed on the prefix or suffix.</span></span> |
| <span data-ttu-id="cca7c-235">Include("~/Scripts/Common/\*og.\*")</span><span class="sxs-lookup"><span data-stu-id="cca7c-235">Include("~/Scripts/Common/\*og.\*")</span></span> | <span data-ttu-id="cca7c-236">Exceção de padrão inválida.</span><span class="sxs-lookup"><span data-stu-id="cca7c-236">Invalid pattern exception.</span></span> <span data-ttu-id="cca7c-237">Somente um caractere curinga é permitido.</span><span class="sxs-lookup"><span data-stu-id="cca7c-237">Only one wildcard character is allowed.</span></span> |
| <span data-ttu-id="cca7c-238">Include ("~/Scripts/Common/T\*")</span><span class="sxs-lookup"><span data-stu-id="cca7c-238">Include("~/Scripts/Common/T\*")</span></span> | <span data-ttu-id="cca7c-239">*ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-239">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="cca7c-240">Include ("~/Scripts/Common/\*")</span><span class="sxs-lookup"><span data-stu-id="cca7c-240">Include("~/Scripts/Common/\*")</span></span> | <span data-ttu-id="cca7c-241">Exceção de padrão inválida.</span><span class="sxs-lookup"><span data-stu-id="cca7c-241">Invalid pattern exception.</span></span> <span data-ttu-id="cca7c-242">Um segmento curinga puro não é válido.</span><span class="sxs-lookup"><span data-stu-id="cca7c-242">A pure wildcard segment is not valid.</span></span> |
| <span data-ttu-id="cca7c-243">IncludeDirectory("~/Scripts/Common", "T\*")</span><span class="sxs-lookup"><span data-stu-id="cca7c-243">IncludeDirectory("~/Scripts/Common", "T\*")</span></span> | <span data-ttu-id="cca7c-244">*ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-244">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="cca7c-245">IncludeDirectory("~/Scripts/Common", "T\*", true)</span><span class="sxs-lookup"><span data-stu-id="cca7c-245">IncludeDirectory("~/Scripts/Common", "T\*", true)</span></span> | <span data-ttu-id="cca7c-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span><span class="sxs-lookup"><span data-stu-id="cca7c-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span></span> |

<span data-ttu-id="cca7c-247">Adicionar explicitamente cada arquivo a um pacote é geralmente o carregamento preferível de arquivos por curinga pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="cca7c-247">Explicitly adding each file to a bundle is generally the preferred over wildcard loading of files for the following reasons:</span></span>

- <span data-ttu-id="cca7c-248">Adicionar scripts por padrões de curinga para carregá-los em ordem alfabética, que normalmente não é o que você deseja.</span><span class="sxs-lookup"><span data-stu-id="cca7c-248">Adding scripts by wildcard defaults to loading them in alphabetical order, which is typically not what you want.</span></span> <span data-ttu-id="cca7c-249">Os arquivos CSS e JavaScript frequentemente precisam ser adicionados em uma ordem específica (não alfabética).</span><span class="sxs-lookup"><span data-stu-id="cca7c-249">CSS and JavaScript files frequently need to be added in a specific (non-alphabetic) order.</span></span> <span data-ttu-id="cca7c-250">Você pode mitigar esse risco adicionando uma implementação de [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) personalizada, mas adicionar explicitamente cada arquivo é menos propenso a erros.</span><span class="sxs-lookup"><span data-stu-id="cca7c-250">You can mitigate this risk by adding a custom [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation, but explicitly adding each file is less error prone.</span></span> <span data-ttu-id="cca7c-251">Por exemplo, você pode adicionar novos ativos a uma pasta no futuro, o que pode exigir que você modifique sua implementação de [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="cca7c-251">For example, you might add new assets to a folder in the future which might require you to modify your [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation.</span></span>
- <span data-ttu-id="cca7c-252">Exibir arquivos específicos adicionados a um diretório usando o carregamento de curingas pode ser incluído em todas as exibições que fazem referência a esse pacote.</span><span class="sxs-lookup"><span data-stu-id="cca7c-252">View specific files added to a directory using wild card loading can be included in all views referencing that bundle.</span></span> <span data-ttu-id="cca7c-253">Se o script específico de exibição for adicionado a um pacote, você poderá receber um erro de JavaScript em outras exibições que fazem referência ao pacote.</span><span class="sxs-lookup"><span data-stu-id="cca7c-253">If the view specific script is added to a bundle, you may get a JavaScript error on other views that reference the bundle.</span></span>
- <span data-ttu-id="cca7c-254">Arquivos CSS que importam outros arquivos resultam em arquivos importados carregados duas vezes.</span><span class="sxs-lookup"><span data-stu-id="cca7c-254">CSS files that import other files result in the imported files loaded twice.</span></span> <span data-ttu-id="cca7c-255">Por exemplo, o código a seguir cria um pacote com a maioria dos arquivos CSS do tema da interface do usuário do jQuery carregados duas vezes.</span><span class="sxs-lookup"><span data-stu-id="cca7c-255">For example, the following code creates a bundle with most of the jQuery UI theme CSS files loaded twice.</span></span> 

    [!code-csharp[Main](bundling-and-minification/samples/sample12.cs)]

  <span data-ttu-id="cca7c-256">O seletor curinga "\*. css" traz cada arquivo CSS na pasta, incluindo o *conteúdo\\themes\\base\\jQuery. UI. All. css* File.</span><span class="sxs-lookup"><span data-stu-id="cca7c-256">The wild card selector "\*.css" brings in each CSS file in the folder, including the *Content\\themes\\base\\jquery.ui.all.css* file.</span></span> <span data-ttu-id="cca7c-257">O arquivo *jQuery. UI. All. css* importa outros arquivos CSS.</span><span class="sxs-lookup"><span data-stu-id="cca7c-257">The *jquery.ui.all.css* file imports other CSS files.</span></span>

## <a name="bundle-caching"></a><span data-ttu-id="cca7c-258">Cache de pacote</span><span class="sxs-lookup"><span data-stu-id="cca7c-258">Bundle Caching</span></span>

<span data-ttu-id="cca7c-259">Os grupos definem o cabeçalho HTTP expira um ano a partir do momento em que o pacote é criado.</span><span class="sxs-lookup"><span data-stu-id="cca7c-259">Bundles set the HTTP Expires Header one year from when the bundle is created.</span></span> <span data-ttu-id="cca7c-260">Se você navegar até uma página exibida anteriormente, o Fiddler mostrará que o IE não faz uma solicitação condicional para o grupo, ou seja, não há solicitações HTTP GET do IE para os pacotes e nenhuma resposta HTTP 304 do servidor.</span><span class="sxs-lookup"><span data-stu-id="cca7c-260">If you navigate to a previously viewed page, Fiddler shows IE does not make a conditional request for the bundle, that is, there are no HTTP GET requests from IE for the bundles and no HTTP 304 responses from the server.</span></span> <span data-ttu-id="cca7c-261">Você pode forçar o IE a fazer uma solicitação condicional para cada pacote com a tecla F5 (resultando em uma resposta HTTP 304 para cada pacote).</span><span class="sxs-lookup"><span data-stu-id="cca7c-261">You can force IE to make a conditional request for each bundle with the F5 key (resulting in a HTTP 304 response for each bundle).</span></span> <span data-ttu-id="cca7c-262">Você pode forçar uma atualização completa usando ^ F5 (resultando em uma resposta HTTP 200 para cada pacote).</span><span class="sxs-lookup"><span data-stu-id="cca7c-262">You can force a full refresh by using ^F5 (resulting in a HTTP 200 response for each bundle.)</span></span>

<span data-ttu-id="cca7c-263">A imagem a seguir mostra a guia **cache** do painel resposta do Fiddler:</span><span class="sxs-lookup"><span data-stu-id="cca7c-263">The following image shows the **Caching** tab of the Fiddler response pane:</span></span>

![imagem de cache Fiddler](bundling-and-minification/_static/image8.png)

<span data-ttu-id="cca7c-265">A solicitação</span><span class="sxs-lookup"><span data-stu-id="cca7c-265">The request</span></span>   
`http://localhost/MvcBM_time/bundles/AllMyScripts?v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81`  
 <span data-ttu-id="cca7c-266">é para o pacote **AllMyScripts** e contém um par de cadeia de caracteres de consulta **v = R0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span><span class="sxs-lookup"><span data-stu-id="cca7c-266">is for the bundle **AllMyScripts** and contains a query string pair **v=r0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span></span> <span data-ttu-id="cca7c-267">A cadeia de caracteres de consulta **v** tem um token de valor que é um identificador exclusivo usado para Caching.</span><span class="sxs-lookup"><span data-stu-id="cca7c-267">The query string **v** has a value token that is a unique identifier used for caching.</span></span> <span data-ttu-id="cca7c-268">Desde que o grupo não seja alterado, o aplicativo ASP.NET solicitará o pacote **AllMyScripts** usando esse token.</span><span class="sxs-lookup"><span data-stu-id="cca7c-268">As long as the bundle doesn't change, the ASP.NET application will request the **AllMyScripts** bundle using this token.</span></span> <span data-ttu-id="cca7c-269">Se qualquer arquivo no pacote for alterado, a estrutura de otimização do ASP.NET gerará um novo token, garantindo que as solicitações do navegador para o pacote obtenham o pacote mais recente.</span><span class="sxs-lookup"><span data-stu-id="cca7c-269">If any file in the bundle changes, the ASP.NET optimization framework will generate a new token, guaranteeing that browser requests for the bundle will get the latest bundle.</span></span>

<span data-ttu-id="cca7c-270">Se você executar as ferramentas de desenvolvedor do IE9 F12 e navegar até uma página carregada anteriormente, o IE mostrará incorretamente as solicitações GET condicionais feitas para cada pacote e o servidor que retorna HTTP 304.</span><span class="sxs-lookup"><span data-stu-id="cca7c-270">If you run the IE9 F12 developer tools and navigate to a previously loaded page, IE incorrectly shows conditional GET requests made to each bundle and the server returning HTTP 304.</span></span> <span data-ttu-id="cca7c-271">Você pode ler por que IE9 tem problemas para determinar se uma solicitação condicional foi feita na entrada de blog [usando CDNs e expirar para melhorar o desempenho do site](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-271">You can read why IE9 has problems determining if a conditional request was made in the blog entry [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

## <a name="less-coffeescript-scss-sass-bundling"></a><span data-ttu-id="cca7c-272">MENOS, CoffeeScript, SCSS, com agrupamento de Sass.</span><span class="sxs-lookup"><span data-stu-id="cca7c-272">LESS, CoffeeScript, SCSS, Sass Bundling.</span></span>

<span data-ttu-id="cca7c-273">A estrutura de agrupamento e minificação fornece um mecanismo para processar linguagens intermediárias, como [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [less](http://www.dotlesscss.org/) ou [CoffeeScript](http://coffeescript.org/), e aplicar transformações como minificação ao pacote resultante.</span><span class="sxs-lookup"><span data-stu-id="cca7c-273">The bundling and minification framework provides a mechanism to process intermediate languages such as [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [LESS](http://www.dotlesscss.org/) or [Coffeescript](http://coffeescript.org/), and apply transforms such as minification to the resulting bundle.</span></span> <span data-ttu-id="cca7c-274">Por exemplo, para adicionar arquivos [. Less](http://www.dotlesscss.org/) a seu projeto MVC 4:</span><span class="sxs-lookup"><span data-stu-id="cca7c-274">For example, to add [.less](http://www.dotlesscss.org/) files to your MVC 4 project:</span></span>

1. <span data-ttu-id="cca7c-275">Crie uma pasta para o conteúdo menos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-275">Create a folder for your LESS content.</span></span> <span data-ttu-id="cca7c-276">O exemplo a seguir usa o *conteúdo\\pasta myless* .</span><span class="sxs-lookup"><span data-stu-id="cca7c-276">The following example uses the *Content\\MyLess* folder.</span></span>
2. <span data-ttu-id="cca7c-277">Adicione o [. menos](http://www.dotlesscss.org/) NuGet com baixo e sem **ping** ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="cca7c-277">Add the [.less](http://www.dotlesscss.org/) NuGet package **dotless** to your project.</span></span>  
    <span data-ttu-id="cca7c-278">![](bundling-and-minification/_static/image9.png) de instalação sem ponto de NuGet</span><span class="sxs-lookup"><span data-stu-id="cca7c-278">![NuGet dotless install](bundling-and-minification/_static/image9.png)</span></span>
3. <span data-ttu-id="cca7c-279">Adicione uma classe que implemente a interface [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="cca7c-279">Add a class that implements the [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) interface.</span></span> <span data-ttu-id="cca7c-280">Para a transformação. Less, adicione o código a seguir ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="cca7c-280">For the .less transform, add the following code to your project.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample13.cs)]
4. <span data-ttu-id="cca7c-281">Crie um pacote de menos arquivos com o `LessTransform` e a transformação [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="cca7c-281">Create a bundle of LESS files with the `LessTransform` and the [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) transform.</span></span> <span data-ttu-id="cca7c-282">Adicione o seguinte código ao método `RegisterBundles` no *aplicativo\\_Start\\arquivo BundleConfig.cs* .</span><span class="sxs-lookup"><span data-stu-id="cca7c-282">Add the following code to the `RegisterBundles` method in the *App\\_Start\\BundleConfig.cs* file.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample14.cs)]
5. <span data-ttu-id="cca7c-283">Adicione o código a seguir a qualquer exibição que faça referência ao pacote menos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-283">Add the following code to any views which references the LESS bundle.</span></span>

    [!code-cshtml[Main](bundling-and-minification/samples/sample15.cshtml)]

## <a name="bundle-considerations"></a><span data-ttu-id="cca7c-284">Considerações sobre o pacote</span><span class="sxs-lookup"><span data-stu-id="cca7c-284">Bundle Considerations</span></span>

<span data-ttu-id="cca7c-285">Uma boa Convenção a ser seguida ao criar pacotes é incluir "Bundle" como um prefixo no nome do pacote.</span><span class="sxs-lookup"><span data-stu-id="cca7c-285">A good convention to follow when creating bundles is to include "bundle" as a prefix in the bundle name.</span></span> <span data-ttu-id="cca7c-286">Isso impedirá um possível [conflito de roteamento](https://forums.asp.net/post/5012037.aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-286">This will prevent a possible [routing conflict](https://forums.asp.net/post/5012037.aspx).</span></span>

<span data-ttu-id="cca7c-287">Depois de atualizar um arquivo em um pacote, um novo token é gerado para o parâmetro de cadeia de caracteres de consulta de pacote e o grupo completo deve ser baixado da próxima vez que um cliente solicitar uma página que contém o pacote.</span><span class="sxs-lookup"><span data-stu-id="cca7c-287">Once you update one file in a bundle, a new token is generated for the bundle query string parameter and the full bundle must be downloaded the next time a client requests a page containing the bundle.</span></span> <span data-ttu-id="cca7c-288">Na marcação tradicional em que cada ativo é listado individualmente, somente o arquivo alterado será baixado.</span><span class="sxs-lookup"><span data-stu-id="cca7c-288">In traditional markup where each asset is listed individually, only the changed file would be downloaded.</span></span> <span data-ttu-id="cca7c-289">Os ativos que mudam com frequência podem não ser bons candidatos para Agrupamento.</span><span class="sxs-lookup"><span data-stu-id="cca7c-289">Assets that change frequently may not be good candidates for bundling.</span></span>

<span data-ttu-id="cca7c-290">O agrupamento e o minificação melhoram principalmente o tempo de carregamento da solicitação da primeira página.</span><span class="sxs-lookup"><span data-stu-id="cca7c-290">Bundling and minification primarily improve the first page request load time.</span></span> <span data-ttu-id="cca7c-291">Depois que uma página da Web for solicitada, o navegador armazenará em cache os ativos (JavaScript, CSS e imagens) para que o agrupamento e o minificação não forneçam nenhum aumento de desempenho ao solicitar a mesma página, ou páginas no mesmo site que solicitam os mesmos ativos.</span><span class="sxs-lookup"><span data-stu-id="cca7c-291">Once a webpage has been requested, the browser caches the assets (JavaScript, CSS and images) so bundling and minification won't provide any performance boost when requesting the same page, or pages on the same site requesting the same assets.</span></span> <span data-ttu-id="cca7c-292">Se você não definir o cabeçalho Expires corretamente em seus ativos e não usar agrupamento e minificação, a heurística de atualização dos navegadores marcará os ativos como obsoletos após alguns dias e o navegador exigirá uma solicitação de validação para cada ativo.</span><span class="sxs-lookup"><span data-stu-id="cca7c-292">If you don't set the expires header correctly on your assets, and you don't use bundling and minification, the browsers freshness heuristics will mark the assets stale after a few days and the browser will require a validation request for each asset.</span></span> <span data-ttu-id="cca7c-293">Nesse caso, o agrupamento e o minificação fornecem um aumento de desempenho após a primeira solicitação de página.</span><span class="sxs-lookup"><span data-stu-id="cca7c-293">In this case, bundling and minification provide a performance increase after the first page request.</span></span> <span data-ttu-id="cca7c-294">Para obter detalhes, consulte o blog [usando CDNs e expira para melhorar o desempenho do site](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-294">For details, see the blog [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

<span data-ttu-id="cca7c-295">A limitação de navegador de seis conexões simultâneas por cada nome de host pode ser atenuada com o uso de uma [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-295">The browser limitation of six simultaneous connections per each hostname can be mitigated by using a [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span> <span data-ttu-id="cca7c-296">Como a CDN terá um nome de host diferente do seu site de hospedagem, as solicitações de ativos da CDN não serão contadas em relação ao limite de seis conexões simultâneas ao seu ambiente de hospedagem.</span><span class="sxs-lookup"><span data-stu-id="cca7c-296">Because the CDN will have a different hostname than your hosting site, asset requests from the CDN will not count against the six simultaneous connections limit to your hosting environment.</span></span> <span data-ttu-id="cca7c-297">Uma CDN também pode fornecer vantagens de cache de pacote e de cache de borda comuns.</span><span class="sxs-lookup"><span data-stu-id="cca7c-297">A CDN can also provide common package caching and edge caching advantages.</span></span>

<span data-ttu-id="cca7c-298">Os grupos devem ser particionados por páginas que precisam deles.</span><span class="sxs-lookup"><span data-stu-id="cca7c-298">Bundles should be partitioned by pages that need them.</span></span> <span data-ttu-id="cca7c-299">Por exemplo, o modelo MVC padrão do ASP.NET para um aplicativo de Internet cria um pacote de validação jQuery separado do jQuery.</span><span class="sxs-lookup"><span data-stu-id="cca7c-299">For example, the default ASP.NET MVC template for an internet application creates a jQuery Validation bundle separate from jQuery.</span></span> <span data-ttu-id="cca7c-300">Como as exibições padrão criadas não têm nenhuma entrada e não postam valores, elas não incluem o pacote de validação.</span><span class="sxs-lookup"><span data-stu-id="cca7c-300">Because the default views created have no input and do not post values, they don't include the validation bundle.</span></span>

<span data-ttu-id="cca7c-301">O namespace `System.Web.Optimization` é implementado em *System. Web. Optimization. dll*.</span><span class="sxs-lookup"><span data-stu-id="cca7c-301">The `System.Web.Optimization` namespace is implemented in *System.Web.Optimization.dll*.</span></span> <span data-ttu-id="cca7c-302">Ele aproveita a biblioteca webgraxa (*webgraxa. dll*) para recursos minificação, que por sua vez usa *Antlr3. Runtime. dll*.</span><span class="sxs-lookup"><span data-stu-id="cca7c-302">It leverages the WebGrease library (*WebGrease.dll*) for minification capabilities, which in turn uses *Antlr3.Runtime.dll*.</span></span>

<span data-ttu-id="cca7c-303">*Eu uso o Twitter para fazer postagens rápidas e links de compartilhamento. Meu identificador do Twitter é*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="cca7c-303">*I use Twitter to make quick posts and share links. My Twitter handle is*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="cca7c-304">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="cca7c-304">Additional resources</span></span>

- <span data-ttu-id="cca7c-305">Vídeo:[agrupamento e otimização](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) de [Howard Dierking](https://twitter.com/#!/howard_dierking)</span><span class="sxs-lookup"><span data-stu-id="cca7c-305">Video:[Bundling and Optimizing](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) by [Howard Dierking](https://twitter.com/#!/howard_dierking)</span></span>
- <span data-ttu-id="cca7c-306">[Adicionar otimização da Web a um site de páginas da Web](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-306">[Adding Web Optimization to a Web Pages Site](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span></span>
- <span data-ttu-id="cca7c-307">[Adicionando agrupamento e minificação a Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span><span class="sxs-lookup"><span data-stu-id="cca7c-307">[Adding Bundling and Minification to Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span></span>
- <span data-ttu-id="cca7c-308">[Implicações de desempenho de agrupamento e minificação na navegação na Web](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) por [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span><span class="sxs-lookup"><span data-stu-id="cca7c-308">[Performance Implications of Bundling and Minification on Web Browsing](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) by [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span></span>
- <span data-ttu-id="cca7c-309">[Usando CDNs e expira para melhorar o desempenho do site](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) de Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="cca7c-309">[Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>
- [<span data-ttu-id="cca7c-310">Minimizar RTT (horas de ida e volta)</span><span class="sxs-lookup"><span data-stu-id="cca7c-310">Minimize RTT (round-trip times)</span></span>](https://developers.google.com/speed/docs/best-practices/rtt)

## <a name="contributors"></a><span data-ttu-id="cca7c-311">Colaboradores</span><span class="sxs-lookup"><span data-stu-id="cca7c-311">Contributors</span></span>

- <span data-ttu-id="cca7c-312">Hao Kung</span><span class="sxs-lookup"><span data-stu-id="cca7c-312">Hao Kung</span></span>
- [<span data-ttu-id="cca7c-313">Howard Dierking</span><span class="sxs-lookup"><span data-stu-id="cca7c-313">Howard Dierking</span></span>](https://twitter.com/#!/howard_dierking)
- <span data-ttu-id="cca7c-314">Diana LaRose</span><span class="sxs-lookup"><span data-stu-id="cca7c-314">Diana LaRose</span></span>
