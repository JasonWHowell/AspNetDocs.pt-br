---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
title: Inserção, atualização e exclusão de dados com o SqlDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Nos tutoriais anteriores, aprendemos como o controle ObjectDataSource permitia inserir, atualizar e excluir dados. O controle SqlDataSource dá suporte a t...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 9673bef3-892c-45ba-a7d8-0da3d6f48ec5
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 4f7b282b09769272df8ff3a32aa4c509c8917481
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78626556"
---
# <a name="inserting-updating-and-deleting-data-with-the-sqldatasource-vb"></a><span data-ttu-id="ee8c1-104">Inserir, atualizar e excluir dados com o SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-104">Inserting, Updating, and Deleting Data with the SqlDataSource (VB)</span></span>

<span data-ttu-id="ee8c1-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ee8c1-106">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) ou [baixar PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span></span>

> <span data-ttu-id="ee8c1-107">Nos tutoriais anteriores, aprendemos como o controle ObjectDataSource permitia inserir, atualizar e excluir dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="ee8c1-108">O controle SqlDataSource dá suporte às mesmas operações, mas a abordagem é diferente, e este tutorial mostra como configurar o SqlDataSource para inserir, atualizar e excluir dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>

## <a name="introduction"></a><span data-ttu-id="ee8c1-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="ee8c1-109">Introduction</span></span>

<span data-ttu-id="ee8c1-110">Conforme discutido em [uma visão geral de inserção, atualização e exclusão](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), o controle GridView fornece recursos internos de atualização e exclusão, enquanto os controles DetailsView e FormView incluem inserção de suporte juntamente com a funcionalidade de edição e exclusão.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="ee8c1-111">Esses recursos de modificação de dados podem ser conectados diretamente a um controle da fonte de dados sem a necessidade de escrever uma linha de código.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="ee8c1-112">[Uma visão geral de inserção, atualização e exclusão](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examinados usando o ObjectDataSource para facilitar a inserção, atualização e exclusão com os controles GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="ee8c1-113">Como alternativa, o SqlDataSource pode ser usado no lugar do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="ee8c1-114">Lembre-se de que para dar suporte à inserção, atualização e exclusão, com o ObjectDataSource, precisávamos especificar os métodos de camada de objeto a serem invocados para executar a ação de inserção, atualização ou exclusão.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="ee8c1-115">Com o SqlDataSource, precisamos fornecer instruções SQL `INSERT`, `UPDATE`e `DELETE` (ou procedimentos armazenados) para executar.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="ee8c1-116">Como veremos neste tutorial, essas instruções podem ser criadas manualmente ou podem ser geradas automaticamente pelo Assistente para configurar fonte de dados do SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8c1-117">Como já vimos os recursos de inserção, edição e exclusão dos controles GridView, DetailsView e FormView, este tutorial se concentrará na configuração do controle SqlDataSource para dar suporte a essas operações.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="ee8c1-118">Se você precisar começar a implementar esses recursos dentro de GridView, DetailsView e FormView, retorne aos tutoriais de edição, inserção e exclusão de dados, começando com [uma visão geral de inserção, atualização e exclusão](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span></span>

## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="ee8c1-119">Etapa 1: especificando instruções`INSERT`,`UPDATE`e`DELETE`</span><span class="sxs-lookup"><span data-stu-id="ee8c1-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="ee8c1-120">Como vimos nos dois tutoriais anteriores, para recuperar dados de um controle SqlDataSource, precisamos definir duas propriedades:</span><span class="sxs-lookup"><span data-stu-id="ee8c1-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="ee8c1-121">`ConnectionString`, que especifica para qual banco de dados enviar a consulta e</span><span class="sxs-lookup"><span data-stu-id="ee8c1-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="ee8c1-122">`SelectCommand`, que especifica a instrução SQL ad hoc ou o nome do procedimento armazenado a ser executado para retornar os resultados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="ee8c1-123">Para `SelectCommand` valores com parâmetros, os valores de parâmetro são especificados por meio da coleção SqlDataSource s `SelectParameters` e podem incluir valores embutidos em código, valores de origem de parâmetro comuns (campos QueryString, variáveis de sessão, valores de controle da Web e assim por diante) ou podem ser atribuídos de forma programática.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="ee8c1-124">Quando o método do controle SqlDataSource s `Select()` é invocado programaticamente ou automaticamente de um controle da Web de dados, uma conexão com o banco de dado é estabelecida, os valores de parâmetro são atribuídos à consulta e o comando é desconectado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="ee8c1-125">Os resultados são retornados como um DataSet ou DataReader, dependendo do valor da propriedade Control s `DataSourceMode`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="ee8c1-126">Juntamente com a seleção de dados, o controle SqlDataSource pode ser usado para inserir, atualizar e excluir dados, fornecendo `INSERT`, `UPDATE`e `DELETE` instruções SQL da mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="ee8c1-127">Basta atribuir as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` as instruções SQL `INSERT`, `UPDATE`e `DELETE` a serem executadas.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="ee8c1-128">Se as instruções tiverem parâmetros (como sempre serão), inclua-os nas coleções `InsertParameters`, `UpdateParameters`e `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="ee8c1-129">Depois que um valor `InsertCommand`, `UpdateCommand`ou `DeleteCommand` tiver sido especificado, a opção Habilitar inserção, habilitar edição ou habilitar a exclusão na marca inteligente s de controle da Web de dados correspondente será disponibilizada.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="ee8c1-130">Para ilustrar isso, vamos pegar um exemplo da página `Querying.aspx` que criamos nos [dados de consulta com o tutorial de controle SqlDataSource](querying-data-with-the-sqldatasource-control-vb.md) e aumentá-lo para incluir recursos de exclusão.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="ee8c1-131">Comece abrindo as páginas `InsertUpdateDelete.aspx` e `Querying.aspx` da pasta `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="ee8c1-132">No designer na página `Querying.aspx`, selecione o SqlDataSource e o GridView do primeiro exemplo (os controles `ProductsDataSource` e `GridView1`).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="ee8c1-133">Depois de selecionar os dois controles, vá para o menu Editar e escolha copiar (ou apenas pressione CTRL + C).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="ee8c1-134">Em seguida, vá para o designer de `InsertUpdateDelete.aspx` e cole os controles.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="ee8c1-135">Depois de mover os dois controles para `InsertUpdateDelete.aspx`, teste a página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="ee8c1-136">Você deve ver os valores das colunas `ProductID`, `ProductName`e `UnitPrice` para todos os registros na tabela `Products` banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>

<span data-ttu-id="ee8c1-137">[![todos os produtos estão listados, ordenados por ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="ee8c1-138">**Figura 1**: todos os produtos são listados, ordenados por `ProductID` ([clique para exibir a imagem em tamanho normal](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="ee8c1-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span></span>

## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="ee8c1-139">Adicionando as propriedades SqlDataSource s`DeleteCommand`e`DeleteParameters`</span><span class="sxs-lookup"><span data-stu-id="ee8c1-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="ee8c1-140">Neste ponto, temos um SqlDataSource que simplesmente retorna todos os registros da tabela `Products` e um GridView que renderiza esses dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="ee8c1-141">Nosso objetivo é estender este exemplo para permitir que o usuário exclua produtos por meio do GridView.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="ee8c1-142">Para fazer isso, precisamos especificar valores para as propriedades do controle SqlDataSource s `DeleteCommand` e `DeleteParameters` e, em seguida, configurar o GridView para dar suporte à exclusão.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="ee8c1-143">As propriedades `DeleteCommand` e `DeleteParameters` podem ser especificadas de várias maneiras:</span><span class="sxs-lookup"><span data-stu-id="ee8c1-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="ee8c1-144">Por meio da sintaxe declarativa</span><span class="sxs-lookup"><span data-stu-id="ee8c1-144">Through the declarative syntax</span></span>
- <span data-ttu-id="ee8c1-145">Do janela Propriedades no designer</span><span class="sxs-lookup"><span data-stu-id="ee8c1-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="ee8c1-146">Na tela especificar uma instrução SQL personalizada ou um procedimento armazenado no Assistente para configurar fonte de dados</span><span class="sxs-lookup"><span data-stu-id="ee8c1-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="ee8c1-147">Por meio do botão Avançado, na tela especificar colunas de uma tabela de exibição no Assistente para configurar fonte de dados, o que gerará automaticamente a instrução `DELETE` SQL e a coleção de parâmetros usada nas propriedades `DeleteCommand` e `DeleteParameters`</span><span class="sxs-lookup"><span data-stu-id="ee8c1-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="ee8c1-148">Examinaremos como fazer automaticamente a instrução de `DELETE` criada na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="ee8c1-149">Por enquanto, vamos usar o janela Propriedades no designer, embora o assistente para configurar fonte de dados ou a opção de sintaxe declarativa também funcione bem.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="ee8c1-150">No designer no `InsertUpdateDelete.aspx`, clique no `ProductsDataSource` SqlDataSource e, em seguida, ative o janela Propriedades (no menu Exibir, escolha janela Propriedades ou simplesmente pressione F4).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="ee8c1-151">Selecione a Propriedade DeleteQuery, que abrirá um conjunto de reticências.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>

![Selecione a Propriedade DeleteQuery na janela Propriedades](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.gif)

<span data-ttu-id="ee8c1-153">**Figura 2**: selecionar a Propriedade DeleteQuery na janela Propriedades</span><span class="sxs-lookup"><span data-stu-id="ee8c1-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>

> [!NOTE]
> <span data-ttu-id="ee8c1-154">O SqlDataSource não tem uma Propriedade DeleteQuery.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="ee8c1-155">Em vez disso, DeleteQuery é uma combinação das propriedades `DeleteCommand` e `DeleteParameters` e é listada somente no janela Propriedades ao exibir a janela por meio do designer.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="ee8c1-156">Se você estiver olhando para a janela Propriedades na exibição de origem, encontrará a propriedade `DeleteCommand` em vez disso.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>

<span data-ttu-id="ee8c1-157">Clique nas reticências na Propriedade DeleteQuery para abrir a caixa de diálogo Editor de comando e parâmetro (consulte a Figura 3).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="ee8c1-158">Nessa caixa de diálogo, você pode especificar a instrução `DELETE` SQL e especificar os parâmetros.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="ee8c1-159">Insira a consulta a seguir na caixa de texto do comando `DELETE` (manualmente ou usando o Construtor de Consultas, se preferir):</span><span class="sxs-lookup"><span data-stu-id="ee8c1-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="ee8c1-160">Em seguida, clique no botão atualizar parâmetros para adicionar o parâmetro `@ProductID` à lista de parâmetros abaixo.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>

<span data-ttu-id="ee8c1-161">[![selecionar a Propriedade DeleteQuery na janela Propriedades](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="ee8c1-162">**Figura 3**: selecione a Propriedade DeleteQuery na janela Propriedades ([clique para exibir a imagem em tamanho normal](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="ee8c1-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="ee8c1-163">*Não* forneça um valor para esse parâmetro (Deixe sua origem de parâmetro em nenhum).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="ee8c1-164">Depois de adicionarmos o suporte de exclusão ao GridView, o GridView fornecerá automaticamente esse valor de parâmetro, usando o valor de sua coleção de `DataKeys` para a linha cujo botão de exclusão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8c1-165">O nome do parâmetro usado na consulta `DELETE` *deve* ser igual ao nome do valor de `DataKeyNames` em GridView, DetailsView ou FormView.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="ee8c1-166">Ou seja, o parâmetro na instrução `DELETE` é intencionalmente nomeado `@ProductID` (em vez de, digamos, `@ID`), porque o nome da coluna de chave primária na tabela Products (e, portanto, o valor DataKeyNames no GridView) é `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>

<span data-ttu-id="ee8c1-167">Se o nome do parâmetro e `DataKeyNames` valor não corresponder, o GridView não poderá atribuir automaticamente o parâmetro ao valor da coleção de `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="ee8c1-168">Depois de inserir as informações relacionadas à exclusão na caixa de diálogo Editor de comandos e parâmetros, clique em OK e vá para a exibição código-fonte para examinar a marcação declarativa resultante:</span><span class="sxs-lookup"><span data-stu-id="ee8c1-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="ee8c1-169">Observe a adição da propriedade `DeleteCommand`, bem como a seção `<DeleteParameters>` e o objeto de parâmetro chamado `productID`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="ee8c1-170">Configurando o GridView para exclusão</span><span class="sxs-lookup"><span data-stu-id="ee8c1-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="ee8c1-171">Com a propriedade `DeleteCommand` adicionada, a marca inteligente s GridView agora contém a opção Habilitar exclusão.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="ee8c1-172">Vá em frente e marque essa caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="ee8c1-173">Conforme discutido em [uma visão geral de inserção, atualização e exclusão](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), isso faz com que o GridView adicione um CommandField com sua propriedade `ShowDeleteButton` definida como `True`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `True`.</span></span> <span data-ttu-id="ee8c1-174">Como mostra a Figura 4, quando a página é visitada por meio de um navegador, um botão excluir é incluído.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="ee8c1-175">Teste essa página excluindo alguns produtos.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-175">Test this page out by deleting some products.</span></span>

<span data-ttu-id="ee8c1-176">[![cada linha GridView agora inclui um botão Delete](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="ee8c1-177">**Figura 4**: cada linha GridView agora inclui um botão Delete ([clique para exibir a imagem em tamanho normal](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ee8c1-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span></span>

<span data-ttu-id="ee8c1-178">Ao clicar em um botão de exclusão, um postback ocorre, o GridView atribui o parâmetro `ProductID` o valor do valor da coleção `DataKeys` para a linha cujo botão de exclusão foi clicado e invoca o método SqlDataSource s `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="ee8c1-179">Em seguida, o controle SqlDataSource se conecta ao banco de dados e executa a instrução `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="ee8c1-180">Em seguida, o GridView reassocia ao SqlDataSource, voltando e exibindo o conjunto atual de produtos (que não inclui mais o registro recém-excluído).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="ee8c1-181">Como o GridView usa sua coleção de `DataKeys` para popular os parâmetros SqlDataSource, é vital que a Propriedade GridView s `DataKeyNames` seja definida como as colunas que constituem a chave primária e que o SqlDataSource s `SelectCommand` retorna essas colunas.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="ee8c1-182">Além disso, é importante que o nome do parâmetro na `DeleteCommand` de SqlDataSource s seja definido como `@ProductID`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="ee8c1-183">Se a propriedade `DataKeyNames` não estiver definida ou o parâmetro não for nomeado `@ProductsID`, clicar no botão excluir causará um postback, mas não excluirá realmente nenhum registro.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won't actually delete any record.</span></span>

<span data-ttu-id="ee8c1-184">A Figura 5 ilustra essa interação graficamente.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="ee8c1-185">Consulte o tutorial [examinando os eventos associados à inserção, atualização e exclusão](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) para obter uma discussão mais detalhada sobre a cadeia de eventos associada à inserção, atualização e exclusão de um controle da Web de dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>

![Clicar no botão excluir no GridView invoca o método SqlDataSource s Delete ()](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.gif)

<span data-ttu-id="ee8c1-187">**Figura 5**: clicar no botão Delete no GridView invoca o método SqlDataSource s `Delete()`</span><span class="sxs-lookup"><span data-stu-id="ee8c1-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>

## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="ee8c1-188">Etapa 2: gerando automaticamente as instruções`INSERT`,`UPDATE`e`DELETE`</span><span class="sxs-lookup"><span data-stu-id="ee8c1-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="ee8c1-189">Como a etapa 1 examinou, `INSERT`, `UPDATE`e `DELETE` instruções SQL podem ser especificadas por meio do janela Propriedades ou da sintaxe declarativa de controle s.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="ee8c1-190">No entanto, essa abordagem exige que as instruções SQL sejam gravadas manualmente, o que pode ser monótono e propenso a erros.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="ee8c1-191">Felizmente, o assistente para configurar fonte de dados fornece uma opção para ter as instruções `INSERT`, `UPDATE`e `DELETE` geradas automaticamente ao usar a tela especificar colunas de uma tabela de exibição.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="ee8c1-192">Vamos explorar essa opção de geração automática.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="ee8c1-193">Adicione um DetailsView ao designer no `InsertUpdateDelete.aspx` e defina sua propriedade `ID` como `ManageProducts`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="ee8c1-194">Em seguida, na marca inteligente DetailsView, escolha criar uma nova fonte de dados e criar um SqlDataSource chamado `ManageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>

<span data-ttu-id="ee8c1-195">[![criar um novo SqlDataSource nomeado ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="ee8c1-196">**Figura 6**: criar um novo SqlDataSource nomeado `ManageProductsDataSource` ([clique para exibir a imagem em tamanho normal](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ee8c1-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="ee8c1-197">No Assistente para configurar fonte de dados, opte por usar a cadeia de conexão `NORTHWINDConnectionString` e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="ee8c1-198">Na tela configurar a instrução SELECT, deixe o botão de opção especificar colunas de uma tabela ou exibição selecionado e escolha a tabela `Products` na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="ee8c1-199">Selecione as colunas `ProductID`, `ProductName`, `UnitPrice`e `Discontinued` na lista de caixas de seleção.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>

<span data-ttu-id="ee8c1-200">[![usar a tabela Products, retornar as colunas ProductID, ProductName, PreçoUnitário e descontinuadas](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="ee8c1-201">**Figura 7**: usando a tabela `Products`, retorne as colunas `ProductID`, `ProductName`, `UnitPrice`e `Discontinued` ([clique para exibir a imagem em tamanho normal](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="ee8c1-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="ee8c1-202">Para gerar automaticamente instruções `INSERT`, `UPDATE`e `DELETE` com base na tabela e nas colunas selecionadas, clique no botão Avançado e marque a caixa de seleção gerar `INSERT`, `UPDATE`e `DELETE` instruções.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>

![Marque a caixa de seleção gerar instruções INSERT, UPDATE e DELETE](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.gif)

<span data-ttu-id="ee8c1-204">**Figura 8**: marque a caixa de seleção gerar `INSERT`, `UPDATE`e `DELETE` instruções</span><span class="sxs-lookup"><span data-stu-id="ee8c1-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>

<span data-ttu-id="ee8c1-205">A caixa de seleção gerar `INSERT`, `UPDATE`e `DELETE` de instruções só poderá ser verificada se a tabela selecionada tiver uma chave primária e a coluna de chave primária (ou colunas) estiver incluída na lista de colunas retornadas.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="ee8c1-206">A caixa de seleção usar simultaneidade otimista, que se torna selecionável após a verificação da caixa de seleção gerar `INSERT`, `UPDATE`e `DELETE` instruções, aumentará as cláusulas `WHERE` nas instruções `UPDATE` e `DELETE` resultantes para fornecer controle de simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="ee8c1-207">Por enquanto, deixe essa caixa de seleção desmarcada; Examinaremos a simultaneidade otimista com o controle SqlDataSource no próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="ee8c1-208">Depois de marcar a caixa de seleção gerar `INSERT`, `UPDATE`e `DELETE` instruções, clique em OK para retornar à tela configurar instrução SELECT, clique em avançar e em concluir para concluir o assistente para configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="ee8c1-209">Após a conclusão do assistente, o Visual Studio adicionará BoundFields ao DetailsView para as colunas `ProductID`, `ProductName`e `UnitPrice` e um CheckBoxField para a coluna `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="ee8c1-210">Na marca inteligente DetailsView s, marque a opção habilitar paginação para que o usuário que visitar esta página possa percorrer os produtos.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="ee8c1-211">Além disso, desmarque as propriedades de `Width` e `Height` DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="ee8c1-212">Observe que a marca inteligente tem as opções Habilitar inserção, habilitar edição e habilitar exclusão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="ee8c1-213">Isso ocorre porque o SqlDataSource contém valores para seu `InsertCommand`, `UpdateCommand`e `DeleteCommand`, como mostra a seguinte sintaxe declarativa:</span><span class="sxs-lookup"><span data-stu-id="ee8c1-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="ee8c1-214">Observe como o controle SqlDataSource tinha valores definidos automaticamente para suas propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="ee8c1-215">O conjunto de colunas referenciadas nas propriedades `InsertCommand` e `UpdateCommand` se baseia neles na instrução `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="ee8c1-216">Ou seja, em vez de ter *cada* coluna de produtos na `InsertCommand` e `UpdateCommand`, há apenas as colunas especificadas no `SelectCommand` (menos `ProductID`, que é omitido porque ele é uma [coluna de`IDENTITY`](http://www.sqlteam.com/item.asp?ItemID=102), cujo valor não pode ser alterado quando editado e que é atribuído automaticamente ao inserir).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="ee8c1-217">Além disso, para cada parâmetro nas propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` há parâmetros correspondentes nas coleções `InsertParameters`, `UpdateParameters`e `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="ee8c1-218">Para ativar os recursos de modificação de dados de DetailsView s, marque as opções Habilitar inserção, habilitar edição e habilitar a exclusão em sua marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="ee8c1-219">Isso adiciona um CommandField com suas propriedades `ShowInsertButton`, `ShowEditButton`e `ShowDeleteButton` definidas como `True`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `True`.</span></span>

<span data-ttu-id="ee8c1-220">Visite a página em um navegador e observe os botões editar, excluir e novo incluídos no DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="ee8c1-221">Clicar no botão Editar transforma o DetailsView em modo de edição, que exibe cada BoundField cuja propriedade `ReadOnly` está definida como `False` (o padrão) como uma caixa de texto e o CheckBoxField como uma caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `False` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>

<span data-ttu-id="ee8c1-222">[![a interface de edição padrão de DetailsView s](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="ee8c1-223">**Figura 9**: a interface de edição padrão de DetailsView s ([clique para exibir a imagem em tamanho normal](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ee8c1-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span></span>

<span data-ttu-id="ee8c1-224">Da mesma forma, você pode excluir o produto selecionado no momento ou adicionar um novo produto ao sistema.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="ee8c1-225">Como a instrução `InsertCommand` só funciona com as colunas `ProductName`, `UnitPrice`e `Discontinued`, as outras colunas têm `NULL` ou seu valor padrão atribuído pelo banco de dados na inserção.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="ee8c1-226">Assim como com o ObjectDataSource, se a `InsertCommand` não tiver nenhuma coluna de tabela de banco de dados que Don t permita `NULL` s e Don t tiver um valor padrão, ocorrerá um erro de SQL ao tentar executar a instrução `INSERT`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8c1-227">As interfaces de inserção e edição do DetailsView s não têm qualquer tipo de personalização ou validação.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="ee8c1-228">Para adicionar controles de validação ou personalizar as interfaces, você precisa converter os BoundFields em TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="ee8c1-229">Consulte o [adicionando controles de validação para as interfaces de edição e inserção](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) e [Personalizando os tutoriais da interface de modificação de dados](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorials for more information.</span></span>

<span data-ttu-id="ee8c1-230">Além disso, lembre-se de que, para atualizar e excluir, o DetailsView usa o valor de `DataKey` do produto atual, que só estará presente se a propriedade `DataKeyNames` estiver configurada.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="ee8c1-231">Se a edição ou exclusão parecer não ter efeito, verifique se a propriedade `DataKeyNames` está definida.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="ee8c1-232">Limitações da geração automática de instruções SQL</span><span class="sxs-lookup"><span data-stu-id="ee8c1-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="ee8c1-233">Como a opção gerar instruções `INSERT`, `UPDATE`e `DELETE` só está disponível ao separar colunas de uma tabela, para consultas mais complexas, você terá que escrever suas próprias instruções `INSERT`, `UPDATE`e `DELETE` como fizemos na etapa 1.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="ee8c1-234">Normalmente, as instruções do SQL `SELECT` usam `JOIN` s para trazer de volta dados de uma ou mais tabelas de pesquisa para fins de exibição (como retornar o campo de `CategoryName` da tabela de `Categories` ao exibir informações do produto).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="ee8c1-235">Ao mesmo tempo, talvez queiramos permitir que o usuário edite, atualize ou insira dados na tabela principal (`Products`, nesse caso).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="ee8c1-236">Embora as instruções `INSERT`, `UPDATE`e `DELETE` possam ser inseridas manualmente, considere a dica de economia de tempo a seguir.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="ee8c1-237">Inicialmente, configure o SqlDataSource para que ele Extraia os dados apenas da tabela `Products`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="ee8c1-238">Use a tela configurar o assistente de fonte de dados s especificar colunas de uma tabela ou exibição para que você possa gerar automaticamente as instruções `INSERT`, `UPDATE`e `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="ee8c1-239">Em seguida, depois de concluir o assistente, escolha configurar o SelectQuery do janela Propriedades (ou, como alternativa, volte para o assistente para configurar fonte de dados, mas use a opção especificar uma instrução SQL personalizada ou procedimento armazenado).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="ee8c1-240">Em seguida, atualize a instrução `SELECT` para incluir a sintaxe de `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="ee8c1-241">Essa técnica oferece os benefícios de economia de tempo das instruções SQL geradas automaticamente e permite uma instrução de `SELECT` mais personalizada.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="ee8c1-242">Outra limitação de gerar automaticamente as instruções `INSERT`, `UPDATE`e `DELETE` é que as colunas nas instruções `INSERT` e `UPDATE` são baseadas nas colunas retornadas pela instrução `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="ee8c1-243">No entanto, talvez seja necessário atualizar ou inserir mais ou menos campos.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="ee8c1-244">Por exemplo, no exemplo da etapa 2, talvez queiramos que o `UnitPrice` BoundField seja somente leitura.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="ee8c1-245">Nesse caso, ele não deve aparecer na `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-245">In that case, it shouldn't appear in the `UpdateCommand`.</span></span> <span data-ttu-id="ee8c1-246">Ou talvez queiramos definir o valor de um campo de tabela que não aparece no GridView.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="ee8c1-247">Por exemplo, ao adicionar um novo registro, talvez queiramos que o valor `QuantityPerUnit` definido como TODO.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="ee8c1-248">Se essas personalizações forem necessárias, você precisará torná-las manualmente, por meio do janela Propriedades, a opção especificar uma instrução SQL personalizada ou um procedimento armazenado no assistente ou por meio da sintaxe declarativa.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="ee8c1-249">Ao adicionar parâmetros que não têm campos correspondentes no controle da Web de dados, tenha em mente que esses valores de parâmetros precisarão ser atribuídos a valores de alguma maneira.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="ee8c1-250">Esses valores podem ser: embutidos no código diretamente no `InsertCommand` ou `UpdateCommand`; pode vir de alguma fonte predefinida (a QueryString, o estado da sessão, os controles da Web na página e assim por diante); ou pode ser atribuído programaticamente, como vimos no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="ee8c1-251">Resumo</span><span class="sxs-lookup"><span data-stu-id="ee8c1-251">Summary</span></span>

<span data-ttu-id="ee8c1-252">Para que os controles da Web de dados utilizem seus recursos internos de inserção, edição e exclusão, o controle da fonte de dados ao qual eles estão vinculados deve oferecer essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="ee8c1-253">Para o SqlDataSource, isso significa que `INSERT`, `UPDATE`e `DELETE` instruções SQL devem ser atribuídas às propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="ee8c1-254">Essas propriedades e as coleções de parâmetros correspondentes podem ser adicionadas manualmente ou geradas automaticamente por meio do assistente para configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="ee8c1-255">Neste tutorial, examinamos as duas técnicas.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="ee8c1-256">Examinamos o uso de simultaneidade otimista com o ObjectDataSource no tutorial [implementando simultaneidade otimista](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="ee8c1-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial.</span></span> <span data-ttu-id="ee8c1-257">O controle SqlDataSource também fornece suporte de simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="ee8c1-258">Conforme observado na etapa 2, ao gerar automaticamente as instruções `INSERT`, `UPDATE`e `DELETE`, o assistente oferece uma opção usar simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="ee8c1-259">Como veremos no próximo tutorial, o uso de simultaneidade otimista com o SqlDataSource modifica as cláusulas `WHERE` nas instruções `UPDATE` e `DELETE` para garantir que os valores das outras colunas não sejam alterados desde que os dados foram exibidos pela última vez na página.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven't changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="ee8c1-260">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="ee8c1-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ee8c1-261">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="ee8c1-261">About the Author</span></span>

<span data-ttu-id="ee8c1-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ee8c1-263">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="ee8c1-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ee8c1-264">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ee8c1-265">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ee8c1-266">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ee8c1-266">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ee8c1-267">[Anterior](using-parameterized-queries-with-the-sqldatasource-vb.md)
> [Próximo](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ee8c1-267">[Previous](using-parameterized-queries-with-the-sqldatasource-vb.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span></span>
