---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Atualizando o TableAdapter para usar junções (VB) | Microsoft Docs
author: rick-anderson
description: Ao trabalhar com um banco de dados, é comum a solicitação de dado que é distribuído por várias tabelas. Para recuperar dados de duas tabelas diferentes, podemos usar...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c94baa99b126cdd24d69afc3d02bfe8b069419b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78532266"
---
# <a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="5c53a-104">Atualizar o TableAdapter para usar JOINs (VB)</span><span class="sxs-lookup"><span data-stu-id="5c53a-104">Updating the TableAdapter to Use JOINs (VB)</span></span>

<span data-ttu-id="5c53a-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5c53a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5c53a-106">[Baixar código](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) ou [baixar PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5c53a-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="5c53a-107">Ao trabalhar com um banco de dados, é comum a solicitação de dado que é distribuído por várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="5c53a-108">Para recuperar dados de duas tabelas diferentes, podemos usar uma subconsulta correlacionada ou uma operação de junção.</span><span class="sxs-lookup"><span data-stu-id="5c53a-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="5c53a-109">Neste tutorial, comparamos Subconsultas correlacionadas e a sintaxe de junção antes de examinar como criar um TableAdapter que inclui uma junção em sua consulta principal.</span><span class="sxs-lookup"><span data-stu-id="5c53a-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="5c53a-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="5c53a-110">Introduction</span></span>

<span data-ttu-id="5c53a-111">Com bancos de dados relacionais, com os quais estamos interessados em trabalhar, muitas vezes se espalham em várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="5c53a-112">Por exemplo, ao exibir as informações do produto, provavelmente, queremos listar os nomes de categoria e fornecedor correspondentes de cada produto.</span><span class="sxs-lookup"><span data-stu-id="5c53a-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="5c53a-113">A tabela `Products` tem valores de `CategoryID` e `SupplierID`, mas os nomes reais de categoria e fornecedor estão nas tabelas `Categories` e `Suppliers`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="5c53a-114">Para recuperar informações de outra tabela relacionada, podemos usar *Subconsultas correlacionadas* ou `JOIN`*s*.</span><span class="sxs-lookup"><span data-stu-id="5c53a-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="5c53a-115">Uma subconsulta correlacionada é uma consulta `SELECT` aninhada que faz referência a colunas na consulta externa.</span><span class="sxs-lookup"><span data-stu-id="5c53a-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="5c53a-116">Por exemplo, no tutorial [criando uma camada de acesso a dados](../introduction/creating-a-data-access-layer-vb.md) , usamos duas Subconsultas correlacionadas na consulta principal `ProductsTableAdapter` s para retornar os nomes da categoria e do fornecedor para cada produto.</span><span class="sxs-lookup"><span data-stu-id="5c53a-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="5c53a-117">Uma `JOIN` é uma construção SQL que mescla linhas relacionadas de duas tabelas diferentes.</span><span class="sxs-lookup"><span data-stu-id="5c53a-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="5c53a-118">Usamos um `JOIN` nos dados de [consulta com o tutorial de controle SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) para exibir informações de categoria junto com cada produto.</span><span class="sxs-lookup"><span data-stu-id="5c53a-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="5c53a-119">O motivo pelo qual temos abstained de usar `JOIN` s com os TableAdapters é devido a limitações no assistente do TableAdapter s para gerar automaticamente as instruções `INSERT`, `UPDATE`e `DELETE` correspondentes.</span><span class="sxs-lookup"><span data-stu-id="5c53a-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="5c53a-120">Mais especificamente, se a consulta principal do TableAdapter s contiver qualquer `JOIN` s, o TableAdapter não poderá criar automaticamente as instruções SQL ad hoc ou procedimentos armazenados para suas propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="5c53a-121">Neste tutorial, vamos comparar brevemente e contrastars com Subconsultas correlacionadas e `JOIN` s antes de explorar como criar um TableAdapter que inclua `JOIN` s em sua consulta principal.</span><span class="sxs-lookup"><span data-stu-id="5c53a-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="5c53a-122">Comparando e contrastanting Subconsultas correlacionadas e`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="5c53a-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="5c53a-123">Lembre-se de que o `ProductsTableAdapter` criado no primeiro tutorial no conjunto de `Northwind` DataSet usa Subconsultas correlacionadas para trazer de volta cada categoria e nome de fornecedor correspondentes.</span><span class="sxs-lookup"><span data-stu-id="5c53a-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="5c53a-124">A consulta principal `ProductsTableAdapter` s é mostrada abaixo.</span><span class="sxs-lookup"><span data-stu-id="5c53a-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="5c53a-125">As duas Subconsultas correlacionadas-`(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` e `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)`-são consultas `SELECT` que retornam um único valor por produto como uma coluna adicional na lista de colunas da instrução de `SELECT` externa.</span><span class="sxs-lookup"><span data-stu-id="5c53a-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="5c53a-126">Como alternativa, um `JOIN` pode ser usado para retornar cada nome de fornecedor e categoria do produto.</span><span class="sxs-lookup"><span data-stu-id="5c53a-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="5c53a-127">A consulta a seguir retorna a mesma saída que a acima, mas usa `JOIN` s no lugar de subconsultas:</span><span class="sxs-lookup"><span data-stu-id="5c53a-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="5c53a-128">Uma `JOIN` mescla os registros de uma tabela com registros de outra tabela com base em alguns critérios.</span><span class="sxs-lookup"><span data-stu-id="5c53a-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="5c53a-129">Na consulta acima, por exemplo, o `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instrui SQL Server a Mesclar cada registro de produto com o registro de categoria cujo valor de `CategoryID` corresponde ao valor de `CategoryID` do produto.</span><span class="sxs-lookup"><span data-stu-id="5c53a-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="5c53a-130">O resultado mesclado nos permite trabalhar com os campos de categoria correspondentes para cada produto (como `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="5c53a-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="5c53a-131">os `JOIN` s são comumente usados ao consultar dados de bancos de dados relacionais.</span><span class="sxs-lookup"><span data-stu-id="5c53a-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="5c53a-132">Se você for novo na sintaxe do `JOIN` ou precisar criar um pouco sobre seu uso, eu d recomendo o tutorial de [junção do SQL](http://www.w3schools.com/sql/sql_join.asp) em [escolas da w3](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="5c53a-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="5c53a-133">Também vale [`JOIN`](https://msdn.microsoft.com/library/ms191517.aspx) a pena ler as seções de [conceitos básicos de subconsultas](https://msdn.microsoft.com/library/ms189575.aspx) e conceitos dos [manuais online do SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c53a-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="5c53a-134">Como as subconsultas `JOIN` s e correlacionadas podem ser usadas para recuperar dados relacionados de outras tabelas, muitos desenvolvedores estão à esquerda e se perguntam qual abordagem usar.</span><span class="sxs-lookup"><span data-stu-id="5c53a-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="5c53a-135">Todos os especialistas em SQL que falei para falaram aproximadamente da mesma coisa, que ele não importa muito em termos de desempenho, pois SQL Server produzirão planos de execução aproximadamente idênticos.</span><span class="sxs-lookup"><span data-stu-id="5c53a-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="5c53a-136">Seu Conselho, então, é usar a técnica com a qual você e sua equipe estão mais confortáveis.</span><span class="sxs-lookup"><span data-stu-id="5c53a-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="5c53a-137">Ele merece observar que, depois de fazer parte desse Conselho, esses especialistas expressam imediatamente sua preferência de `JOIN` s sobre Subconsultas correlacionadas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="5c53a-138">Ao criar uma camada de acesso a dados usando datasets tipados, as ferramentas funcionam melhor ao usar subconsultas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="5c53a-139">Em particular, o assistente do TableAdapter s não gerará automaticamente instruções `INSERT`, `UPDATE`e `DELETE` correspondentes se a consulta principal contiver quaisquer `JOIN` s, mas irá gerar automaticamente essas instruções quando Subconsultas correlacionadas forem usadas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="5c53a-140">Para explorar essa deficiência, crie um DataSet tipado temporário na pasta `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="5c53a-141">Durante o assistente de configuração do TableAdapter, escolha usar instruções SQL ad hoc e insira a seguinte consulta de `SELECT` (consulte a Figura 1):</span><span class="sxs-lookup"><span data-stu-id="5c53a-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]

<span data-ttu-id="5c53a-142">[![inserir uma consulta principal que contém junções](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="5c53a-143">**Figura 1**: Insira uma consulta principal que contenha `JOIN` s ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>

<span data-ttu-id="5c53a-144">Por padrão, o TableAdapter criará automaticamente `INSERT`, `UPDATE`e `DELETE` instruções com base na consulta principal.</span><span class="sxs-lookup"><span data-stu-id="5c53a-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="5c53a-145">Se você clicar no botão Avançado, poderá ver que esse recurso está habilitado.</span><span class="sxs-lookup"><span data-stu-id="5c53a-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="5c53a-146">Apesar dessa configuração, o TableAdapter não será capaz de criar as instruções `INSERT`, `UPDATE`e `DELETE` porque a consulta principal contém uma `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Insira uma consulta principal que contém junções](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="5c53a-148">**Figura 2**: inserir uma consulta principal que contém `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="5c53a-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="5c53a-149">Clique em Concluir para finalizar o assistente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="5c53a-150">Neste ponto, o designer do seu conjunto de seus DataSet incluirá um único TableAdapter com uma DataTable com colunas para cada um dos campos retornados na lista de colunas da consulta `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="5c53a-151">Isso inclui o `CategoryName` e `SupplierName`, como mostra a Figura 3.</span><span class="sxs-lookup"><span data-stu-id="5c53a-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![A DataTable inclui uma coluna para cada campo retornado na lista de colunas](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="5c53a-153">**Figura 3**: a DataTable inclui uma coluna para cada campo retornado na lista de colunas</span><span class="sxs-lookup"><span data-stu-id="5c53a-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="5c53a-154">Embora a DataTable tenha as colunas apropriadas, o TableAdapter não tem valores para suas propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="5c53a-155">Para confirmar isso, clique no TableAdapter no designer e, em seguida, vá para a janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="5c53a-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="5c53a-156">Lá, você verá que as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` são definidas como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="5c53a-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="5c53a-157">[![as propriedades InsertCommand, UpdateCommand e DeleteCommand são definidas como (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="5c53a-158">**Figura 4**: as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` são definidas como (nenhum) ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>

<span data-ttu-id="5c53a-159">Para contornar essa deficiência, podemos fornecer manualmente as instruções SQL e os parâmetros para as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` por meio do janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="5c53a-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="5c53a-160">Como alternativa, poderíamos começar Configurando a consulta principal do TableAdapter s para *não* incluir nenhum `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="5c53a-161">Isso permitirá que as instruções `INSERT`, `UPDATE`e `DELETE` sejam geradas automaticamente para nós.</span><span class="sxs-lookup"><span data-stu-id="5c53a-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="5c53a-162">Depois de concluir o assistente, poderíamos atualizar manualmente o `SelectCommand` do TableAdapter s a partir do janela Propriedades para que ele inclua a sintaxe `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="5c53a-163">Embora essa abordagem funcione, é muito frágil ao usar consultas SQL ad hoc, pois sempre que a consulta principal do TableAdapter s é reconfigurada por meio do assistente, as instruções `INSERT`geradas automaticamente, `UPDATE`e `DELETE` são recriadas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="5c53a-164">Isso significa que todas as personalizações feitas posteriormente seriam perdidas se clicarmos com o botão direito do mouse no TableAdapter, escolhemos configurar no menu de contexto e concluimos o assistente novamente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="5c53a-165">A fragilidade das instruções `INSERT`das geradas automaticamente pelo TableAdapter s, `UPDATE`e `DELETE` é, felizmente, limitada a instruções SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="5c53a-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="5c53a-166">Se o seu TableAdapter usar procedimentos armazenados, você poderá personalizar os `SelectCommand`, `InsertCommand`, `UpdateCommand`ou `DeleteCommand` procedimentos armazenados e executar novamente o assistente de configuração do TableAdapter sem ter que temer que os procedimentos armazenados serão modificados.</span><span class="sxs-lookup"><span data-stu-id="5c53a-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="5c53a-167">Nas próximas etapas, criaremos um TableAdapter que, inicialmente, usa uma consulta principal que omite qualquer `JOIN` s para que os procedimentos armazenados de inserção, atualização e exclusão correspondentes sejam gerados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="5c53a-168">Em seguida, atualizaremos o `SelectCommand` para que use um `JOIN` que retorne colunas adicionais de tabelas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="5c53a-169">Por fim, criaremos uma classe de camada de lógica de negócios correspondente e demonstraremos o uso do TableAdapter em uma página da Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5c53a-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="5c53a-170">Etapa 1: criando o TableAdapter usando uma consulta principal simplificada</span><span class="sxs-lookup"><span data-stu-id="5c53a-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="5c53a-171">Para este tutorial, adicionaremos um TableAdapter e uma DataTable fortemente tipada para a tabela `Employees` no conjunto de `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="5c53a-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="5c53a-172">A tabela de `Employees` contém um campo de `ReportsTo` que especificou a `EmployeeID` do gerente do funcionário s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="5c53a-173">Por exemplo, o funcionário Anne Dodsworth tem um valor `ReportTo` de 5, que é o `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="5c53a-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="5c53a-174">Consequentemente, Anne relata para Steven, seu gerente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="5c53a-175">Juntamente com o relatório de `ReportsTo` valor de cada funcionário, talvez também queiramos recuperar o nome do seu gerente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="5c53a-176">Isso pode ser feito usando uma `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="5c53a-177">Mas usar um `JOIN` ao criar inicialmente o TableAdapter impede que o assistente gere automaticamente os recursos correspondentes de inserção, atualização e exclusão.</span><span class="sxs-lookup"><span data-stu-id="5c53a-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="5c53a-178">Portanto, começaremos criando um TableAdapter cuja consulta principal não contém nenhum `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="5c53a-179">Em seguida, na etapa 2, atualizaremos o procedimento armazenado de consulta principal para recuperar o nome do Gerenciador por meio de um `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="5c53a-180">Comece abrindo o conjunto de `NorthwindWithSprocs` DataSet na pasta `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="5c53a-181">Clique com o botão direito do mouse no designer, selecione a opção Adicionar no menu de contexto e selecione o item de menu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="5c53a-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="5c53a-182">Isso iniciará o assistente de configuração do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="5c53a-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="5c53a-183">Como mostra a Figura 5, faça com que o assistente crie novos procedimentos armazenados e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="5c53a-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="5c53a-184">Para obter um atualizador sobre a criação de novos procedimentos armazenados a partir do assistente do TableAdapter s, consulte o tutorial [criando novos procedimentos armazenados para o DataSets do tipo s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="5c53a-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="5c53a-185">[![selecionar a opção criar novos procedimentos armazenados](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="5c53a-186">**Figura 5**: selecione a opção criar novos procedimentos armazenados ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>

<span data-ttu-id="5c53a-187">Use a seguinte instrução de `SELECT` para a consulta principal do TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="5c53a-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="5c53a-188">Como essa consulta não inclui nenhuma `JOIN` s, o assistente TableAdapter criará automaticamente procedimentos armazenados com as instruções `INSERT`, `UPDATE`e `DELETE` correspondentes, bem como um procedimento armazenado para executar a consulta principal.</span><span class="sxs-lookup"><span data-stu-id="5c53a-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="5c53a-189">A etapa a seguir nos permite nomear os procedimentos armazenados do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="5c53a-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="5c53a-190">Use os nomes `Employees_Select`, `Employees_Insert`, `Employees_Update`e `Employees_Delete`, como mostra a Figura 6.</span><span class="sxs-lookup"><span data-stu-id="5c53a-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="5c53a-191">[![nomear os procedimentos armazenados do TableAdapter s](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="5c53a-192">**Figura 6**: nomear os procedimentos armazenados do TableAdapter s ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>

<span data-ttu-id="5c53a-193">A etapa final solicita que nomeiem os métodos TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="5c53a-194">Use `Fill` e `GetEmployees` como os nomes de método.</span><span class="sxs-lookup"><span data-stu-id="5c53a-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="5c53a-195">Lembre-se também de deixar a caixa de seleção criar métodos para enviar atualizações diretamente para o banco de dados (GenerateDBDirectMethods) marcada.</span><span class="sxs-lookup"><span data-stu-id="5c53a-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="5c53a-196">[![nomear os métodos TableAdapter s Fill e GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="5c53a-197">**Figura 7**: nomear os métodos TableAdapter s `Fill` e `GetEmployees` ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>

<span data-ttu-id="5c53a-198">Depois de concluir o assistente, reserve alguns instantes para examinar os procedimentos armazenados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5c53a-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="5c53a-199">Você deve ver quatro novos: `Employees_Select`, `Employees_Insert`, `Employees_Update`e `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="5c53a-200">Em seguida, inspecione o `EmployeesDataTable` e `EmployeesTableAdapter` recém-criado.</span><span class="sxs-lookup"><span data-stu-id="5c53a-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="5c53a-201">A DataTable contém uma coluna para cada campo retornado pela consulta principal.</span><span class="sxs-lookup"><span data-stu-id="5c53a-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="5c53a-202">Clique no TableAdapter e, em seguida, vá para a janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="5c53a-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="5c53a-203">Lá, você verá que as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` estão configuradas corretamente para chamar os procedimentos armazenados correspondentes.</span><span class="sxs-lookup"><span data-stu-id="5c53a-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="5c53a-204">[![o TableAdapter inclui recursos de inserção, atualização e exclusão](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="5c53a-205">**Figura 8**: o TableAdapter inclui recursos de inserção, atualização e exclusão ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>

<span data-ttu-id="5c53a-206">Com os procedimentos armazenados INSERT, Update e Delete criados automaticamente e as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand` configuradas corretamente, estamos prontos para personalizar o procedimento armazenado `SelectCommand` s para retornar informações adicionais sobre cada funcionário s Manager.</span><span class="sxs-lookup"><span data-stu-id="5c53a-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="5c53a-207">Especificamente, precisamos atualizar o `Employees_Select` procedimento armazenado para usar um `JOIN` e retornar os valores de `FirstName` e `LastName` do Manager s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="5c53a-208">Depois que o procedimento armazenado tiver sido atualizado, precisaremos atualizar a DataTable para que ela inclua essas colunas adicionais.</span><span class="sxs-lookup"><span data-stu-id="5c53a-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="5c53a-209">Iremos lidar com essas duas tarefas nas etapas 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="5c53a-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="5c53a-210">Etapa 2: Personalizando o procedimento armazenado para incluir um`JOIN`</span><span class="sxs-lookup"><span data-stu-id="5c53a-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="5c53a-211">Comece indo para a Gerenciador de Servidores, fazendo Drill down na pasta Northwind Database s stored procedures e abrindo o procedimento armazenado `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="5c53a-212">Se você não vir esse procedimento armazenado, clique com o botão direito do mouse na pasta procedimentos armazenados e escolha Atualizar.</span><span class="sxs-lookup"><span data-stu-id="5c53a-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="5c53a-213">Atualize o procedimento armazenado para que ele use um `LEFT JOIN` para retornar o nome e o sobrenome do Gerenciador:</span><span class="sxs-lookup"><span data-stu-id="5c53a-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="5c53a-214">Depois de atualizar a instrução `SELECT`, salve as alterações Acessando o menu arquivo e escolhendo salvar `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="5c53a-215">Como alternativa, você pode clicar no ícone salvar na barra de ferramentas ou pressionar CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="5c53a-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="5c53a-216">Depois de salvar as alterações, clique com o botão direito do mouse no procedimento armazenado `Employees_Select` no Gerenciador de Servidores e escolha Executar.</span><span class="sxs-lookup"><span data-stu-id="5c53a-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="5c53a-217">Isso executará o procedimento armazenado e mostrará seus resultados na janela de saída (consulte a Figura 9).</span><span class="sxs-lookup"><span data-stu-id="5c53a-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="5c53a-218">[![os resultados dos procedimentos armazenados são exibidos no Janela de Saída](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="5c53a-219">**Figura 9**: os resultados dos procedimentos armazenados são exibidos na janela de saída ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="5c53a-220">Etapa 3: atualizando as colunas DataTable s</span><span class="sxs-lookup"><span data-stu-id="5c53a-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="5c53a-221">Neste ponto, o procedimento armazenado `Employees_Select` retorna `ManagerFirstName` e `ManagerLastName` valores, mas a `EmployeesDataTable` está perdendo essas colunas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="5c53a-222">Essas colunas ausentes podem ser adicionadas à DataTable de uma das duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="5c53a-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="5c53a-223">Clique **manualmente** com o botão direito do mouse na DataTable no designer de conjunto de e, no menu Adicionar, escolha coluna.</span><span class="sxs-lookup"><span data-stu-id="5c53a-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="5c53a-224">Em seguida, você pode nomear a coluna e definir suas propriedades de acordo.</span><span class="sxs-lookup"><span data-stu-id="5c53a-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="5c53a-225">**Automaticamente** -o assistente de configuração do TableAdapter atualizará as colunas DataTable s para refletir os campos retornados pelo procedimento armazenado `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="5c53a-226">Ao usar instruções SQL ad hoc, o assistente também removerá as propriedades `InsertCommand`, `UpdateCommand`e `DeleteCommand`, já que a `SelectCommand` agora contém uma `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="5c53a-227">Mas, ao usar procedimentos armazenados, essas propriedades de comando permanecem intactas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="5c53a-228">Exploramos manualmente a adição de colunas DataTable nos tutoriais anteriores, incluindo [mestre/detalhes, usando uma lista com marcadores de registros mestres com detalhes DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) e [carregando arquivos](../working-with-binary-files/uploading-files-vb.md), e veremos esse processo novamente mais detalhadamente em nosso próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="5c53a-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="5c53a-229">Para este tutorial, no entanto, vamos usar a abordagem automática por meio do assistente de configuração do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="5c53a-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="5c53a-230">Comece clicando com o botão direito do mouse na `EmployeesTableAdapter` e selecionando configurar no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="5c53a-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="5c53a-231">Isso abre o assistente de configuração do TableAdapter, que lista os procedimentos armazenados usados para selecionar, inserir, atualizar e excluir, juntamente com seus valores de retorno e parâmetros (se houver).</span><span class="sxs-lookup"><span data-stu-id="5c53a-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="5c53a-232">A Figura 10 mostra esse assistente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="5c53a-233">Aqui, podemos ver que o procedimento armazenado `Employees_Select` agora retorna os campos `ManagerFirstName` e `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="5c53a-234">[![o assistente mostra a lista de colunas atualizada para o procedimento armazenado Employees_Select](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="5c53a-235">**Figura 10**: o assistente mostra a lista de colunas atualizada para o procedimento armazenado `Employees_Select` ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>

<span data-ttu-id="5c53a-236">Conclua o assistente clicando em concluir.</span><span class="sxs-lookup"><span data-stu-id="5c53a-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="5c53a-237">Ao retornar ao DataSet Designer, o `EmployeesDataTable` inclui duas colunas adicionais: `ManagerFirstName` e `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="5c53a-238">[![o EmployeesDataTable contém duas novas colunas](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="5c53a-239">**Figura 11**: a `EmployeesDataTable` contém duas novas colunas ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>

<span data-ttu-id="5c53a-240">Para ilustrar que o procedimento armazenado `Employees_Select` atualizado está em vigor e que os recursos de inserção, atualização e exclusão do TableAdapter ainda estão funcionais, vamos criar uma página da Web que permita aos usuários exibir e excluir funcionários.</span><span class="sxs-lookup"><span data-stu-id="5c53a-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="5c53a-241">Antes de criarmos essa página, no entanto, precisamos primeiro criar uma nova classe na camada de lógica de negócios para trabalhar com os funcionários do conjunto de `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="5c53a-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="5c53a-242">Na etapa 4, criaremos uma classe de `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="5c53a-243">Na etapa 5, usaremos essa classe em uma página do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5c53a-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="5c53a-244">Etapa 4: implementando a camada de lógica de negócios</span><span class="sxs-lookup"><span data-stu-id="5c53a-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="5c53a-245">Crie um novo arquivo de classe na pasta `~/App_Code/BLL` chamada `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="5c53a-246">Essa classe imita a semântica da classe de `EmployeesBLL` existente, somente essa nova fornece menos métodos e usa o conjunto de `NorthwindWithSprocs` DataSet (em vez do conjunto de `Northwind` DataSet).</span><span class="sxs-lookup"><span data-stu-id="5c53a-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="5c53a-247">Adicione o código a seguir à classe `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="5c53a-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="5c53a-248">A propriedade `EmployeesBLLWithSprocs` s `Adapter` de classe retorna uma instância do `EmployeesTableAdapter`de `NorthwindWithSprocs` do conjunto de os s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="5c53a-249">Isso é usado pelos métodos de classe s `GetEmployees` e `DeleteEmployee`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="5c53a-250">O método `GetEmployees` chama o método `GetEmployees` `EmployeesTableAdapter` correspondente, que invoca o procedimento armazenado `Employees_Select` e popula seus resultados em um `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="5c53a-251">O método `DeleteEmployee`, de forma semelhante, chama o método `EmployeesTableAdapter` s `Delete`, que invoca o procedimento armazenado `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="5c53a-252">Etapa 5: trabalhando com os dados na camada de apresentação</span><span class="sxs-lookup"><span data-stu-id="5c53a-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="5c53a-253">Com a classe `EmployeesBLLWithSprocs` concluída, estamos prontos para trabalhar com dados de funcionários por meio de uma página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5c53a-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="5c53a-254">Abra a página `JOINs.aspx` na pasta `AdvancedDAL` e arraste um GridView da caixa de ferramentas para o designer, definindo sua propriedade `ID` como `Employees`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="5c53a-255">Em seguida, na marca inteligente do GridView, associe a grade a um novo controle ObjectDataSource chamado `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="5c53a-256">Configure o ObjectDataSource para usar a classe `EmployeesBLLWithSprocs` e, nas guias SELECT e DELETE, verifique se os métodos `GetEmployees` e `DeleteEmployee` estão selecionados nas listas suspensas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="5c53a-257">Clique em concluir para concluir a configuração de ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="5c53a-258">[![configurar o ObjectDataSource para usar a classe EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="5c53a-259">**Figura 12**: configurar o ObjectDataSource para usar a classe `EmployeesBLLWithSprocs` ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>

<span data-ttu-id="5c53a-260">[![fazer com que o ObjectDataSource use os métodos GetEmployees e DeleteEmployee](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="5c53a-261">**Figura 13**: fazer com que o ObjectDataSource use os métodos `GetEmployees` e `DeleteEmployee` ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>

<span data-ttu-id="5c53a-262">O Visual Studio adicionará um BoundField ao GridView para cada uma das colunas `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="5c53a-263">Remova todos esses BoundFields, exceto `Title`, `LastName`, `FirstName`, `ManagerFirstName`e `ManagerLastName` e renomeie as propriedades `HeaderText` para os últimos quatro BoundFields para sobrenome, nome, nome do gerente e sobrenome do gerente, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="5c53a-264">Para permitir que os usuários excluam os funcionários desta página, precisamos fazer duas coisas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="5c53a-265">Primeiro, instrua o GridView a fornecer recursos de exclusão marcando a opção Habilitar exclusão em sua marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="5c53a-266">Em segundo lugar, altere a Propriedade ObjectDataSource s `OldValuesParameterFormatString` do valor definido pelo assistente ObjectDataSource (`original_{0}`) para seu valor padrão (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="5c53a-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="5c53a-267">Depois de fazer essas alterações, a marcação declarativa de GridView e ObjectDataSource s deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="5c53a-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="5c53a-268">Teste a página visitando-a por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="5c53a-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="5c53a-269">Como mostra a Figura 14, a página listará cada funcionário e seu nome de gerente (supondo que eles tenham um).</span><span class="sxs-lookup"><span data-stu-id="5c53a-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="5c53a-270">[![a junção no procedimento armazenado Employees_Select retorna o nome do gerente](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="5c53a-271">**Figura 14**: a `JOIN` no procedimento armazenado `Employees_Select` retorna o nome do gerente ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>

<span data-ttu-id="5c53a-272">Clicar no botão excluir inicia o fluxo de trabalho de exclusão, que culmina na execução do procedimento armazenado `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="5c53a-273">No entanto, a instrução tentada `DELETE` no procedimento armazenado falha devido a uma violação de restrição de chave estrangeira (consulte a Figura 15).</span><span class="sxs-lookup"><span data-stu-id="5c53a-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="5c53a-274">Especificamente, cada funcionário tem um ou mais registros na tabela `Orders`, fazendo com que a exclusão falhe.</span><span class="sxs-lookup"><span data-stu-id="5c53a-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="5c53a-275">[![excluir um funcionário que tem pedidos correspondentes resulta em uma violação de restrição de chave estrangeira](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="5c53a-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="5c53a-276">**Figura 15**: a exclusão de um funcionário que tem pedidos correspondentes resulta em uma violação de restrição de chave estrangeira ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="5c53a-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>

<span data-ttu-id="5c53a-277">Para permitir que um funcionário seja excluído, você poderia:</span><span class="sxs-lookup"><span data-stu-id="5c53a-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="5c53a-278">Atualizar a restrição FOREIGN KEY para as exclusões em cascata,</span><span class="sxs-lookup"><span data-stu-id="5c53a-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="5c53a-279">Exclua manualmente os registros da tabela `Orders` para os funcionários que você deseja excluir ou</span><span class="sxs-lookup"><span data-stu-id="5c53a-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="5c53a-280">Atualize o procedimento armazenado `Employees_Delete` para primeiro excluir os registros relacionados da tabela `Orders` antes de excluir o registro `Employees`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="5c53a-281">Discutimos essa técnica no tutorial [usando os procedimentos armazenados existentes para os TableAdapters do DataSet s tipados](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="5c53a-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="5c53a-282">Eu deixe isso como um exercício para o leitor.</span><span class="sxs-lookup"><span data-stu-id="5c53a-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="5c53a-283">Resumo</span><span class="sxs-lookup"><span data-stu-id="5c53a-283">Summary</span></span>

<span data-ttu-id="5c53a-284">Ao trabalhar com bancos de dados relacionais, é comum que as consultas recebam seus dados de várias tabelas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="5c53a-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="5c53a-285">Subconsultas correlacionadas e `JOIN` s fornecem duas técnicas diferentes para acessar dados de tabelas relacionadas em uma consulta.</span><span class="sxs-lookup"><span data-stu-id="5c53a-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="5c53a-286">Nos tutoriais anteriores, mais comumente usamos as Subconsultas correlacionadas porque o TableAdapter não pode gerar automaticamente instruções `INSERT`, `UPDATE`e `DELETE` para consultas que envolvem `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="5c53a-287">Embora esses valores possam ser fornecidos manualmente, ao usar instruções SQL ad hoc, todas as personalizações serão substituídas quando o assistente de configuração do TableAdapter for concluído.</span><span class="sxs-lookup"><span data-stu-id="5c53a-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="5c53a-288">Felizmente, os TableAdapters criados usando procedimentos armazenados não sofrem com a mesma fragilidade que aquelas criadas usando instruções SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="5c53a-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="5c53a-289">Portanto, é viável criar um TableAdapter cuja consulta principal usa um `JOIN` ao usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="5c53a-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="5c53a-290">Neste tutorial, vimos como criar um TableAdapter desse tipo.</span><span class="sxs-lookup"><span data-stu-id="5c53a-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="5c53a-291">Começamos usando uma consulta `SELECT` sem `JOIN`para a consulta principal do TableAdapter s para que os procedimentos armazenados de inserção, atualização e exclusão correspondentes sejam criados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5c53a-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="5c53a-292">Com a configuração inicial do TableAdapter s concluída, aumentamos o `SelectCommand` procedimento armazenado para usar um `JOIN` e executar novamente o assistente de configuração do TableAdapter para atualizar as colunas do `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="5c53a-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="5c53a-293">Executar novamente o assistente de configuração do TableAdapter atualizou automaticamente as colunas de `EmployeesDataTable` para refletir os campos de dados retornados pelo procedimento armazenado `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="5c53a-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="5c53a-294">Como alternativa, poderíamos ter adicionado manualmente essas colunas à DataTable.</span><span class="sxs-lookup"><span data-stu-id="5c53a-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="5c53a-295">Exploraremos manualmente a adição de colunas à DataTable no próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="5c53a-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="5c53a-296">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="5c53a-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5c53a-297">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="5c53a-297">About the Author</span></span>

<span data-ttu-id="5c53a-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="5c53a-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5c53a-299">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="5c53a-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5c53a-300">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5c53a-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5c53a-301">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5c53a-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5c53a-302">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5c53a-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5c53a-303">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="5c53a-303">Special Thanks To</span></span>

<span data-ttu-id="5c53a-304">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="5c53a-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5c53a-305">Os revisores potenciais para este tutorial foram Hilton Geisenow, David Suru e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="5c53a-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="5c53a-306">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="5c53a-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5c53a-307">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5c53a-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5c53a-308">[Anterior](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Próximo](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5c53a-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
