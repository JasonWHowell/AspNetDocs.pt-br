---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Trabalhando com colunas computadas (VB) | Microsoft Docs
author: rick-anderson
description: Ao criar uma tabela de banco de dados, Microsoft SQL Server permite que você defina uma coluna computada cujo valor é calculado a partir de uma expressão que geralmente se refere...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: e425d7363c2cdea6efb0ba51f3fc2b6a5330bf2a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78524482"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="882d7-103">Trabalhar com colunas computadas (VB)</span><span class="sxs-lookup"><span data-stu-id="882d7-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="882d7-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="882d7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="882d7-105">[Baixar código](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) ou [baixar PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="882d7-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="882d7-106">Ao criar uma tabela de banco de dados, Microsoft SQL Server permite que você defina uma coluna computada cujo valor é calculado a partir de uma expressão que geralmente faz referência a outros valores no mesmo registro de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="882d7-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="882d7-107">Esses valores são somente leitura no banco de dados, o que exige considerações especiais ao trabalhar com TableAdapters.</span><span class="sxs-lookup"><span data-stu-id="882d7-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="882d7-108">Neste tutorial, aprendemos como atender aos desafios apresentados por colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="882d7-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="882d7-109">Introduction</span></span>

<span data-ttu-id="882d7-110">Microsoft SQL Server permite *[colunas computadas](https://msdn.microsoft.com/library/ms191250.aspx)* , que são colunas cujos valores são calculados a partir de uma expressão que geralmente referencia os valores de outras colunas na mesma tabela.</span><span class="sxs-lookup"><span data-stu-id="882d7-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="882d7-111">Por exemplo, um modelo de dados de rastreamento de tempo pode ter uma tabela chamada `ServiceLog` com colunas, incluindo `ServicePerformed`, `EmployeeID`, `Rate`e `Duration`, entre outras.</span><span class="sxs-lookup"><span data-stu-id="882d7-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="882d7-112">Embora a quantia devida por item de serviço (sendo a taxa multiplicada pela duração) pudesse ser calculada por meio de uma página da Web ou outra interface programática, pode ser útil incluir uma coluna na tabela `ServiceLog` chamada `AmountDue` que reportou essas informações.</span><span class="sxs-lookup"><span data-stu-id="882d7-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="882d7-113">Esta coluna pode ser criada como uma coluna normal, mas precisa ser atualizada sempre que o `Rate` ou `Duration` valores de coluna forem alterados.</span><span class="sxs-lookup"><span data-stu-id="882d7-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="882d7-114">Uma abordagem melhor seria tornar a coluna `AmountDue` uma coluna computada usando a expressão `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="882d7-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="882d7-115">Isso faria com que SQL Server calcular automaticamente o valor da coluna `AmountDue` sempre que ele fosse referenciado em uma consulta.</span><span class="sxs-lookup"><span data-stu-id="882d7-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="882d7-116">Como um valor de s de coluna computada é determinado por uma expressão, essas colunas são somente leitura e, portanto, não podem ter valores atribuídos a elas em instruções `INSERT` ou `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="882d7-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="882d7-117">No entanto, quando as colunas computadas fazem parte da consulta principal para um TableAdapter que usa instruções SQL ad hoc, elas são incluídas automaticamente nas instruções `INSERT` geradas automaticamente e `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="882d7-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="882d7-118">Consequentemente, as consultas do TableAdapter s `INSERT` e `UPDATE` e as propriedades `InsertCommand` e `UpdateCommand` devem ser atualizadas para remover referências a quaisquer colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="882d7-119">Um desafio de usar colunas computadas com um TableAdapter que usa instruções SQL ad hoc é que as consultas do TableAdapter s `INSERT` e `UPDATE` são regeneradas automaticamente sempre que o assistente de configuração do TableAdapter é concluído.</span><span class="sxs-lookup"><span data-stu-id="882d7-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="882d7-120">Portanto, as colunas computadas são removidas manualmente da `INSERT` e `UPDATE` consultas reaparecerão se o assistente for executado novamente.</span><span class="sxs-lookup"><span data-stu-id="882d7-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="882d7-121">Embora os TableAdapters que usam procedimentos armazenados Don t sofram dessa fragilidade, eles têm suas próprias sutilezas que iremos abordar na etapa 3.</span><span class="sxs-lookup"><span data-stu-id="882d7-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="882d7-122">Neste tutorial, adicionaremos uma coluna computada à tabela `Suppliers` no banco de dados Northwind e, em seguida, criaremos um TableAdapter correspondente para trabalhar com essa tabela e sua coluna computada.</span><span class="sxs-lookup"><span data-stu-id="882d7-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="882d7-123">Nosso TableAdapter usará procedimentos armazenados em vez de instruções SQL ad hoc para que nossas personalizações não sejam perdidas quando o assistente de configuração do TableAdapter for usado.</span><span class="sxs-lookup"><span data-stu-id="882d7-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="882d7-124">Vamos começar!</span><span class="sxs-lookup"><span data-stu-id="882d7-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="882d7-125">Etapa 1: adicionar uma coluna computada à tabela de`Suppliers`</span><span class="sxs-lookup"><span data-stu-id="882d7-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="882d7-126">O banco de dados Northwind não tem nenhuma coluna computada, portanto, precisaremos adicionar um por si só.</span><span class="sxs-lookup"><span data-stu-id="882d7-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="882d7-127">Para este tutorial, vamos adicionar uma coluna computada à tabela de `Suppliers` chamada `FullContactName` que retorna o nome, o título e a empresa do contato em que eles trabalham no seguinte formato: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="882d7-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="882d7-128">Essa coluna computada pode ser usada em relatórios ao exibir informações sobre fornecedores.</span><span class="sxs-lookup"><span data-stu-id="882d7-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="882d7-129">Comece abrindo a definição da tabela de `Suppliers` clicando com o botão direito do mouse na tabela `Suppliers` no Gerenciador de Servidores e escolhendo Abrir definição de tabela no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="882d7-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="882d7-130">Isso exibirá as colunas da tabela e suas propriedades, como o tipo de dados, se elas permitem `NULL` s e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="882d7-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="882d7-131">Para adicionar uma coluna computada, comece digitando o nome da coluna na definição da tabela.</span><span class="sxs-lookup"><span data-stu-id="882d7-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="882d7-132">Em seguida, insira sua expressão na caixa de texto (fórmula) na seção especificação de coluna computada na janela Propriedades da coluna (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="882d7-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="882d7-133">Nomeie a coluna computada `FullContactName` e use a seguinte expressão:</span><span class="sxs-lookup"><span data-stu-id="882d7-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="882d7-134">Observe que as cadeias de caracteres podem ser concatenadas no SQL usando o operador `+`.</span><span class="sxs-lookup"><span data-stu-id="882d7-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="882d7-135">A instrução `CASE` pode ser usada como uma condicional em uma linguagem de programação tradicional.</span><span class="sxs-lookup"><span data-stu-id="882d7-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="882d7-136">Na expressão acima, a instrução `CASE` pode ser lida como: se `ContactTitle` não estiver `NULL`, em seguida, gere o valor de `ContactTitle` concatenado com uma vírgula; caso contrário, não emitirá nada.</span><span class="sxs-lookup"><span data-stu-id="882d7-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="882d7-137">Para obter mais informações sobre a utilidade da instrução `CASE`, consulte [o poder das instruções SQL `CASE`](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="882d7-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="882d7-138">Em vez de usar uma instrução `CASE` aqui, poderíamos ter usado `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="882d7-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="882d7-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) retornará *CheckId* se ela não for nula, caso contrário retornará *replacevalue*.</span><span class="sxs-lookup"><span data-stu-id="882d7-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="882d7-140">Embora `ISNULL` ou `CASE` funcionem nessa instância, há cenários mais complexos em que a flexibilidade da instrução `CASE` não pode corresponder ao `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="882d7-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="882d7-141">Depois de adicionar essa coluna computada, sua tela deve ser parecida com a captura de tela na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="882d7-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="882d7-142">[![adicionar uma coluna computada chamada FullContactName à tabela Suppliers](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="882d7-143">**Figura 1**: adicionar uma coluna computada chamada `FullContactName` à tabela `Suppliers` ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="882d7-144">Depois de nomear a coluna computada e inserir sua expressão, salve as alterações na tabela clicando no ícone salvar na barra de ferramentas, pressionando CTRL + S ou acessando o menu arquivo e escolhendo salvar `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="882d7-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="882d7-145">Salvar a tabela deve atualizar a Gerenciador de Servidores, incluindo a coluna recém-adicionada na lista de colunas da tabela de `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="882d7-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="882d7-146">Além disso, a expressão inserida na caixa de texto (fórmula) se ajustará automaticamente a uma expressão equivalente que retira o espaço em branco desnecessário, circunda os nomes das colunas com colchetes (`[]`) e inclui parênteses para mostrar mais explicitamente a ordem das operações:</span><span class="sxs-lookup"><span data-stu-id="882d7-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="882d7-147">Para obter mais informações sobre colunas computadas no Microsoft SQL Server, consulte a [documentação técnica](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="882d7-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="882d7-148">Além disso, confira a seção [como especificar as colunas computadas](https://msdn.microsoft.com/library/ms188300.aspx) para um passo a passo de criação de colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="882d7-149">Por padrão, as colunas computadas não são fisicamente armazenadas na tabela, mas, em vez disso, são recalculadas sempre que são referenciadas em uma consulta.</span><span class="sxs-lookup"><span data-stu-id="882d7-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="882d7-150">Ao marcar a caixa de seleção é persistente, no entanto, você pode instruir SQL Server a armazenar fisicamente a coluna computada na tabela.</span><span class="sxs-lookup"><span data-stu-id="882d7-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="882d7-151">Isso permite que um índice seja criado na coluna computada, o que pode melhorar o desempenho de consultas que usam o valor da coluna computada em suas cláusulas de `WHERE`.</span><span class="sxs-lookup"><span data-stu-id="882d7-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="882d7-152">Consulte [criando índices em colunas computadas](https://msdn.microsoft.com/library/ms189292.aspx) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="882d7-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="882d7-153">Etapa 2: exibindo os valores de s de coluna computada</span><span class="sxs-lookup"><span data-stu-id="882d7-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="882d7-154">Antes de começarmos a trabalhar na camada de acesso a dados, deixe-nos levar um minuto para exibir os valores de `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="882d7-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="882d7-155">No Gerenciador de Servidores, clique com o botão direito do mouse no nome da tabela de `Suppliers` e escolha nova consulta no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="882d7-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="882d7-156">Isso abrirá uma janela de consulta que nos solicitará a escolha quais tabelas serão incluídas na consulta.</span><span class="sxs-lookup"><span data-stu-id="882d7-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="882d7-157">Adicione a tabela `Suppliers` e clique em fechar.</span><span class="sxs-lookup"><span data-stu-id="882d7-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="882d7-158">Em seguida, verifique as colunas `CompanyName`, `ContactName`, `ContactTitle`e `FullContactName` da tabela fornecedores.</span><span class="sxs-lookup"><span data-stu-id="882d7-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="882d7-159">Por fim, clique no ícone de ponto de exclamação vermelho na barra de ferramentas para executar a consulta e exibir os resultados.</span><span class="sxs-lookup"><span data-stu-id="882d7-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="882d7-160">Como mostra a Figura 2, os resultados incluem `FullContactName`, que lista as colunas `CompanyName`, `ContactName`e `ContactTitle` usando o formato `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="882d7-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="882d7-161">[![o FullContactName usa o formato ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="882d7-162">**Figura 2**: a `FullContactName` usa o formato `ContactName` (`ContactTitle``CompanyName`) ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="882d7-163">Etapa 3: Adicionar o`SuppliersTableAdapter`à camada de acesso a dados</span><span class="sxs-lookup"><span data-stu-id="882d7-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="882d7-164">Para trabalhar com as informações do fornecedor em nosso aplicativo, precisamos primeiro criar um TableAdapter e DataTable em nossa DAL.</span><span class="sxs-lookup"><span data-stu-id="882d7-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="882d7-165">O ideal é que isso seja feito usando as mesmas etapas simples examinadas nos tutoriais anteriores.</span><span class="sxs-lookup"><span data-stu-id="882d7-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="882d7-166">No entanto, trabalhar com colunas computadas apresenta algumas rugas que abordam o mérito.</span><span class="sxs-lookup"><span data-stu-id="882d7-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="882d7-167">Se você estiver usando um TableAdapter que usa instruções SQL ad hoc, poderá simplesmente incluir a coluna computada na consulta principal do TableAdapter s por meio do assistente de configuração do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="882d7-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="882d7-168">No entanto, isso gerará automaticamente `INSERT` e `UPDATE` instruções que incluem a coluna computada.</span><span class="sxs-lookup"><span data-stu-id="882d7-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="882d7-169">Se você tentar executar um desses métodos, uma `SqlException` com a mensagem a coluna *ColumnName* não poderá ser modificada porque ela é uma coluna computada ou será o resultado de um operador Union será gerado.</span><span class="sxs-lookup"><span data-stu-id="882d7-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="882d7-170">Embora a instrução `INSERT` e `UPDATE` possa ser manualmente ajustada por meio das propriedades `InsertCommand` do TableAdapter e `UpdateCommand`, essas personalizações serão perdidas sempre que o assistente de configuração do TableAdapter for executado novamente.</span><span class="sxs-lookup"><span data-stu-id="882d7-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="882d7-171">Devido à fragilidade dos TableAdapters que usam instruções SQL ad hoc, é recomendável que possamos usar procedimentos armazenados ao trabalhar com colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="882d7-172">Se você estiver usando procedimentos armazenados existentes, bastará configurar o TableAdapter conforme discutido no tutorial [usando os procedimentos armazenados existentes para o conjunto de DataSets s tipados](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="882d7-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="882d7-173">Se você tiver o assistente TableAdapter criar os procedimentos armazenados para você, no entanto, é importante omitir inicialmente todas as colunas computadas da consulta principal.</span><span class="sxs-lookup"><span data-stu-id="882d7-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="882d7-174">Se você incluir uma coluna computada na consulta principal, o assistente de configuração do TableAdapter informará, após a conclusão, que não poderá criar os procedimentos armazenados correspondentes.</span><span class="sxs-lookup"><span data-stu-id="882d7-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="882d7-175">Em suma, precisamos configurar inicialmente o TableAdapter usando uma consulta principal computada sem coluna e, em seguida, atualizar manualmente o procedimento armazenado correspondente e o TableAdapter s `SelectCommand` para incluir a coluna computada.</span><span class="sxs-lookup"><span data-stu-id="882d7-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="882d7-176">Essa abordagem é semelhante à usada no tutorial [atualizando o TableAdapter para usar](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* .</span><span class="sxs-lookup"><span data-stu-id="882d7-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="882d7-177">Para este tutorial, vamos adicionar um novo TableAdapter e fazer com que ele crie automaticamente os procedimentos armazenados para nós.</span><span class="sxs-lookup"><span data-stu-id="882d7-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="882d7-178">Consequentemente, precisaremos omitir inicialmente a `FullContactName` coluna computada da consulta principal.</span><span class="sxs-lookup"><span data-stu-id="882d7-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="882d7-179">Comece abrindo o conjunto de `NorthwindWithSprocs` DataSet na pasta `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="882d7-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="882d7-180">Clique com o botão direito do mouse no designer e, no menu de contexto, escolha Adicionar um novo TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="882d7-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="882d7-181">Isso iniciará o assistente de configuração do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="882d7-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="882d7-182">Especifique o banco de dados do qual será consultada a data (`NORTHWNDConnectionString` de `Web.config`) e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="882d7-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="882d7-183">Como ainda não criamos nenhum procedimento armazenado para consultar ou modificar a tabela de `Suppliers`, selecione a opção criar novos procedimentos armazenados para que o assistente os crie para nós e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="882d7-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="882d7-184">[![escolher a opção criar novos procedimentos armazenados](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="882d7-185">**Figura 3**: escolha a opção criar novos procedimentos armazenados ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="882d7-186">A etapa subsequente solicita a consulta principal.</span><span class="sxs-lookup"><span data-stu-id="882d7-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="882d7-187">Insira a consulta a seguir, que retorna as colunas `SupplierID`, `CompanyName`, `ContactName`e `ContactTitle` para cada fornecedor.</span><span class="sxs-lookup"><span data-stu-id="882d7-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="882d7-188">Observe que essa consulta omite propositadamente a coluna computada (`FullContactName`); atualizaremos o procedimento armazenado correspondente para incluir essa coluna na etapa 4.</span><span class="sxs-lookup"><span data-stu-id="882d7-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="882d7-189">Depois de inserir a consulta principal e clicar em avançar, o assistente nos permite nomear os quatro procedimentos armazenados que serão gerados.</span><span class="sxs-lookup"><span data-stu-id="882d7-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="882d7-190">Nomeie esses procedimentos armazenados `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`e `Suppliers_Delete`, como ilustra a Figura 4.</span><span class="sxs-lookup"><span data-stu-id="882d7-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="882d7-191">[![personalizar os nomes dos procedimentos armazenados gerados automaticamente](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="882d7-192">**Figura 4**: personalizar os nomes dos procedimentos armazenados gerados automaticamente ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="882d7-193">A próxima etapa do assistente nos permite nomear os métodos TableAdapter s e especificar os padrões usados para acessar e atualizar os dados.</span><span class="sxs-lookup"><span data-stu-id="882d7-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="882d7-194">Deixe todas as três caixas de seleção marcadas, mas renomeie o método `GetData` como `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="882d7-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="882d7-195">Clique em Concluir para finalizar o assistente.</span><span class="sxs-lookup"><span data-stu-id="882d7-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="882d7-196">[![renomear o método GetData para getsuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="882d7-197">**Figura 5**: renomear o método `GetData` como `GetSuppliers` ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="882d7-198">Ao clicar em concluir, o assistente criará os quatro procedimentos armazenados e adicionará o TableAdapter e a DataTable correspondente ao DataSet tipado.</span><span class="sxs-lookup"><span data-stu-id="882d7-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="882d7-199">Etapa 4: incluindo a coluna computada na consulta principal do TableAdapter s</span><span class="sxs-lookup"><span data-stu-id="882d7-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="882d7-200">Agora, precisamos atualizar o TableAdapter e DataTable criado na etapa 3 para incluir a `FullContactName` coluna computada.</span><span class="sxs-lookup"><span data-stu-id="882d7-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="882d7-201">Isso envolve duas etapas:</span><span class="sxs-lookup"><span data-stu-id="882d7-201">This involves two steps:</span></span>

1. <span data-ttu-id="882d7-202">Atualizando o procedimento armazenado `Suppliers_Select` para retornar a `FullContactName` coluna computada e</span><span class="sxs-lookup"><span data-stu-id="882d7-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="882d7-203">Atualizando DataTable para incluir uma coluna de `FullContactName` correspondente.</span><span class="sxs-lookup"><span data-stu-id="882d7-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="882d7-204">Comece navegando até a Gerenciador de Servidores e fazendo Drill down na pasta procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="882d7-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="882d7-205">Abra o procedimento armazenado `Suppliers_Select` e atualize a consulta `SELECT` para incluir a `FullContactName` coluna computada:</span><span class="sxs-lookup"><span data-stu-id="882d7-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="882d7-206">Salve as alterações no procedimento armazenado clicando no ícone salvar na barra de ferramentas, pressionando CTRL + S ou escolhendo a opção salvar `Suppliers_Select` no menu arquivo.</span><span class="sxs-lookup"><span data-stu-id="882d7-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="882d7-207">Em seguida, retorne ao DataSet Designer, clique com o botão direito do mouse no `SuppliersTableAdapter`e escolha configurar no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="882d7-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="882d7-208">Observe que a coluna `Suppliers_Select` agora inclui a coluna `FullContactName` em sua coleção de colunas de dados.</span><span class="sxs-lookup"><span data-stu-id="882d7-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="882d7-209">[![executar o assistente de configuração do TableAdapter s para atualizar as colunas DataTable s](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="882d7-210">**Figura 6**: executar o assistente de configuração do TableAdapter s para atualizar as colunas DataTable s ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="882d7-211">Clique em Concluir para finalizar o assistente.</span><span class="sxs-lookup"><span data-stu-id="882d7-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="882d7-212">Isso adicionará automaticamente uma coluna correspondente à `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="882d7-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="882d7-213">O assistente TableAdapter é inteligente o suficiente para detectar que a coluna `FullContactName` é uma coluna computada e, portanto, somente leitura.</span><span class="sxs-lookup"><span data-stu-id="882d7-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="882d7-214">Consequentemente, ele define a propriedade s `ReadOnly` da coluna como `true`.</span><span class="sxs-lookup"><span data-stu-id="882d7-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="882d7-215">Para verificar isso, selecione a coluna na `SuppliersDataTable` e, em seguida, vá para a janela Propriedades (veja a Figura 7).</span><span class="sxs-lookup"><span data-stu-id="882d7-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="882d7-216">Observe que as propriedades `FullContactName` s `DataType` e `MaxLength` de coluna também são definidas de acordo.</span><span class="sxs-lookup"><span data-stu-id="882d7-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="882d7-217">[![a coluna FullContactName está marcada como somente leitura](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="882d7-218">**Figura 7**: a coluna `FullContactName` é marcada como somente leitura ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="882d7-219">Etapa 5: adicionando um método`GetSupplierBySupplierID`ao TableAdapter</span><span class="sxs-lookup"><span data-stu-id="882d7-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="882d7-220">Para este tutorial, criaremos uma página ASP.NET que exibe os fornecedores em uma grade atualizável.</span><span class="sxs-lookup"><span data-stu-id="882d7-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="882d7-221">Nos tutoriais anteriores, atualizamos um único registro da camada de lógica de negócios recuperando esse registro específico da DAL como uma DataTable com rigidez de tipos, atualizando suas propriedades e enviando a DataTable atualizada de volta para a DAL para propagar as alterações para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="882d7-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="882d7-222">Para realizar essa primeira etapa – recuperando o registro que está sendo atualizado da DAL-precisamos primeiro adicionar um método `GetSupplierBySupplierID(supplierID)` à DAL.</span><span class="sxs-lookup"><span data-stu-id="882d7-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="882d7-223">Clique com o botão direito do mouse na `SuppliersTableAdapter` no design do conjunto de conjuntos e escolha a opção Adicionar consulta no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="882d7-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="882d7-224">Como fizemos na etapa 3, deixe que o assistente gere um novo procedimento armazenado para nós selecionando a opção Criar novo procedimento armazenado (consulte a Figura 3 para obter uma captura de tela desta etapa do assistente).</span><span class="sxs-lookup"><span data-stu-id="882d7-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="882d7-225">Como esse método retornará um registro com várias colunas, indique que queremos usar uma consulta SQL que é uma seleção que retorna linhas e clica em Avançar.</span><span class="sxs-lookup"><span data-stu-id="882d7-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="882d7-226">[![escolher a opção Selecionar que retorna linhas](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="882d7-227">**Figura 8**: escolha a opção Selecionar que retorna linhas ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="882d7-228">A etapa subsequente solicita que a consulta seja usada para esse método.</span><span class="sxs-lookup"><span data-stu-id="882d7-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="882d7-229">Insira o seguinte, que retorna os mesmos campos de dados que a consulta principal, mas para um fornecedor específico.</span><span class="sxs-lookup"><span data-stu-id="882d7-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="882d7-230">A próxima tela nos pede para nomear o procedimento armazenado que será gerado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="882d7-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="882d7-231">Nomeie esse procedimento armazenado `Suppliers_SelectBySupplierID` e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="882d7-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="882d7-232">[![nomear o procedimento armazenado Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="882d7-233">**Figura 9**: nomear o procedimento armazenado `Suppliers_SelectBySupplierID` ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="882d7-234">Por fim, o assistente nos solicita os padrões de acesso a dados e os nomes de método a serem usados para o TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="882d7-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="882d7-235">Deixe ambas as caixas de seleção marcadas, mas renomeie os métodos `FillBy` e `GetDataBy` como `FillBySupplierID` e `GetSupplierBySupplierID`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="882d7-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="882d7-236">[![nomear os métodos TableAdapter FillBySupplierID e GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="882d7-237">**Figura 10**: nomear os métodos TableAdapter `FillBySupplierID` e `GetSupplierBySupplierID` ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="882d7-238">Clique em Concluir para finalizar o assistente.</span><span class="sxs-lookup"><span data-stu-id="882d7-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="882d7-239">Etapa 6: criando a camada de lógica de negócios</span><span class="sxs-lookup"><span data-stu-id="882d7-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="882d7-240">Antes de criarmos uma página ASP.NET que usa a coluna computada criada na etapa 1, primeiro precisamos adicionar os métodos correspondentes na BLL.</span><span class="sxs-lookup"><span data-stu-id="882d7-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="882d7-241">Nossa página ASP.NET, que vamos criar na etapa 7, permitirá que os usuários exibam e editem fornecedores.</span><span class="sxs-lookup"><span data-stu-id="882d7-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="882d7-242">Portanto, precisamos de nossa BLL para fornecer, no mínimo, um método para obter todos os fornecedores e outro para atualizar um fornecedor específico.</span><span class="sxs-lookup"><span data-stu-id="882d7-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="882d7-243">Crie um novo arquivo de classe chamado `SuppliersBLLWithSprocs` na pasta `~/App_Code/BLL` e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="882d7-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="882d7-244">Assim como as outras classes de BLL, `SuppliersBLLWithSprocs` tem uma propriedade `Protected` `Adapter` que retorna uma instância da classe `SuppliersTableAdapter` juntamente com dois métodos `Public`: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="882d7-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="882d7-245">O método `GetSuppliers` chama e retorna o `SuppliersDataTable` retornado pelo método `GetSupplier` correspondente na camada de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="882d7-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="882d7-246">O método `UpdateSupplier` recupera informações sobre o fornecedor específico que está sendo atualizado por meio de uma chamada para o método de `GetSupplierBySupplierID(supplierID)` DAL.</span><span class="sxs-lookup"><span data-stu-id="882d7-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="882d7-247">Em seguida, ele atualiza as propriedades `CategoryName`, `ContactName`e `ContactTitle` e confirma essas alterações no banco de dados chamando o método de `Update` da camada de acesso a data, passando o objeto de `SuppliersRow` modificado.</span><span class="sxs-lookup"><span data-stu-id="882d7-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="882d7-248">Exceto para `SupplierID` e `CompanyName`, todas as colunas na tabela Suppliers permitem valores `NULL`.</span><span class="sxs-lookup"><span data-stu-id="882d7-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="882d7-249">Portanto, se os parâmetros `contactName` ou `contactTitle` passados forem `Nothing` precisaremos definir as propriedades `ContactName` e `ContactTitle` correspondentes como um valor de banco de dados `NULL` usando os métodos `SetContactNameNull` e `SetContactTitleNull`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="882d7-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="882d7-250">Etapa 7: trabalhando com a coluna computada da camada de apresentação</span><span class="sxs-lookup"><span data-stu-id="882d7-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="882d7-251">Com a coluna computada adicionada à tabela de `Suppliers` e a DAL e a BLL atualizadas de acordo, estamos prontos para criar uma página ASP.NET que funcione com a coluna computada `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="882d7-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="882d7-252">Comece abrindo a página `ComputedColumns.aspx` na pasta `AdvancedDAL` e arraste um GridView da caixa de ferramentas para o designer.</span><span class="sxs-lookup"><span data-stu-id="882d7-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="882d7-253">Defina a Propriedade GridView s `ID` como `Suppliers` e, em sua marca inteligente, associe-a a um novo ObjectDataSource chamado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="882d7-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="882d7-254">Configure o ObjectDataSource para usar a classe `SuppliersBLLWithSprocs` que adicionamos de volta na etapa 6 e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="882d7-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="882d7-255">[![configurar o ObjectDataSource para usar a classe SuppliersBLLWithSprocs](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="882d7-256">**Figura 11**: configurar o ObjectDataSource para usar a classe `SuppliersBLLWithSprocs` ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="882d7-257">Há apenas dois métodos definidos na classe `SuppliersBLLWithSprocs`: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="882d7-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="882d7-258">Verifique se esses dois métodos estão especificados nas guias selecionar e atualizar, respectivamente, e clique em concluir para concluir a configuração do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="882d7-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="882d7-259">Após a conclusão do assistente de configuração de fonte de dados, o Visual Studio adicionará um BoundField para cada um dos campos de dados retornados.</span><span class="sxs-lookup"><span data-stu-id="882d7-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="882d7-260">Remova o `SupplierID` BoundField e altere as propriedades de `HeaderText` do `CompanyName`, `ContactName`, `ContactTitle`e `FullContactName` BoundFields para empresa, nome de contato, título e nome de contato completo, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="882d7-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="882d7-261">Na marca inteligente, marque a caixa de seleção Habilitar edição para ativar os recursos de edição internos do GridView.</span><span class="sxs-lookup"><span data-stu-id="882d7-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="882d7-262">Além de adicionar BoundFields ao GridView, a conclusão do assistente de fonte de dados também faz com que o Visual Studio defina a Propriedade ObjectDataSource s `OldValuesParameterFormatString` como original\_{0}.</span><span class="sxs-lookup"><span data-stu-id="882d7-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="882d7-263">Reverta essa configuração de volta para o valor padrão, {0}.</span><span class="sxs-lookup"><span data-stu-id="882d7-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="882d7-264">Depois de fazer essas edições no GridView e no ObjectDataSource, sua marcação declarativa deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="882d7-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="882d7-265">Em seguida, visite esta página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="882d7-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="882d7-266">Como mostra a Figura 12, cada fornecedor é listado em uma grade que inclui a coluna `FullContactName`, cujo valor é simplesmente a concatenação das outras três colunas formatadas como `ContactName` (`ContactTitle``CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="882d7-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="882d7-267">[![cada fornecedor está listado na grade](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="882d7-268">**Figura 12**: cada fornecedor é listado na grade ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="882d7-269">Clicar no botão Editar de um fornecedor específico causa um postback e tem essa linha renderizada em sua interface de edição (consulte a Figura 13).</span><span class="sxs-lookup"><span data-stu-id="882d7-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="882d7-270">As três primeiras colunas são renderizadas em sua interface de edição padrão – um controle TextBox cuja propriedade `Text` é definida como o valor do campo de dados.</span><span class="sxs-lookup"><span data-stu-id="882d7-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="882d7-271">No entanto, a coluna `FullContactName` permanece como texto.</span><span class="sxs-lookup"><span data-stu-id="882d7-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="882d7-272">Quando os BoundFields foram adicionados ao GridView na conclusão do assistente de configuração da fonte de dados, a propriedade `FullContactName` BoundField s `ReadOnly` foi definida como `True` porque a coluna `FullContactName` correspondente na `SuppliersDataTable` tem sua propriedade `ReadOnly` definida como `True`.</span><span class="sxs-lookup"><span data-stu-id="882d7-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="882d7-273">Conforme observado na etapa 4, a propriedade `FullContactName` s `ReadOnly` foi definida como `True` porque o TableAdapter detectou que a coluna era uma coluna computada.</span><span class="sxs-lookup"><span data-stu-id="882d7-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="882d7-274">[![a coluna FullContactName não é editável](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="882d7-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="882d7-275">**Figura 13**: a coluna `FullContactName` não é editável ([clique para exibir a imagem em tamanho normal](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="882d7-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="882d7-276">Vá em frente e atualize o valor de uma ou mais das colunas editáveis e clique em atualizar.</span><span class="sxs-lookup"><span data-stu-id="882d7-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="882d7-277">Observe como o valor de `FullContactName` s é atualizado automaticamente para refletir a alteração.</span><span class="sxs-lookup"><span data-stu-id="882d7-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="882d7-278">O GridView atualmente usa BoundFields para os campos editáveis, resultando na interface de edição padrão.</span><span class="sxs-lookup"><span data-stu-id="882d7-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="882d7-279">Como o campo `CompanyName` é necessário, ele deve ser convertido em um TemplateField que inclui um RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="882d7-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="882d7-280">Deixe isso como um exercício para o leitor interessado.</span><span class="sxs-lookup"><span data-stu-id="882d7-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="882d7-281">Consulte o tutorial [adicionando controles de validação para as interfaces de edição e inserção](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) para obter instruções passo a passo sobre como converter um BoundField em um TemplateField e adicionar controles de validação.</span><span class="sxs-lookup"><span data-stu-id="882d7-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="882d7-282">Resumo</span><span class="sxs-lookup"><span data-stu-id="882d7-282">Summary</span></span>

<span data-ttu-id="882d7-283">Ao definir o esquema para uma tabela, Microsoft SQL Server permite a inclusão de colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="882d7-284">Essas são as colunas cujos valores são calculados a partir de uma expressão que geralmente referencia os valores de outras colunas no mesmo registro.</span><span class="sxs-lookup"><span data-stu-id="882d7-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="882d7-285">Como os valores das colunas computadas se baseiam em uma expressão, eles são somente leitura e não podem ser atribuídos a um valor em uma instrução `INSERT` ou `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="882d7-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="882d7-286">Isso apresenta desafios ao usar uma coluna computada na consulta principal de um TableAdapter que tenta gerar automaticamente instruções `INSERT`, `UPDATE`e `DELETE` correspondentes.</span><span class="sxs-lookup"><span data-stu-id="882d7-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="882d7-287">Neste tutorial, discutimos técnicas para burlar os desafios apresentados por colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="882d7-288">Em particular, usamos procedimentos armazenados em nosso TableAdapter para superar a fragilidade inerente em TableAdapters que usam instruções SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="882d7-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="882d7-289">Quando o assistente TableAdapter cria novos procedimentos armazenados, é importante que tenhamos a consulta principal omitir inicialmente todas as colunas computadas porque sua presença impede que os procedimentos armazenados de modificação de dados sejam gerados.</span><span class="sxs-lookup"><span data-stu-id="882d7-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="882d7-290">Depois que o TableAdapter tiver sido inicialmente configurado, seu procedimento armazenado `SelectCommand` pode ser reinicializado para incluir colunas computadas.</span><span class="sxs-lookup"><span data-stu-id="882d7-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="882d7-291">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="882d7-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="882d7-292">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="882d7-292">About the Author</span></span>

<span data-ttu-id="882d7-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="882d7-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="882d7-294">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="882d7-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="882d7-295">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="882d7-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="882d7-296">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="882d7-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="882d7-297">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="882d7-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="882d7-298">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="882d7-298">Special Thanks To</span></span>

<span data-ttu-id="882d7-299">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="882d7-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="882d7-300">Os revisores potenciais para este tutorial foram Hilton Geisenow e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="882d7-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="882d7-301">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="882d7-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="882d7-302">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="882d7-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="882d7-303">[Anterior](adding-additional-datatable-columns-vb.md)
> [Próximo](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="882d7-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>
