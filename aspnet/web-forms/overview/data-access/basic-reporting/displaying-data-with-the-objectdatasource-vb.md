---
uid: web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-vb
title: Exibindo dados com o ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Este tutorial analisa o controle ObjectDataSource usando esse controle, você pode associar dados recuperados da BLL criada no tutorial anterior sem havi...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: d62c3a63-0940-4019-874e-4a4047df0c1c
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 754188352cbfb08e610027f5b7890a32bd88ae26
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78597044"
---
# <a name="displaying-data-with-the-objectdatasource-vb"></a><span data-ttu-id="a1550-103">Exibir dados com o ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="a1550-103">Displaying Data With the ObjectDataSource (VB)</span></span>

<span data-ttu-id="a1550-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a1550-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a1550-105">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_4_VB.exe) ou [baixar PDF](displaying-data-with-the-objectdatasource-vb/_static/datatutorial04vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a1550-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_4_VB.exe) or [Download PDF](displaying-data-with-the-objectdatasource-vb/_static/datatutorial04vb1.pdf)</span></span>

> <span data-ttu-id="a1550-106">Este tutorial analisa o controle ObjectDataSource usando esse controle, você pode associar dados recuperados da BLL criada no tutorial anterior sem precisar escrever uma linha de código!</span><span class="sxs-lookup"><span data-stu-id="a1550-106">This tutorial looks at the ObjectDataSource control Using this control you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

## <a name="introduction"></a><span data-ttu-id="a1550-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="a1550-107">Introduction</span></span>

<span data-ttu-id="a1550-108">Com a arquitetura do aplicativo e o layout da página do site concluídos, estamos prontos para começar a explorar como realizar uma variedade de tarefas comuns relacionadas a dados e relatórios.</span><span class="sxs-lookup"><span data-stu-id="a1550-108">With our application architecture and website page layout complete, we're ready to start exploring how to accomplish a variety of common data- and reporting-related tasks.</span></span> <span data-ttu-id="a1550-109">Nos tutoriais anteriores, vimos como associar de forma programática os dados da DAL e da BLL a um controle da Web de dados em uma página do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a1550-109">In the previous tutorials we've seen how to programmatically bind data from the DAL and BLL to a data Web control in an ASP.NET page.</span></span> <span data-ttu-id="a1550-110">Essa sintaxe atribui a propriedade `DataSource` do controle da Web de dados aos dados a serem exibidos e, em seguida, chamar o método `DataBind()` do controle era o padrão usado em aplicativos ASP.NET 1. x e pode continuar a ser usado em seus aplicativos 2,0.</span><span class="sxs-lookup"><span data-stu-id="a1550-110">This syntax assigning the data Web control's `DataSource` property to the data to display and then calling the control's `DataBind()` method was the pattern used in ASP.NET 1.x applications, and can continue to be used in your 2.0 applications.</span></span> <span data-ttu-id="a1550-111">No entanto, os novos controles da fonte de dados do ASP.NET 2.0 oferecem uma maneira declarativa de trabalhar com os dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-111">However, ASP.NET 2.0's new data source controls offer a declarative way to work with data.</span></span> <span data-ttu-id="a1550-112">Usando esses controles, você pode associar dados recuperados da BLL criada no tutorial anterior sem precisar escrever uma linha de código!</span><span class="sxs-lookup"><span data-stu-id="a1550-112">Using these controls you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

<span data-ttu-id="a1550-113">O ASP.NET 2,0 é fornecido com cinco controles de fonte de dados internos [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx)e [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx) , embora você possa criar seus próprios controles de [fonte de dados personalizados](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp), se necessário.</span><span class="sxs-lookup"><span data-stu-id="a1550-113">ASP.NET 2.0 ships with five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx) although you can build your own [custom data source controls](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp), if needed.</span></span> <span data-ttu-id="a1550-114">Como desenvolvemos uma arquitetura para nosso aplicativo de tutorial, usaremos o ObjectDataSource em nossas classes de BLL.</span><span class="sxs-lookup"><span data-stu-id="a1550-114">Since we have developed an architecture for our tutorial application, we'll be using the ObjectDataSource against our BLL classes.</span></span>

![O ASP.NET 2,0 inclui cinco controles de fonte de dados internos](displaying-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="a1550-116">**Figura 1**: ASP.NET 2,0 inclui cinco controles de fonte de dados internos</span><span class="sxs-lookup"><span data-stu-id="a1550-116">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

<span data-ttu-id="a1550-117">O ObjectDataSource serve como um proxy para trabalhar com algum outro objeto.</span><span class="sxs-lookup"><span data-stu-id="a1550-117">The ObjectDataSource serves as a proxy for working with some other object.</span></span> <span data-ttu-id="a1550-118">Para configurar o ObjectDataSource, especificamos esse objeto subjacente e como seus métodos são mapeados para os métodos `Select`, `Insert`, `Update`e `Delete` do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-118">To configure the ObjectDataSource we specify this underlying object and how its methods map to the ObjectDataSource's `Select`, `Insert`, `Update`, and `Delete` methods.</span></span> <span data-ttu-id="a1550-119">Depois que esse objeto subjacente tiver sido especificado e seus métodos forem mapeados para o ObjectDataSource, podemos associar o ObjectDataSource a um controle da Web de dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-119">Once this underlying object has been specified and its methods mapped to the ObjectDataSource's, we can then bind the ObjectDataSource to a data Web control.</span></span> <span data-ttu-id="a1550-120">O ASP.NET é fornecido com muitos controles da Web de dados, incluindo GridView, DetailsView, RadioButtonList e DropDownList, entre outros.</span><span class="sxs-lookup"><span data-stu-id="a1550-120">ASP.NET ships with many data Web controls, including the GridView, DetailsView, RadioButtonList, and DropDownList, among others.</span></span> <span data-ttu-id="a1550-121">Durante o ciclo de vida da página, o controle da Web de dados pode precisar acessar os dados aos quais está associado, invocando o método de `Select` de ObjectDataSource; Se o controle da Web de dados der suporte à inserção, atualização ou exclusão, podem ser feitas chamadas para os métodos `Insert`, `Update`ou `Delete` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-121">During the page lifecycle, the data Web control may need to access the data it's bound to, which it will accomplish by invoking its ObjectDataSource's `Select` method; if the data Web control supports inserting, updating, or deleting, calls may be made to its ObjectDataSource's `Insert`, `Update`, or `Delete` methods.</span></span> <span data-ttu-id="a1550-122">Essas chamadas são então roteadas pelo ObjectDataSource para os métodos do objeto subjacente apropriado, como ilustra o diagrama a seguir.</span><span class="sxs-lookup"><span data-stu-id="a1550-122">These calls are then routed by the ObjectDataSource to the appropriate underlying object's methods as the following diagram illustrates.</span></span>

<span data-ttu-id="a1550-123">[![o ObjectDataSource serve como um proxy](displaying-data-with-the-objectdatasource-vb/_static/image3.png)](displaying-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-123">[![The ObjectDataSource Serves as a Proxy](displaying-data-with-the-objectdatasource-vb/_static/image3.png)](displaying-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="a1550-124">**Figura 2**: o ObjectDataSource serve como um proxy ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-124">**Figure 2**: The ObjectDataSource Serves as a Proxy ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="a1550-125">Embora o ObjectDataSource possa ser usado para invocar métodos para inserção, atualização ou exclusão de dados, vamos apenas nos concentrar em retornar dados; os tutoriais futuros explorarão o uso dos controles ObjectDataSource e da Web de dados que modificam os dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-125">While the ObjectDataSource can be used to invoke methods for inserting, updating, or deleting data, let's just focus on returning data; future tutorials will explore using the ObjectDataSource and data Web controls that modify data.</span></span>

## <a name="step-1-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="a1550-126">Etapa 1: adicionando e Configurando o controle ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="a1550-126">Step 1: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="a1550-127">Comece abrindo a página de `SimpleDisplay.aspx` na pasta `BasicReporting`, alterne para modo de exibição de Design e arraste um controle ObjectDataSource da caixa de ferramentas para a superfície de design da página.</span><span class="sxs-lookup"><span data-stu-id="a1550-127">Start by opening the `SimpleDisplay.aspx` page in the `BasicReporting` folder, switch to Design view, and then drag an ObjectDataSource control from the Toolbox onto the page's design surface.</span></span> <span data-ttu-id="a1550-128">O ObjectDataSource é exibido como uma caixa cinza na superfície de design porque não produz nenhuma marcação; Ele simplesmente acessa os dados invocando um método de um objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="a1550-128">The ObjectDataSource appears as a gray box on the design surface because it does not produce any markup; it simply accesses data by invoking a method from a specified object.</span></span> <span data-ttu-id="a1550-129">Os dados retornados por um ObjectDataSource podem ser exibidos por um controle da Web de dados, como GridView, DetailsView, FormView e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="a1550-129">The data returned by an ObjectDataSource can be displayed by a data Web control, such as the GridView, DetailsView, FormView, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="a1550-130">Como alternativa, você pode primeiro adicionar o controle da Web de dados à página e, em seguida, a partir de sua marca inteligente, escolha a opção &lt;nova fonte de dados&gt; na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="a1550-130">Alternatively, you may first add the data Web control to the page and then, from its smart tag, choose the &lt;New data source&gt; option from the drop-down list.</span></span>

<span data-ttu-id="a1550-131">Para especificar o objeto subjacente do ObjectDataSource e como os métodos desse objeto são mapeados para o ObjectDataSource, clique no link configurar fonte de dados da marca inteligente ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-131">To specify the ObjectDataSource's underlying object and how that object's methods map to the ObjectDataSource's, click on the Configure Data Source link from the ObjectDataSource's smart tag.</span></span>

<span data-ttu-id="a1550-132">[![clique no link configurar fonte de dados na marca inteligente](displaying-data-with-the-objectdatasource-vb/_static/image6.png)](displaying-data-with-the-objectdatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-132">[![Click the Configure Data Source Link from the Smart Tag](displaying-data-with-the-objectdatasource-vb/_static/image6.png)](displaying-data-with-the-objectdatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="a1550-133">**Figura 3**: clique no link configurar fonte de dados na marca inteligente ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-133">**Figure 3**: Click the Configure Data Source Link from the Smart Tag ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image7.png))</span></span>

<span data-ttu-id="a1550-134">Isso abre o assistente para configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-134">This brings up the Configure Data Source wizard.</span></span> <span data-ttu-id="a1550-135">Primeiro, devemos especificar o objeto com o qual o ObjectDataSource deve trabalhar.</span><span class="sxs-lookup"><span data-stu-id="a1550-135">First, we must specify the object the ObjectDataSource is to work with.</span></span> <span data-ttu-id="a1550-136">Se a caixa de seleção "mostrar apenas componentes de dados" estiver marcada, a lista suspensa nessa tela listará somente os objetos que foram decorados com o atributo `DataObject`.</span><span class="sxs-lookup"><span data-stu-id="a1550-136">If the "Show only data components" checkbox is checked, the drop-down list on this screen lists only those objects that have been decorated with the `DataObject` attribute.</span></span> <span data-ttu-id="a1550-137">Atualmente, nossa lista inclui os TableAdapters no DataSet tipado e as classes de BLL que criamos no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="a1550-137">Currently our list includes the TableAdapters in the Typed DataSet and the BLL classes we created in the previous tutorial.</span></span> <span data-ttu-id="a1550-138">Se você esqueceu de adicionar o atributo `DataObject` às classes da camada de lógica de negócios, você não os verá nesta lista.</span><span class="sxs-lookup"><span data-stu-id="a1550-138">If you forgot to add the `DataObject` attribute to the Business Logic Layer classes you won't see them in this list.</span></span> <span data-ttu-id="a1550-139">Nesse caso, desmarque a caixa de seleção "mostrar apenas componentes de dados" para exibir todos os objetos, que devem incluir as classes de BLL (juntamente com as outras classes no conjunto de dados digitado, as DataTables, as linhas de dados e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="a1550-139">In that case, uncheck the "Show only data components" checkbox to view all objects, which should include the BLL classes (along with the other classes in the Typed DataSet the DataTables, DataRows, and so on).</span></span>

<span data-ttu-id="a1550-140">Nessa primeira tela, escolha a classe `ProductsBLL` na lista suspensa e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="a1550-140">From this first screen choose the `ProductsBLL` class from the drop-down list and click Next.</span></span>

<span data-ttu-id="a1550-141">[![especificar o objeto a ser usado com o controle ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image9.png)](displaying-data-with-the-objectdatasource-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-141">[![Specify the Object to Use with the ObjectDataSource Control](displaying-data-with-the-objectdatasource-vb/_static/image9.png)](displaying-data-with-the-objectdatasource-vb/_static/image8.png)</span></span>

<span data-ttu-id="a1550-142">**Figura 4**: especificar o objeto a ser usado com o controle ObjectDataSource ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-142">**Figure 4**: Specify the Object to Use with the ObjectDataSource Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="a1550-143">A próxima tela do assistente solicita que você selecione o método que o ObjectDataSource deve invocar.</span><span class="sxs-lookup"><span data-stu-id="a1550-143">The next screen in the wizard prompts you to select what method the ObjectDataSource should invoke.</span></span> <span data-ttu-id="a1550-144">O menu suspenso lista os métodos que retornam dados no objeto selecionado na tela anterior.</span><span class="sxs-lookup"><span data-stu-id="a1550-144">The drop-down lists those methods that return data in the object selected from the previous screen.</span></span> <span data-ttu-id="a1550-145">Aqui, vemos `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`e `GetProductsBySupplierID`.</span><span class="sxs-lookup"><span data-stu-id="a1550-145">Here we see `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`, and `GetProductsBySupplierID`.</span></span> <span data-ttu-id="a1550-146">Selecione o método `GetProducts` na lista suspensa e clique em concluir (se você adicionou o `DataObjectMethodAttribute` aos métodos de `ProductBLL`, conforme mostrado no tutorial anterior, essa opção será selecionada por padrão).</span><span class="sxs-lookup"><span data-stu-id="a1550-146">Select the `GetProducts` method from the drop-down list and click Finish (if you added the `DataObjectMethodAttribute` to the `ProductBLL`'s methods as shown in the previous tutorial, this option will be selected by default).</span></span>

<span data-ttu-id="a1550-147">[![escolher o método para retornar dados da guia selecionar](displaying-data-with-the-objectdatasource-vb/_static/image12.png)](displaying-data-with-the-objectdatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-147">[![Choose the Method for Returning Data from the SELECT Tab](displaying-data-with-the-objectdatasource-vb/_static/image12.png)](displaying-data-with-the-objectdatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="a1550-148">**Figura 5**: escolha o método para retornar dados da guia selecionar ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-148">**Figure 5**: Choose the Method for Returning Data from the SELECT Tab ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image13.png))</span></span>

## <a name="configure-the-objectdatasource-manually"></a><span data-ttu-id="a1550-149">Configurar o ObjectDataSource manualmente</span><span class="sxs-lookup"><span data-stu-id="a1550-149">Configure the ObjectDataSource Manually</span></span>

<span data-ttu-id="a1550-150">O assistente para configurar fonte de dados do ObjectDataSource oferece uma maneira rápida de especificar o objeto que ele usa e associar quais métodos do objeto são invocados.</span><span class="sxs-lookup"><span data-stu-id="a1550-150">The ObjectDataSource's Configure Data Source wizard offers a quick way to specify the object it uses and to associate what methods of the object are invoked.</span></span> <span data-ttu-id="a1550-151">No entanto, você pode configurar o ObjectDataSource por meio de suas propriedades, seja por meio da janela Propriedades ou diretamente na marcação declarativa.</span><span class="sxs-lookup"><span data-stu-id="a1550-151">You can, however, configure the ObjectDataSource through its properties, either through the Properties window or directly in the declarative markup.</span></span> <span data-ttu-id="a1550-152">Basta definir a propriedade `TypeName` como o tipo do objeto subjacente a ser usado e o `SelectMethod` para o método a ser invocado durante a recuperação de dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-152">Simply set the `TypeName` property to the type of the underlying object to be used, and the `SelectMethod` to the method to invoke when retrieving data.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample1.aspx)]

<span data-ttu-id="a1550-153">Mesmo que você prefira o assistente para configurar fonte de dados, pode haver ocasiões em que você precisa configurar o ObjectDataSource manualmente, pois o assistente lista apenas as classes criadas pelo desenvolvedor.</span><span class="sxs-lookup"><span data-stu-id="a1550-153">Even if you prefer the Configure Data Source wizard there may be times when you need to manually configure the ObjectDataSource, as the wizard only lists developer-created classes.</span></span> <span data-ttu-id="a1550-154">Se você quiser associar o ObjectDataSource a uma classe no .NET Framework como a [classe Membership](https://msdn.microsoft.com/library/system.web.security.membership.aspx), para acessar as informações da conta de usuário ou a [classe de diretório](https://msdn.microsoft.com/library/system.io.directory.aspx) para trabalhar com as informações do sistema de arquivos, será necessário definir manualmente as propriedades do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-154">If you want to bind the ObjectDataSource to a class in the .NET Framework such as the [Membership class](https://msdn.microsoft.com/library/system.web.security.membership.aspx), to access user account information, or the [Directory class](https://msdn.microsoft.com/library/system.io.directory.aspx) to work with file system information you'll need to manually set the ObjectDataSource's properties.</span></span>

## <a name="step-2-adding-a-data-web-control-and-binding-it-to-the-objectdatasource"></a><span data-ttu-id="a1550-155">Etapa 2: adicionar um controle da Web de dados e associá-lo ao ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="a1550-155">Step 2: Adding a Data Web Control and Binding it to the ObjectDataSource</span></span>

<span data-ttu-id="a1550-156">Depois que o ObjectDataSource tiver sido adicionado à página e configurado, estamos prontos para adicionar controles da Web de dados à página para exibir os dados retornados pelo método de `Select` do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-156">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to display the data returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="a1550-157">Qualquer controle da Web de dados pode ser associado a um ObjectDataSource; Vejamos a exibição dos dados do ObjectDataSource em um GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="a1550-157">Any data Web control can be bound to an ObjectDataSource; let's look at displaying the ObjectDataSource's data in a GridView, DetailsView, and FormView.</span></span>

## <a name="binding-a-gridview-to-the-objectdatasource"></a><span data-ttu-id="a1550-158">Associando um GridView ao ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="a1550-158">Binding a GridView to the ObjectDataSource</span></span>

<span data-ttu-id="a1550-159">Adicione um controle GridView da caixa de ferramentas à superfície de design de `SimpleDisplay.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a1550-159">Add a GridView control from the Toolbox to `SimpleDisplay.aspx`'s design surface.</span></span> <span data-ttu-id="a1550-160">Na marca inteligente do GridView, escolha o controle ObjectDataSource que adicionamos na etapa 1.</span><span class="sxs-lookup"><span data-stu-id="a1550-160">From the GridView's smart tag, choose the ObjectDataSource control we added in Step 1.</span></span> <span data-ttu-id="a1550-161">Isso criará automaticamente um BoundField no GridView para cada propriedade retornada pelos dados do método de `Select` do ObjectDataSource (ou seja, as propriedades definidas pela DataTable Products).</span><span class="sxs-lookup"><span data-stu-id="a1550-161">This will automatically create a BoundField in the GridView for each property returned by the data from the ObjectDataSource's `Select` method (namely, the properties defined by the Products DataTable).</span></span>

<span data-ttu-id="a1550-162">[![um GridView foi adicionado à página e associado a ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image15.png)](displaying-data-with-the-objectdatasource-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-162">[![A GridView Has Been Added to the Page and Bound to the ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image15.png)](displaying-data-with-the-objectdatasource-vb/_static/image14.png)</span></span>

<span data-ttu-id="a1550-163">**Figura 6**: um GridView foi adicionado à página e associado a ObjectDataSource ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-163">**Figure 6**: A GridView Has Been Added to the Page and Bound to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image16.png))</span></span>

<span data-ttu-id="a1550-164">Em seguida, você pode personalizar, reorganizar ou remover o BoundFields do GridView clicando na opção Editar colunas da marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="a1550-164">You can then customize, rearrange, or remove the GridView's BoundFields by clicking the Edit Columns option from the smart tag.</span></span>

<span data-ttu-id="a1550-165">[![gerenciar as BoundFields do GridView por meio da caixa de diálogo Editar colunas](displaying-data-with-the-objectdatasource-vb/_static/image18.png)](displaying-data-with-the-objectdatasource-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-165">[![Manage the GridView's BoundFields Through the Edit Columns Dialog Box](displaying-data-with-the-objectdatasource-vb/_static/image18.png)](displaying-data-with-the-objectdatasource-vb/_static/image17.png)</span></span>

<span data-ttu-id="a1550-166">**Figura 7**: gerenciar as boundfields do GridView por meio da caixa de diálogo Editar colunas ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-166">**Figure 7**: Manage the GridView's BoundFields Through the Edit Columns Dialog Box ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image19.png))</span></span>

<span data-ttu-id="a1550-167">Reserve um tempo para modificar os BoundFields do GridView, removendo os `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`e `ReorderLevel` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="a1550-167">Take a moment to modify the GridView's BoundFields, removing the `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="a1550-168">Basta selecionar o BoundField na lista na parte inferior esquerda e clicar no botão excluir (o X vermelho) para removê-los.</span><span class="sxs-lookup"><span data-stu-id="a1550-168">Simply select the BoundField from the list in the bottom left and click the delete button (the red X) to remove them.</span></span> <span data-ttu-id="a1550-169">Em seguida, reorganize os BoundFields para que os `CategoryName` e `SupplierName` BoundFields precedem o `UnitPrice` BoundField selecionando esses BoundFields e clicando na seta para cima.</span><span class="sxs-lookup"><span data-stu-id="a1550-169">Next, Rearrange the BoundFields so that the `CategoryName` and `SupplierName` BoundFields precede the `UnitPrice` BoundField by selecting these BoundFields and clicking the up arrow.</span></span> <span data-ttu-id="a1550-170">Defina as propriedades `HeaderText` dos BoundFields restantes para `Products`, `Category`, `Supplier`e `Price`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a1550-170">Set the `HeaderText` properties of the remaining BoundFields to `Products`, `Category`, `Supplier`, and `Price`, respectively.</span></span> <span data-ttu-id="a1550-171">Em seguida, tenha o `Price` BoundField formatado como uma moeda definindo a propriedade `HtmlEncode` de BoundField como false e sua propriedade `DataFormatString` como `{0:c}`.</span><span class="sxs-lookup"><span data-stu-id="a1550-171">Next, have the `Price` BoundField formatted as a currency by setting the BoundField's `HtmlEncode` property to False and its `DataFormatString` property to `{0:c}`.</span></span> <span data-ttu-id="a1550-172">Por fim, alinhe horizontalmente o `Price` à direita e a caixa de seleção `Discontinued` no centro por meio da propriedade `ItemStyle`/`HorizontalAlign`.</span><span class="sxs-lookup"><span data-stu-id="a1550-172">Finally, horizontally align the `Price` to the right and the `Discontinued` checkbox in the center via the `ItemStyle`/`HorizontalAlign` property.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="a1550-173">[![os BoundFields do GridView foram personalizados](displaying-data-with-the-objectdatasource-vb/_static/image21.png)](displaying-data-with-the-objectdatasource-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-173">[![The GridView's BoundFields Have Been Customized](displaying-data-with-the-objectdatasource-vb/_static/image21.png)](displaying-data-with-the-objectdatasource-vb/_static/image20.png)</span></span>

<span data-ttu-id="a1550-174">**Figura 8**: os boundfields do GridView foram personalizados ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-174">**Figure 8**: The GridView's BoundFields Have Been Customized ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image22.png))</span></span>

## <a name="using-themes-for-a-consistent-look"></a><span data-ttu-id="a1550-175">Usando temas para uma aparência consistente</span><span class="sxs-lookup"><span data-stu-id="a1550-175">Using Themes for a Consistent Look</span></span>

<span data-ttu-id="a1550-176">Esses tutoriais se esforçam para remover qualquer configuração de estilo de nível de controle, em vez disso, usando folhas de estilo em cascata definidas em um arquivo externo sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="a1550-176">These tutorials strive to remove any control-level style settings, instead using cascading style sheets defined in an external file whenever possible.</span></span> <span data-ttu-id="a1550-177">O arquivo de `Styles.css` contém `DataWebControlStyle`, `HeaderStyle`, `RowStyle`e `AlternatingRowStyle` classes CSS que devem ser usadas para ditar a aparência dos controles da Web de dados usados nesses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="a1550-177">The `Styles.css` file contains `DataWebControlStyle`, `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` CSS classes that should be used to dictate the appearance of the data Web controls used in these tutorials.</span></span> <span data-ttu-id="a1550-178">Para fazer isso, poderíamos definir a propriedade de `CssClass` do GridView como `DataWebControlStyle`, e `HeaderStyle`suas propriedades `AlternatingRowStyle`, `RowStyle`e `CssClass` Properties '.</span><span class="sxs-lookup"><span data-stu-id="a1550-178">To accomplish this, we could set the GridView's `CssClass` property to `DataWebControlStyle`, and its `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` properties' `CssClass` properties accordingly.</span></span>

<span data-ttu-id="a1550-179">Se definirmos essas `CssClass` Propriedades no controle da Web, precisaremos me lembrar de definir explicitamente esses valores de propriedade para cada controle da Web de dados adicionado aos nossos tutoriais.</span><span class="sxs-lookup"><span data-stu-id="a1550-179">If we set these `CssClass` properties at the Web control we'd need to remember to explicitly set these property values for each and every data Web control added to our tutorials.</span></span> <span data-ttu-id="a1550-180">Uma abordagem mais gerenciável é definir as propriedades relacionadas à CSS padrão para os controles GridView, DetailsView e FormView usando um tema.</span><span class="sxs-lookup"><span data-stu-id="a1550-180">A more manageable approach is to define the default CSS-related properties for the GridView, DetailsView, and FormView controls using a Theme.</span></span> <span data-ttu-id="a1550-181">Um tema é uma coleção de configurações de propriedade no nível de controle, imagens e classes CSS que podem ser aplicadas a páginas em um site para impor uma aparência comum.</span><span class="sxs-lookup"><span data-stu-id="a1550-181">A Theme is a collection of control-level property settings, images, and CSS classes that can be applied to pages across a site to enforce a common look and feel.</span></span>

<span data-ttu-id="a1550-182">Nosso tema não incluirá imagens ou arquivos CSS (deixaremos a folha de estilos `Styles.css` no estado em que se encontra, definido na pasta raiz do aplicativo Web), mas incluirá duas capas.</span><span class="sxs-lookup"><span data-stu-id="a1550-182">Our Theme won't include any images or CSS files (we'll leave the stylesheet `Styles.css` as-is, defined in the root folder of the web application), but will include two Skins.</span></span> <span data-ttu-id="a1550-183">Uma aparência é um arquivo que define as propriedades padrão para um controle da Web.</span><span class="sxs-lookup"><span data-stu-id="a1550-183">A Skin is a file that defines the default properties for a Web control.</span></span> <span data-ttu-id="a1550-184">Especificamente, teremos um arquivo de capa para os controles GridView e DetailsView, indicando as propriedades padrão relacionadas ao `CssClass`.</span><span class="sxs-lookup"><span data-stu-id="a1550-184">Specifically, we'll have a Skin file for the GridView and DetailsView controls, indicating the default `CssClass`-related properties.</span></span>

<span data-ttu-id="a1550-185">Comece adicionando um novo arquivo de capa ao seu projeto chamado `GridView.skin` clicando com o botão direito do mouse no nome do projeto na Gerenciador de Soluções e escolhendo Adicionar novo item.</span><span class="sxs-lookup"><span data-stu-id="a1550-185">Start by adding a new Skin File to your project named `GridView.skin` by right-clicking on the project name in the Solution Explorer and choosing Add New Item.</span></span>

<span data-ttu-id="a1550-186">[![adicionar um arquivo de capa chamado GridView. Skin](displaying-data-with-the-objectdatasource-vb/_static/image24.png)](displaying-data-with-the-objectdatasource-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-186">[![Add a Skin File Named GridView.skin](displaying-data-with-the-objectdatasource-vb/_static/image24.png)](displaying-data-with-the-objectdatasource-vb/_static/image23.png)</span></span>

<span data-ttu-id="a1550-187">**Figura 9**: adicionar um arquivo de capa chamado `GridView.skin` ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-187">**Figure 9**: Add a Skin File Named `GridView.skin` ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image25.png))</span></span>

<span data-ttu-id="a1550-188">Os arquivos de capa precisam ser colocados em um tema, que estão localizados na pasta `App_Themes`.</span><span class="sxs-lookup"><span data-stu-id="a1550-188">Skin files need to be placed in a Theme, which are located in the `App_Themes` folder.</span></span> <span data-ttu-id="a1550-189">Como ainda não temos essa pasta, o Visual Studio oferecerá uma espécie para criar uma para nós ao adicionar nossa primeira capa.</span><span class="sxs-lookup"><span data-stu-id="a1550-189">Since we don't yet have such a folder, Visual Studio will kindly offer to create one for us when adding our first Skin.</span></span> <span data-ttu-id="a1550-190">Clique em Sim para criar a pasta `App_Theme` e coloque o novo arquivo de `GridView.skin`.</span><span class="sxs-lookup"><span data-stu-id="a1550-190">Click Yes to create the `App_Theme` folder and place the new `GridView.skin` file there.</span></span>

<span data-ttu-id="a1550-191">[![deixar o Visual Studio criar a pasta App_Theme](displaying-data-with-the-objectdatasource-vb/_static/image27.png)](displaying-data-with-the-objectdatasource-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-191">[![Let Visual Studio Create the App_Theme Folder](displaying-data-with-the-objectdatasource-vb/_static/image27.png)](displaying-data-with-the-objectdatasource-vb/_static/image26.png)</span></span>

<span data-ttu-id="a1550-192">**Figura 10**: Deixe que o Visual Studio crie a pasta `App_Theme` ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-192">**Figure 10**: Let Visual Studio Create the `App_Theme` Folder ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image28.png))</span></span>

<span data-ttu-id="a1550-193">Isso criará um novo tema na pasta `App_Themes` chamada GridView com o arquivo de capa `GridView.skin`.</span><span class="sxs-lookup"><span data-stu-id="a1550-193">This will create a new Theme in the `App_Themes` folder named GridView with the Skin file `GridView.skin`.</span></span>

![O tema GridView foi adicionado à pasta App_Theme](displaying-data-with-the-objectdatasource-vb/_static/image29.png)

<span data-ttu-id="a1550-195">**Figura 11**: o tema GridView foi adicionado à pasta `App_Theme`</span><span class="sxs-lookup"><span data-stu-id="a1550-195">**Figure 11**: The GridView Theme has Been Added to the `App_Theme` Folder</span></span>

<span data-ttu-id="a1550-196">Renomeie o tema GridView para datawebcontrols (clique com o botão direito do mouse na pasta GridView na pasta `App_Theme` e escolha Renomear).</span><span class="sxs-lookup"><span data-stu-id="a1550-196">Rename the GridView Theme to DataWebControls (right-click on the GridView folder in the `App_Theme` folder and choose Rename).</span></span> <span data-ttu-id="a1550-197">Em seguida, digite a seguinte marcação no arquivo de `GridView.skin`:</span><span class="sxs-lookup"><span data-stu-id="a1550-197">Next, enter the following markup into the `GridView.skin` file:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="a1550-198">Isso define as propriedades padrão para as propriedades relacionadas a `CssClass`para qualquer GridView em qualquer página que usa o tema datawebcontrols.</span><span class="sxs-lookup"><span data-stu-id="a1550-198">This defines the default properties for the `CssClass`-related properties for any GridView in any page that uses the DataWebControls Theme.</span></span> <span data-ttu-id="a1550-199">Vamos adicionar outra capa para o DetailsView, um controle da Web de dados que usaremos em breve.</span><span class="sxs-lookup"><span data-stu-id="a1550-199">Let's add another Skin for the DetailsView, a data Web control that we'll be using shortly.</span></span> <span data-ttu-id="a1550-200">Adicione uma nova aparência ao tema datawebcontrols chamado `DetailsView.skin` e adicione a seguinte marcação:</span><span class="sxs-lookup"><span data-stu-id="a1550-200">Add a new Skin to the DataWebControls Theme named `DetailsView.skin` and add the following markup:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample4.aspx)]

<span data-ttu-id="a1550-201">Com nosso tema definido, a última etapa é aplicar o tema à nossa página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a1550-201">With our Theme defined, the last step is to apply the Theme to our ASP.NET page.</span></span> <span data-ttu-id="a1550-202">Um tema pode ser aplicado em uma base página por página ou em todas as páginas de um site.</span><span class="sxs-lookup"><span data-stu-id="a1550-202">A Theme can be applied on a page-by-page basis or for all pages in a website.</span></span> <span data-ttu-id="a1550-203">Vamos usar esse tema para todas as páginas no site.</span><span class="sxs-lookup"><span data-stu-id="a1550-203">Let's use this theme for all pages in the website.</span></span> <span data-ttu-id="a1550-204">Para fazer isso, adicione a seguinte marcação à seção `<system.web>` do `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="a1550-204">To accomplish this, add the following markup to `Web.config`'s `<system.web>` section:</span></span>

[!code-xml[Main](displaying-data-with-the-objectdatasource-vb/samples/sample5.xml)]

<span data-ttu-id="a1550-205">Isso é tudo!</span><span class="sxs-lookup"><span data-stu-id="a1550-205">That's all there is to it!</span></span> <span data-ttu-id="a1550-206">A configuração `styleSheetTheme` indica que as propriedades especificadas no tema *não* devem substituir as propriedades especificadas no nível de controle.</span><span class="sxs-lookup"><span data-stu-id="a1550-206">The `styleSheetTheme` setting indicates that the properties specified in the Theme should *not* override the properties specified at the control level.</span></span> <span data-ttu-id="a1550-207">Para especificar que as configurações de tema devem ser configurações de controle de trunfo, use o atributo `theme` no lugar de `styleSheetTheme`; Infelizmente, as configurações de tema não aparecem no modo de exibição de Design do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a1550-207">To specify that Theme settings should trump control settings, use the `theme` attribute in place of `styleSheetTheme`; unfortunately, Theme settings do not appear in the Visual Studio Design view.</span></span> <span data-ttu-id="a1550-208">Consulte [visão geral de temas e capas do ASP.net](https://msdn.microsoft.com/library/ykzx33wh.aspx) e [estilos do lado do servidor usando temas](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) para obter mais informações sobre temas e capas; consulte [como: aplicar temas do ASP.net](https://msdn.microsoft.com/library/0yy5hxdk%28VS.80%29.aspx) para saber mais sobre como configurar uma página para usar um tema.</span><span class="sxs-lookup"><span data-stu-id="a1550-208">Refer to [ASP.NET Themes and Skins Overview](https://msdn.microsoft.com/library/ykzx33wh.aspx) and [Server-Side Styles Using Themes](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) for more information on Themes and Skins; see [How To: Apply ASP.NET Themes](https://msdn.microsoft.com/library/0yy5hxdk%28VS.80%29.aspx) for more on configuring a page to use a theme.</span></span>

<span data-ttu-id="a1550-209">[![o GridView exibe o nome, a categoria, o fornecedor, o preço e as informações descontinuadas do produto](displaying-data-with-the-objectdatasource-vb/_static/image31.png)](displaying-data-with-the-objectdatasource-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-209">[![The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information](displaying-data-with-the-objectdatasource-vb/_static/image31.png)](displaying-data-with-the-objectdatasource-vb/_static/image30.png)</span></span>

<span data-ttu-id="a1550-210">**Figura 12**: o GridView exibe o nome do produto, a categoria, o fornecedor, o preço e as informações descontinuadas ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-210">**Figure 12**: The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image32.png))</span></span>

## <a name="displaying-one-record-at-a-time-in-the-detailsview"></a><span data-ttu-id="a1550-211">Exibindo um registro por vez no DetailsView</span><span class="sxs-lookup"><span data-stu-id="a1550-211">Displaying One Record at a Time in the DetailsView</span></span>

<span data-ttu-id="a1550-212">O GridView exibe uma linha para cada registro retornado pelo controle da fonte de dados ao qual está associado.</span><span class="sxs-lookup"><span data-stu-id="a1550-212">The GridView displays one row for each record returned by the data source control to which it's bound.</span></span> <span data-ttu-id="a1550-213">No entanto, há ocasiões em que talvez queiramos exibir um único registro ou apenas um registro por vez.</span><span class="sxs-lookup"><span data-stu-id="a1550-213">There are times, however, when we may want to display a sole record or just one record at a time.</span></span> <span data-ttu-id="a1550-214">O [controle DetailsView](https://msdn.microsoft.com/library/s3w1w7t4.aspx) oferece essa funcionalidade, renderizando como um `<table>` HTML com duas colunas e uma linha para cada coluna ou propriedade associada ao controle.</span><span class="sxs-lookup"><span data-stu-id="a1550-214">The [DetailsView control](https://msdn.microsoft.com/library/s3w1w7t4.aspx) offers this functionality, rendering as an HTML `<table>` with two columns and one row for each column or property bound to the control.</span></span> <span data-ttu-id="a1550-215">Você pode considerar o DetailsView como um GridView com um único registro girado em 90 graus.</span><span class="sxs-lookup"><span data-stu-id="a1550-215">You can think of the DetailsView as a GridView with a single record rotated 90 degrees.</span></span>

<span data-ttu-id="a1550-216">Comece adicionando um controle DetailsView *acima* do GridView no `SimpleDisplay.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a1550-216">Start by adding a DetailsView control *above* the GridView in `SimpleDisplay.aspx`.</span></span> <span data-ttu-id="a1550-217">Em seguida, associe-o ao mesmo controle ObjectDataSource que o GridView.</span><span class="sxs-lookup"><span data-stu-id="a1550-217">Next, bind it to the same ObjectDataSource control as the GridView.</span></span> <span data-ttu-id="a1550-218">Assim como com o GridView, um BoundField será adicionado a DetailsView para cada propriedade no objeto retornado pelo método de `Select` do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-218">Like with the GridView, a BoundField will be added to the DetailsView for each property in the object returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="a1550-219">A única diferença é que os BoundFields de DetailsView são dispostos horizontalmente em vez de verticalmente.</span><span class="sxs-lookup"><span data-stu-id="a1550-219">The only difference is that the DetailsView's BoundFields are laid out horizontally rather than vertically.</span></span>

<span data-ttu-id="a1550-220">[![adicionar um DetailsView à página e associá-lo ao ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image34.png)](displaying-data-with-the-objectdatasource-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-220">[![Add a DetailsView to the Page and Bind it to the ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image34.png)](displaying-data-with-the-objectdatasource-vb/_static/image33.png)</span></span>

<span data-ttu-id="a1550-221">**Figura 13**: adicionar um DetailsView à página e associá-lo ao ObjectDataSource ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-221">**Figure 13**: Add a DetailsView to the Page and Bind it to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image35.png))</span></span>

<span data-ttu-id="a1550-222">Como o GridView, os BoundFields de DetailsView podem ser ajustados para fornecer uma exibição mais personalizada dos dados retornados pelo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-222">Like the GridView, the DetailsView's BoundFields can be tweaked to provide a more customized display of the data returned by the ObjectDataSource.</span></span> <span data-ttu-id="a1550-223">A Figura 14 mostra o DetailsView após seus BoundFields e `CssClass` propriedades foram configuradas para fazer sua aparência semelhante ao exemplo de GridView.</span><span class="sxs-lookup"><span data-stu-id="a1550-223">Figure 14 shows the DetailsView after its BoundFields and `CssClass` properties have been configured to make its appearance similar to the GridView example.</span></span>

<span data-ttu-id="a1550-224">[![o DetailsView mostra um único registro](displaying-data-with-the-objectdatasource-vb/_static/image37.png)](displaying-data-with-the-objectdatasource-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-224">[![The DetailsView Shows a Single Record](displaying-data-with-the-objectdatasource-vb/_static/image37.png)](displaying-data-with-the-objectdatasource-vb/_static/image36.png)</span></span>

<span data-ttu-id="a1550-225">**Figura 14**: o DetailsView mostra um único registro ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-225">**Figure 14**: The DetailsView Shows a Single Record ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image38.png))</span></span>

<span data-ttu-id="a1550-226">Observe que o DetailsView exibe apenas o primeiro registro retornado por sua fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-226">Note that the DetailsView only displays the first record returned by its data source.</span></span> <span data-ttu-id="a1550-227">Para permitir que o usuário percorra todos os registros, um de cada vez, devemos habilitar a paginação para o DetailsView.</span><span class="sxs-lookup"><span data-stu-id="a1550-227">To allow the user to step through all of the records, one at a time, we must enable paging for the DetailsView.</span></span> <span data-ttu-id="a1550-228">Para fazer isso, retorne ao Visual Studio e marque a caixa de seleção habilitar paginação na marca inteligente de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="a1550-228">To do so, return to Visual Studio and check the Enable Paging checkbox in the DetailsView's smart tag.</span></span>

<span data-ttu-id="a1550-229">[![habilitar a paginação no controle DetailsView](displaying-data-with-the-objectdatasource-vb/_static/image40.png)](displaying-data-with-the-objectdatasource-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-229">[![Enable Paging in the DetailsView Control](displaying-data-with-the-objectdatasource-vb/_static/image40.png)](displaying-data-with-the-objectdatasource-vb/_static/image39.png)</span></span>

<span data-ttu-id="a1550-230">**Figura 15**: habilitar a paginação no controle DetailsView ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-230">**Figure 15**: Enable Paging in the DetailsView Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image41.png))</span></span>

<span data-ttu-id="a1550-231">[![com a paginação habilitada, o DetailsView permite que o usuário exiba qualquer um dos produtos](displaying-data-with-the-objectdatasource-vb/_static/image43.png)](displaying-data-with-the-objectdatasource-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-231">[![With Paging Enabled, the DetailsView Allows the User to View Any of the Products](displaying-data-with-the-objectdatasource-vb/_static/image43.png)](displaying-data-with-the-objectdatasource-vb/_static/image42.png)</span></span>

<span data-ttu-id="a1550-232">**Figura 16**: com a paginação habilitada, o DetailsView permite que o usuário exiba qualquer um dos produtos ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-232">**Figure 16**: With Paging Enabled, the DetailsView Allows the User to View Any of the Products ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image44.png))</span></span>

<span data-ttu-id="a1550-233">Falaremos mais sobre paginação em Tutoriais futuros.</span><span class="sxs-lookup"><span data-stu-id="a1550-233">We'll talk more about paging in future tutorials.</span></span>

## <a name="a-more-flexible-layout-for-showing-one-record-at-a-time"></a><span data-ttu-id="a1550-234">Um layout mais flexível para mostrar um registro por vez</span><span class="sxs-lookup"><span data-stu-id="a1550-234">A More Flexible Layout for Showing One Record at a Time</span></span>

<span data-ttu-id="a1550-235">O DetailsView é bastante rígido em como ele exibe cada registro retornado de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-235">The DetailsView is pretty rigid in how it displays each record returned from the ObjectDataSource.</span></span> <span data-ttu-id="a1550-236">Talvez queiramos uma exibição mais flexível dos dados.</span><span class="sxs-lookup"><span data-stu-id="a1550-236">We may want a more flexible view of the data.</span></span> <span data-ttu-id="a1550-237">Por exemplo, em vez de mostrar o nome, a categoria, o fornecedor, o preço e as informações descontinuadas do produto, cada um em uma linha separada, talvez queiramos mostrar o nome do produto e o preço em um título de `<h4>`, com as informações de categoria e fornecedor aparecendo abaixo do nome e do preço em um tamanho de fonte menor.</span><span class="sxs-lookup"><span data-stu-id="a1550-237">For example, rather than showing the product's name, category, supplier, price, and discontinued information each on a separate row, we may want to show the product name and price in an `<h4>` heading, with the category and supplier information appearing below the name and price in a smaller font size.</span></span> <span data-ttu-id="a1550-238">E não podemos nos preocupar em mostrar os nomes de propriedade (produto, categoria e assim por diante) ao lado dos valores.</span><span class="sxs-lookup"><span data-stu-id="a1550-238">And we may not care to show the property names (Product, Category, and so on) next to the values.</span></span>

<span data-ttu-id="a1550-239">O [controle FormView](https://msdn.microsoft.com/library/fyf1dk77.aspx) fornece esse nível de personalização.</span><span class="sxs-lookup"><span data-stu-id="a1550-239">The [FormView control](https://msdn.microsoft.com/library/fyf1dk77.aspx) provides this level of customization.</span></span> <span data-ttu-id="a1550-240">Em vez de usar campos (como GridView e DetailsView), o FormView usa modelos, que permitem uma combinação de controles da Web, HTML estático e sintaxe de [DataBinding](http://www.15seconds.com/issue/040630.htm).</span><span class="sxs-lookup"><span data-stu-id="a1550-240">Rather than using fields (like the GridView and DetailsView do), the FormView uses templates, which allow for a mix of Web controls, static HTML, and [databinding syntax](http://www.15seconds.com/issue/040630.htm).</span></span> <span data-ttu-id="a1550-241">Se você estiver familiarizado com o controle Repeater do ASP.NET 1. x, poderá considerar o FormView como o repetidor para mostrar um único registro.</span><span class="sxs-lookup"><span data-stu-id="a1550-241">If you are familiar with the Repeater control from ASP.NET 1.x, you can think of the FormView as the Repeater for showing a single record.</span></span>

<span data-ttu-id="a1550-242">Adicione um controle FormView à superfície de design da página `SimpleDisplay.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a1550-242">Add a FormView control to the `SimpleDisplay.aspx` page's design surface.</span></span> <span data-ttu-id="a1550-243">Inicialmente, o FormView é exibido como um bloco cinza, informando que precisamos fornecer, no mínimo, o `ItemTemplate`do controle.</span><span class="sxs-lookup"><span data-stu-id="a1550-243">Initially the FormView displays as a gray block, informing us that we need to provide, at minimum, the control's `ItemTemplate`.</span></span>

<span data-ttu-id="a1550-244">[![FormView deve incluir um ItemTemplate](displaying-data-with-the-objectdatasource-vb/_static/image46.png)](displaying-data-with-the-objectdatasource-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-244">[![The FormView Must Include an ItemTemplate](displaying-data-with-the-objectdatasource-vb/_static/image46.png)](displaying-data-with-the-objectdatasource-vb/_static/image45.png)</span></span>

<span data-ttu-id="a1550-245">**Figura 17**: o FormView deve incluir um `ItemTemplate` ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-245">**Figure 17**: The FormView Must Include an `ItemTemplate` ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image47.png))</span></span>

<span data-ttu-id="a1550-246">Você pode associar o FormView diretamente a um controle da fonte de dados por meio da marca inteligente do FormView, que criará um `ItemTemplate` padrão automaticamente (juntamente com um `EditItemTemplate` e `InsertItemTemplate`, se as propriedades `InsertMethod` e `UpdateMethod` do controle ObjectDataSource estiverem definidas).</span><span class="sxs-lookup"><span data-stu-id="a1550-246">You can bind the FormView directly to a data source control through the FormView's smart tag, which will create a default `ItemTemplate` automatically (along with an `EditItemTemplate` and `InsertItemTemplate`, if the ObjectDataSource control's `InsertMethod` and `UpdateMethod` properties are set).</span></span> <span data-ttu-id="a1550-247">No entanto, para este exemplo, vamos associar os dados ao FormView e especificar seu `ItemTemplate` manualmente.</span><span class="sxs-lookup"><span data-stu-id="a1550-247">However, for this example let's bind the data to the FormView and specify its `ItemTemplate` manually.</span></span> <span data-ttu-id="a1550-248">Comece definindo a propriedade `DataSourceID` do FormView como a `ID` do controle ObjectDataSource `ObjectDataSource1`.</span><span class="sxs-lookup"><span data-stu-id="a1550-248">Start by setting the FormView's `DataSourceID` property to the `ID` of the ObjectDataSource control, `ObjectDataSource1`.</span></span> <span data-ttu-id="a1550-249">Em seguida, crie o `ItemTemplate` para que ele exiba o nome e o preço do produto em um elemento de `<h4>` e os nomes de categoria e de transportador abaixo dele em um tamanho de fonte menor.</span><span class="sxs-lookup"><span data-stu-id="a1550-249">Next, create the `ItemTemplate` so that it displays the product's name and price in an `<h4>` element and the category and shipper names beneath that in a smaller font size.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample6.aspx)]

<span data-ttu-id="a1550-250">[![o primeiro produto (Chai) é exibido em um formato personalizado](displaying-data-with-the-objectdatasource-vb/_static/image49.png)](displaying-data-with-the-objectdatasource-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="a1550-250">[![The First Product (Chai) is Displayed in a Custom Format](displaying-data-with-the-objectdatasource-vb/_static/image49.png)](displaying-data-with-the-objectdatasource-vb/_static/image48.png)</span></span>

<span data-ttu-id="a1550-251">**Figura 18**: o primeiro produto (Chai) é exibido em um formato personalizado ([clique para exibir a imagem em tamanho normal](displaying-data-with-the-objectdatasource-vb/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="a1550-251">**Figure 18**: The First Product (Chai) is Displayed in a Custom Format ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image50.png))</span></span>

<span data-ttu-id="a1550-252">O `<%# Eval(propertyName) %>` é a sintaxe de DataBinding.</span><span class="sxs-lookup"><span data-stu-id="a1550-252">The `<%# Eval(propertyName) %>` is the databinding syntax.</span></span> <span data-ttu-id="a1550-253">O método `Eval` retorna o valor da propriedade especificada para o objeto atual que está sendo associado ao controle FormView.</span><span class="sxs-lookup"><span data-stu-id="a1550-253">The `Eval` method returns the value of the specified property for the current object being bound to the FormView control.</span></span> <span data-ttu-id="a1550-254">Confira o artigo de Alex Homer [e a sintaxe de ligação de dados estendida no ASP.NET 2,0](http://www.15seconds.com/issue/040630.htm) para obter mais informações sobre as vantagens e desvantagens da Associação de vínculo.</span><span class="sxs-lookup"><span data-stu-id="a1550-254">Check out Alex Homer's article [Simplified and Extended Data Binding Syntax in ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm) for more information on the ins and outs of databinding.</span></span>

<span data-ttu-id="a1550-255">Como o DetailsView, o FormView mostra apenas o primeiro registro retornado de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-255">Like the DetailsView, the FormView only shows the first record returned from the ObjectDataSource.</span></span> <span data-ttu-id="a1550-256">Você pode habilitar a paginação no FormView para permitir que os visitantes percorram os produtos um de cada vez.</span><span class="sxs-lookup"><span data-stu-id="a1550-256">You can enable paging in the FormView to allow visitors to step through the products one at a time.</span></span>

## <a name="summary"></a><span data-ttu-id="a1550-257">Resumo</span><span class="sxs-lookup"><span data-stu-id="a1550-257">Summary</span></span>

<span data-ttu-id="a1550-258">O acesso e a exibição de dados de uma camada de lógica de negócios podem ser realizados sem escrever uma linha de código graças ao controle ObjectDataSource do ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="a1550-258">Accessing and displaying data from a Business Logic Layer can be accomplished without writing a line of code thanks to ASP.NET 2.0's ObjectDataSource control.</span></span> <span data-ttu-id="a1550-259">O ObjectDataSource invoca um método especificado de uma classe e retorna os resultados.</span><span class="sxs-lookup"><span data-stu-id="a1550-259">The ObjectDataSource invokes a specified method of a class and returns the results.</span></span> <span data-ttu-id="a1550-260">Esses resultados podem ser exibidos em um controle da Web de dados associado ao ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-260">These results can be displayed in a data Web control that's bound to the ObjectDataSource.</span></span> <span data-ttu-id="a1550-261">Neste tutorial, examinamos a vinculação dos controles GridView, DetailsView e FormView ao ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="a1550-261">In this tutorial we looked at binding the GridView, DetailsView, and FormView controls to the ObjectDataSource.</span></span>

<span data-ttu-id="a1550-262">Até agora, vimos como usar o ObjectDataSource para invocar um método sem parâmetros, mas e se quisermos invocar um método que espera parâmetros de entrada, como o `GetProductsByCategoryID(categoryID)`da classe `ProductBLL`?</span><span class="sxs-lookup"><span data-stu-id="a1550-262">So far we've only seen how to use the ObjectDataSource to invoke a parameter-less method, but what if we want to invoke a method that expects input parameters, such as the `ProductBLL` class's `GetProductsByCategoryID(categoryID)`?</span></span> <span data-ttu-id="a1550-263">Para chamar um método que espera um ou mais parâmetros, devemos configurar o ObjectDataSource para especificar os valores para esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="a1550-263">In order to call a method that expects one or more parameters we must configure the ObjectDataSource to specify the values for these parameters.</span></span> <span data-ttu-id="a1550-264">Veremos como fazer isso em nosso [próximo tutorial](declarative-parameters-vb.md).</span><span class="sxs-lookup"><span data-stu-id="a1550-264">We'll see how to accomplish this in our [next tutorial](declarative-parameters-vb.md).</span></span>

<span data-ttu-id="a1550-265">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="a1550-265">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="a1550-266">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="a1550-266">Further Reading</span></span>

<span data-ttu-id="a1550-267">Para obter mais informações sobre os tópicos discutidos neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="a1550-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a1550-268">Criar seus próprios controles de fonte de dados</span><span class="sxs-lookup"><span data-stu-id="a1550-268">Create Your Own Data Source Controls</span></span>](https://msdn.microsoft.com/library/ms364049.aspx)
- [<span data-ttu-id="a1550-269">Exemplos de GridView para ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="a1550-269">GridView Examples for ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/aa479339.aspx)
- [<span data-ttu-id="a1550-270">Sintaxe de vinculação de dados simplificada e estendida no ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="a1550-270">Simplified and Extended Data Binding Syntax in ASP.NET 2.0</span></span>](http://www.15seconds.com/issue/040630.htm)
- [<span data-ttu-id="a1550-271">Temas no ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="a1550-271">Themes in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/423.aspx)
- [<span data-ttu-id="a1550-272">Estilos do lado do servidor usando temas</span><span class="sxs-lookup"><span data-stu-id="a1550-272">Server-Side Styles Using Themes</span></span>](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)
- [<span data-ttu-id="a1550-273">Como aplicar temas de ASP.NET programaticamente</span><span class="sxs-lookup"><span data-stu-id="a1550-273">How To: Apply ASP.NET Themes Programmatically</span></span>](https://msdn.microsoft.com/library/tx35bd89.aspx)

## <a name="about-the-author"></a><span data-ttu-id="a1550-274">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="a1550-274">About the Author</span></span>

<span data-ttu-id="a1550-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="a1550-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a1550-276">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="a1550-276">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a1550-277">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a1550-277">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a1550-278">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a1550-278">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a1550-279">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a1550-279">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a1550-280">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="a1550-280">Special Thanks To</span></span>

<span data-ttu-id="a1550-281">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="a1550-281">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a1550-282">O revisor de Lead para este tutorial foi Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="a1550-282">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="a1550-283">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="a1550-283">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a1550-284">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a1550-284">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a1550-285">[Anterior](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)
> [Próximo](declarative-parameters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a1550-285">[Previous](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)
[Next](declarative-parameters-vb.md)</span></span>
