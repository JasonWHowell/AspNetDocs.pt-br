---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
title: Definindo programaticamente os valores de parâmetro de ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, veremos como adicionar um método à nossa DAL e à BLL que aceita um único parâmetro de entrada e retorna dados. O exemplo definirá esse parâmetro...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 0ecb03b6-52a0-4731-8c7a-436391d36838
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
msc.type: authoredcontent
ms.openlocfilehash: f1dd50f46528e8dd51f85e503604d3f0dbc21ad2
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78577052"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-vb"></a><span data-ttu-id="d708a-104">Configurar programaticamente os valores do parâmetro ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="d708a-104">Programmatically Setting the ObjectDataSource's Parameter Values (VB)</span></span>

<span data-ttu-id="d708a-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d708a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d708a-106">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) ou [baixar PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d708a-106">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span></span>

> <span data-ttu-id="d708a-107">Neste tutorial, veremos como adicionar um método à nossa DAL e à BLL que aceita um único parâmetro de entrada e retorna dados.</span><span class="sxs-lookup"><span data-stu-id="d708a-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="d708a-108">O exemplo definirá esse parâmetro programaticamente.</span><span class="sxs-lookup"><span data-stu-id="d708a-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="d708a-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="d708a-109">Introduction</span></span>

<span data-ttu-id="d708a-110">Como vimos no [tutorial anterior](declarative-parameters-vb.md), várias opções estão disponíveis para passar valores de parâmetro de forma declarativa para os métodos de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d708a-110">As we saw in the [previous tutorial](declarative-parameters-vb.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="d708a-111">Se o valor do parâmetro for embutido em código, vier de um controle da Web na página ou em qualquer outra fonte que possa ser lida por uma fonte de dados `Parameter` objeto, por exemplo, esse valor poderá ser associado ao parâmetro de entrada sem escrever uma linha de código.</span><span class="sxs-lookup"><span data-stu-id="d708a-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="d708a-112">No entanto, pode haver ocasiões em que o valor do parâmetro venha de alguma fonte que ainda não tenha sido contada por um dos objetos da fonte de dados interna `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="d708a-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="d708a-113">Se o nosso site tiver suporte para contas de usuário, talvez queiramos definir o parâmetro com base na ID de usuário do visitante conectado no momento.</span><span class="sxs-lookup"><span data-stu-id="d708a-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="d708a-114">Ou talvez seja necessário personalizar o valor do parâmetro antes de enviá-lo ao método do objeto subjacente do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d708a-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="d708a-115">Sempre que o método `Select` do ObjectDataSource é invocado, o ObjectDataSource primeiro levanta seu [evento de seleção](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="d708a-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="d708a-116">O método do objeto subjacente do ObjectDataSource é invocado.</span><span class="sxs-lookup"><span data-stu-id="d708a-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="d708a-117">Depois de concluir o [evento selecionado](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) do ObjectDataSource, acionado (a Figura 1 ilustra essa sequência de eventos).</span><span class="sxs-lookup"><span data-stu-id="d708a-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="d708a-118">Os valores de parâmetro passados para o método do objeto subjacente do ObjectDataSource podem ser definidos ou personalizados em um manipulador de eventos para o evento `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="d708a-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="d708a-119">[![os eventos do ObjectDataSource selecionado e de seleção são acionados antes e depois que o método do objeto subjacente é invocado](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span></span>

<span data-ttu-id="d708a-120">**Figura 1**: os eventos de `Selected` e `Selecting` do ObjectDataSource são acionados antes e depois que o método do objeto subjacente é invocado ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span></span>

<span data-ttu-id="d708a-121">Neste tutorial, veremos como adicionar um método à nossa DAL e à BLL que aceita um único parâmetro de entrada `Month`, do tipo `Integer` e retorna um objeto `EmployeesDataTable` populado com os funcionários que têm seu aniversário de contratação no `Month`especificado.</span><span class="sxs-lookup"><span data-stu-id="d708a-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `Integer` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="d708a-122">Nosso exemplo definirá esse parâmetro programaticamente com base no mês atual, mostrando uma lista de "aniversários de funcionários deste mês".</span><span class="sxs-lookup"><span data-stu-id="d708a-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="d708a-123">Vamos começar!</span><span class="sxs-lookup"><span data-stu-id="d708a-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="d708a-124">Etapa 1: adicionando um método a`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="d708a-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="d708a-125">Para nosso primeiro exemplo, precisamos adicionar um meio para recuperar os funcionários cujos `HireDate` ocorreram em um mês especificado.</span><span class="sxs-lookup"><span data-stu-id="d708a-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="d708a-126">Para fornecer essa funcionalidade de acordo com nossa arquitetura, precisamos primeiro criar um método em `EmployeesTableAdapter` que seja mapeado para a instrução SQL apropriada.</span><span class="sxs-lookup"><span data-stu-id="d708a-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="d708a-127">Para fazer isso, comece abrindo o DataSet tipado Northwind.</span><span class="sxs-lookup"><span data-stu-id="d708a-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="d708a-128">Clique com o botão direito do mouse no rótulo `EmployeesTableAdapter` e escolha Adicionar consulta.</span><span class="sxs-lookup"><span data-stu-id="d708a-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="d708a-129">[![adicionar uma nova consulta ao EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span></span>

<span data-ttu-id="d708a-130">**Figura 2**: adicionar uma nova consulta à `EmployeesTableAdapter` ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span></span>

<span data-ttu-id="d708a-131">Escolha Adicionar uma instrução SQL que retorna linhas.</span><span class="sxs-lookup"><span data-stu-id="d708a-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="d708a-132">Quando você atingir a tela especificar uma `SELECT` instrução, a instrução de `SELECT` padrão para o `EmployeesTableAdapter` já será carregada.</span><span class="sxs-lookup"><span data-stu-id="d708a-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="d708a-133">Basta adicionar na cláusula `WHERE`: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="d708a-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="d708a-134">[Datepart](https://msdn.microsoft.com/library/ms174420.aspx) é uma função T-SQL que retorna uma parte de data específica de um tipo de `datetime`; Nesse caso, estamos usando `DATEPART` para retornar o mês da coluna `HireDate`.</span><span class="sxs-lookup"><span data-stu-id="d708a-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="d708a-135">[![retornar apenas as linhas em que a coluna HireDate é menor ou igual ao parâmetro @HiredBeforeDate](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span></span>

<span data-ttu-id="d708a-136">**Figura 3**: retornar apenas as linhas em que a coluna `HireDate` é menor ou igual ao parâmetro `@HiredBeforeDate` ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span></span>

<span data-ttu-id="d708a-137">Por fim, altere o `FillBy` e `GetDataBy` nomes de método para `FillByHiredDateMonth` e `GetEmployeesByHiredDateMonth`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d708a-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="d708a-138">[![escolher os nomes de método mais apropriados do que FillBy e GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span></span>

<span data-ttu-id="d708a-139">**Figura 4**: escolha mais nomes de métodos apropriados do que `FillBy` e `GetDataBy` ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span></span>

<span data-ttu-id="d708a-140">Clique em concluir para concluir o assistente e retornar à superfície de design do conjunto de um.</span><span class="sxs-lookup"><span data-stu-id="d708a-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="d708a-141">O `EmployeesTableAdapter` agora deve incluir um novo conjunto de métodos para acessar os funcionários contratados em um mês especificado.</span><span class="sxs-lookup"><span data-stu-id="d708a-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="d708a-142">[![os novos métodos aparecem no Design Surface do conjunto de um](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span></span>

<span data-ttu-id="d708a-143">**Figura 5**: os novos métodos aparecem na design Surface do conjunto de[datas (clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="d708a-144">Etapa 2: adicionando o método de`GetEmployeesByHiredDateMonth(month)`à camada de lógica de negócios</span><span class="sxs-lookup"><span data-stu-id="d708a-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="d708a-145">Como nossa arquitetura de aplicativo usa uma camada separada para a lógica de negócios e a lógica de acesso a dados, precisamos adicionar um método à nossa BLL que chama para a DAL para recuperar os funcionários contratados antes de uma data especificada.</span><span class="sxs-lookup"><span data-stu-id="d708a-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="d708a-146">Abra o arquivo `EmployeesBLL.vb` e adicione o seguinte método:</span><span class="sxs-lookup"><span data-stu-id="d708a-146">Open the `EmployeesBLL.vb` file and add the following method:</span></span>

[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample1.vb)]

<span data-ttu-id="d708a-147">Assim como acontece com nossos outros métodos nessa classe, `GetEmployeesByHiredDateMonth(month)` simplesmente chama a DAL e retorna os resultados.</span><span class="sxs-lookup"><span data-stu-id="d708a-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="d708a-148">Etapa 3: exibindo funcionários cujo aniversário de contratação é este mês</span><span class="sxs-lookup"><span data-stu-id="d708a-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="d708a-149">Nossa etapa final para este exemplo é exibir os funcionários cujo aniversário de contratação é este mês.</span><span class="sxs-lookup"><span data-stu-id="d708a-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="d708a-150">Comece adicionando um GridView à página `ProgrammaticParams.aspx` na pasta `BasicReporting` e adicione uma nova ObjectDataSource como sua fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="d708a-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="d708a-151">Configure o ObjectDataSource para usar a classe `EmployeesBLL` com a `SelectMethod` definida como `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="d708a-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="d708a-152">[![usar a classe EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span></span>

<span data-ttu-id="d708a-153">**Figura 6**: usar a classe `EmployeesBLL` ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span></span>

<span data-ttu-id="d708a-154">[![selecionar do método GetEmployeesByHiredDateMonth (mês)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span></span>

<span data-ttu-id="d708a-155">**Figura 7**: selecione no método de `GetEmployeesByHiredDateMonth(month)` ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span></span>

<span data-ttu-id="d708a-156">A tela final solicita que possamos fornecer a origem do valor do parâmetro de `month`.</span><span class="sxs-lookup"><span data-stu-id="d708a-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="d708a-157">Como vamos definir esse valor programaticamente, deixe a origem do parâmetro definida como a opção None padrão e clique em concluir.</span><span class="sxs-lookup"><span data-stu-id="d708a-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="d708a-158">[![deixar a origem do parâmetro definida como None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span></span>

<span data-ttu-id="d708a-159">**Figura 8**: Deixe a origem do parâmetro definida como nenhum ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span></span>

<span data-ttu-id="d708a-160">Isso criará um objeto `Parameter` na coleção de `SelectParameters` do ObjectDataSource que não tem um valor especificado.</span><span class="sxs-lookup"><span data-stu-id="d708a-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample2.aspx)]

<span data-ttu-id="d708a-161">Para definir esse valor programaticamente, precisamos criar um manipulador de eventos para o evento de `Selecting` do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d708a-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="d708a-162">Para fazer isso, vá para a modo de exibição de Design e clique duas vezes em ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d708a-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="d708a-163">Como alternativa, selecione o ObjectDataSource, vá para o janela Propriedades e clique no ícone de raio.</span><span class="sxs-lookup"><span data-stu-id="d708a-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="d708a-164">Em seguida, clique duas vezes na caixa de texto ao lado do evento `Selecting` ou digite o nome do manipulador de eventos que você deseja usar.</span><span class="sxs-lookup"><span data-stu-id="d708a-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span> <span data-ttu-id="d708a-165">Como uma terceira opção, você pode criar o manipulador de eventos selecionando o evento ObjectDataSource e seu `Selecting` nas duas listas suspensas na parte superior da classe code-behind da página.</span><span class="sxs-lookup"><span data-stu-id="d708a-165">As a third option, you can create the event handler by selecting the ObjectDataSource and its `Selecting` event from the two drop-down lists at the top of the page's code-behind class.</span></span>

![Clique no ícone de raio na janela Propriedades para listar os eventos de um controle da Web](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image25.png)

<span data-ttu-id="d708a-167">**Figura 9**: clique no ícone de raio na janela Propriedades para listar os eventos de um controle da Web</span><span class="sxs-lookup"><span data-stu-id="d708a-167">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="d708a-168">Todas as três abordagens adicionam um novo manipulador de eventos para o evento de `Selecting` do ObjectDataSource à classe code-behind da página.</span><span class="sxs-lookup"><span data-stu-id="d708a-168">All three approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="d708a-169">Nesse manipulador de eventos, podemos ler e gravar nos valores de parâmetro usando `e.InputParameters(parameterName)`, em que *`parameterName`* é o valor do atributo `Name` na marca de `<asp:Parameter>` (a coleção de `InputParameters` também pode ser indexada no ordinal, como no `e.InputParameters(index)`).</span><span class="sxs-lookup"><span data-stu-id="d708a-169">In this event handler we can read and write to the parameter values using `e.InputParameters(parameterName)`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters(index)`).</span></span> <span data-ttu-id="d708a-170">Para definir o parâmetro `month` para o mês atual, adicione o seguinte ao manipulador de eventos `Selecting`:</span><span class="sxs-lookup"><span data-stu-id="d708a-170">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample3.vb)]

<span data-ttu-id="d708a-171">Ao visitar esta página por meio de um navegador, podemos ver que apenas um funcionário foi contratado neste mês (março) Laura Callahan, que foi a empresa desde 1994.</span><span class="sxs-lookup"><span data-stu-id="d708a-171">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="d708a-172">[![os funcionários cujos aniversários são mostrados neste mês](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="d708a-172">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span></span>

<span data-ttu-id="d708a-173">**Figura 10**: os funcionários cujos aniversários deste mês são mostrados ([clique para exibir a imagem em tamanho normal](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="d708a-173">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="d708a-174">Resumo</span><span class="sxs-lookup"><span data-stu-id="d708a-174">Summary</span></span>

<span data-ttu-id="d708a-175">Embora os valores dos parâmetros de ObjectDataSource possam ser normalmente definidos declarativamente, sem a necessidade de uma linha de código, é fácil definir os valores de parâmetro programaticamente.</span><span class="sxs-lookup"><span data-stu-id="d708a-175">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="d708a-176">Tudo o que precisamos fazer é criar um manipulador de eventos para o evento `Selecting` do ObjectDataSource, que é acionado antes de o método do objeto subjacente ser invocado e definir manualmente os valores de um ou mais parâmetros por meio da coleção `InputParameters`.</span><span class="sxs-lookup"><span data-stu-id="d708a-176">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="d708a-177">Este tutorial conclui a seção de relatório básico.</span><span class="sxs-lookup"><span data-stu-id="d708a-177">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="d708a-178">O [próximo tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) inicia a seção filtragem e cenários mestre-detalhes, na qual veremos as técnicas para permitir que o visitante filtre os dados e faça uma busca detalhada de um relatório mestre em um relatório de detalhes.</span><span class="sxs-lookup"><span data-stu-id="d708a-178">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="d708a-179">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="d708a-179">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d708a-180">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="d708a-180">About the Author</span></span>

<span data-ttu-id="d708a-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="d708a-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d708a-182">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="d708a-182">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d708a-183">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d708a-183">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d708a-184">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d708a-184">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d708a-185">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d708a-185">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d708a-186">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="d708a-186">Special Thanks To</span></span>

<span data-ttu-id="d708a-187">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="d708a-187">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d708a-188">O revisor de Lead para este tutorial foi Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="d708a-188">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="d708a-189">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="d708a-189">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d708a-190">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d708a-190">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d708a-191">Anterior</span><span class="sxs-lookup"><span data-stu-id="d708a-191">Previous</span></span>](declarative-parameters-vb.md)
