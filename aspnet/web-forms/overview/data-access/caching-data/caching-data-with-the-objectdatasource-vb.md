---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: Armazenando dados em cache com o ObjectDataSource (VB) | Microsoft Docs
author: rick-anderson
description: O Caching pode significar a diferença entre um aplicativo Web lento e rápido. Este tutorial é o primeiro de quatro que faz uma visão detalhada do cache em ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 16f20d9a0f4f677073174d680418b278dba40b07
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612198"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="f68d8-104">Armazenar dados em cache com o ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="f68d8-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="f68d8-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f68d8-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f68d8-106">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) ou [baixar PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f68d8-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="f68d8-107">O Caching pode significar a diferença entre um aplicativo Web lento e rápido.</span><span class="sxs-lookup"><span data-stu-id="f68d8-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="f68d8-108">Este tutorial é o primeiro de quatro que faz uma visão detalhada do cache em ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f68d8-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="f68d8-109">Aprenda os principais conceitos de cache e como aplicar o Caching à camada de apresentação por meio do controle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f68d8-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="f68d8-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="f68d8-110">Introduction</span></span>

<span data-ttu-id="f68d8-111">Na ciência da computação, o *Caching* é o processo de obtenção de dados ou informações que são caras para obter e armazenar uma cópia dela em um local mais rápido de acessar.</span><span class="sxs-lookup"><span data-stu-id="f68d8-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="f68d8-112">Para aplicativos controlados por dados, consultas grandes e complexas normalmente consomem a maioria do tempo de execução do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f68d8-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="f68d8-113">Esse tipo de desempenho de aplicativo, em seguida, pode ser melhorado com freqüência armazenando os resultados de consultas dispendiosas de banco de dados na memória s do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f68d8-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="f68d8-114">O ASP.NET 2,0 oferece uma variedade de opções de cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="f68d8-115">Uma página da Web inteira ou a marcação renderizada s de controle de usuário pode ser armazenada em cache por meio do *cache de saída*.</span><span class="sxs-lookup"><span data-stu-id="f68d8-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="f68d8-116">Os controles ObjectDataSource e SqlDataSource fornecem recursos de cache, permitindo assim que os dados sejam armazenados em cache no nível de controle.</span><span class="sxs-lookup"><span data-stu-id="f68d8-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="f68d8-117">E o *cache de dados* do ASP.NET fornece uma API de cache rica que permite que os desenvolvedores de páginas armazenem em cache os objetos de forma programática.</span><span class="sxs-lookup"><span data-stu-id="f68d8-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="f68d8-118">Neste tutorial e nos próximos três, examinaremos usando os recursos de cache do ObjectDataSource s, bem como o cache de dados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="f68d8-119">Também exploraremos como armazenar em cache os dados de todo o aplicativo na inicialização e como manter os dados em cache atualizados por meio do uso de dependências de cache do SQL.</span><span class="sxs-lookup"><span data-stu-id="f68d8-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="f68d8-120">Esses tutoriais não exploram o cache de saída.</span><span class="sxs-lookup"><span data-stu-id="f68d8-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="f68d8-121">Para obter uma visão detalhada do cache de saída, consulte [Caching de saída no ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="f68d8-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="f68d8-122">O Caching pode ser aplicado em qualquer lugar da arquitetura, desde a camada de acesso a dados até a camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="f68d8-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="f68d8-123">Neste tutorial, veremos como aplicar o cache à camada de apresentação por meio do controle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f68d8-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="f68d8-124">No próximo tutorial, examinaremos o cache de dados na camada de lógica de negócios.</span><span class="sxs-lookup"><span data-stu-id="f68d8-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="f68d8-125">Conceitos de cache de chave</span><span class="sxs-lookup"><span data-stu-id="f68d8-125">Key Caching Concepts</span></span>

<span data-ttu-id="f68d8-126">O Caching pode melhorar muito o desempenho e a escalabilidade gerais de um aplicativo, obtendo dados caros para gerar e armazenar uma cópia dele em um local que pode ser acessado com mais eficiência.</span><span class="sxs-lookup"><span data-stu-id="f68d8-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="f68d8-127">Como o cache mantém apenas uma cópia dos dados subjacentes reais, ele poderá ficar desatualizado ou *obsoleto*se os dados subjacentes forem alterados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="f68d8-128">Para combater isso, um desenvolvedor de página pode indicar critérios pelos quais o item de cache será *removido* do cache, usando:</span><span class="sxs-lookup"><span data-stu-id="f68d8-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="f68d8-129">**Critérios baseados em tempo** um item pode ser adicionado ao cache por uma duração absoluta ou deslizante.</span><span class="sxs-lookup"><span data-stu-id="f68d8-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="f68d8-130">Por exemplo, um desenvolvedor de página pode indicar uma duração de, digamos, 60 segundos.</span><span class="sxs-lookup"><span data-stu-id="f68d8-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="f68d8-131">Com uma duração absoluta, o item armazenado em cache é removido 60 segundos depois de ser adicionado ao cache, independentemente da frequência com que ele foi acessado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="f68d8-132">Com uma duração deslizante, o item armazenado em cache é removido 60 segundos após o último acesso.</span><span class="sxs-lookup"><span data-stu-id="f68d8-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="f68d8-133">**Critérios baseados em dependência** uma dependência pode ser associada a um item quando adicionado ao cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="f68d8-134">Quando a dependência do item s é alterada, ela é removida do cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="f68d8-135">A dependência pode ser um arquivo, outro item de cache ou uma combinação dos dois.</span><span class="sxs-lookup"><span data-stu-id="f68d8-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="f68d8-136">O ASP.NET 2,0 também permite as dependências de cache do SQL, que permitem aos desenvolvedores adicionar um item ao cache e removê-lo quando os dados subjacentes do banco de dados forem alterados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="f68d8-137">Examinaremos as dependências do cache SQL no futuro usando o tutorial de [dependências do cache SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="f68d8-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="f68d8-138">Independentemente dos critérios de remoção especificados, um item no cache pode ser *eliminado* antes que os critérios baseados no tempo ou na dependência sejam atendidos.</span><span class="sxs-lookup"><span data-stu-id="f68d8-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="f68d8-139">Se o cache atingiu sua capacidade, os itens existentes devem ser removidos antes que novos possam ser adicionados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="f68d8-140">Consequentemente, ao trabalhar de forma programática com dados armazenados em cache, é vital que você sempre presuma que os dados armazenados em cache podem não estar presentes.</span><span class="sxs-lookup"><span data-stu-id="f68d8-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="f68d8-141">Examinaremos o padrão a ser usado ao acessar dados do cache programaticamente em nosso próximo tutorial, *armazenando em cache os dados na arquitetura*.</span><span class="sxs-lookup"><span data-stu-id="f68d8-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="f68d8-142">O caching fornece um meio econômico para comprimir mais desempenho de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f68d8-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="f68d8-143">Como [Steven Smith](http://aspadvice.com/blogs/ssmith/) articula em seu artigo [ASP.net Caching: técnicas e práticas recomendadas](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="f68d8-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="f68d8-144">O Caching pode ser uma boa maneira de obter um bom desempenho suficiente sem exigir muito tempo e análise.</span><span class="sxs-lookup"><span data-stu-id="f68d8-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="f68d8-145">A memória é barata, portanto, se você puder obter o desempenho de que precisa armazenando em cache a saída por 30 segundos, em vez de gastar um dia ou uma semana tentando otimizar seu código ou banco de dados, faça a solução de cache (supondo que o dado de 30 segundos esteja OK) e passe.</span><span class="sxs-lookup"><span data-stu-id="f68d8-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="f68d8-146">Por fim, um design ruim provavelmente será feito para você, portanto, é claro que você deve tentar projetar seus aplicativos corretamente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="f68d8-147">Mas se você só precisa obter um desempenho suficiente hoje, o Caching pode ser uma excelente [abordagem], comprando tempo para refatorar seu aplicativo posteriormente quando você tiver tempo para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="f68d8-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="f68d8-148">Embora o Caching possa fornecer aprimoramentos de desempenho de apreciável, ele não é aplicável em todas as situações, como com aplicativos que usam dados em tempo real, atualizando com frequência ou onde mesmo os dados obsoletos em breve duração são inaceitáveis.</span><span class="sxs-lookup"><span data-stu-id="f68d8-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="f68d8-149">Mas, para a maioria dos aplicativos, o Caching deve ser usado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="f68d8-150">Para obter mais informações sobre cache no ASP.NET 2,0, consulte a seção [cache for performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) dos [tutoriais de início rápido do ASP.NET 2,0](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="f68d8-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="f68d8-151">Etapa 1: criando as páginas da Web de cache</span><span class="sxs-lookup"><span data-stu-id="f68d8-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="f68d8-152">Antes de começarmos nossa exploração dos recursos de cache de ObjectDataSource s, vamos primeiro reservar um momento para criar as páginas ASP.NET em nosso projeto de site, que precisaremos para este tutorial e os três seguintes.</span><span class="sxs-lookup"><span data-stu-id="f68d8-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="f68d8-153">Comece adicionando uma nova pasta chamada `Caching`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="f68d8-154">Em seguida, adicione as seguintes páginas ASP.NET a essa pasta, assegurando a associação de cada página com a página mestra `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="f68d8-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![Adicionar as páginas ASP.NET para os tutoriais relacionados ao cache](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="f68d8-156">**Figura 1**: adicionar as páginas ASP.net para os tutoriais relacionados ao cache</span><span class="sxs-lookup"><span data-stu-id="f68d8-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="f68d8-157">Assim como nas outras pastas, `Default.aspx` na pasta `Caching` listará os tutoriais em sua seção.</span><span class="sxs-lookup"><span data-stu-id="f68d8-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f68d8-158">Lembre-se de que o controle de usuário `SectionLevelTutorialListing.ascx` fornece essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="f68d8-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f68d8-159">Portanto, adicione esse controle de usuário a `Default.aspx` arrastando-o da Gerenciador de Soluções para a página s modo de exibição de Design.</span><span class="sxs-lookup"><span data-stu-id="f68d8-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="f68d8-160">[![Figura 2: Adicionar o controle de usuário SectionLevelTutorialListing. ascx a default. aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="f68d8-161">**Figura 2**: Adicionar o controle de usuário `SectionLevelTutorialListing.ascx` ao `Default.aspx` ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="f68d8-162">Por fim, adicione essas páginas como entradas ao arquivo de `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f68d8-163">Especificamente, adicione a seguinte marcação após o trabalho com dados binários `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="f68d8-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="f68d8-164">Depois de atualizar `Web.sitemap`, Reserve um momento para exibir o site de tutoriais por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="f68d8-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f68d8-165">O menu à esquerda agora inclui itens para os tutoriais de cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-165">The menu on the left now includes items for the caching tutorials.</span></span>

![O mapa do site agora inclui entradas para os tutoriais de cache](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="f68d8-167">**Figura 3**: o mapa do site agora inclui entradas para os tutoriais de cache</span><span class="sxs-lookup"><span data-stu-id="f68d8-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="f68d8-168">Etapa 2: exibindo uma lista de produtos em uma página da Web</span><span class="sxs-lookup"><span data-stu-id="f68d8-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="f68d8-169">Este tutorial explora como usar os recursos de cache interno do controle ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="f68d8-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="f68d8-170">Antes que possamos examinar esses recursos, no entanto, precisamos primeiro de uma página para trabalhar.</span><span class="sxs-lookup"><span data-stu-id="f68d8-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="f68d8-171">Deixe que o s Crie uma página da Web que usa um GridView para listar informações de produtos recuperadas por um ObjectDataSource da classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="f68d8-172">Comece abrindo a página de `ObjectDataSource.aspx` na pasta `Caching`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="f68d8-173">Arraste um GridView da caixa de ferramentas para o designer, defina sua propriedade `ID` como `Products`e, em sua marca inteligente, escolha associá-la a um novo controle ObjectDataSource chamado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="f68d8-174">Configure o ObjectDataSource para trabalhar com a classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="f68d8-175">[![configurar o ObjectDataSource para usar a classe ProductsBLL](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="f68d8-176">**Figura 4**: configurar o ObjectDataSource para usar a classe `ProductsBLL` ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="f68d8-177">Para esta página, vamos criar um GridView editável para que possamos examinar o que acontece quando os dados armazenados em cache em ObjectDataSource são modificados por meio da interface GridView.</span><span class="sxs-lookup"><span data-stu-id="f68d8-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="f68d8-178">Deixe a lista suspensa na guia selecionar definida como seu padrão, `GetProducts()`, mas altere o item selecionado na guia atualizar para a sobrecarga `UpdateProduct` que aceita `productName`, `unitPrice`e `productID` como seus parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="f68d8-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="f68d8-179">[![definir a lista suspensa da guia atualizar para a sobrecarga UpdateProduct apropriada](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="f68d8-180">**Figura 5**: definir a lista suspensa da guia atualizar s para a sobrecarga de `UpdateProduct` apropriada ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>

<span data-ttu-id="f68d8-181">Por fim, defina as listas suspensas nas guias inserir e excluir como (nenhum) e clique em concluir.</span><span class="sxs-lookup"><span data-stu-id="f68d8-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="f68d8-182">Após a conclusão do assistente para configurar fonte de dados, o Visual Studio define a Propriedade ObjectDataSource s `OldValuesParameterFormatString` como `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="f68d8-183">Conforme discutido na [visão geral do tutorial inserir, atualizar e excluir dados](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , essa propriedade precisa ser removida da sintaxe declarativa ou redefinida para o valor padrão, `{0}`, para que o fluxo de trabalho de atualização continue sem erros.</span><span class="sxs-lookup"><span data-stu-id="f68d8-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="f68d8-184">Além disso, na conclusão do assistente, o Visual Studio adiciona um campo ao GridView para cada um dos campos de dados do produto.</span><span class="sxs-lookup"><span data-stu-id="f68d8-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="f68d8-185">Remova tudo, exceto o `ProductName`, o `CategoryName`e o `UnitPrice` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="f68d8-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="f68d8-186">Em seguida, atualize as propriedades `HeaderText` de cada um desses BoundFields para produto, categoria e preço, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="f68d8-187">Como o campo `ProductName` é necessário, converta o BoundField em um TemplateField e adicione um RequiredFieldValidator ao `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="f68d8-188">Da mesma forma, converta o `UnitPrice` BoundField em um TemplateField e adicione um CompareValidator para garantir que o valor inserido pelo usuário seja um valor de moeda válido que seja maior ou igual a zero.</span><span class="sxs-lookup"><span data-stu-id="f68d8-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="f68d8-189">Além dessas modificações, sinta-se à vontade para executar quaisquer alterações estéticos, como o alinhamento à direita do valor `UnitPrice` ou a especificação da formatação para o texto `UnitPrice` em suas interfaces somente leitura e de edição.</span><span class="sxs-lookup"><span data-stu-id="f68d8-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="f68d8-190">Torne o GridView editável marcando a caixa de seleção Habilitar edição na marca inteligente s GridView.</span><span class="sxs-lookup"><span data-stu-id="f68d8-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="f68d8-191">Marque também as caixas de seleção habilitar paginação e Habilitar classificação.</span><span class="sxs-lookup"><span data-stu-id="f68d8-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="f68d8-192">Precisa de uma revisão de como personalizar a interface de edição de GridView?</span><span class="sxs-lookup"><span data-stu-id="f68d8-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="f68d8-193">Nesse caso, consulte o tutorial [Personalizando a interface de modificação de dados](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="f68d8-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="f68d8-194">[![habilitar o suporte a GridView para edição, classificação e paginação](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="f68d8-195">**Figura 6**: habilitar o suporte a GridView para edição, classificação e paginação ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>

<span data-ttu-id="f68d8-196">Depois de fazer essas modificações em GridView, a marcação declarativa de GridView e ObjectDataSource s deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="f68d8-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="f68d8-197">Como mostra a Figura 7, o GridView editável lista o nome, a categoria e o preço de cada um dos produtos no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="f68d8-198">Reserve um tempo para testar a funcionalidade de s de página, classificar os resultados, pageá-los e editar um registro.</span><span class="sxs-lookup"><span data-stu-id="f68d8-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="f68d8-199">[![cada nome, categoria e preço do produto está listado em um GridView classificável, paginável e editável](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="f68d8-200">**Figura 7**: cada nome, categoria e preço do produto é listado em um GridView classificável, paginável e editável ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="f68d8-201">Etapa 3: examinando quando o ObjectDataSource está solicitando dados</span><span class="sxs-lookup"><span data-stu-id="f68d8-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="f68d8-202">O `Products` GridView recupera seus dados para exibição invocando o método `Select` do `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f68d8-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="f68d8-203">Esse ObjectDataSource cria uma instância da classe de `ProductsBLL` da camada de lógica de negócios e chama seu método `GetProducts()`, que por sua vez chama o método de `GetProducts()` de camada de acesso a dados s `ProductsTableAdapter` s.</span><span class="sxs-lookup"><span data-stu-id="f68d8-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="f68d8-204">O método DAL conecta-se ao banco de dados Northwind e emite a consulta de `SELECT` configurada.</span><span class="sxs-lookup"><span data-stu-id="f68d8-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="f68d8-205">Esses dados são retornados para a DAL, que o empacota em um `NorthwindDataTable`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="f68d8-206">O objeto DataTable é retornado para a BLL, que retorna para o ObjectDataSource, que o retorna para o GridView.</span><span class="sxs-lookup"><span data-stu-id="f68d8-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="f68d8-207">Em seguida, o GridView cria um objeto `GridViewRow` para cada `DataRow` na DataTable, e cada `GridViewRow` é eventualmente renderizado no HTML que é retornado ao cliente e exibido no navegador do visitante.</span><span class="sxs-lookup"><span data-stu-id="f68d8-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="f68d8-208">Essa sequência de eventos acontece cada uma e toda vez que o GridView precisa se associar aos seus dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="f68d8-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="f68d8-209">Isso acontece quando a página é visitada pela primeira vez, ao mover de uma página de dados para outra, ao classificar o GridView ou ao modificar os dados de GridView por meio de suas interfaces internas de edição ou exclusão.</span><span class="sxs-lookup"><span data-stu-id="f68d8-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="f68d8-210">Se o estado de exibição de GridView s estiver desabilitado, o GridView será reassociado em cada e todos os postbacks também.</span><span class="sxs-lookup"><span data-stu-id="f68d8-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="f68d8-211">O GridView também pode ser reassociado explicitamente a seus dados chamando seu método `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="f68d8-212">Para apreciar totalmente a frequência com que os dados são recuperados do banco de dados, vamos exibir uma mensagem indicando quando os dados estão sendo recuperados novamente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="f68d8-213">Adicione um controle de rótulo da Web acima do GridView chamado `ODSEvents`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="f68d8-214">Desmarque sua propriedade `Text` e defina sua propriedade `EnableViewState` como `False`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="f68d8-215">Abaixo do rótulo, adicione um controle de botão da Web e defina sua propriedade `Text` como postback.</span><span class="sxs-lookup"><span data-stu-id="f68d8-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="f68d8-216">[![adicionar um rótulo e um botão à página acima do GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="f68d8-217">**Figura 8**: adicionar um rótulo e um botão à página acima do GridView ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="f68d8-218">Durante o fluxo de trabalho de acesso a dados, o evento ObjectDataSource s `Selecting` é disparado antes de o objeto subjacente ser criado e seu método configurado invocado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="f68d8-219">Crie um manipulador de eventos para esse evento e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="f68d8-219">Create an event handler for this event and add the following code:</span></span>

[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="f68d8-220">Cada vez que o ObjectDataSource faz uma solicitação para a arquitetura de dados, o rótulo exibirá o texto que seleciona o evento disparado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="f68d8-221">Visite esta página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="f68d8-221">Visit this page in a browser.</span></span> <span data-ttu-id="f68d8-222">Quando a página é visitada pela primeira vez, o evento de seleção de texto acionado é mostrado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="f68d8-223">Clique no botão postback e observe que o texto desaparece (supondo que a Propriedade GridView s `EnableViewState` esteja definida como `True`, o padrão).</span><span class="sxs-lookup"><span data-stu-id="f68d8-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="f68d8-224">Isso ocorre porque, no postback, o GridView é reconstruído a partir de seu estado de exibição e, portanto, não é ativado para o ObjectDataSource para seus dados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="f68d8-225">No entanto, classificar, paginar ou editar os dados faz com que o GridView reassocie a sua fonte de dados e, portanto, o texto de seleção disparado é exibido novamente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="f68d8-226">[![sempre que GridView é reassociado à sua fonte de dados, selecionar evento disparado é exibido](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="f68d8-227">**Figura 9**: sempre que GridView é reassociado à sua fonte de dados, selecionar o evento disparado é exibido ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>

<span data-ttu-id="f68d8-228">[![clicar no botão postback faz com que o GridView seja reconstruído a partir de seu estado de exibição](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="f68d8-229">**Figura 10**: clicar no botão postback faz com que o GridView seja reconstruído a partir de seu estado de exibição ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>

<span data-ttu-id="f68d8-230">Pode parecer um desperdício recuperar os dados do banco cada vez que os dados são paginados ou classificados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="f68d8-231">Afinal, como reutilizamos a paginação padrão, o ObjectDataSource recuperou todos os registros ao exibir a primeira página.</span><span class="sxs-lookup"><span data-stu-id="f68d8-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="f68d8-232">Mesmo que o GridView não forneça suporte à classificação e à paginação, os dados deverão ser recuperados do banco cada vez que a página for visitada pela primeira vez por qualquer usuário (e em cada postagem, se o estado de exibição estiver desabilitado).</span><span class="sxs-lookup"><span data-stu-id="f68d8-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="f68d8-233">Mas se GridView estiver mostrando os mesmos dados a todos os usuários, essas solicitações de banco de dados extras serão supérfluas.</span><span class="sxs-lookup"><span data-stu-id="f68d8-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="f68d8-234">Por que não armazenar em cache os resultados retornados do método `GetProducts()` e associar o GridView a esses resultados armazenados em cache?</span><span class="sxs-lookup"><span data-stu-id="f68d8-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="f68d8-235">Etapa 4: armazenar em cache os dados usando o ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="f68d8-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="f68d8-236">Simplesmente definindo algumas propriedades, o ObjectDataSource pode ser configurado para armazenar em cache automaticamente seus dados recuperados no cache de dados ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f68d8-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="f68d8-237">A lista a seguir resume as propriedades relacionadas ao cache de ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="f68d8-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="f68d8-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) deve ser definido como `True` para habilitar o Caching.</span><span class="sxs-lookup"><span data-stu-id="f68d8-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="f68d8-239">O padrão é `False`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-239">The default is `False`.</span></span>
- <span data-ttu-id="f68d8-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) a quantidade de tempo, em segundos, em que os dados são armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="f68d8-241">O padrão é 0.</span><span class="sxs-lookup"><span data-stu-id="f68d8-241">The default is 0.</span></span> <span data-ttu-id="f68d8-242">O ObjectDataSource só armazenará os dados em cache se `EnableCaching` estiver `True` e `CacheDuration` for definido como um valor maior que zero.</span><span class="sxs-lookup"><span data-stu-id="f68d8-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="f68d8-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) pode ser definido como `Absolute` ou `Sliding`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="f68d8-244">Se `Absolute`, o ObjectDataSource armazenará em cache seus dados recuperados por `CacheDuration` segundos; se `Sliding`, os dados expirarão somente depois que não tiverem sido acessados por `CacheDuration` segundos.</span><span class="sxs-lookup"><span data-stu-id="f68d8-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="f68d8-245">O padrão é `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="f68d8-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) Use essa propriedade para associar as entradas de cache ObjectDataSource s a uma dependência de cache existente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="f68d8-247">As entradas de dados de ObjectDataSource s podem ser removidas prematuramente do cache, expirando seu `CacheKeyDependency`associado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="f68d8-248">Essa propriedade é mais comumente usada para associar uma dependência de cache do SQL ao cache ObjectDataSource s, um tópico que exploraremos no futuro usando o tutorial de [dependências do cache do SQL](using-sql-cache-dependencies-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="f68d8-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="f68d8-249">Deixe que os s configurem o `ProductsDataSource` ObjectDataSource para armazenar em cache seus dados por 30 segundos em uma escala absoluta.</span><span class="sxs-lookup"><span data-stu-id="f68d8-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="f68d8-250">Defina a Propriedade ObjectDataSource s `EnableCaching` como `True` e sua propriedade `CacheDuration` como 30.</span><span class="sxs-lookup"><span data-stu-id="f68d8-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="f68d8-251">Deixe a propriedade `CacheExpirationPolicy` definida como seu padrão, `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="f68d8-252">[![configurar o ObjectDataSource para armazenar em cache seus dados por 30 segundos](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="f68d8-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="f68d8-253">**Figura 11**: configurar o ObjectDataSource para armazenar em cache seus dados por 30 segundos ([clique para exibir a imagem em tamanho normal](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="f68d8-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>

<span data-ttu-id="f68d8-254">Salve suas alterações e revisite esta página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="f68d8-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="f68d8-255">O texto de seleção acionado será exibido quando você visitar a página pela primeira vez, pois inicialmente os dados não estão no cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="f68d8-256">Mas os postbacks subsequentes disparados clicando no botão postback, classificando, paginando ou clicando nos botões editar ou *Cancelar não* exibem novamente o texto de seleção acionado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="f68d8-257">Isso ocorre porque o evento `Selecting` só é acionado quando o ObjectDataSource obtém seus dados de seu objeto subjacente; o evento `Selecting` não será acionado se os dados forem extraídos do cache de dados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="f68d8-258">Após 30 segundos, os dados serão removidos do cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="f68d8-259">Os dados também serão removidos do cache se os métodos ObjectDataSource s `Insert`, `Update`ou `Delete` forem invocados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="f68d8-260">Consequentemente, depois de 30 segundos ou o botão de atualização ter sido clicado, classificar, paginar ou clicar nos botões editar ou cancelar fará com que o ObjectDataSource obtenha seus dados de seu objeto subjacente, exibindo o evento selecionando o texto acionado quando o evento `Selecting` for acionado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="f68d8-261">Esses resultados retornados são colocados de volta no cache de dados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="f68d8-262">Se você vir o texto de seleção acionado com frequência, mesmo quando espera que o ObjectDataSource esteja trabalhando com dados armazenados em cache, pode ser devido a restrições de memória.</span><span class="sxs-lookup"><span data-stu-id="f68d8-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="f68d8-263">Se não houver memória livre suficiente, os dados adicionados ao cache pelo ObjectDataSource podem ter sido eliminados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="f68d8-264">Se a ObjectDataSource não parecer armazenar os dados em cache corretamente ou apenas armazenar os dados de forma esporádica, feche alguns aplicativos para liberar memória e tente novamente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="f68d8-265">A Figura 12 ilustra o fluxo de trabalho de cache do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f68d8-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="f68d8-266">Quando o texto de seleção disparado é exibido na tela, isso ocorre porque os dados não estavam no cache e tiveram que ser recuperados do objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="f68d8-267">No entanto, quando esse texto está ausente, ele ocorre porque os dados estavam disponíveis no cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="f68d8-268">Quando os dados são retornados do cache, não há nenhuma chamada para o objeto subjacente e, portanto, nenhuma consulta de banco de dados foi executada.</span><span class="sxs-lookup"><span data-stu-id="f68d8-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![O ObjectDataSource armazena e recupera seus dados do cache de dados](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="f68d8-270">**Figura 12**: o ObjectDataSource armazena e recupera seus dados do cache de dados</span><span class="sxs-lookup"><span data-stu-id="f68d8-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="f68d8-271">Cada aplicativo ASP.NET tem sua própria instância de cache de dados que s compartilhou em todas as páginas e visitantes.</span><span class="sxs-lookup"><span data-stu-id="f68d8-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="f68d8-272">Isso significa que os dados armazenados no cache de dados pelo ObjectDataSource, da mesma forma, são compartilhados entre todos os usuários que visitam a página.</span><span class="sxs-lookup"><span data-stu-id="f68d8-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="f68d8-273">Para verificar isso, abra a página `ObjectDataSource.aspx` em um navegador.</span><span class="sxs-lookup"><span data-stu-id="f68d8-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="f68d8-274">Ao visitar a página pela primeira vez, o texto de seleção disparado será exibido (supondo que os dados adicionados ao cache pelos testes anteriores tenham sido removidos agora).</span><span class="sxs-lookup"><span data-stu-id="f68d8-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="f68d8-275">Abra uma segunda instância do navegador e copie e cole a URL da primeira instância do navegador para a segunda.</span><span class="sxs-lookup"><span data-stu-id="f68d8-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="f68d8-276">Na segunda instância do navegador, o texto de seleção acionado não é mostrado porque ele usa os mesmos dados armazenados em cache como o primeiro.</span><span class="sxs-lookup"><span data-stu-id="f68d8-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="f68d8-277">Ao inserir seus dados recuperados no cache, o ObjectDataSource usa um valor de chave de cache que inclui: os valores de propriedade `CacheDuration` e `CacheExpirationPolicy`; o tipo do objeto comercial subjacente que está sendo usado pelo ObjectDataSource, que é especificado por meio da [propriedade`TypeName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, neste exemplo); o valor da propriedade `SelectMethod` e o nome e os valores dos parâmetros na coleção `SelectParameters`; e os valores de suas propriedades `StartRowIndex` e `MaximumRows`, que são usadas na implementação de [paginação personalizada](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="f68d8-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="f68d8-278">A criação do valor da chave de cache como uma combinação dessas propriedades garante uma entrada de cache exclusiva à medida que esses valores forem alterados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="f68d8-279">Por exemplo, nos tutoriais anteriores, veremos como usar o `GetProductsByCategoryID(categoryID)`da classe `ProductsBLL`, que retorna todos os produtos de uma categoria especificada.</span><span class="sxs-lookup"><span data-stu-id="f68d8-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="f68d8-280">Um usuário pode chegar à página e exibir bebidas, que tem um `CategoryID` de 1.</span><span class="sxs-lookup"><span data-stu-id="f68d8-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="f68d8-281">Se o ObjectDataSource armazenar em cache seus resultados sem considerar os valores de `SelectParameters`, quando outro usuário vier à página para exibir condiments enquanto os produtos de bebidas estivessem no cache, eles d verão os produtos de bebidas em cache em vez de condiments.</span><span class="sxs-lookup"><span data-stu-id="f68d8-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="f68d8-282">Variando a chave de cache por essas propriedades, que incluem os valores da `SelectParameters`, o ObjectDataSource mantém uma entrada de cache separada para bebidas e condiments.</span><span class="sxs-lookup"><span data-stu-id="f68d8-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="f68d8-283">Problemas de dados obsoletos</span><span class="sxs-lookup"><span data-stu-id="f68d8-283">Stale Data Concerns</span></span>

<span data-ttu-id="f68d8-284">O ObjectDataSource remove automaticamente seus itens do cache quando qualquer um de seus métodos `Insert`, `Update`ou `Delete` é invocado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="f68d8-285">Isso ajuda a proteger contra dados obsoletos limpando as entradas de cache quando os dados são modificados por meio da página.</span><span class="sxs-lookup"><span data-stu-id="f68d8-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="f68d8-286">No entanto, é possível que um ObjectDataSource usando Caching ainda exiba dados obsoletos.</span><span class="sxs-lookup"><span data-stu-id="f68d8-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="f68d8-287">No caso mais simples, pode ser devido à alteração de dados diretamente no banco de dado.</span><span class="sxs-lookup"><span data-stu-id="f68d8-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="f68d8-288">Talvez um administrador de banco de dados simplesmente executasse um script que modificasse alguns dos registros no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f68d8-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="f68d8-289">Esse cenário também pode desdobrar de maneira mais sutil.</span><span class="sxs-lookup"><span data-stu-id="f68d8-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="f68d8-290">Enquanto o ObjectDataSource remove seus itens do cache quando um de seus métodos de modificação de dados é chamado, os itens armazenados em cache removidos são para a combinação de valores de propriedade de ObjectDataSource s (`CacheDuration`, `TypeName`, `SelectMethod`e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="f68d8-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="f68d8-291">Se você tiver duas objectdatasources que usam diferentes `SelectMethods` ou `SelectParameters`, mas ainda puder atualizar os mesmos dados, um ObjectDataSource poderá atualizar uma linha e invalidar suas próprias entradas de cache, mas a linha correspondente para o segundo ObjectDataSource ainda será servida a partir do cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="f68d8-292">Recomendo que você crie páginas para exibir essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="f68d8-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="f68d8-293">Crie uma página que exibe um GridView editável que extrai seus dados de um ObjectDataSource que usa Caching e está configurado para obter dados do método de `GetProducts()` da classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="f68d8-294">Adicione outro GridView editável e ObjectDataSource a esta página (ou outra), mas, para esse segundo ObjectDataSource, use o método `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="f68d8-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="f68d8-295">Como as duas propriedades de `SelectMethod` ObjectDataSource são diferentes, elas têm seus próprios valores armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="f68d8-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="f68d8-296">Se você editar um produto em uma grade, na próxima vez que vincular os dados de volta à outra grade (por paginação, classificação e assim por diante), ele ainda servirá os dados antigos armazenados em cache e não refletirá a alteração feita na outra grade.</span><span class="sxs-lookup"><span data-stu-id="f68d8-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="f68d8-297">Em suma, use somente expirações baseadas em tempo se você estiver disposto a ter o potencial de dados obsoletos e usar expirações menores para cenários em que a atualização de dados é importante.</span><span class="sxs-lookup"><span data-stu-id="f68d8-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="f68d8-298">Se os dados obsoletos não forem aceitáveis, abrem mão o cache ou use as dependências de cache do SQL (supondo-se que os dados do banco que você armazenam em cache</span><span class="sxs-lookup"><span data-stu-id="f68d8-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="f68d8-299">Exploraremos as dependências do cache do SQL em um tutorial futuro.</span><span class="sxs-lookup"><span data-stu-id="f68d8-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="f68d8-300">Resumo</span><span class="sxs-lookup"><span data-stu-id="f68d8-300">Summary</span></span>

<span data-ttu-id="f68d8-301">Neste tutorial, examinamos as funcionalidades de cache internas do ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="f68d8-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="f68d8-302">Simplesmente definindo algumas propriedades, podemos instruir o ObjectDataSource a armazenar em cache os resultados retornados do `SelectMethod` especificado no cache de dados ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f68d8-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="f68d8-303">As propriedades `CacheDuration` e `CacheExpirationPolicy` indicam a duração em que o item é armazenado em cache e se é uma expiração absoluta ou deslizante.</span><span class="sxs-lookup"><span data-stu-id="f68d8-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="f68d8-304">A propriedade `CacheKeyDependency` associa todas as entradas de cache ObjectDataSource s a uma dependência de cache existente.</span><span class="sxs-lookup"><span data-stu-id="f68d8-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="f68d8-305">Isso pode ser usado para remover as entradas de ObjectDataSource s do cache antes que a expiração baseada em tempo seja atingida e normalmente é usada com dependências de cache do SQL.</span><span class="sxs-lookup"><span data-stu-id="f68d8-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="f68d8-306">Como o ObjectDataSource simplesmente armazena em cache seus valores no cache de dados, poderíamos replicar a funcionalidade interna de ObjectDataSource s de forma programática.</span><span class="sxs-lookup"><span data-stu-id="f68d8-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="f68d8-307">Não faz sentido fazer isso na camada de apresentação, já que o ObjectDataSource oferece essa funcionalidade pronta para uso, mas podemos implementar recursos de cache em uma camada separada da arquitetura.</span><span class="sxs-lookup"><span data-stu-id="f68d8-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="f68d8-308">Para fazer isso, precisaremos repetir a mesma lógica usada pelo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f68d8-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="f68d8-309">Exploraremos como trabalhar programaticamente com o cache de dados de dentro da arquitetura em nosso próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="f68d8-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="f68d8-310">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="f68d8-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="f68d8-311">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="f68d8-311">Further Reading</span></span>

<span data-ttu-id="f68d8-312">Para obter mais informações sobre os tópicos discutidos neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="f68d8-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f68d8-313">Cache ASP.NET: técnicas e práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="f68d8-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="f68d8-314">Guia de arquitetura de caching para aplicativos .NET Framework</span><span class="sxs-lookup"><span data-stu-id="f68d8-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="f68d8-315">Cache de saída no ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="f68d8-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="f68d8-316">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="f68d8-316">About the Author</span></span>

<span data-ttu-id="f68d8-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="f68d8-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f68d8-318">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="f68d8-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f68d8-319">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f68d8-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f68d8-320">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f68d8-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f68d8-321">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f68d8-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f68d8-322">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="f68d8-322">Special Thanks To</span></span>

<span data-ttu-id="f68d8-323">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="f68d8-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f68d8-324">O revisor de Lead para este tutorial foi Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="f68d8-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="f68d8-325">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="f68d8-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f68d8-326">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f68d8-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f68d8-327">[Anterior](using-sql-cache-dependencies-cs.md)
> [Próximo](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f68d8-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
