---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb
title: Uma visão geral da edição e exclusão de dados no DataList (VB) | Microsoft Docs
author: rick-anderson
description: Embora o DataList não tenha recursos internos de edição e exclusão, neste tutorial, veremos como criar um DataList com suporte para editar e excluir o...
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 9410a23c-9697-4f07-bd71-e62b0ceac655
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 49b09cbf0f12f7c7233c3bb2a8b3b2c073bf117e
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74573192"
---
# <a name="an-overview-of-editing-and-deleting-data-in-the-datalist-vb"></a><span data-ttu-id="84b16-103">Uma visão geral da edição e exclusão de dados no DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="84b16-103">An Overview of Editing and Deleting Data in the DataList (VB)</span></span>

<span data-ttu-id="84b16-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="84b16-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="84b16-105">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_VB.exe) ou [baixar PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/datatutorial36vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="84b16-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_VB.exe) or [Download PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/datatutorial36vb1.pdf)</span></span>

> <span data-ttu-id="84b16-106">Embora o DataList não tenha recursos internos de edição e exclusão, neste tutorial, veremos como criar um DataList que dá suporte à edição e exclusão de seus dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="84b16-106">While the DataList lacks built-in editing and deleting capabilities, in this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span>

## <a name="introduction"></a><span data-ttu-id="84b16-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="84b16-107">Introduction</span></span>

<span data-ttu-id="84b16-108">Na [visão geral do tutorial inserir, atualizar e excluir dados](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) , examinamos como inserir, atualizar e excluir dados usando a arquitetura do aplicativo, um ObjectDataSource e os controles GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="84b16-108">In the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial we looked at how to insert, update, and delete data using the application architecture, an ObjectDataSource, and the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="84b16-109">Com o ObjectDataSource e esses três controles da Web de dados, a implementação de interfaces simples de modificação de dados foi um ajuste e envolveva apenas a marcação de uma caixa de seleção de uma marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="84b16-109">With the ObjectDataSource and these three data Web controls, implementing simple data modification interfaces was a snap and involved merely ticking a checkbox from a smart tag.</span></span> <span data-ttu-id="84b16-110">Nenhum código precisa ser gravado.</span><span class="sxs-lookup"><span data-stu-id="84b16-110">No code needed to be written.</span></span>

<span data-ttu-id="84b16-111">Infelizmente, o DataList não tem os recursos internos de edição e exclusão inerentes ao controle GridView.</span><span class="sxs-lookup"><span data-stu-id="84b16-111">Unfortunately, the DataList lacks the built-in editing and deleting capabilities inherent in the GridView control.</span></span> <span data-ttu-id="84b16-112">Essa funcionalidade ausente é devido, em parte, ao fato de que o DataList é um Relic da versão anterior do ASP.NET, quando os controles de fonte de dados declarativos e as páginas de modificação de dados sem código não estavam disponíveis.</span><span class="sxs-lookup"><span data-stu-id="84b16-112">This missing functionality is due in part to the fact that the DataList is a relic from the previous version of ASP.NET, when declarative data source controls and code-free data modification pages were unavailable.</span></span> <span data-ttu-id="84b16-113">Embora o DataList no ASP.NET 2,0 não ofereça os mesmos recursos de modificação de dados prontos para uso que o GridView, podemos usar as técnicas do ASP.NET 1. x para incluir essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="84b16-113">While the DataList in ASP.NET 2.0 does not offer the same out of the box data modification capabilities as the GridView, we can use ASP.NET 1.x techniques to include such functionality.</span></span> <span data-ttu-id="84b16-114">Essa abordagem requer um pouco de código, mas como veremos neste tutorial, o DataList tem alguns eventos e propriedades em vigor para auxiliar nesse processo.</span><span class="sxs-lookup"><span data-stu-id="84b16-114">This approach requires a bit of code but, as we'll see in this tutorial, the DataList has some events and properties in place to aid in this process.</span></span>

<span data-ttu-id="84b16-115">Neste tutorial, veremos como criar um DataList que dá suporte à edição e exclusão de seus dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="84b16-115">In this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span> <span data-ttu-id="84b16-116">Os tutoriais futuros examinarão os cenários de edição e exclusão mais avançados, incluindo a validação do campo de entrada, tratando normalmente as exceções geradas por camadas de acesso a dados ou lógica de negócios e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="84b16-116">Future tutorials will examine more advanced editing and deleting scenarios, including input field validation, gracefully handling exceptions raised from the Data Access or Business Logic Layers, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="84b16-117">Como o DataList, o controle Repeater não tem a funcionalidade pronta para uso para inserção, atualização ou exclusão.</span><span class="sxs-lookup"><span data-stu-id="84b16-117">Like the DataList, the Repeater control lacks the out of the box functionality for inserting, updating, or deleting.</span></span> <span data-ttu-id="84b16-118">Embora essa funcionalidade possa ser adicionada, o DataList inclui propriedades e eventos não encontrados no repetidor que simplificam a adição desses recursos.</span><span class="sxs-lookup"><span data-stu-id="84b16-118">While such functionality can be added, the DataList includes properties and events not found in the Repeater that simplify adding such capabilities.</span></span> <span data-ttu-id="84b16-119">Portanto, este tutorial e os futuros que examinam a edição e a exclusão se concentrarão estritamente no DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-119">Therefore, this tutorial and future ones that look at editing and deleting will focus strictly on the DataList.</span></span>

## <a name="step-1-creating-the-editing-and-deleting-tutorials-web-pages"></a><span data-ttu-id="84b16-120">Etapa 1: criando as páginas da Web de tutoriais de edição e exclusão</span><span class="sxs-lookup"><span data-stu-id="84b16-120">Step 1: Creating the Editing and Deleting Tutorials Web Pages</span></span>

<span data-ttu-id="84b16-121">Antes de começarmos a explorar como atualizar e excluir dados de um DataList, vamos primeiro reservar um momento para criar as páginas do ASP.NET em nosso projeto de site, que precisaremos para este tutorial e as próximas várias delas.</span><span class="sxs-lookup"><span data-stu-id="84b16-121">Before we start exploring how to update and delete data from a DataList, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="84b16-122">Comece adicionando uma nova pasta chamada `EditDeleteDataList`.</span><span class="sxs-lookup"><span data-stu-id="84b16-122">Start by adding a new folder named `EditDeleteDataList`.</span></span> <span data-ttu-id="84b16-123">Em seguida, adicione as seguintes páginas ASP.NET a essa pasta, assegurando a associação de cada página com a página mestra `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="84b16-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `BatchUpdate.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![Adicionar as páginas ASP.NET para os tutoriais](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image1.png)

<span data-ttu-id="84b16-125">**Figura 1**: adicionar as páginas ASP.net para os tutoriais</span><span class="sxs-lookup"><span data-stu-id="84b16-125">**Figure 1**: Add the ASP.NET Pages for the Tutorials</span></span>

<span data-ttu-id="84b16-126">Assim como nas outras pastas, `Default.aspx` na pasta `EditDeleteDataList` lista os tutoriais em sua seção.</span><span class="sxs-lookup"><span data-stu-id="84b16-126">Like in the other folders, `Default.aspx` in the `EditDeleteDataList` folder lists the tutorials in its section.</span></span> <span data-ttu-id="84b16-127">Lembre-se de que o controle de usuário `SectionLevelTutorialListing.ascx` fornece essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="84b16-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="84b16-128">Portanto, adicione esse controle de usuário a `Default.aspx` arrastando-o da Gerenciador de Soluções para a página s modo de exibição de Design.</span><span class="sxs-lookup"><span data-stu-id="84b16-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="84b16-129">[![adicionar o controle de usuário SectionLevelTutorialListing. ascx a default. aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image2.png)</span></span>

<span data-ttu-id="84b16-130">**Figura 2**: Adicionar o controle de usuário `SectionLevelTutorialListing.ascx` ao `Default.aspx` ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image4.png))</span></span>

<span data-ttu-id="84b16-131">Por fim, adicione as páginas como entradas ao arquivo de `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="84b16-131">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="84b16-132">Especificamente, adicione a seguinte marcação após os relatórios mestre/de detalhes com o DataList e o repetidor `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="84b16-132">Specifically, add the following markup after the Master/Detail Reports with the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample1.xml)]

<span data-ttu-id="84b16-133">Depois de atualizar `Web.sitemap`, Reserve um momento para exibir o site de tutoriais por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="84b16-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="84b16-134">O menu à esquerda agora inclui itens para os tutoriais de edição e exclusão de DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-134">The menu on the left now includes items for the DataList editing and deleting tutorials.</span></span>

![O mapa do site agora inclui entradas para os tutoriais de edição e exclusão de DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image5.png)

<span data-ttu-id="84b16-136">**Figura 3**: o mapa do site agora inclui entradas para os tutoriais de edição e exclusão de DataList</span><span class="sxs-lookup"><span data-stu-id="84b16-136">**Figure 3**: The Site Map Now Includes Entries for the DataList Editing and Deleting Tutorials</span></span>

## <a name="step-2-examining-techniques-for-updating-and-deleting-data"></a><span data-ttu-id="84b16-137">Etapa 2: examinando técnicas para atualizar e excluir dados</span><span class="sxs-lookup"><span data-stu-id="84b16-137">Step 2: Examining Techniques for Updating and Deleting Data</span></span>

<span data-ttu-id="84b16-138">Editar e excluir dados com o GridView é tão fácil porque, sob os bastidores, o GridView e o ObjectDataSource funcionam em conjunto.</span><span class="sxs-lookup"><span data-stu-id="84b16-138">Editing and deleting data with the GridView is so easy because, underneath the covers, the GridView and ObjectDataSource work in concert.</span></span> <span data-ttu-id="84b16-139">Conforme discutido no tutorial [examinando os eventos associados com inserção, atualização e exclusão](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) , quando um botão de atualização de linha s é clicado, o GridView atribui automaticamente seus campos que usaram a ligação de dados bidirecional à coleção de `UpdateParameters` de seu ObjectDataSource e, em seguida, invoca esse método objectdatasource s `Update()`.</span><span class="sxs-lookup"><span data-stu-id="84b16-139">As discussed in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, when a row s Update button is clicked, the GridView automatically assigns its fields that used two-way databinding to the `UpdateParameters` collection of its ObjectDataSource and then invokes that ObjectDataSource s `Update()` method.</span></span>

<span data-ttu-id="84b16-140">Infelizmente, o DataList não fornece nenhuma dessas funcionalidades internas.</span><span class="sxs-lookup"><span data-stu-id="84b16-140">Sadly, the DataList does not provide any of this built-in functionality.</span></span> <span data-ttu-id="84b16-141">É nossa responsabilidade garantir que os valores de s do usuário sejam atribuídos aos parâmetros de ObjectDataSource s e que seu método `Update()` seja chamado.</span><span class="sxs-lookup"><span data-stu-id="84b16-141">It is our responsibility to ensure that the user s values are assigned to the ObjectDataSource s parameters and that its `Update()` method is called.</span></span> <span data-ttu-id="84b16-142">Para nos ajudar nessa tarefa, o DataList fornece as seguintes propriedades e eventos:</span><span class="sxs-lookup"><span data-stu-id="84b16-142">To aid us in this endeavor, the DataList provides the following properties and events:</span></span>

- <span data-ttu-id="84b16-143">**A [Propriedade`DataKeyField`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)**  ao atualizar ou excluir, precisamos ser capaz de identificar exclusivamente cada item no DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-143">**The [`DataKeyField` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** when updating or deleting, we need to be able to uniquely identify each item in the DataList.</span></span> <span data-ttu-id="84b16-144">Defina essa propriedade como o campo de chave primária dos dados exibidos.</span><span class="sxs-lookup"><span data-stu-id="84b16-144">Set this property to the primary key field of the displayed data.</span></span> <span data-ttu-id="84b16-145">Isso irá preencher a coleção DataList s [`DataKeys`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) com o valor de `DataKeyField` especificado para cada item DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-145">Doing so will populate the DataList s [`DataKeys` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) with the specified `DataKeyField` value for each DataList item.</span></span>
- <span data-ttu-id="84b16-146">**O [evento`EditCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)**  é acionado quando um Button, LinkButton ou ImageButton cuja propriedade `CommandName` é definida como Edit é clicado.</span><span class="sxs-lookup"><span data-stu-id="84b16-146">**The [`EditCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Edit is clicked.</span></span>
- <span data-ttu-id="84b16-147">**O [evento`CancelCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)**  é acionado quando um Button, LinkButton ou ImageButton cuja propriedade `CommandName` é definida como Cancel é clicado.</span><span class="sxs-lookup"><span data-stu-id="84b16-147">**The [`CancelCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Cancel is clicked.</span></span>
- <span data-ttu-id="84b16-148">**O [evento`UpdateCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)**  é acionado quando um Button, LinkButton ou ImageButton cuja propriedade `CommandName` está definida como Update é clicada.</span><span class="sxs-lookup"><span data-stu-id="84b16-148">**The [`UpdateCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Update is clicked.</span></span>
- <span data-ttu-id="84b16-149">**O [evento`DeleteCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)**  é acionado quando um Button, LinkButton ou ImageButton cuja propriedade `CommandName` está definida como Delete é clicado.</span><span class="sxs-lookup"><span data-stu-id="84b16-149">**The [`DeleteCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete is clicked.</span></span>

<span data-ttu-id="84b16-150">Usando essas propriedades e eventos, há quatro abordagens que podemos usar para atualizar e excluir dados do DataList:</span><span class="sxs-lookup"><span data-stu-id="84b16-150">Using these properties and events, there are four approaches we can use to update and delete data from the DataList:</span></span>

1. <span data-ttu-id="84b16-151">**Usando as técnicas ASP.NET 1. x** , o DataList existia antes do ASP.NET 2,0 e do ObjectDataSource e foi capaz de atualizar e excluir dados inteiramente por meio de meios programáticos.</span><span class="sxs-lookup"><span data-stu-id="84b16-151">**Using ASP.NET 1.x Techniques** the DataList existed prior to ASP.NET 2.0 and ObjectDataSources and was able to update and delete data entirely through programmatic means.</span></span> <span data-ttu-id="84b16-152">Essa técnica Ditches a ObjectDataSource e requer que associemos os dados ao DataList diretamente da camada de lógica de negócios, na recuperação dos dados a serem exibidos e ao atualizar ou excluir um registro.</span><span class="sxs-lookup"><span data-stu-id="84b16-152">This technique ditches the ObjectDataSource altogether and requires that we bind the data to the DataList directly from the Business Logic Layer, both in retrieving the data to display and when updating or deleting a record.</span></span>
2. <span data-ttu-id="84b16-153">**Usando um único controle ObjectDataSource na página para seleção, atualização e exclusão** enquanto o DataList não tem os recursos de edição e exclusão inerentes ao GridView, não há motivo para não adicioná-los por si mesmos.</span><span class="sxs-lookup"><span data-stu-id="84b16-153">**Using a Single ObjectDataSource Control on the Page for Selecting, Updating, and Deleting** while the DataList lacks the GridView s inherent editing and deleting capabilities, there s no reason we can t add them in ourselves.</span></span> <span data-ttu-id="84b16-154">Com essa abordagem, usamos um ObjectDataSource exatamente como nos exemplos de GridView, mas devemos criar um manipulador de eventos para o evento DataList s `UpdateCommand` em que definimos os parâmetros de ObjectDataSource s e chamamos seu método `Update()`.</span><span class="sxs-lookup"><span data-stu-id="84b16-154">With this approach, we use an ObjectDataSource just like in the GridView examples, but must create an event handler for the DataList s `UpdateCommand` event where we set the ObjectDataSource s parameters and call its `Update()` method.</span></span>
3. <span data-ttu-id="84b16-155">**Usando um controle ObjectDataSource para selecionar, mas atualizar e excluir diretamente em relação à BLL** ao usar a opção 2, precisamos escrever um pouco de código no evento `UpdateCommand`, atribuindo valores de parâmetro e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="84b16-155">**Using an ObjectDataSource Control for Selecting, but Updating and Deleting Directly Against the BLL** when using option 2, we need to write a bit of code in the `UpdateCommand` event, assigning parameter values and so on.</span></span> <span data-ttu-id="84b16-156">Em vez disso, podemos usar o ObjectDataSource para selecionar, mas fazer as chamadas de atualização e exclusão diretamente em relação à BLL (como com a opção 1).</span><span class="sxs-lookup"><span data-stu-id="84b16-156">Instead, we can stick with using the ObjectDataSource for selecting, but make the updating and deleting calls directly against the BLL (like with option 1).</span></span> <span data-ttu-id="84b16-157">Na minha opinião, a atualização de dados por meio da interface direta com a BLL leva a um código mais legível do que a atribuição do `UpdateParameters` ObjectDataSource s e a chamada de seu método `Update()`.</span><span class="sxs-lookup"><span data-stu-id="84b16-157">In my opinion, updating data by interfacing directly with the BLL leads to more readable code than assigning the ObjectDataSource s `UpdateParameters` and calling its `Update()` method.</span></span>
4. <span data-ttu-id="84b16-158">**Usando significados declarativos por meio de várias ObjectDataSource** , as três abordagens anteriores exigem um pouco de código.</span><span class="sxs-lookup"><span data-stu-id="84b16-158">**Using Declarative Means through Multiple ObjectDataSources** the previous three approaches all require a bit of code.</span></span> <span data-ttu-id="84b16-159">Se você d preferir usar o máximo de sintaxe declarativa possível, uma opção final será incluir vários objectdatasources na página.</span><span class="sxs-lookup"><span data-stu-id="84b16-159">If you d rather keep using as much declarative syntax as possible, a final option is to include multiple ObjectDataSources on the page.</span></span> <span data-ttu-id="84b16-160">O primeiro ObjectDataSource recupera os dados da BLL e os associa ao DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-160">The first ObjectDataSource retrieves the data from the BLL and binds it to the DataList.</span></span> <span data-ttu-id="84b16-161">Para atualização, outro ObjectDataSource é adicionado, mas adicionado diretamente dentro do `EditItemTemplate`de DataList s.</span><span class="sxs-lookup"><span data-stu-id="84b16-161">For updating, another ObjectDataSource is added, but added directly within the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="84b16-162">Para incluir o suporte à exclusão, ainda é necessário outro ObjectDataSource no `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-162">To include deleting support, yet another ObjectDataSource would be needed in the `ItemTemplate`.</span></span> <span data-ttu-id="84b16-163">Com essa abordagem, essas s ObjectDataSource inseridas usam `ControlParameters` para associar declarativamente os parâmetros de ObjectDataSource s aos controles de entrada do usuário (em vez de ter que especificá-los programaticamente no manipulador de eventos do s `UpdateCommand`).</span><span class="sxs-lookup"><span data-stu-id="84b16-163">With this approach, these embedded ObjectDataSource s use `ControlParameters` to declaratively bind the ObjectDataSource s parameters to the user input controls (rather than having to specify them programmatically in the DataList s `UpdateCommand` event handler).</span></span> <span data-ttu-id="84b16-164">Essa abordagem ainda requer um pouco de código que precisamos para chamar o comando ObjectDataSource s `Update()` ou `Delete()`, mas que exige muito menos do que com as outras três abordagens.</span><span class="sxs-lookup"><span data-stu-id="84b16-164">This approach still requires a bit of code we need to call the embedded ObjectDataSource s `Update()` or `Delete()` command but requires far less than with the other three approaches.</span></span> <span data-ttu-id="84b16-165">A desvantagem aqui é que as várias objectdatasources desorganizam a página, prejudicando a legibilidade geral.</span><span class="sxs-lookup"><span data-stu-id="84b16-165">The downside here is that the multiple ObjectDataSources do clutter up the page, detracting from the overall readability.</span></span>

<span data-ttu-id="84b16-166">Se forçada a usar apenas uma dessas abordagens, eu escolho a opção 1 porque ela fornece mais flexibilidade e porque o DataList foi originalmente projetado para acomodar esse padrão.</span><span class="sxs-lookup"><span data-stu-id="84b16-166">If forced to only ever use one of these approaches, I d choose option 1 because it provides the most flexibility and because the DataList was originally designed to accommodate this pattern.</span></span> <span data-ttu-id="84b16-167">Embora o DataList tenha sido estendido para funcionar com os controles de fonte de dados ASP.NET 2,0, ele não tem todos os pontos de extensibilidade ou recursos dos controles da Web de dados oficiais do ASP.NET 2,0 (GridView, DetailsView e FormView).</span><span class="sxs-lookup"><span data-stu-id="84b16-167">While the DataList was extended to work with the ASP.NET 2.0 data source controls, it does not have all of the extensibility points or features of the official ASP.NET 2.0 data Web controls (the GridView, DetailsView, and FormView).</span></span> <span data-ttu-id="84b16-168">No entanto, as opções 2 a 4 não estão sem mérito.</span><span class="sxs-lookup"><span data-stu-id="84b16-168">Options 2 through 4 are not without merit, though.</span></span>

<span data-ttu-id="84b16-169">Este e os tutoriais de edição e exclusão futuros usarão um ObjectDataSource para recuperar os dados para exibir e direcionar chamadas para a BLL para atualizar e excluir dados (opção 3).</span><span class="sxs-lookup"><span data-stu-id="84b16-169">This and the future editing and deleting tutorials will use an ObjectDataSource for retrieving the data to display and direct calls to the BLL to update and delete data (option 3).</span></span>

## <a name="step-3-adding-the-datalist-and-configuring-its-objectdatasource"></a><span data-ttu-id="84b16-170">Etapa 3: adicionando o DataList e configurando seu ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="84b16-170">Step 3: Adding the DataList and Configuring its ObjectDataSource</span></span>

<span data-ttu-id="84b16-171">Neste tutorial, criaremos um DataList que lista informações sobre produtos e, para cada produto, fornece ao usuário a capacidade de editar o nome e o preço e excluir o produto completamente.</span><span class="sxs-lookup"><span data-stu-id="84b16-171">In this tutorial we will create a DataList that lists product information and, for each product, provides the user the ability to edit the name and price and to delete the product altogether.</span></span> <span data-ttu-id="84b16-172">Em particular, recuperaremos os registros a serem exibidos usando um ObjectDataSource, mas executaremos as ações Update e Delete fazendo a interface direta com a BLL.</span><span class="sxs-lookup"><span data-stu-id="84b16-172">In particular, we will retrieve the records to display using an ObjectDataSource, but perform the update and delete actions by interfacing directly with the BLL.</span></span> <span data-ttu-id="84b16-173">Antes de nos preocuparmos em implementar os recursos de edição e exclusão para o DataList, vamos primeiro obter a página para exibir os produtos em uma interface somente leitura.</span><span class="sxs-lookup"><span data-stu-id="84b16-173">Before we worry about implementing the editing and deleting capabilities to the DataList, let s first get the page to display the products in a read-only interface.</span></span> <span data-ttu-id="84b16-174">Como examinamos essas etapas nos tutoriais anteriores, passarei por elas rapidamente.</span><span class="sxs-lookup"><span data-stu-id="84b16-174">Since we ve examined these steps in previous tutorials, I'll proceed through them quickly.</span></span>

<span data-ttu-id="84b16-175">Comece abrindo a página de `Basics.aspx` na pasta `EditDeleteDataList` e, na modo de exibição de Design, adicione uma DataList à página.</span><span class="sxs-lookup"><span data-stu-id="84b16-175">Start by opening the `Basics.aspx` page in the `EditDeleteDataList` folder and, from the Design view, add a DataList to the page.</span></span> <span data-ttu-id="84b16-176">Em seguida, na marca inteligente DataList s, crie um novo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="84b16-176">Next, from the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="84b16-177">Como estamos trabalhando com os dados do produto, configure-o para usar a classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="84b16-177">Since we are working with product data, configure it to use the `ProductsBLL` class.</span></span> <span data-ttu-id="84b16-178">Para recuperar *todos os* produtos, escolha o método `GetProducts()` na guia selecionar.</span><span class="sxs-lookup"><span data-stu-id="84b16-178">To retrieve *all* products, choose the `GetProducts()` method in the SELECT tab.</span></span>

<span data-ttu-id="84b16-179">[![configurar o ObjectDataSource para usar a classe ProductsBLL](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-179">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image6.png)</span></span>

<span data-ttu-id="84b16-180">**Figura 4**: configurar o ObjectDataSource para usar a classe `ProductsBLL` ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-180">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image8.png))</span></span>

<span data-ttu-id="84b16-181">[![retornar as informações do produto usando o método GetProducts ()](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-181">[![Return the Product Information Using the GetProducts() Method](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image9.png)</span></span>

<span data-ttu-id="84b16-182">**Figura 5**: retornar as informações do produto usando o método `GetProducts()` ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-182">**Figure 5**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image11.png))</span></span>

<span data-ttu-id="84b16-183">O DataList, como o GridView, não foi projetado para inserir novos dados; Portanto, selecione a opção (nenhum) na lista suspensa na guia Inserir. Além disso, escolha (nenhum) para as guias atualizar e excluir, pois as atualizações e exclusões serão executadas programaticamente por meio da BLL.</span><span class="sxs-lookup"><span data-stu-id="84b16-183">The DataList, like the GridView, is not designed for inserting new data; therefore, select the (None) option from the drop-down list in the INSERT tab. Also choose (None) for the UPDATE and DELETE tabs since the updates and deletes will be performed programmatically through the BLL.</span></span>

<span data-ttu-id="84b16-184">[![confirmar se as listas suspensas nas guias ObjectDataSource s INSERT, UPDATE e DELETE são definidas como (None)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-184">[![Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image12.png)</span></span>

<span data-ttu-id="84b16-185">**Figura 6**: Confirme se as listas suspensas nas guias OBJECTDATASOURCE s INSERT, Update e Delete estão definidas como (None) ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-185">**Figure 6**: Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None) ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image14.png))</span></span>

<span data-ttu-id="84b16-186">Depois de configurar o ObjectDataSource, clique em concluir, retornando ao designer.</span><span class="sxs-lookup"><span data-stu-id="84b16-186">After configuring the ObjectDataSource, click Finish, returning to the Designer.</span></span> <span data-ttu-id="84b16-187">Como vimos nos exemplos anteriores, ao concluir a configuração de ObjectDataSource, o Visual Studio cria automaticamente um `ItemTemplate` para DropDownList, exibindo cada um dos campos de dados.</span><span class="sxs-lookup"><span data-stu-id="84b16-187">As we ve seen in past examples, when completing the ObjectDataSource configuration, Visual Studio automatically creates an `ItemTemplate` for the DropDownList, displaying each of the data fields.</span></span> <span data-ttu-id="84b16-188">Substitua essa `ItemTemplate` por uma que exibe apenas o nome e o preço do produto.</span><span class="sxs-lookup"><span data-stu-id="84b16-188">Replace this `ItemTemplate` with one that displays only the product s name and price.</span></span> <span data-ttu-id="84b16-189">Além disso, defina a propriedade `RepeatColumns` como 2.</span><span class="sxs-lookup"><span data-stu-id="84b16-189">Also, set the `RepeatColumns` property to 2.</span></span>

> [!NOTE]
> <span data-ttu-id="84b16-190">Conforme discutido na *visão geral do tutorial inserir, atualizar e excluir dados* , ao modificar dados usando o ObjectDataSource, nossa arquitetura exige que removamos a propriedade `OldValuesParameterFormatString` da marcação declarativa s de ObjectDataSource (ou redefina-a para seu valor padrão, `{0}`).</span><span class="sxs-lookup"><span data-stu-id="84b16-190">As discussed in the *Overview of Inserting, Updating, and Deleting Data* tutorial, when modifying data using the ObjectDataSource our architecture requires that we remove the `OldValuesParameterFormatString` property from the ObjectDataSource s declarative markup (or reset it to its default value, `{0}`).</span></span> <span data-ttu-id="84b16-191">Neste tutorial, no entanto, estamos usando o ObjectDataSource somente para recuperar dados.</span><span class="sxs-lookup"><span data-stu-id="84b16-191">In this tutorial, however, we are using the ObjectDataSource only for retrieving data.</span></span> <span data-ttu-id="84b16-192">Portanto, não precisamos modificar o valor da Propriedade ObjectDataSource s `OldValuesParameterFormatString` (embora não atrapalhe isso).</span><span class="sxs-lookup"><span data-stu-id="84b16-192">Therefore, we do not need to modify the ObjectDataSource s `OldValuesParameterFormatString` property value (although it doesn t hurt to do so).</span></span>

<span data-ttu-id="84b16-193">Depois de substituir o `ItemTemplate` DataList padrão por um personalizado, a marcação declarativa em sua página deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="84b16-193">After replacing the default DataList `ItemTemplate` with a customized one, the declarative markup on your page should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="84b16-194">Reserve um tempo para exibir nosso progresso por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="84b16-194">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="84b16-195">Como mostra a Figura 7, o DataList exibe o nome do produto e o preço unitário de cada produto em duas colunas.</span><span class="sxs-lookup"><span data-stu-id="84b16-195">As Figure 7 shows, the DataList displays the product name and unit price for each product in two columns.</span></span>

<span data-ttu-id="84b16-196">[![os nomes e os preços dos produtos são exibidos em um DataList de duas colunas](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-196">[![The Products Names and Prices are Displayed in a Two-Column DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image15.png)</span></span>

<span data-ttu-id="84b16-197">**Figura 7**: os nomes e os preços dos produtos são exibidos em um DataList de duas colunas ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-197">**Figure 7**: The Products Names and Prices are Displayed in a Two-Column DataList ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image17.png))</span></span>

> [!NOTE]
> <span data-ttu-id="84b16-198">O DataList tem um número de propriedades que são necessárias para o processo de atualização e exclusão, e esses valores são armazenados em estado de exibição.</span><span class="sxs-lookup"><span data-stu-id="84b16-198">The DataList has a number of properties that are required for the updating and deleting process, and these values are stored in view state.</span></span> <span data-ttu-id="84b16-199">Portanto, ao criar um DataList que ofereça suporte à edição ou exclusão de dados, é essencial que o estado de exibição DataList s esteja habilitado.</span><span class="sxs-lookup"><span data-stu-id="84b16-199">Therefore, when building a DataList that supports editing or deleting data, it is essential that the DataList s view state be enabled.</span></span>  
>   
> <span data-ttu-id="84b16-200">O leitor do astuto pode se lembrar de que pudemos desabilitar o estado de exibição ao criar GridViews editáveis, DetailsViews e FormViews.</span><span class="sxs-lookup"><span data-stu-id="84b16-200">The astute reader may recall that we were able to disable view state when creating editable GridViews, DetailsViews, and FormViews.</span></span> <span data-ttu-id="84b16-201">Isso ocorre porque os controles da Web do ASP.NET 2,0 podem incluir o *estado do controle*, que é persistido em postagens como o estado de exibição, mas considerado essencial.</span><span class="sxs-lookup"><span data-stu-id="84b16-201">This is because ASP.NET 2.0 Web controls can include *control state*, which is state persisted across postbacks like view state, but deemed essential.</span></span>

<span data-ttu-id="84b16-202">Desabilitar o estado de exibição no GridView meramente omite informações de estado trivial, mas mantém o estado de controle (que inclui o estado necessário para edição e exclusão).</span><span class="sxs-lookup"><span data-stu-id="84b16-202">Disabling view state in the GridView merely omits trivial state information, but maintains the control state (which includes the state necessary for editing and deleting).</span></span> <span data-ttu-id="84b16-203">O DataList, que tinha sido criado no período de tempo ASP.NET 1. x, não utiliza o estado de controle e, portanto, deve ter o estado de exibição habilitado.</span><span class="sxs-lookup"><span data-stu-id="84b16-203">The DataList, having been created in the ASP.NET 1.x timeframe, does not utilize control state and therefore must have view state enabled.</span></span> <span data-ttu-id="84b16-204">Consulte estado de [controle versus estado de exibição](https://msdn.microsoft.com/library/1whwt1k7.aspx) para obter mais informações sobre a finalidade do estado de controle e como ele difere do estado de exibição.</span><span class="sxs-lookup"><span data-stu-id="84b16-204">See [Control State vs. View State](https://msdn.microsoft.com/library/1whwt1k7.aspx) for more information on the purpose of control state and how it differs from view state.</span></span>

## <a name="step-4-adding-an-editing-user-interface"></a><span data-ttu-id="84b16-205">Etapa 4: adicionando uma interface do usuário de edição</span><span class="sxs-lookup"><span data-stu-id="84b16-205">Step 4: Adding an Editing User Interface</span></span>

<span data-ttu-id="84b16-206">O controle GridView é composto de uma coleção de campos (BoundFields, CheckBoxFields, TemplateFields e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="84b16-206">The GridView control is composed of a collection of fields (BoundFields, CheckBoxFields, TemplateFields, and so on).</span></span> <span data-ttu-id="84b16-207">Esses campos podem ajustar sua marcação renderizada dependendo do seu modo.</span><span class="sxs-lookup"><span data-stu-id="84b16-207">These fields can adjust their rendered markup depending on their mode.</span></span> <span data-ttu-id="84b16-208">Por exemplo, quando no modo somente leitura, um BoundField exibe seu valor de campo de dados como texto; no modo de edição, ele renderiza um controle da Web TextBox cuja propriedade `Text` é atribuído ao valor do campo de dados.</span><span class="sxs-lookup"><span data-stu-id="84b16-208">For example, when in read-only mode, a BoundField displays its data field value as text; when in edit mode, it renders a TextBox Web control whose `Text` property is assigned the data field value.</span></span>

<span data-ttu-id="84b16-209">O DataList, por outro lado, renderiza seus itens usando modelos.</span><span class="sxs-lookup"><span data-stu-id="84b16-209">The DataList, on the other hand, renders its items using templates.</span></span> <span data-ttu-id="84b16-210">Os itens somente leitura são renderizados usando o `ItemTemplate`, enquanto os itens no modo de edição são renderizados por meio do `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-210">Read-only items are rendered using the `ItemTemplate` whereas items in edit mode are rendered via the `EditItemTemplate`.</span></span> <span data-ttu-id="84b16-211">Neste ponto, nosso DataList tem apenas um `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-211">At this point, our DataList has only an `ItemTemplate`.</span></span> <span data-ttu-id="84b16-212">Para dar suporte à funcionalidade de edição no nível de item, precisamos adicionar um `EditItemTemplate` que contém a marcação a ser exibida para o item editável.</span><span class="sxs-lookup"><span data-stu-id="84b16-212">To support item-level editing functionality we need to add an `EditItemTemplate` that contains the markup to be displayed for the editable item.</span></span> <span data-ttu-id="84b16-213">Para este tutorial, usaremos os controles da Web TextBox para editar o nome e o preço unitário do produto.</span><span class="sxs-lookup"><span data-stu-id="84b16-213">For this tutorial, we'll use TextBox Web controls for editing the product s name and unit price.</span></span>

<span data-ttu-id="84b16-214">O `EditItemTemplate` pode ser criado de forma declarativa ou por meio do designer (selecionando a opção Editar modelos na marca inteligente DataList s).</span><span class="sxs-lookup"><span data-stu-id="84b16-214">The `EditItemTemplate` can be created either declaratively or through the Designer (by selecting the Edit Templates option from the DataList s smart tag).</span></span> <span data-ttu-id="84b16-215">Para usar a opção Editar modelos, primeiro clique no link editar modelos na marca inteligente e, em seguida, selecione o `EditItemTemplate` item na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="84b16-215">To use the Edit Templates option, first click the Edit Templates link in the smart tag and then select the `EditItemTemplate` item from the drop-down list.</span></span>

<span data-ttu-id="84b16-216">[![optar por trabalhar com o controle DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-216">[![Opt to Work with the DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image18.png)</span></span>

<span data-ttu-id="84b16-217">**Figura 8**: optar por trabalhar com o `EditItemTemplate` s de DataList ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-217">**Figure 8**: Opt to Work with the DataList s `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image20.png))</span></span>

<span data-ttu-id="84b16-218">Em seguida, digite o nome do produto: e Price: e arraste dois controles TextBox da caixa de ferramentas para a interface `EditItemTemplate` no designer.</span><span class="sxs-lookup"><span data-stu-id="84b16-218">Next, type in Product name: and Price: and then drag two TextBox controls from the Toolbox into the `EditItemTemplate` interface on the Designer.</span></span> <span data-ttu-id="84b16-219">Defina as caixas de entrada `ID` propriedades como `ProductName` e `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="84b16-219">Set the TextBoxes `ID` properties to `ProductName` and `UnitPrice`.</span></span>

<span data-ttu-id="84b16-220">[![adicionar uma caixa de texto para o nome e o preço do produto](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-220">[![Add a TextBox for the Product s Name and Price](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image21.png)</span></span>

<span data-ttu-id="84b16-221">**Figura 9**: adicionar uma caixa de texto para o nome e o preço do produto ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-221">**Figure 9**: Add a TextBox for the Product s Name and Price ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image23.png))</span></span>

<span data-ttu-id="84b16-222">Precisamos associar os valores do campo de dados do produto correspondente às propriedades `Text` das duas caixas de entrada.</span><span class="sxs-lookup"><span data-stu-id="84b16-222">We need to bind the corresponding product data field values to the `Text` properties of the two TextBoxes.</span></span> <span data-ttu-id="84b16-223">Nas marcas inteligentes de TextBoxes, clique no link editar DataBindings e associe o campo de dados apropriado com a propriedade `Text`, conforme mostrado na Figura 10.</span><span class="sxs-lookup"><span data-stu-id="84b16-223">From the TextBoxes smart tags, click on the Edit DataBindings link and then associate the appropriate data field with the `Text` property, as shown in Figure 10.</span></span>

> [!NOTE]
> <span data-ttu-id="84b16-224">Ao vincular o campo de dados de `UnitPrice` ao campo `Text` da caixa de texto de preços, você pode formatá-lo como um valor de moeda (`{0:C}`), um número geral (`{0:N}`) ou deixá-lo não formatado.</span><span class="sxs-lookup"><span data-stu-id="84b16-224">When binding the `UnitPrice` data field to the price TextBox s `Text` field, you may format it as a currency value (`{0:C}`), a general number (`{0:N}`), or leave it unformatted.</span></span>

![Associar os campos de dados NomeDoProduto e UnitPrice às propriedades Text das caixas de texto](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image24.png)

<span data-ttu-id="84b16-226">**Figura 10**: associar os campos de dados `ProductName` e `UnitPrice` às propriedades `Text` das caixas de entrada</span><span class="sxs-lookup"><span data-stu-id="84b16-226">**Figure 10**: Bind the `ProductName` and `UnitPrice` Data Fields to the `Text` Properties of the TextBoxes</span></span>

<span data-ttu-id="84b16-227">Observe como a caixa de diálogo Editar DataBindings na Figura 10 *não inclui a* CheckBox de ligação de dados bidirecional que está presente ao editar um TemplateField em GridView ou DetailsView, ou um modelo no FormView.</span><span class="sxs-lookup"><span data-stu-id="84b16-227">Notice how the Edit DataBindings dialog box in Figure 10 does *not* include the Two-way databinding checkbox that is present when editing a TemplateField in the GridView or DetailsView, or a template in the FormView.</span></span> <span data-ttu-id="84b16-228">O recurso de ligação de dados bidirecional permitia que o valor inserido no controle da Web de entrada fosse atribuído automaticamente à `InsertParameters` ObjectDataSource s correspondente ou `UpdateParameters` ao inserir ou atualizar dados.</span><span class="sxs-lookup"><span data-stu-id="84b16-228">The two-way databinding feature allowed the value entered into the input Web control to be automatically assigned to the corresponding ObjectDataSource s `InsertParameters` or `UpdateParameters` when inserting or updating data.</span></span> <span data-ttu-id="84b16-229">O DataList não dá suporte à ligação de dados bidirecional, como veremos mais adiante neste tutorial, depois que o usuário fizer suas alterações e estiver pronto para atualizar os dados, precisaremos acessar esses TextBoxes de forma programática `Text` Propriedades e passar seus valores para o método `UpdateProduct` apropriado na classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="84b16-229">The DataList does not support two-way databinding as we'll see later on in this tutorial, after the user makes her changes and is ready to update the data, we will need to programmatically access these TextBoxes `Text` properties and pass in their values to the appropriate `UpdateProduct` method in the `ProductsBLL` class.</span></span>

<span data-ttu-id="84b16-230">Por fim, precisamos adicionar os botões Update e Cancel ao `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-230">Finally, we need to add Update and Cancel buttons to the `EditItemTemplate`.</span></span> <span data-ttu-id="84b16-231">Como vimos no [mestre/detalhes usando uma lista com marcadores de registros mestres com um tutorial DataList detalhes](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) , quando um Button, LinkButton ou ImageButton cuja propriedade `CommandName` é definida é clicado em um Repeater ou DataList, o evento Repeater ou datalist s `ItemCommand` é gerado.</span><span class="sxs-lookup"><span data-stu-id="84b16-231">As we saw in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial, when a Button, LinkButton, or ImageButton whose `CommandName` property is set is clicked from within a Repeater or DataList, the Repeater or DataList s `ItemCommand` event is raised.</span></span> <span data-ttu-id="84b16-232">Para o DataList, se a propriedade `CommandName` for definida como um determinado valor, um evento adicional também poderá ser gerado.</span><span class="sxs-lookup"><span data-stu-id="84b16-232">For the DataList, if the `CommandName` property is set to a certain value, an additional event may be raised as well.</span></span> <span data-ttu-id="84b16-233">Os valores de propriedade de `CommandName` especiais incluem, entre outros:</span><span class="sxs-lookup"><span data-stu-id="84b16-233">The special `CommandName` property values include, among others:</span></span>

- <span data-ttu-id="84b16-234">Cancelar gera o evento `CancelCommand`</span><span class="sxs-lookup"><span data-stu-id="84b16-234">Cancel raises the `CancelCommand` event</span></span>
- <span data-ttu-id="84b16-235">Editar gera o evento `EditCommand`</span><span class="sxs-lookup"><span data-stu-id="84b16-235">Edit raises the `EditCommand` event</span></span>
- <span data-ttu-id="84b16-236">A atualização gera o evento `UpdateCommand`</span><span class="sxs-lookup"><span data-stu-id="84b16-236">Update raises the `UpdateCommand` event</span></span>

<span data-ttu-id="84b16-237">Tenha em mente que esses eventos *são gerados além* do evento `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="84b16-237">Keep in mind that these events are raised *in addition to* the `ItemCommand` event.</span></span>

<span data-ttu-id="84b16-238">Adicione ao `EditItemTemplate` dois botões de controles da Web, um cujo `CommandName` está definido como atualizar e os outros s definidos como cancelar.</span><span class="sxs-lookup"><span data-stu-id="84b16-238">Add to the `EditItemTemplate` two Button Web controls, one whose `CommandName` is set to Update and the other s set to Cancel.</span></span> <span data-ttu-id="84b16-239">Depois de adicionar esses dois controles de botão da Web, o designer deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="84b16-239">After adding these two Button Web controls the Designer should look similar to the following:</span></span>

<span data-ttu-id="84b16-240">[![adicionar os botões atualizar e cancelar ao EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-240">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="84b16-241">**Figura 11**: adicionar os botões atualizar e cancelar à `EditItemTemplate` ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-241">**Figure 11**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image27.png))</span></span>

<span data-ttu-id="84b16-242">Com o `EditItemTemplate` concluir, a marcação declarativa s de DataList deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="84b16-242">With the `EditItemTemplate` complete your DataList s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample3.aspx)]

## <a name="step-5-adding-the-plumbing-to-enter-edit-mode"></a><span data-ttu-id="84b16-243">Etapa 5: Adicionar o encanamento para entrar no modo de edição</span><span class="sxs-lookup"><span data-stu-id="84b16-243">Step 5: Adding the Plumbing to Enter Edit Mode</span></span>

<span data-ttu-id="84b16-244">Neste ponto, nosso DataList tem uma interface de edição definida por meio de sua `EditItemTemplate`; no entanto, atualmente, não há nenhuma maneira de um usuário visitar nossa página para indicar que ele deseja editar as informações de um produto.</span><span class="sxs-lookup"><span data-stu-id="84b16-244">At this point our DataList has an editing interface defined via its `EditItemTemplate`; however, there s currently no way for a user visiting our page to indicate that he wants to edit a product s information.</span></span> <span data-ttu-id="84b16-245">Precisamos adicionar um botão de edição a cada produto que, quando clicado, renderiza esse item DataList no modo de edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-245">We need to add an Edit button to each product that, when clicked, renders that DataList item in edit mode.</span></span> <span data-ttu-id="84b16-246">Comece adicionando um botão de edição à `ItemTemplate`, seja por meio do designer ou declarativamente.</span><span class="sxs-lookup"><span data-stu-id="84b16-246">Start by adding an Edit button to the `ItemTemplate`, either through the Designer or declaratively.</span></span> <span data-ttu-id="84b16-247">Certifique-se de definir a propriedade s `CommandName` do botão Editar para editar.</span><span class="sxs-lookup"><span data-stu-id="84b16-247">Be certain to set the Edit button s `CommandName` property to Edit .</span></span>

<span data-ttu-id="84b16-248">Depois de adicionar esse botão de edição, Reserve um momento para exibir a página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="84b16-248">After you have added this Edit button, take a moment to view the page through a browser.</span></span> <span data-ttu-id="84b16-249">Com essa adição, cada listagem de produto deve incluir um botão de edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-249">With this addition, each product listing should include an Edit button.</span></span>

<span data-ttu-id="84b16-250">[![adicionar os botões atualizar e cancelar ao EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-250">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image28.png)</span></span>

<span data-ttu-id="84b16-251">**Figura 12**: adicionar os botões atualizar e cancelar à `EditItemTemplate` ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-251">**Figure 12**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image30.png))</span></span>

<span data-ttu-id="84b16-252">Clicar no botão causa um postback, mas *não* coloca a listagem do produto no modo de edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-252">Clicking the button causes a postback, but does *not* bring the product listing into edit mode.</span></span> <span data-ttu-id="84b16-253">Para tornar o produto editável, precisamos:</span><span class="sxs-lookup"><span data-stu-id="84b16-253">To make the product editable, we need to:</span></span>

1. <span data-ttu-id="84b16-254">Defina a propriedade DataList s [`EditItemIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) como o índice do `DataListItem` cujo botão de edição foi clicado apenas.</span><span class="sxs-lookup"><span data-stu-id="84b16-254">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of the `DataListItem` whose Edit button was just clicked.</span></span>
2. <span data-ttu-id="84b16-255">Reassocie os dados ao DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-255">Rebind the data to the DataList.</span></span> <span data-ttu-id="84b16-256">Quando o DataList é renderizado novamente, o `DataListItem` cujas `ItemIndex` corresponde à `EditItemIndex` DataList s será renderizada usando seu `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-256">When the DataList is re-rendered, the `DataListItem` whose `ItemIndex` corresponds with the DataList s `EditItemIndex` will render using its `EditItemTemplate`.</span></span>

<span data-ttu-id="84b16-257">Como o evento DataList s `EditCommand` é acionado quando o botão de edição é clicado, crie um manipulador de eventos `EditCommand` com o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="84b16-257">Since the DataList s `EditCommand` event is fired when the Edit button is clicked, create an `EditCommand` event handler with the following code:</span></span>

[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample4.vb)]

<span data-ttu-id="84b16-258">O manipulador de eventos `EditCommand` é passado em um objeto do tipo `DataListCommandEventArgs` como seu segundo parâmetro de entrada, que inclui uma referência à `DataListItem` com o qual o botão de edição foi clicado (`e.Item`).</span><span class="sxs-lookup"><span data-stu-id="84b16-258">The `EditCommand` event handler is passed in an object of type `DataListCommandEventArgs` as its second input parameter, which includes a reference to the `DataListItem` whose Edit button was clicked (`e.Item`).</span></span> <span data-ttu-id="84b16-259">O manipulador de eventos primeiro define os `EditItemIndex` DataList para a `ItemIndex` do `DataListItem` editável e, em seguida, reassocia os dados ao DataList chamando o método DataList s `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="84b16-259">The event handler first sets the DataList s `EditItemIndex` to the `ItemIndex` of the editable `DataListItem` and then rebinds the data to the DataList by calling the DataList s `DataBind()` method.</span></span>

<span data-ttu-id="84b16-260">Depois de adicionar esse manipulador de eventos, reveja a página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="84b16-260">After adding this event handler, revisit the page in a browser.</span></span> <span data-ttu-id="84b16-261">Clicar no botão Editar agora torna editável o produto clicado (consulte a Figura 13).</span><span class="sxs-lookup"><span data-stu-id="84b16-261">Clicking the Edit button now makes the clicked product editable (see Figure 13).</span></span>

<span data-ttu-id="84b16-262">[![clicar no botão Editar torna o produto editável](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-262">[![Clicking the Edit Button Makes the Product Editable](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image31.png)</span></span>

<span data-ttu-id="84b16-263">**Figura 13**: clicar no botão Editar torna o produto editável ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-263">**Figure 13**: Clicking the Edit Button Makes the Product Editable ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image33.png))</span></span>

## <a name="step-6-saving-the-user-s-changes"></a><span data-ttu-id="84b16-264">Etapa 6: salvar as alterações de s do usuário</span><span class="sxs-lookup"><span data-stu-id="84b16-264">Step 6: Saving the User s Changes</span></span>

<span data-ttu-id="84b16-265">Clicar nos botões atualizar ou cancelar do produto editado não faz nada neste ponto; para adicionar essa funcionalidade, precisamos criar manipuladores de eventos para os eventos DataList s `UpdateCommand` e `CancelCommand`.</span><span class="sxs-lookup"><span data-stu-id="84b16-265">Clicking the edited product s Update or Cancel buttons does nothing at this point; to add this functionality we need to create event handlers for the DataList s `UpdateCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="84b16-266">Comece criando o manipulador de eventos `CancelCommand`, que será executado quando o botão Cancelar do produto editado for clicado e ele tiver a tarefa de retornar o DataList para seu estado de pré-edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-266">Start by creating the `CancelCommand` event handler, which will execute when the edited product s Cancel button is clicked and it tasked with returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="84b16-267">Para que o DataList processe todos os seus itens no modo somente leitura, precisamos:</span><span class="sxs-lookup"><span data-stu-id="84b16-267">To have the DataList render all of its items in the read-only mode, we need to:</span></span>

1. <span data-ttu-id="84b16-268">Defina a propriedade DataList s [`EditItemIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) como o índice de um índice `DataListItem` não existente.</span><span class="sxs-lookup"><span data-stu-id="84b16-268">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="84b16-269">`-1` é uma opção segura, já que os índices de `DataListItem` começam em `0`.</span><span class="sxs-lookup"><span data-stu-id="84b16-269">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
2. <span data-ttu-id="84b16-270">Reassocie os dados ao DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-270">Rebind the data to the DataList.</span></span> <span data-ttu-id="84b16-271">Como nenhum `DataListItem` `ItemIndex` es corresponde à `EditItemIndex`DataList s, o DataList inteiro será renderizado em um modo somente leitura.</span><span class="sxs-lookup"><span data-stu-id="84b16-271">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="84b16-272">Essas etapas podem ser realizadas com o seguinte código de manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="84b16-272">These steps can be accomplished with the following event handler code:</span></span>

[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample5.vb)]

<span data-ttu-id="84b16-273">Com essa adição, clicar no botão Cancelar retorna o DataList ao seu estado de pré-edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-273">With this addition, clicking the Cancel button returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="84b16-274">O último manipulador de eventos que precisamos concluir é o manipulador de eventos `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="84b16-274">The last event handler we need to complete is the `UpdateCommand` event handler.</span></span> <span data-ttu-id="84b16-275">Este manipulador de eventos precisa:</span><span class="sxs-lookup"><span data-stu-id="84b16-275">This event handler needs to:</span></span>

1. <span data-ttu-id="84b16-276">Acesse programaticamente o nome do produto e o preço digitados pelo usuário, bem como os s `ProductID`do produto editado.</span><span class="sxs-lookup"><span data-stu-id="84b16-276">Programmatically access the user-entered product name and price as well as the edited product s `ProductID`.</span></span>
2. <span data-ttu-id="84b16-277">Inicie o processo de atualização chamando a sobrecarga de `UpdateProduct` apropriada na classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="84b16-277">Initiate the update process by calling the appropriate `UpdateProduct` overload in the `ProductsBLL` class.</span></span>
3. <span data-ttu-id="84b16-278">Defina a propriedade DataList s [`EditItemIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) como o índice de um índice `DataListItem` não existente.</span><span class="sxs-lookup"><span data-stu-id="84b16-278">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="84b16-279">`-1` é uma opção segura, já que os índices de `DataListItem` começam em `0`.</span><span class="sxs-lookup"><span data-stu-id="84b16-279">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
4. <span data-ttu-id="84b16-280">Reassocie os dados ao DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-280">Rebind the data to the DataList.</span></span> <span data-ttu-id="84b16-281">Como nenhum `DataListItem` `ItemIndex` es corresponde à `EditItemIndex`DataList s, o DataList inteiro será renderizado em um modo somente leitura.</span><span class="sxs-lookup"><span data-stu-id="84b16-281">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="84b16-282">As etapas 1 e 2 são responsáveis por salvar as alterações de s do usuário; as etapas 3 e 4 retornam o DataList para seu estado de pré-edição depois que as alterações foram salvas e são idênticas às etapas executadas no manipulador de eventos `CancelCommand`.</span><span class="sxs-lookup"><span data-stu-id="84b16-282">Steps 1 and 2 are responsible for saving the user s changes; steps 3 and 4 return the DataList to its pre-editing state after the changes have been saved and are identical to the steps performed in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="84b16-283">Para obter o nome e o preço do produto atualizado, precisamos usar o método `FindControl` para fazer referência programaticamente aos controles da Web TextBox dentro do `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-283">To get the updated product name and price, we need to use the `FindControl` method to programmatically reference the TextBox Web controls within the `EditItemTemplate`.</span></span> <span data-ttu-id="84b16-284">Também precisamos obter o valor de `ProductID` do produto editado.</span><span class="sxs-lookup"><span data-stu-id="84b16-284">We also need to get the edited product s `ProductID` value.</span></span> <span data-ttu-id="84b16-285">Quando vinculamos inicialmente o ObjectDataSource ao DataList, o Visual Studio atribuiu a propriedade DataList s `DataKeyField` ao valor de chave primária da fonte de dados (`ProductID`).</span><span class="sxs-lookup"><span data-stu-id="84b16-285">When we initially bound the ObjectDataSource to the DataList, Visual Studio assigned the DataList s `DataKeyField` property to the primary key value from the data source (`ProductID`).</span></span> <span data-ttu-id="84b16-286">Esse valor pode então ser recuperado da coleção DataList s `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="84b16-286">This value can then be retrieved from the DataList s `DataKeys` collection.</span></span> <span data-ttu-id="84b16-287">Reserve um tempo para garantir que a propriedade `DataKeyField` realmente esteja definida como `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="84b16-287">Take a moment to ensure that the `DataKeyField` property is indeed set to `ProductID`.</span></span>

<span data-ttu-id="84b16-288">O código a seguir implementa as quatro etapas:</span><span class="sxs-lookup"><span data-stu-id="84b16-288">The following code implements the four steps:</span></span>

[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="84b16-289">O manipulador de eventos começa lendo no `ProductID` do produto editado na coleção de `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="84b16-289">The event handler starts by reading in the edited product s `ProductID` from the `DataKeys` collection.</span></span> <span data-ttu-id="84b16-290">Em seguida, as duas caixas de textna `EditItemTemplate` são referenciadas e suas propriedades de `Text` armazenadas em variáveis locais, `productNameValue` e `unitPriceValue`.</span><span class="sxs-lookup"><span data-stu-id="84b16-290">Next, the two TextBoxes in the `EditItemTemplate` are referenced and their `Text` properties stored in local variables, `productNameValue` and `unitPriceValue`.</span></span> <span data-ttu-id="84b16-291">Usamos o método `Decimal.Parse()` para ler o valor da caixa de texto `UnitPrice` de forma que, se o valor inserido tiver um símbolo de moeda, ele ainda poderá ser convertido corretamente em um valor de `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="84b16-291">We use the `Decimal.Parse()` method to read the value from the `UnitPrice` TextBox so that if the value entered has a currency symbol, it can still be correctly converted into a `Decimal` value.</span></span>

> [!NOTE]
> <span data-ttu-id="84b16-292">Os valores das caixas de texto `ProductName` e `UnitPrice` são atribuídos somente às variáveis productNamevalue e unitPricevalue, se as propriedades Text TextBoxes tiverem um valor especificado.</span><span class="sxs-lookup"><span data-stu-id="84b16-292">The values from the `ProductName` and `UnitPrice` TextBoxes are only assigned to the productNameValue and unitPriceValue variables if the TextBoxes Text properties have a value specified.</span></span> <span data-ttu-id="84b16-293">Caso contrário, um valor de `Nothing` é usado para as variáveis, que tem o efeito de atualizar os dados com um valor de banco de `NULL`.</span><span class="sxs-lookup"><span data-stu-id="84b16-293">Otherwise, a value of `Nothing` is used for the variables, which has the effect of updating the data with a database `NULL` value.</span></span> <span data-ttu-id="84b16-294">Ou seja, nosso código trata a conversão de cadeias de caracteres vazias em valores de `NULL` de banco de dados, que é o comportamento padrão da interface de edição nos controles GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="84b16-294">That is, our code treats converts empty strings to database `NULL` values, which is the default behavior of the editing interface in the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="84b16-295">Depois de ler os valores, a classe `ProductsBLL` s `UpdateProduct` método é chamado, passando o nome, o preço e o `ProductID`do produto.</span><span class="sxs-lookup"><span data-stu-id="84b16-295">After reading the values, the `ProductsBLL` class s `UpdateProduct` method is called, passing in the product s name, price, and `ProductID`.</span></span> <span data-ttu-id="84b16-296">O manipulador de eventos é concluído retornando o DataList para seu estado de pré-edição usando exatamente a mesma lógica que o manipulador de eventos `CancelCommand`.</span><span class="sxs-lookup"><span data-stu-id="84b16-296">The event handler completes by returning the DataList to its pre-editing state using the exact same logic as in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="84b16-297">Com os manipuladores de eventos `EditCommand`, `CancelCommand`e `UpdateCommand` concluídos, um visitante pode editar o nome e o preço de um produto.</span><span class="sxs-lookup"><span data-stu-id="84b16-297">With the `EditCommand`, `CancelCommand`, and `UpdateCommand` event handlers complete, a visitor can edit the name and price of a product.</span></span> <span data-ttu-id="84b16-298">As figuras 14-16 mostram esse fluxo de trabalho de edição em ação.</span><span class="sxs-lookup"><span data-stu-id="84b16-298">Figures 14-16 show this editing workflow in action.</span></span>

<span data-ttu-id="84b16-299">[![ao visitar a página pela primeira vez, todos os produtos estão no modo somente leitura](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-299">[![When First Visiting the Page, All Products are in Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image34.png)</span></span>

<span data-ttu-id="84b16-300">**Figura 14**: ao visitar a página pela primeira vez, todos os produtos estão no modo somente leitura ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-300">**Figure 14**: When First Visiting the Page, All Products are in Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image36.png))</span></span>

<span data-ttu-id="84b16-301">[![para atualizar o nome ou o preço de um produto, clique no botão Editar](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-301">[![To Update a Product s Name or Price, Click the Edit Button](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image37.png)</span></span>

<span data-ttu-id="84b16-302">**Figura 15**: para atualizar o nome ou o preço de um produto, clique no botão Editar ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-302">**Figure 15**: To Update a Product s Name or Price, Click the Edit Button ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image39.png))</span></span>

<span data-ttu-id="84b16-303">[![depois de alterar o valor, clique em atualizar para retornar ao modo somente leitura](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="84b16-303">[![After Changing the Value, Click Update to Return to the Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image40.png)</span></span>

<span data-ttu-id="84b16-304">**Figura 16**: depois de alterar o valor, clique em atualizar para retornar ao modo somente leitura ([clique para exibir a imagem em tamanho normal](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="84b16-304">**Figure 16**: After Changing the Value, Click Update to Return to the Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image42.png))</span></span>

## <a name="step-7-adding-delete-capabilities"></a><span data-ttu-id="84b16-305">Etapa 7: adicionando recursos de exclusão</span><span class="sxs-lookup"><span data-stu-id="84b16-305">Step 7: Adding Delete Capabilities</span></span>

<span data-ttu-id="84b16-306">As etapas para adicionar recursos de exclusão a um DataList são semelhantes àquelas para adicionar recursos de edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-306">The steps for adding delete capabilities to a DataList are similar to those for adding editing capabilities.</span></span> <span data-ttu-id="84b16-307">Em suma, precisamos adicionar um botão Delete ao `ItemTemplate` que, quando clicado:</span><span class="sxs-lookup"><span data-stu-id="84b16-307">In short, we need to add a Delete button to the `ItemTemplate` that, when clicked:</span></span>

1. <span data-ttu-id="84b16-308">Lê no `ProductID` do produto correspondente por meio da coleção de `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="84b16-308">Reads in the corresponding product s `ProductID` via the `DataKeys` collection.</span></span>
2. <span data-ttu-id="84b16-309">Executa a exclusão chamando o método de `DeleteProduct` da classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="84b16-309">Performs the delete by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>
3. <span data-ttu-id="84b16-310">Reassocia os dados ao DataList.</span><span class="sxs-lookup"><span data-stu-id="84b16-310">Rebinds the data to the DataList.</span></span>

<span data-ttu-id="84b16-311">Deixe que o s comece adicionando um botão de exclusão à `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="84b16-311">Let s start by adding a Delete button to the `ItemTemplate`.</span></span>

<span data-ttu-id="84b16-312">Quando clicado, um botão cujo `CommandName` é editar, atualizar ou cancelar gera o evento DataList s `ItemCommand` junto com um evento adicional (por exemplo, ao usar editar o evento `EditCommand` também é gerado).</span><span class="sxs-lookup"><span data-stu-id="84b16-312">When clicked, a Button whose `CommandName` is Edit, Update, or Cancel raises the DataList s `ItemCommand` event along with an additional event (for example, when using Edit the `EditCommand` event is raised as well).</span></span> <span data-ttu-id="84b16-313">Da mesma forma, qualquer Button, LinkButton ou ImageButton no DataList cuja propriedade `CommandName` está definida como Delete faz com que o evento `DeleteCommand` seja acionado (juntamente com `ItemCommand`).</span><span class="sxs-lookup"><span data-stu-id="84b16-313">Similarly, any Button, LinkButton, or ImageButton in the DataList whose `CommandName` property is set to Delete causes the `DeleteCommand` event to fire (along with `ItemCommand`).</span></span>

<span data-ttu-id="84b16-314">Adicione um botão excluir ao lado do botão Editar na `ItemTemplate`, definindo sua propriedade `CommandName` como excluir.</span><span class="sxs-lookup"><span data-stu-id="84b16-314">Add a Delete button next to the Edit button in the `ItemTemplate`, setting its `CommandName` property to Delete.</span></span> <span data-ttu-id="84b16-315">Depois de adicionar esse botão, o controle da sintaxe declarativa s `ItemTemplate` de DataList deve ser semelhante a:</span><span class="sxs-lookup"><span data-stu-id="84b16-315">After adding this Button control your DataList s `ItemTemplate` declarative syntax should look like:</span></span>

[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample7.aspx)]

<span data-ttu-id="84b16-316">Em seguida, crie um manipulador de eventos para o evento DataList s `DeleteCommand`, usando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="84b16-316">Next, create an event handler for the DataList s `DeleteCommand` event, using the following code:</span></span>

[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample8.vb)]

<span data-ttu-id="84b16-317">Clicar no botão excluir causa um postback e dispara o evento DataList s `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="84b16-317">Clicking the Delete button causes a postback and fires the DataList s `DeleteCommand` event.</span></span> <span data-ttu-id="84b16-318">No manipulador de eventos, o valor de `ProductID` do produto clicado é acessado na coleção de `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="84b16-318">In the event handler, the clicked product s `ProductID` value is accessed from the `DataKeys` collection.</span></span> <span data-ttu-id="84b16-319">Em seguida, o produto é excluído chamando o método de `DeleteProduct` da classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="84b16-319">Next, the product is deleted by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>

<span data-ttu-id="84b16-320">Depois de excluir o produto, é importante que reassocie os dados ao DataList (`DataList1.DataBind()`), caso contrário, o DataList continuará mostrando o produto que acabou de ser excluído.</span><span class="sxs-lookup"><span data-stu-id="84b16-320">After deleting the product, it s important that we rebind the data to the DataList (`DataList1.DataBind()`), otherwise the DataList will continue to show the product that was just deleted.</span></span>

## <a name="summary"></a><span data-ttu-id="84b16-321">Resumo</span><span class="sxs-lookup"><span data-stu-id="84b16-321">Summary</span></span>

<span data-ttu-id="84b16-322">Embora o DataList não tenha o ponto e clique em Editar e excluir o suporte aproveitado pelo GridView, com um pouco de código, ele pode ser aprimorado para incluir esses recursos.</span><span class="sxs-lookup"><span data-stu-id="84b16-322">While the DataList lacks the point and click editing and deleting support enjoyed by the GridView, with a short bit of code it can be enhanced to include these features.</span></span> <span data-ttu-id="84b16-323">Neste tutorial, vimos como criar uma listagem de duas colunas de produtos que poderiam ser excluídos e cujo nome e preço poderiam ser editados.</span><span class="sxs-lookup"><span data-stu-id="84b16-323">In this tutorial we saw how to create a two-column listing of products that could be deleted and whose name and price could be edited.</span></span> <span data-ttu-id="84b16-324">Adicionar suporte à edição e exclusão é uma questão de incluir os controles da Web apropriados no `ItemTemplate` e `EditItemTemplate`, criar os manipuladores de eventos correspondentes, ler os valores de chave primária e inseridos pelo usuário e fazer a interface com a camada de lógica de negócios.</span><span class="sxs-lookup"><span data-stu-id="84b16-324">Adding editing and deleting support is a matter of including the appropriate Web controls in the `ItemTemplate` and `EditItemTemplate`, creating the corresponding event handlers, reading the user-entered and primary key values, and interfacing with the Business Logic Layer.</span></span>

<span data-ttu-id="84b16-325">Embora tenhamos adicionado recursos básicos de edição e exclusão ao DataList, ele não tem recursos mais avançados.</span><span class="sxs-lookup"><span data-stu-id="84b16-325">While we have added basic editing and deleting capabilities to the DataList, it lacks more advanced features.</span></span> <span data-ttu-id="84b16-326">Por exemplo, não há nenhuma validação de campo de entrada – se um usuário inserir um preço muito caro, uma exceção será lançada por `Decimal.Parse` ao tentar converter muito caro em um `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="84b16-326">For example, there is no input field validation - if a user enters a price of Too expensive, an exception will be thrown by `Decimal.Parse` when attempting to convert Too expensive into a `Decimal`.</span></span> <span data-ttu-id="84b16-327">Da mesma forma, se houver um problema na atualização dos dados na lógica de negócios ou nas camadas de acesso a dados, o usuário será apresentado com a tela de erro padrão.</span><span class="sxs-lookup"><span data-stu-id="84b16-327">Similarly, if there is a problem in updating the data at the Business Logic or Data Access Layers the user will be presented with the standard error screen.</span></span> <span data-ttu-id="84b16-328">Sem qualquer tipo de confirmação no botão excluir, a exclusão acidental de um produto é muito provável.</span><span class="sxs-lookup"><span data-stu-id="84b16-328">Without any sort of confirmation on the Delete button, accidentally deleting a product is all too likely.</span></span>

<span data-ttu-id="84b16-329">Em Tutoriais futuros, veremos como melhorar a experiência do usuário de edição.</span><span class="sxs-lookup"><span data-stu-id="84b16-329">In future tutorials we'll see how to improve the editing user experience.</span></span>

<span data-ttu-id="84b16-330">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="84b16-330">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="84b16-331">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="84b16-331">About the Author</span></span>

<span data-ttu-id="84b16-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="84b16-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="84b16-333">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="84b16-333">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="84b16-334">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="84b16-334">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="84b16-335">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="84b16-335">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="84b16-336">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="84b16-336">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="84b16-337">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="84b16-337">Special Thanks To</span></span>

<span data-ttu-id="84b16-338">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="84b16-338">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="84b16-339">Os revisores potenciais para este tutorial foram Zack Jones, Ken Pespisa e Randy Schmidt.</span><span class="sxs-lookup"><span data-stu-id="84b16-339">Lead reviewers for this tutorial were Zack Jones, Ken Pespisa, and Randy Schmidt.</span></span> <span data-ttu-id="84b16-340">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="84b16-340">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="84b16-341">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="84b16-341">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="84b16-342">[Anterior](customizing-the-datalist-s-editing-interface-cs.md)
> [Próximo](performing-batch-updates-vb.md)</span><span class="sxs-lookup"><span data-stu-id="84b16-342">[Previous](customizing-the-datalist-s-editing-interface-cs.md)
[Next](performing-batch-updates-vb.md)</span></span>
