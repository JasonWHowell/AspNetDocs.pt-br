---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Adicionando confirmação do lado do cliente ao excluir (VB) | Microsoft Docs
author: rick-anderson
description: Nas interfaces que criamos até agora, um usuário pode acidentalmente excluir dados clicando no botão excluir quando pretendia clicar no botão Editar. Neste t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: addb5a1fdc5793309388c5f06b44fb3b145bc102
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74589336"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="670e3-104">Adicionar confirmação do lado do cliente ao excluir (VB)</span><span class="sxs-lookup"><span data-stu-id="670e3-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="670e3-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="670e3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="670e3-106">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) ou [baixar PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="670e3-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="670e3-107">Nas interfaces que criamos até agora, um usuário pode acidentalmente excluir dados clicando no botão excluir quando pretendia clicar no botão Editar.</span><span class="sxs-lookup"><span data-stu-id="670e3-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="670e3-108">Neste tutorial, adicionaremos uma caixa de diálogo de confirmação do lado do cliente que aparece quando o botão excluir é clicado.</span><span class="sxs-lookup"><span data-stu-id="670e3-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

## <a name="introduction"></a><span data-ttu-id="670e3-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="670e3-109">Introduction</span></span>

<span data-ttu-id="670e3-110">Nos últimos tutoriais, vimos como usar nossa arquitetura de aplicativo, ObjectDataSource e os controles da Web de dados em conjunto para fornecer recursos de inserção, edição e exclusão.</span><span class="sxs-lookup"><span data-stu-id="670e3-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="670e3-111">As interfaces de exclusão que examinamos até agora foram compostas por um botão de exclusão que, quando clicado, causa um postback e invoca o método ObjectDataSource s `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="670e3-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="670e3-112">O método `Delete()`, em seguida, invoca o método configurado da camada de lógica de negócios, que propaga a chamada para a camada de acesso a dados, emitindo a instrução `DELETE` real para o Database.</span><span class="sxs-lookup"><span data-stu-id="670e3-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="670e3-113">Embora essa interface do usuário permita que os visitantes excluam registros por meio dos controles GridView, DetailsView ou FormView, ele não tem qualquer tipo de confirmação quando o usuário clica no botão excluir.</span><span class="sxs-lookup"><span data-stu-id="670e3-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="670e3-114">Se um usuário clicar acidentalmente no botão excluir quando pretendia clicar em Editar, o registro que pretendia atualizar será excluído em vez disso.</span><span class="sxs-lookup"><span data-stu-id="670e3-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="670e3-115">Para ajudar a evitar isso, neste tutorial, adicionaremos uma caixa de diálogo de confirmação do lado do cliente que aparece quando o botão excluir é clicado.</span><span class="sxs-lookup"><span data-stu-id="670e3-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="670e3-116">A função JavaScript `confirm(string)` exibe seu parâmetro de entrada de cadeia de caracteres como o texto dentro de uma caixa de diálogo modal que vem equipado com dois botões-OK e Cancel (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="670e3-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="670e3-117">A função `confirm(string)` retorna um valor booliano dependendo de qual botão é clicado (`true`, se o usuário clicar em OK e `false` se clicar em Cancelar).</span><span class="sxs-lookup"><span data-stu-id="670e3-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>

![O método Confirm (String) do JavaScript exibe uma MessageBox modal, do lado do cliente](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="670e3-119">**Figura 1**: o método JavaScript `confirm(string)` exibe uma MessageBox modal, do lado do cliente</span><span class="sxs-lookup"><span data-stu-id="670e3-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>

<span data-ttu-id="670e3-120">Durante um envio de formulário, se um valor de `false` for retornado de um manipulador de eventos do lado do cliente, o envio do formulário será cancelado.</span><span class="sxs-lookup"><span data-stu-id="670e3-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="670e3-121">Usando esse recurso, podemos fazer com que o manipulador de eventos do lado do cliente do botão excluir `onclick` retorne o valor de uma chamada para `confirm("Are you sure you want to delete this product?")`.</span><span class="sxs-lookup"><span data-stu-id="670e3-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="670e3-122">Se o usuário clicar em cancelar, `confirm(string)` retornará false, fazendo com que o envio do formulário seja cancelado.</span><span class="sxs-lookup"><span data-stu-id="670e3-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="670e3-123">Sem postback, o produto cujo botão de exclusão foi clicado não será excluído.</span><span class="sxs-lookup"><span data-stu-id="670e3-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="670e3-124">Se, no entanto, o usuário clicar em OK na caixa de diálogo de confirmação, o postback continuará unabated e o produto será excluído.</span><span class="sxs-lookup"><span data-stu-id="670e3-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="670e3-125">Consulte [usando JavaScript s `confirm()` método para controlar o envio de formulário](http://www.webreference.com/programming/javascript/confirm/) para obter mais informações sobre essa técnica.</span><span class="sxs-lookup"><span data-stu-id="670e3-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="670e3-126">Adicionar o script do lado do cliente necessário difere ligeiramente se estiver usando modelos do que ao usar um comando.</span><span class="sxs-lookup"><span data-stu-id="670e3-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="670e3-127">Portanto, neste tutorial, veremos um exemplo FormView e GridView.</span><span class="sxs-lookup"><span data-stu-id="670e3-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="670e3-128">Usar técnicas de confirmação do lado do cliente, como as discutidas neste tutorial, pressupõe que os usuários estão visitando navegadores que dão suporte a JavaScript e que têm o JavaScript habilitado.</span><span class="sxs-lookup"><span data-stu-id="670e3-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="670e3-129">Se uma dessas suposições não for verdadeira para um usuário específico, clicar no botão excluir fará com que um postback seja imediatamente (não exibindo uma confirmação MessageBox).</span><span class="sxs-lookup"><span data-stu-id="670e3-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>

## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="670e3-130">Etapa 1: Criando um FormView que dá suporte à exclusão</span><span class="sxs-lookup"><span data-stu-id="670e3-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="670e3-131">Comece adicionando um FormView à página `ConfirmationOnDelete.aspx` na pasta `EditInsertDelete`, associando-o a um novo ObjectDataSource que retorna as informações do produto por meio do método `GetProducts()` classe s `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="670e3-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="670e3-132">Configure também o ObjectDataSource para que a classe `ProductsBLL` `DeleteProduct(productID)` método seja mapeada para o método ObjectDataSource s `Delete()`; Verifique se as listas suspensas inserir e atualizar guias estão definidas como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="670e3-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="670e3-133">Por fim, marque a caixa de seleção habilitar paginação na marca inteligente FormView s.</span><span class="sxs-lookup"><span data-stu-id="670e3-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="670e3-134">Após essas etapas, a nova marcação declarativa de ObjectDataSource s será parecida com a seguinte:</span><span class="sxs-lookup"><span data-stu-id="670e3-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="670e3-135">Como nos nossos exemplos anteriores que não usavam a simultaneidade otimista, Reserve um tempo para limpar a Propriedade ObjectDataSource s `OldValuesParameterFormatString`.</span><span class="sxs-lookup"><span data-stu-id="670e3-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="670e3-136">Como ele foi associado a um controle ObjectDataSource que dá suporte apenas à exclusão, o s `ItemTemplate` do FormView oferece apenas o botão excluir, sem os botões novo e atualizar.</span><span class="sxs-lookup"><span data-stu-id="670e3-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="670e3-137">No entanto, a marcação declarativa s de FormView inclui um `EditItemTemplate` supérfluo e `InsertItemTemplate`, que podem ser removidos.</span><span class="sxs-lookup"><span data-stu-id="670e3-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="670e3-138">Reserve um tempo para personalizar o `ItemTemplate` para que o exiba apenas um subconjunto dos campos de dados do produto.</span><span class="sxs-lookup"><span data-stu-id="670e3-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="670e3-139">Eu configurei minha para mostrar o nome do produto em um `<h3>` título acima de seus nomes de fornecedor e categoria (juntamente com o botão de exclusão).</span><span class="sxs-lookup"><span data-stu-id="670e3-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="670e3-140">Com essas alterações, temos uma página da Web totalmente funcional que permite que um usuário alterne pelos produtos um de cada vez, com a capacidade de excluir um produto simplesmente clicando no botão excluir.</span><span class="sxs-lookup"><span data-stu-id="670e3-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="670e3-141">A Figura 2 mostra uma captura de tela de nosso progresso até o momento quando visualizado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="670e3-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="670e3-142">[![o FormView mostra informações sobre um único produto](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="670e3-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="670e3-143">**Figura 2**: o FormView mostra informações sobre um único produto ([clique para exibir a imagem em tamanho normal](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="670e3-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>

## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="670e3-144">Etapa 2: chamando a função Confirm (String) por meio do evento onclick do lado do cliente de botões de exclusão</span><span class="sxs-lookup"><span data-stu-id="670e3-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="670e3-145">Com o FormView criado, a etapa final é configurar o botão de exclusão de modo que, quando clicado pelo visitante, a função JavaScript `confirm(string)` seja invocada.</span><span class="sxs-lookup"><span data-stu-id="670e3-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="670e3-146">Adicionar um script do lado do cliente a um evento de `onclick` de botão, LinkButton ou ImageButton do lado do cliente pode ser realizado por meio do uso do `OnClientClick property`, que é novo no ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="670e3-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="670e3-147">Como queremos ter o valor da função `confirm(string)` retornada, basta definir essa propriedade como: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="670e3-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="670e3-148">Após essa alteração, a sintaxe declarativa de Delete LinkButton s deve ser semelhante a:</span><span class="sxs-lookup"><span data-stu-id="670e3-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="670e3-149">Isso é tudo!</span><span class="sxs-lookup"><span data-stu-id="670e3-149">That s all there is to it!</span></span> <span data-ttu-id="670e3-150">A Figura 3 mostra uma captura de tela dessa confirmação em ação.</span><span class="sxs-lookup"><span data-stu-id="670e3-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="670e3-151">Clicar no botão excluir abre a caixa de diálogo confirmar.</span><span class="sxs-lookup"><span data-stu-id="670e3-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="670e3-152">Se o usuário clicar em cancelar, o postback será cancelado e o produto não será excluído.</span><span class="sxs-lookup"><span data-stu-id="670e3-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="670e3-153">No entanto, se o usuário clicar em OK, o postback continuará e o método ObjectDataSource s `Delete()` será invocado, culminando no registro do banco de dados que está sendo excluído.</span><span class="sxs-lookup"><span data-stu-id="670e3-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="670e3-154">A cadeia de caracteres passada para a `confirm(string)` função JavaScript é delimitada com apóstrofos (e não aspas).</span><span class="sxs-lookup"><span data-stu-id="670e3-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="670e3-155">No JavaScript, as cadeias de caracteres podem ser delimitadas usando qualquer caractere.</span><span class="sxs-lookup"><span data-stu-id="670e3-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="670e3-156">Usamos apóstrofos aqui para que os delimitadores da cadeia de caracteres transmitidos para `confirm(string)` não introduzam uma ambiguidade com os delimitadores usados para o valor da propriedade `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="670e3-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>

<span data-ttu-id="670e3-157">[![uma confirmação agora é exibida ao clicar no botão excluir](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="670e3-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="670e3-158">**Figura 3**: uma confirmação agora é exibida ao clicar no botão excluir ([clique para exibir a imagem em tamanho normal](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="670e3-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>

## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="670e3-159">Etapa 3: Configurando a propriedade OnClientClick para o botão excluir em um CommandField</span><span class="sxs-lookup"><span data-stu-id="670e3-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="670e3-160">Ao trabalhar com um botão, LinkButton ou ImageButton diretamente em um modelo, uma caixa de diálogo de confirmação pode ser associada a ele simplesmente Configurando sua propriedade `OnClientClick` para retornar os resultados da função JavaScript `confirm(string)`.</span><span class="sxs-lookup"><span data-stu-id="670e3-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="670e3-161">No entanto, o CommandField-que adiciona um campo de botões delete a um GridView ou DetailsView-não tem uma propriedade `OnClientClick` que pode ser definida declarativamente.</span><span class="sxs-lookup"><span data-stu-id="670e3-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="670e3-162">Em vez disso, devemos referenciar programaticamente o botão de exclusão em GridView ou DetailsView s apropriado `DataBound` manipulador de eventos e, em seguida, definir sua propriedade `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="670e3-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="670e3-163">Ao definir o botão de exclusão como s `OnClientClick` Propriedade no manipulador de eventos de `DataBound` apropriado, temos acesso aos dados associados ao registro atual.</span><span class="sxs-lookup"><span data-stu-id="670e3-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="670e3-164">Isso significa que podemos estender a mensagem de confirmação para incluir detalhes sobre o registro específico, como "tem certeza de que deseja excluir o produto Chai?"</span><span class="sxs-lookup"><span data-stu-id="670e3-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="670e3-165">Essa personalização também é possível em modelos que usam a sintaxe DataBinding.</span><span class="sxs-lookup"><span data-stu-id="670e3-165">Such customization is also possible in templates using databinding syntax.</span></span>

<span data-ttu-id="670e3-166">Para praticar a configuração da propriedade `OnClientClick` para os botões Delete em um CommandField, deixe s adicionar um GridView à página.</span><span class="sxs-lookup"><span data-stu-id="670e3-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="670e3-167">Configure este GridView para usar o mesmo controle ObjectDataSource que o FormView usa.</span><span class="sxs-lookup"><span data-stu-id="670e3-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="670e3-168">Além disso, limitar o GridView s BoundFields para incluir apenas o nome, a categoria e o fornecedor do produto.</span><span class="sxs-lookup"><span data-stu-id="670e3-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="670e3-169">Por fim, marque a caixa de seleção Habilitar exclusão na marca inteligente de GridView.</span><span class="sxs-lookup"><span data-stu-id="670e3-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="670e3-170">Isso adicionará um CommandField à coleção GridView s `Columns` com sua propriedade `ShowDeleteButton` definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="670e3-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="670e3-171">Depois de fazer essas alterações, sua marcação declarativa s de GridView deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="670e3-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="670e3-172">O CommandField contém uma única instância de Delete LinkButton que pode ser acessada programaticamente por meio do manipulador de eventos GridView s `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="670e3-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="670e3-173">Depois de referenciado, podemos definir sua propriedade `OnClientClick` de acordo.</span><span class="sxs-lookup"><span data-stu-id="670e3-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="670e3-174">Crie um manipulador de eventos para o evento `RowDataBound` usando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="670e3-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="670e3-175">Esse manipulador de eventos funciona com linhas de dados (aquelas que terão o botão excluir) e começa pela referência programática ao botão excluir.</span><span class="sxs-lookup"><span data-stu-id="670e3-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="670e3-176">Em geral, use o seguinte padrão:</span><span class="sxs-lookup"><span data-stu-id="670e3-176">In general use the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="670e3-177">*ButtonType* é o tipo de botão que está sendo usado pelo comando-Button, LinkButton ou ImageButton.</span><span class="sxs-lookup"><span data-stu-id="670e3-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="670e3-178">Por padrão, o CommandField usa LinkButtons, mas isso pode ser personalizado por meio do comando s `ButtonType property`.</span><span class="sxs-lookup"><span data-stu-id="670e3-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="670e3-179">O *commandFieldIndex* é o índice ordinal do CommandField na coleção GridView s `Columns`, enquanto o *controlIndex* é o índice do botão de exclusão dentro da coleção CommandField s `Controls`.</span><span class="sxs-lookup"><span data-stu-id="670e3-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="670e3-180">O valor de *controlIndex* depende da posição do botão em relação a outros botões no comando.</span><span class="sxs-lookup"><span data-stu-id="670e3-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="670e3-181">Por exemplo, se o único botão exibido no CommandField for o botão excluir, use um índice de 0.</span><span class="sxs-lookup"><span data-stu-id="670e3-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="670e3-182">No entanto, se houver um botão de edição que precede o botão excluir, use um índice de 2.</span><span class="sxs-lookup"><span data-stu-id="670e3-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="670e3-183">O motivo pelo qual um índice de 2 é usado é que dois controles são adicionados pelo CommandField antes do botão de exclusão: o botão de edição e um LiteralControl que s usaram para adicionar algum espaço entre os botões editar e excluir.</span><span class="sxs-lookup"><span data-stu-id="670e3-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="670e3-184">Para nosso exemplo específico, o CommandField usa LinkButtons e, sendo o campo mais à esquerda, tem um *commandFieldIndex* de 0.</span><span class="sxs-lookup"><span data-stu-id="670e3-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="670e3-185">Como não há outros botões, mas o botão excluir no CommandField, usamos um *controlIndex* de 0.</span><span class="sxs-lookup"><span data-stu-id="670e3-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="670e3-186">Depois de referenciar o botão Delete no CommandField, vamos capturar informações sobre o produto associado à linha GridView atual.</span><span class="sxs-lookup"><span data-stu-id="670e3-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="670e3-187">Por fim, definimos o botão Delete como a propriedade s `OnClientClick` como o JavaScript apropriado, que inclui o nome do produto.</span><span class="sxs-lookup"><span data-stu-id="670e3-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="670e3-188">Como a cadeia de caracteres JavaScript passada para a função `confirm(string)` é delimitada usando apóstrofos, devemos escapar de qualquer apóstrofo que apareça dentro do nome do produto.</span><span class="sxs-lookup"><span data-stu-id="670e3-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="670e3-189">Em particular, todos os apóstrofos no nome do produto são ignorados com "`\'`".</span><span class="sxs-lookup"><span data-stu-id="670e3-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="670e3-190">Com essas alterações concluídas, clicar em um botão excluir no GridView exibe uma caixa de diálogo de confirmação personalizada (consulte a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="670e3-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="670e3-191">Assim como com a confirmação MessageBox do FormView, se o usuário clicar em cancelar, o postback será cancelado, impedindo que a exclusão ocorra.</span><span class="sxs-lookup"><span data-stu-id="670e3-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="670e3-192">Essa técnica também pode ser usada para acessar programaticamente o botão excluir no CommandField em um DetailsView.</span><span class="sxs-lookup"><span data-stu-id="670e3-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="670e3-193">No entanto, para o DetailsView, você d cria um manipulador de eventos para o evento `DataBound`, pois DetailsView não tem um evento `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="670e3-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>

<span data-ttu-id="670e3-194">[![clicar no botão de exclusão de GridView exibe uma caixa de diálogo de confirmação personalizada](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="670e3-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="670e3-195">**Figura 4**: clicar no botão de exclusão de GridView exibe uma caixa de diálogo de confirmação personalizada ([clique para exibir a imagem em tamanho normal](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="670e3-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>

## <a name="using-templatefields"></a><span data-ttu-id="670e3-196">Usando TemplateFields</span><span class="sxs-lookup"><span data-stu-id="670e3-196">Using TemplateFields</span></span>

<span data-ttu-id="670e3-197">Uma das desvantagens do CommandField é que seus botões devem ser acessados por meio da indexação e que o objeto resultante deve ser convertido para o tipo de botão apropriado (Button, LinkButton ou ImageButton).</span><span class="sxs-lookup"><span data-stu-id="670e3-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="670e3-198">Usar "números mágicos" e tipos embutidos em código convida problemas que não podem ser descobertos até o tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="670e3-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="670e3-199">Por exemplo, se você, ou outro desenvolvedor, adicionar novos botões ao CommandField em algum momento no futuro (como um botão de edição) ou alterar a propriedade `ButtonType`, o código existente ainda será compilado sem erros, mas visitar a página poderá causar uma exceção ou um comportamento inesperado, dependendo de como o código foi escrito e quais alterações foram feitas.</span><span class="sxs-lookup"><span data-stu-id="670e3-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="670e3-200">Uma abordagem alternativa é converter o GridView e DetailsView CommandFields em TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="670e3-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="670e3-201">Isso irá gerar um TemplateField com um `ItemTemplate` que tenha um LinkButton (ou um botão ou ImageButton) para cada botão no CommandField.</span><span class="sxs-lookup"><span data-stu-id="670e3-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="670e3-202">Esses botões `OnClientClick` propriedades podem ser atribuídos declarativamente, como vimos com o FormView, ou podem ser acessados programaticamente no manipulador de eventos de `DataBound` apropriado usando o seguinte padrão:</span><span class="sxs-lookup"><span data-stu-id="670e3-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="670e3-203">Em que *ControlID* é o valor da propriedade button s `ID`.</span><span class="sxs-lookup"><span data-stu-id="670e3-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="670e3-204">Embora esse padrão ainda exija um tipo embutido em código para a conversão, ele elimina a necessidade de indexação, permitindo que o layout seja alterado sem resultar em um erro de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="670e3-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="670e3-205">Resumo</span><span class="sxs-lookup"><span data-stu-id="670e3-205">Summary</span></span>

<span data-ttu-id="670e3-206">A função JavaScript `confirm(string)` é uma técnica comumente usada para controlar o fluxo de trabalho de envio de formulário.</span><span class="sxs-lookup"><span data-stu-id="670e3-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="670e3-207">Quando executada, a função exibe uma caixa de diálogo modal, do lado do cliente que inclui dois botões, OK e cancelar.</span><span class="sxs-lookup"><span data-stu-id="670e3-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="670e3-208">Se o usuário clicar em OK, a função `confirm(string)` retornará `true`; clicar em cancelar retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="670e3-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="670e3-209">Essa funcionalidade, acoplada com um comportamento de navegador s para cancelar um envio de formulário, se um manipulador de eventos durante o processo de envio retornar `false`, poderá ser usado para exibir uma MessageBox de confirmação ao excluir um registro.</span><span class="sxs-lookup"><span data-stu-id="670e3-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="670e3-210">A função `confirm(string)` pode ser associada a um manipulador de eventos de `onclick` de controle da Web de botão no lado do cliente por meio da propriedade Control s `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="670e3-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="670e3-211">Ao trabalhar com um botão de exclusão em um modelo – em um dos modelos FormView s ou em um TemplateField em DetailsView ou GridView-essa propriedade pode ser definida de forma declarativa ou programaticamente, como vimos neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="670e3-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="670e3-212">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="670e3-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="670e3-213">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="670e3-213">About the Author</span></span>

<span data-ttu-id="670e3-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="670e3-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="670e3-215">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="670e3-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="670e3-216">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="670e3-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="670e3-217">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="670e3-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="670e3-218">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="670e3-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="670e3-219">[Anterior](implementing-optimistic-concurrency-vb.md)
> [Próximo](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="670e3-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>
