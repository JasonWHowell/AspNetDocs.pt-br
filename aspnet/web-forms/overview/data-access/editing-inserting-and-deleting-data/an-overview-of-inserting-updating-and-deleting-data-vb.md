---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
title: Uma visão geral de inserção, atualização e exclusão de dados (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, veremos como mapear os métodos Insert (), Update () e Delete () de ObjectDataSource para os métodos de classes de BLL, bem como para como configu...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 35b40b8f-2ca8-4ab3-9c19-f361a91a3647
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 79491118ba1cbbc8c1b67ca9646a817d941f17ba
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78609630"
---
# <a name="an-overview-of-inserting-updating-and-deleting-data-vb"></a><span data-ttu-id="c2e05-103">Uma visão geral de inserção, atualização e exclusão de dados (VB)</span><span class="sxs-lookup"><span data-stu-id="c2e05-103">An Overview of Inserting, Updating, and Deleting Data (VB)</span></span>

<span data-ttu-id="c2e05-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c2e05-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c2e05-105">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) ou [baixar PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c2e05-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span></span>

> <span data-ttu-id="c2e05-106">Neste tutorial, veremos como mapear os métodos Insert (), Update () e Delete () de ObjectDataSource para os métodos de classes de BLL, bem como para configurar os controles GridView, DetailsView e FormView para fornecer recursos de modificação de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="introduction"></a><span data-ttu-id="c2e05-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="c2e05-107">Introduction</span></span>

<span data-ttu-id="c2e05-108">Nos últimos vários tutoriais examinamos como exibir dados em uma página ASP.NET usando os controles GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="c2e05-109">Esses controles simplesmente funcionam com os dados fornecidos a eles.</span><span class="sxs-lookup"><span data-stu-id="c2e05-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="c2e05-110">Normalmente, esses controles acessam dados por meio do uso de um controle da fonte de dados, como o ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="c2e05-111">Vimos como o ObjectDataSource atua como um proxy entre a página ASP.NET e os dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="c2e05-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="c2e05-112">Quando um GridView precisa exibir dados, ele invoca o método de `Select()` de ObjectDataSource que, por sua vez, invoca um método de nossa camada de lógica de negócios (BLL), que chama um método no TableAdapter (DAL) apropriado da camada de acesso a dados que, por sua vez, envia uma consulta de `SELECT` para o Northwind.</span><span class="sxs-lookup"><span data-stu-id="c2e05-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="c2e05-113">Lembre-se de que quando criamos os TableAdapters na DAL em [nosso primeiro tutorial](../introduction/creating-a-data-access-layer-cs.md), o Visual Studio adicionou automaticamente os métodos para inserção, atualização e exclusão de dados da tabela de banco de dado subjacente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="c2e05-114">Além disso, ao [criar uma camada de lógica de negócios](../introduction/creating-a-business-logic-layer-vb.md) , criamos métodos na BLL que se chamaram para esses métodos da Dal de modificação de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="c2e05-115">Além de seu método `Select()`, o ObjectDataSource também tem os métodos `Insert()`, `Update()`e `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="c2e05-116">Como o método `Select()`, esses três métodos podem ser mapeados para métodos em um objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="c2e05-117">Quando configurado para inserir, atualizar ou excluir dados, os controles GridView, DetailsView e FormView fornecem uma interface do usuário para modificar os dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="c2e05-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="c2e05-118">Essa interface do usuário chama os métodos `Insert()`, `Update()`e `Delete()` do ObjectDataSource, que invocam os métodos associados do objeto subjacente (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="c2e05-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>

<span data-ttu-id="c2e05-119">[![os métodos Insert (), Update () e Delete () do ObjectDataSource servem como um proxy para a BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="c2e05-120">**Figura 1**: os métodos `Insert()`, `Update()`e `Delete()` do ObjectDataSource servem como um proxy para a BLL ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="c2e05-121">Neste tutorial, veremos como mapear os métodos `Insert()`, `Update()`e `Delete()` do ObjectDataSource para métodos de classes na BLL, bem como configurar os controles GridView, DetailsView e FormView para fornecer recursos de modificação de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="c2e05-122">Etapa 1: criando as páginas da Web de tutoriais de inserção, atualização e exclusão</span><span class="sxs-lookup"><span data-stu-id="c2e05-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="c2e05-123">Antes de começarmos a explorar como inserir, atualizar e excluir dados, primeiro vamos reservar um momento para criar as páginas ASP.NET em nosso projeto de site, que precisaremos para este tutorial e para as próximas várias delas.</span><span class="sxs-lookup"><span data-stu-id="c2e05-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="c2e05-124">Comece adicionando uma nova pasta chamada `EditInsertDelete`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="c2e05-125">Em seguida, adicione as seguintes páginas ASP.NET a essa pasta, assegurando a associação de cada página com a página mestra `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="c2e05-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![Adicionar as páginas ASP.NET para os tutoriais relacionados à modificação de dados](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image4.png)

<span data-ttu-id="c2e05-127">**Figura 2**: adicionar as páginas ASP.net para os tutoriais relacionados à modificação de dados</span><span class="sxs-lookup"><span data-stu-id="c2e05-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>

<span data-ttu-id="c2e05-128">Assim como nas outras pastas, `Default.aspx` na pasta `EditInsertDelete` listará os tutoriais em sua seção.</span><span class="sxs-lookup"><span data-stu-id="c2e05-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="c2e05-129">Lembre-se de que o controle de usuário `SectionLevelTutorialListing.ascx` fornece essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="c2e05-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="c2e05-130">Portanto, adicione esse controle de usuário a `Default.aspx` arrastando-o da Gerenciador de Soluções para a modo de exibição de Design da página.</span><span class="sxs-lookup"><span data-stu-id="c2e05-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>

<span data-ttu-id="c2e05-131">[![adicionar o controle de usuário SectionLevelTutorialListing. ascx a default. aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span></span>

<span data-ttu-id="c2e05-132">**Figura 3**: Adicionar o controle de usuário `SectionLevelTutorialListing.ascx` ao `Default.aspx` ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span></span>

<span data-ttu-id="c2e05-133">Por fim, adicione as páginas como entradas ao arquivo de `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="c2e05-134">Especificamente, adicione a seguinte marcação após a formatação personalizada `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="c2e05-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample1.xml)]

<span data-ttu-id="c2e05-135">Depois de atualizar `Web.sitemap`, Reserve um momento para exibir o site de tutoriais por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="c2e05-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="c2e05-136">O menu à esquerda agora inclui itens para os tutoriais de edição, inserção e exclusão.</span><span class="sxs-lookup"><span data-stu-id="c2e05-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![O mapa do site agora inclui entradas para os tutoriais de edição, inserção e exclusão](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image8.png)

<span data-ttu-id="c2e05-138">**Figura 4**: o mapa do site agora inclui entradas para os tutoriais de edição, inserção e exclusão</span><span class="sxs-lookup"><span data-stu-id="c2e05-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="c2e05-139">Etapa 2: adicionando e Configurando o controle ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="c2e05-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="c2e05-140">Como GridView, DetailsView e FormView diferem em seus recursos e layout de modificação de dados, vamos examinar cada um deles individualmente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="c2e05-141">No entanto, em vez de ter cada controle usando seu próprio ObjectDataSource, vamos criar apenas um ObjectDataSource que todos os exemplos de controle possam compartilhar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="c2e05-142">Abra a página `Basics.aspx`, arraste um ObjectDataSource da caixa de ferramentas para o designer e clique no link configurar fonte de dados de sua marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="c2e05-143">Como a `ProductsBLL` é a única classe BLL que fornece os métodos de edição, inserção e exclusão, configure o ObjectDataSource para usar essa classe.</span><span class="sxs-lookup"><span data-stu-id="c2e05-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>

<span data-ttu-id="c2e05-144">[![configurar o ObjectDataSource para usar a classe ProductsBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="c2e05-145">**Figura 5**: configurar o ObjectDataSource para usar a classe `ProductsBLL` ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="c2e05-146">Na próxima tela, podemos especificar quais métodos da classe `ProductsBLL` são mapeados para o `Select()`do ObjectDataSource, `Insert()`, `Update()`e `Delete()` selecionando a guia apropriada e escolhendo o método na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="c2e05-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="c2e05-147">A Figura 6, que deve parecer familiar agora, mapeia o método `Select()` do ObjectDataSource para o método `GetProducts()` da classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="c2e05-148">Os métodos `Insert()`, `Update()`e `Delete()` podem ser configurados selecionando a guia apropriada na lista ao longo da parte superior.</span><span class="sxs-lookup"><span data-stu-id="c2e05-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>

<span data-ttu-id="c2e05-149">[![fazer com que o ObjectDataSource retorne todos os produtos](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="c2e05-150">**Figura 6**: fazer com que o ObjectDataSource retorne todos os produtos ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="c2e05-151">As figuras 7, 8 e 9 mostram as guias UPDATE, INSERT e DELETE do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="c2e05-152">Configure essas guias para que os métodos `Insert()`, `Update()`e `Delete()` invoquem os métodos `UpdateProduct`, `AddProduct`e `DeleteProduct` da classe `ProductsBLL`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>

<span data-ttu-id="c2e05-153">[![mapear o método Update () do ObjectDataSource para o método UpdateProduct da classe ProductBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="c2e05-154">**Figura 7**: mapear o método de `Update()` do ObjectDataSource para o método de `UpdateProduct` da classe `ProductBLL` ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span></span>

<span data-ttu-id="c2e05-155">[![mapear o método Insert () do ObjectDataSource para o método addproduct da classe ProductBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="c2e05-156">**Figura 8**: mapear o método de `Insert()` do ObjectDataSource para o método Add `Product` da classe `ProductBLL` ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="c2e05-157">[![mapear o método Delete () do ObjectDataSource para o método DeleteProduct da classe ProductBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="c2e05-158">**Figura 9**: mapear o método de `Delete()` do ObjectDataSource para o método de `DeleteProduct` da classe `ProductBLL` ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span></span>

<span data-ttu-id="c2e05-159">Talvez você tenha notado que as listas suspensas nas guias atualizar, inserir e excluir já tinham esses métodos selecionados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="c2e05-160">Isso é obrigado ao nosso uso do `DataObjectMethodAttribute` que decora os métodos de `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProductsBLL`.</span></span> <span data-ttu-id="c2e05-161">Por exemplo, o método DeleteProduct tem a seguinte assinatura:</span><span class="sxs-lookup"><span data-stu-id="c2e05-161">For example, the DeleteProduct method has the following signature:</span></span>

[!code-vb[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample2.vb)]

<span data-ttu-id="c2e05-162">O atributo `DataObjectMethodAttribute` indica a finalidade de cada método, seja para seleção, inserção, atualização ou exclusão, e se é o valor padrão.</span><span class="sxs-lookup"><span data-stu-id="c2e05-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="c2e05-163">Se você omitir esses atributos ao criar suas classes de BLL, precisará selecionar manualmente os métodos nas guias atualizar, inserir e excluir.</span><span class="sxs-lookup"><span data-stu-id="c2e05-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="c2e05-164">Depois de garantir que os métodos de `ProductsBLL` apropriados sejam mapeados para os métodos `Insert()`, `Update()`e `Delete()` do ObjectDataSource, clique em concluir para concluir o assistente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="c2e05-165">Examinando a marcação do ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="c2e05-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="c2e05-166">Depois de configurar o ObjectDataSource por meio de seu assistente, vá para a exibição de código-fonte para examinar a marcação declarativa gerada.</span><span class="sxs-lookup"><span data-stu-id="c2e05-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="c2e05-167">A marca `<asp:ObjectDataSource>` especifica o objeto subjacente e os métodos a serem invocados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="c2e05-168">Além disso, há `DeleteParameters`, `UpdateParameters`e `InsertParameters` que mapeiam para os parâmetros de entrada dos métodos `AddProduct`, `UpdateProduct`e `DeleteProduct` da classe `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="c2e05-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample3.aspx)]

<span data-ttu-id="c2e05-169">O ObjectDataSource inclui um parâmetro para cada um dos parâmetros de entrada para seus métodos associados, assim como uma lista de `SelectParameter` s está presente quando o ObjectDataSource está configurado para chamar um método Select que espera um parâmetro de entrada (como `GetProductsByCategoryID(categoryID)`).</span><span class="sxs-lookup"><span data-stu-id="c2e05-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="c2e05-170">Como veremos em breve, os valores para esses `DeleteParameters`, `UpdateParameters`e `InsertParameters` são definidos automaticamente pelo GridView, DetailsView e FormView antes de invocar o método `Insert()`, `Update()`ou `Delete()` do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="c2e05-171">Esses valores também podem ser definidos programaticamente conforme necessário, como discutiremos em um tutorial futuro.</span><span class="sxs-lookup"><span data-stu-id="c2e05-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="c2e05-172">Um efeito colateral de usar o assistente para configurar o para ObjectDataSource é que o Visual Studio define a [propriedade OldValuesParameterFormatString](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) como `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="c2e05-173">Esse valor de propriedade é usado para incluir os valores originais dos dados que estão sendo editados e é útil em dois cenários:</span><span class="sxs-lookup"><span data-stu-id="c2e05-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="c2e05-174">Se, ao editar um registro, os usuários forem capazes de alterar o valor da chave primária.</span><span class="sxs-lookup"><span data-stu-id="c2e05-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="c2e05-175">Nesse caso, o novo valor de chave primária e o valor da chave primária original devem ser fornecidos para que o registro com o valor da chave primária original possa ser encontrado e ter seu valor atualizado de acordo.</span><span class="sxs-lookup"><span data-stu-id="c2e05-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="c2e05-176">Ao usar a simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="c2e05-176">When using optimistic concurrency.</span></span> <span data-ttu-id="c2e05-177">A simultaneidade otimista é uma técnica para garantir que dois usuários simultâneos não substituam as alterações de outra, e é o tópico para um tutorial futuro.</span><span class="sxs-lookup"><span data-stu-id="c2e05-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="c2e05-178">A propriedade `OldValuesParameterFormatString` indica o nome dos parâmetros de entrada nos métodos Update e Delete do objeto subjacente para os valores originais.</span><span class="sxs-lookup"><span data-stu-id="c2e05-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="c2e05-179">Discutiremos essa propriedade e sua finalidade mais detalhadamente quando explorarmos a simultaneidade otimista.</span><span class="sxs-lookup"><span data-stu-id="c2e05-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="c2e05-180">No entanto, faço isso agora porque nossos métodos de BLL não esperam os valores originais e, portanto, é importante que removamos essa propriedade.</span><span class="sxs-lookup"><span data-stu-id="c2e05-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="c2e05-181">Deixar a propriedade `OldValuesParameterFormatString` definida como qualquer coisa diferente do padrão (`{0}`) causará um erro quando um controle da Web de dados tentar invocar os métodos `Update()` ou `Delete()` de ObjectDataSource, pois o ObjectDataSource tentará passar o `UpdateParameters` ou `DeleteParameters` especificado, bem como os parâmetros de valor original.</span><span class="sxs-lookup"><span data-stu-id="c2e05-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="c2e05-182">Se isso não for extremamente claro neste momento, não se preocupe, vamos examinar essa propriedade e seu utilitário em um tutorial futuro.</span><span class="sxs-lookup"><span data-stu-id="c2e05-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="c2e05-183">Por enquanto, apenas tenha certeza de remover essa declaração de propriedade por completo da sintaxe declarativa ou definir o valor para o valor padrão ({0}).</span><span class="sxs-lookup"><span data-stu-id="c2e05-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-184">Se você simplesmente desmarcar o valor da propriedade `OldValuesParameterFormatString` da janela Propriedades no modo de exibição de Design, a propriedade ainda existirá na sintaxe declarativa, mas será definida como uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="c2e05-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="c2e05-185">Isso, infelizmente, ainda resultará no mesmo problema discutido acima.</span><span class="sxs-lookup"><span data-stu-id="c2e05-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="c2e05-186">Portanto, remova a propriedade completamente da sintaxe declarativa ou, na janela Propriedades, defina o valor como o padrão, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="c2e05-187">Etapa 3: adicionando um controle da Web de dados e Configurando-o para modificação de dados</span><span class="sxs-lookup"><span data-stu-id="c2e05-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="c2e05-188">Depois que o ObjectDataSource tiver sido adicionado à página e configurado, estamos prontos para adicionar controles da Web de dados à página para exibir os dados e fornecer um meio para o usuário final modificá-lo.</span><span class="sxs-lookup"><span data-stu-id="c2e05-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="c2e05-189">Veremos o GridView, o DetailsView e o FormView separadamente, pois esses controles da Web de dados diferem em suas configurações e recursos de modificação de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="c2e05-190">Como veremos no restante deste artigo, adicionar suporte a edição, inserção e exclusão muito básicos por meio dos controles GridView, DetailsView e FormView é realmente tão simples quanto marcar algumas caixas de seleção.</span><span class="sxs-lookup"><span data-stu-id="c2e05-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="c2e05-191">Há muitas sutilezas e casos de borda no mundo real que tornam essa funcionalidade mais envolvida do que apenas apontar e clicar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="c2e05-192">No entanto, este tutorial se concentra exclusivamente na prova de recursos de modificação de dados simplista.</span><span class="sxs-lookup"><span data-stu-id="c2e05-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="c2e05-193">Os tutoriais futuros examinarão as preocupações que, sem dúvida, surgirão em uma configuração do mundo real.</span><span class="sxs-lookup"><span data-stu-id="c2e05-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="c2e05-194">Excluindo dados do GridView</span><span class="sxs-lookup"><span data-stu-id="c2e05-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="c2e05-195">Comece arrastando um GridView da caixa de ferramentas para o designer.</span><span class="sxs-lookup"><span data-stu-id="c2e05-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="c2e05-196">Em seguida, associe o ObjectDataSource ao GridView selecionando-o na lista suspensa na marca inteligente do GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="c2e05-197">Neste ponto, a marcação declarativa do GridView será:</span><span class="sxs-lookup"><span data-stu-id="c2e05-197">At this point the GridView's declarative markup will be:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample4.aspx)]

<span data-ttu-id="c2e05-198">Associar o GridView ao ObjectDataSource por meio de sua marca inteligente tem dois benefícios:</span><span class="sxs-lookup"><span data-stu-id="c2e05-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="c2e05-199">Os BoundFields e CheckBoxFields são criados automaticamente para cada um dos campos retornados pelo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="c2e05-200">Além disso, as propriedades BoundField e CheckBoxField são definidas com base nos metadados do campo subjacente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="c2e05-201">Por exemplo, os campos `ProductID`, `CategoryName`e `SupplierName` são marcados como somente leitura no `ProductsDataTable` e, portanto, não devem ser atualizáveis durante a edição.</span><span class="sxs-lookup"><span data-stu-id="c2e05-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="c2e05-202">Para acomodar isso, [as propriedades ReadOnly](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) de boundfields são definidas como `True`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `True`.</span></span>
- <span data-ttu-id="c2e05-203">A [propriedade DataKeyNames](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) é atribuída aos campos de chave primária do objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="c2e05-204">Isso é essencial ao usar o GridView para editar ou excluir dados, pois essa propriedade indica o campo (ou conjunto de campos) que identifica exclusivamente cada registro.</span><span class="sxs-lookup"><span data-stu-id="c2e05-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="c2e05-205">Para obter mais informações sobre a propriedade `DataKeyNames`, consulte o [mestre/detalhes usando um GridView mestre selecionável com um tutorial de detalhes detailview](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="c2e05-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="c2e05-206">Embora o GridView possa ser associado ao ObjectDataSource por meio da sintaxe janela Propriedades ou declarativa, fazer isso exige que você adicione manualmente a marcação de BoundField e `DataKeyNames` apropriada.</span><span class="sxs-lookup"><span data-stu-id="c2e05-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="c2e05-207">O controle GridView fornece suporte interno para edição e exclusão em nível de linha.</span><span class="sxs-lookup"><span data-stu-id="c2e05-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="c2e05-208">Configurar um GridView para dar suporte à exclusão adiciona uma coluna de botões de exclusão.</span><span class="sxs-lookup"><span data-stu-id="c2e05-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="c2e05-209">Quando o usuário final clica no botão excluir para uma linha específica, um postback massacre e o GridView executa as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="c2e05-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="c2e05-210">Os valores de `DeleteParameters` do ObjectDataSource são atribuídos</span><span class="sxs-lookup"><span data-stu-id="c2e05-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="c2e05-211">O método de `Delete()` do ObjectDataSource é invocado, excluindo o registro especificado</span><span class="sxs-lookup"><span data-stu-id="c2e05-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="c2e05-212">O GridView se reassocia ao ObjectDataSource invocando seu método de `Select()`</span><span class="sxs-lookup"><span data-stu-id="c2e05-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="c2e05-213">Os valores atribuídos à `DeleteParameters` são os valores dos campos de `DataKeyNames` para a linha cujo botão de exclusão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="c2e05-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="c2e05-214">Portanto, é vital que a propriedade `DataKeyNames` de um GridView seja definida corretamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="c2e05-215">Se estiver ausente, o `DeleteParameters` será atribuído a um valor de `Nothing` na etapa 1, que por sua vez não resultará em quaisquer registros excluídos na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="c2e05-215">If it's missing, the `DeleteParameters` will be assigned a value of `Nothing` in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-216">A coleção de `DataKeys` é armazenada no estado de controle GridView s, o que significa que os valores de `DataKeys` serão lembrados por postagem, mesmo que o estado de exibição de GridView s tenha sido desabilitado.</span><span class="sxs-lookup"><span data-stu-id="c2e05-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="c2e05-217">No entanto, é muito importante que o estado de exibição permaneça habilitado para GridViews que dão suporte à edição ou exclusão (o comportamento padrão).</span><span class="sxs-lookup"><span data-stu-id="c2e05-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="c2e05-218">Se você definir a Propriedade GridView s `EnableViewState` como `false`, o comportamento de edição e exclusão funcionará bem para um único usuário, mas se houver usuários simultâneos excluindo dados, existirá a possibilidade de que esses usuários simultâneos excluam ou editem os registros que não pretendiam.</span><span class="sxs-lookup"><span data-stu-id="c2e05-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn't intend.</span></span> <span data-ttu-id="c2e05-219">Consulte minha entrada de blog, [AVISO: problema de simultaneidade com ASP.NET 2,0 GridViews/DetailsView/formviews que dão suporte à edição e/ou exclusão e cujo estado de exibição está desabilitado](http://scottonwriting.net/sowblog/posts/10054.aspx), para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="c2e05-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx), for more information.</span></span>

<span data-ttu-id="c2e05-220">Esse mesmo aviso também se aplica a DetailsViews e FormViews.</span><span class="sxs-lookup"><span data-stu-id="c2e05-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="c2e05-221">Para adicionar recursos de exclusão a um GridView, basta ir para sua marca inteligente e marcar a caixa de seleção Habilitar exclusão.</span><span class="sxs-lookup"><span data-stu-id="c2e05-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>

![Marque a caixa de seleção Habilitar exclusão](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image24.png)

<span data-ttu-id="c2e05-223">**Figura 10**: marque a caixa de seleção Habilitar exclusão</span><span class="sxs-lookup"><span data-stu-id="c2e05-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>

<span data-ttu-id="c2e05-224">Marcar a caixa de seleção Habilitar exclusão da marca inteligente adiciona um CommandField ao GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="c2e05-225">O CommandField renderiza uma coluna no GridView com botões para executar uma ou mais das seguintes tarefas: selecionando um registro, editando um registro e excluindo um registro.</span><span class="sxs-lookup"><span data-stu-id="c2e05-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="c2e05-226">Vimos anteriormente o CommandField em ação com a seleção de registros no [mestre/detalhes usando um GridView mestre selecionável com um tutorial de detalhes detailview](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="c2e05-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="c2e05-227">O CommandField contém um número de `ShowXButton` propriedades que indicam qual série de botões são exibidos no comando.</span><span class="sxs-lookup"><span data-stu-id="c2e05-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="c2e05-228">Marcando a caixa de seleção Habilitar exclusão, um CommandField cujo `ShowDeleteButton` propriedade é `True` foi adicionado à coleção de colunas do GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `True` has been added to the GridView's Columns collection.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample5.aspx)]

<span data-ttu-id="c2e05-229">Neste ponto, acredite ou não, concluimos a adição de suporte à exclusão ao GridView!</span><span class="sxs-lookup"><span data-stu-id="c2e05-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="c2e05-230">Como mostra a Figura 11, ao visitar esta página por meio de um navegador, uma coluna de botões de exclusão está presente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>

<span data-ttu-id="c2e05-231">[![o CommandField adiciona uma coluna de botões excluir](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span></span>

<span data-ttu-id="c2e05-232">**Figura 11**: o CommandField adiciona uma coluna de botões Delete ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span></span>

<span data-ttu-id="c2e05-233">Se você já está criando este tutorial do zero por conta própria, ao testar esta página, clicar no botão excluir gerará uma exceção.</span><span class="sxs-lookup"><span data-stu-id="c2e05-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="c2e05-234">Continue lendo para saber por que essas exceções foram geradas e como corrigi-las.</span><span class="sxs-lookup"><span data-stu-id="c2e05-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-235">Se você estiver seguindo usando o download que acompanha este tutorial, esses problemas já foram contados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="c2e05-236">No entanto, recomendo que você leia os detalhes listados abaixo para ajudar a identificar problemas que podem surgir e soluções alternativas adequadas.</span><span class="sxs-lookup"><span data-stu-id="c2e05-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>

<span data-ttu-id="c2e05-237">Se, ao tentar excluir um produto, você receber uma exceção cuja mensagem é semelhante a "ObjectDataSource"*ObjectDataSource1 "não foi possível encontrar um método não genérico" DeleteProduct "que tenha parâmetros: ProductID, original\_ProductID*," você provavelmente esqueceu de remover a propriedade `OldValuesParameterFormatString` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="c2e05-238">Com a propriedade `OldValuesParameterFormatString` especificada, o ObjectDataSource tenta passar os parâmetros de entrada `productID` e `original_ProductID` para o método `DeleteProduct`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="c2e05-239">o `DeleteProduct`, no entanto, só aceita um único parâmetro de entrada, portanto, a exceção.</span><span class="sxs-lookup"><span data-stu-id="c2e05-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="c2e05-240">Remover a propriedade `OldValuesParameterFormatString` (ou defini-la como `{0}`) instrui o ObjectDataSource a não tentar passar o parâmetro de entrada original.</span><span class="sxs-lookup"><span data-stu-id="c2e05-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>

<span data-ttu-id="c2e05-241">[![garantir que a propriedade OldValuesParameterFormatString foi apagada](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="c2e05-242">**Figura 12**: Verifique se a propriedade `OldValuesParameterFormatString` foi apagada ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span></span>

<span data-ttu-id="c2e05-243">Mesmo que você tenha removido a propriedade `OldValuesParameterFormatString`, você ainda receberá uma exceção ao tentar excluir um produto com a mensagem: "*a instrução DELETE entrou em conflito com a ordem de referência ' FK\_Order\_detalhes\_produtos '* ." O banco de dados Northwind contém uma restrição FOREIGN KEY entre a `Order Details` e a tabela `Products`, o que significa que um produto não poderá ser excluído do sistema se houver um ou mais registros para ele na tabela `Order Details`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="c2e05-244">Como cada produto no banco de dados Northwind tem pelo menos um registro no `Order Details`, não podemos excluir nenhum produto até que primeiro exclua os registros de detalhes do pedido associado do produto.</span><span class="sxs-lookup"><span data-stu-id="c2e05-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>

<span data-ttu-id="c2e05-245">[![uma restrição FOREIGN KEY proíbe a exclusão de produtos](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="c2e05-246">**Figura 13**: uma restrição FOREIGN KEY proíbe a exclusão de produtos ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span></span>

<span data-ttu-id="c2e05-247">Para nosso tutorial, vamos apenas excluir todos os registros da tabela `Order Details`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="c2e05-248">Em um aplicativo do mundo real, precisaremos:</span><span class="sxs-lookup"><span data-stu-id="c2e05-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="c2e05-249">Ter outra tela para gerenciar informações de detalhes do pedido</span><span class="sxs-lookup"><span data-stu-id="c2e05-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="c2e05-250">Aumentar o método de `DeleteProduct` para incluir a lógica para excluir os detalhes do pedido do produto especificado</span><span class="sxs-lookup"><span data-stu-id="c2e05-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="c2e05-251">Modificar a consulta SQL usada pelo TableAdapter para incluir a exclusão dos detalhes do pedido do produto especificado</span><span class="sxs-lookup"><span data-stu-id="c2e05-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="c2e05-252">Vamos apenas excluir todos os registros da tabela `Order Details` para burlar a restrição FOREIGN KEY.</span><span class="sxs-lookup"><span data-stu-id="c2e05-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="c2e05-253">Vá para a Gerenciador de Servidores no Visual Studio, clique com o botão direito do mouse no nó `NORTHWND.MDF` e escolha nova consulta.</span><span class="sxs-lookup"><span data-stu-id="c2e05-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="c2e05-254">Em seguida, na janela de consulta, execute a seguinte instrução SQL: `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="c2e05-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>

<span data-ttu-id="c2e05-255">[![excluir todos os registros da tabela detalhes do pedido](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span></span>

<span data-ttu-id="c2e05-256">**Figura 14**: excluir todos os registros da tabela de `Order Details` ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span></span>

<span data-ttu-id="c2e05-257">Depois de limpar a tabela de `Order Details`, clicar no botão excluir excluirá o produto sem erros.</span><span class="sxs-lookup"><span data-stu-id="c2e05-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="c2e05-258">Se clicar no botão excluir não excluir o produto, verifique se a propriedade `DataKeyNames` do GridView está definida como o campo de chave primária (`ProductID`).</span><span class="sxs-lookup"><span data-stu-id="c2e05-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-259">Ao clicar no botão excluir, um postback massacre e o registro são excluídos.</span><span class="sxs-lookup"><span data-stu-id="c2e05-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="c2e05-260">Isso pode ser perigoso, pois é fácil clicar acidentalmente no botão excluir da linha errada.</span><span class="sxs-lookup"><span data-stu-id="c2e05-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="c2e05-261">Em um futuro tutorial, veremos como adicionar uma confirmação do lado do cliente ao excluir um registro.</span><span class="sxs-lookup"><span data-stu-id="c2e05-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>

## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="c2e05-262">Editando dados com o GridView</span><span class="sxs-lookup"><span data-stu-id="c2e05-262">Editing Data with the GridView</span></span>

<span data-ttu-id="c2e05-263">Juntamente com a exclusão, o controle GridView também fornece suporte interno à edição em nível de linha.</span><span class="sxs-lookup"><span data-stu-id="c2e05-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="c2e05-264">Configurar um GridView para dar suporte à edição adiciona uma coluna de botões de edição.</span><span class="sxs-lookup"><span data-stu-id="c2e05-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="c2e05-265">Da perspectiva do usuário final, clicar no botão Editar de uma linha faz com que essa linha se torne editável, transformando as células em caixas de Textque contêm os valores existentes e substituindo o botão Editar pelos botões atualizar e cancelar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="c2e05-266">Depois de fazer as alterações desejadas, o usuário final pode clicar no botão atualizar para confirmar as alterações ou no botão Cancelar para descartá-las.</span><span class="sxs-lookup"><span data-stu-id="c2e05-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="c2e05-267">Em ambos os casos, depois de clicar em atualizar ou cancelar o GridView retorna para seu estado de pré-edição.</span><span class="sxs-lookup"><span data-stu-id="c2e05-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="c2e05-268">Da nossa perspectiva como o desenvolvedor da página, quando o usuário final clica no botão Editar para uma linha específica, um postback massacre e o GridView executa as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="c2e05-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="c2e05-269">A propriedade `EditItemIndex` do GridView é atribuída ao índice da linha cujo botão de edição foi clicado</span><span class="sxs-lookup"><span data-stu-id="c2e05-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="c2e05-270">O GridView se reassocia ao ObjectDataSource invocando seu método de `Select()`</span><span class="sxs-lookup"><span data-stu-id="c2e05-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="c2e05-271">O índice de linha que corresponde ao `EditItemIndex` é renderizado no "modo de edição".</span><span class="sxs-lookup"><span data-stu-id="c2e05-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="c2e05-272">Nesse modo, o botão Editar é substituído pelos botões Update e Cancel e BoundFields cujas propriedades `ReadOnly` são false (o padrão) são renderizadas como controles da Web TextBox cujas propriedades `Text` são atribuídas aos valores dos campos de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="c2e05-273">Neste ponto, a marcação é retornada para o navegador, permitindo que o usuário final faça alterações nos dados da linha.</span><span class="sxs-lookup"><span data-stu-id="c2e05-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="c2e05-274">Quando o usuário clica no botão atualizar, ocorre um postback e o GridView executa as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="c2e05-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="c2e05-275">Os valores de `UpdateParameters` do ObjectDataSource são atribuídos aos valor inseridos pelo usuário final na interface de edição do GridView</span><span class="sxs-lookup"><span data-stu-id="c2e05-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="c2e05-276">O método de `Update()` do ObjectDataSource é invocado, atualizando o registro especificado</span><span class="sxs-lookup"><span data-stu-id="c2e05-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="c2e05-277">O GridView se reassocia ao ObjectDataSource invocando seu método de `Select()`</span><span class="sxs-lookup"><span data-stu-id="c2e05-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="c2e05-278">Os valores de chave primária atribuídos ao `UpdateParameters` na etapa 1 vêm dos valores especificados na propriedade `DataKeyNames`, enquanto os valores de chave não primária são provenientes do texto nos controles da Web da caixa de texto para a linha editada.</span><span class="sxs-lookup"><span data-stu-id="c2e05-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="c2e05-279">Assim como acontece com a exclusão, é vital que a propriedade `DataKeyNames` de um GridView seja definida corretamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="c2e05-280">Se ele estiver ausente, o valor da chave primária `UpdateParameters` será atribuído a um valor de `Nothing` na etapa 1, que por sua vez não resultará em nenhum registro atualizado na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="c2e05-280">If it's missing, the `UpdateParameters` primary key value will be assigned a value of `Nothing` in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="c2e05-281">A funcionalidade de edição pode ser ativada simplesmente marcando a caixa de seleção Habilitar edição na marca inteligente do GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>

![Marque a caixa de seleção Habilitar edição](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image37.png)

<span data-ttu-id="c2e05-283">**Figura 15**: marcar a caixa de seleção Habilitar edição</span><span class="sxs-lookup"><span data-stu-id="c2e05-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>

<span data-ttu-id="c2e05-284">Marcar a caixa de seleção Habilitar edição adicionará um CommandField (se necessário) e definirá sua propriedade `ShowEditButton` como `True`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `True`.</span></span> <span data-ttu-id="c2e05-285">Como vimos anteriormente, o CommandField contém um número de `ShowXButton` propriedades que indicam qual série de botões são exibidos no comando.</span><span class="sxs-lookup"><span data-stu-id="c2e05-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="c2e05-286">Marcar a caixa de seleção Habilitar edição adiciona a propriedade `ShowEditButton` ao CommandField existente:</span><span class="sxs-lookup"><span data-stu-id="c2e05-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample6.aspx)]

<span data-ttu-id="c2e05-287">Isso é tudo o que é para adicionar suporte à edição rudimentar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="c2e05-288">Como mostra o Figure16, a interface de edição é, em vez de crua, cada BoundField cuja propriedade `ReadOnly` está definida como `False` (o padrão) é renderizada como uma caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="c2e05-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `False` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="c2e05-289">Isso inclui campos como `CategoryID` e `SupplierID`, que são chaves para outras tabelas.</span><span class="sxs-lookup"><span data-stu-id="c2e05-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>

<span data-ttu-id="c2e05-290">[![clicar no botão Chai s Edit exibe a linha no modo de edição](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span></span>

<span data-ttu-id="c2e05-291">**Figura 16**: clicar no botão Chai s Edit exibe a linha no modo de edição ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span></span>

<span data-ttu-id="c2e05-292">Além de solicitar aos usuários que editem valores de chave estrangeira diretamente, a interface da interface de edição não tem as seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="c2e05-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="c2e05-293">Se o usuário inserir um `CategoryID` ou `SupplierID` que não exista no banco de dados, o `UPDATE` violará uma restrição FOREIGN KEY, fazendo com que uma exceção seja gerada.</span><span class="sxs-lookup"><span data-stu-id="c2e05-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="c2e05-294">A interface de edição não inclui nenhuma validação.</span><span class="sxs-lookup"><span data-stu-id="c2e05-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="c2e05-295">Se você não fornecer um valor necessário (como `ProductName`) ou inserir um valor de cadeia de caracteres em que um valor numérico é esperado (como inserir "muito!"</span><span class="sxs-lookup"><span data-stu-id="c2e05-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="c2e05-296">na caixa de texto `UnitPrice`), uma exceção será lançada.</span><span class="sxs-lookup"><span data-stu-id="c2e05-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="c2e05-297">Um tutorial futuro examinará como adicionar controles de validação à interface do usuário de edição.</span><span class="sxs-lookup"><span data-stu-id="c2e05-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="c2e05-298">Atualmente, *todos os* campos de produto que não são somente leitura devem ser incluídos no GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="c2e05-299">Se tivéssemos de remover um campo do GridView, digamos `UnitPrice`, ao atualizar os dados, o GridView não definiria o valor de `UpdateParameters` de `UnitPrice`, que alteraria o `UnitPrice` do registro do banco de dados para um valor de `NULL`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="c2e05-300">Da mesma forma, se um campo obrigatório, como `ProductName`, for removido do GridView, a atualização falhará com a mesma "*coluna ' ProductName ' não permite nulos*" exceção mencionada acima.</span><span class="sxs-lookup"><span data-stu-id="c2e05-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="c2e05-301">A formatação da interface de edição deixa muito a desejar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="c2e05-302">O `UnitPrice` é mostrado com quatro pontos decimais.</span><span class="sxs-lookup"><span data-stu-id="c2e05-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="c2e05-303">O ideal é que os valores `CategoryID` e `SupplierID` contenham DropDownLists que listem as categorias e os fornecedores no sistema.</span><span class="sxs-lookup"><span data-stu-id="c2e05-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="c2e05-304">Essas são todas as falhas com as quais teremos que viver por enquanto, mas serão abordadas em Tutoriais futuros.</span><span class="sxs-lookup"><span data-stu-id="c2e05-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="c2e05-305">Inserindo, editando e excluindo dados com o DetailsView</span><span class="sxs-lookup"><span data-stu-id="c2e05-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="c2e05-306">Como vimos nos tutoriais anteriores, o controle DetailsView exibe um registro de cada vez e, como o GridView, permite a edição e a exclusão do registro exibido no momento.</span><span class="sxs-lookup"><span data-stu-id="c2e05-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="c2e05-307">A experiência do usuário final com edição e exclusão de itens de um DetailsView e o fluxo de trabalho do lado do ASP.NET é idêntica à do GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="c2e05-308">Onde o DetailsView difere do GridView é que ele também fornece suporte interno à inserção.</span><span class="sxs-lookup"><span data-stu-id="c2e05-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="c2e05-309">Para demonstrar os recursos de modificação de dados do GridView, comece adicionando um DetailsView à página de `Basics.aspx` acima do GridView existente e associe-o ao ObjectDataSource existente por meio da marca inteligente de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="c2e05-310">Em seguida, desmarque as propriedades `Height` e `Width` de DetailsView e marque a opção habilitar paginação na marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="c2e05-311">Para habilitar a edição, inserção e exclusão de suporte, basta marcar as caixas de seleção Habilitar edição, habilitar inserção e habilitar exclusão na marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>

![Configurar o DetailsView para dar suporte à edição, inserção e exclusão](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image41.png)

<span data-ttu-id="c2e05-313">**Figura 17**: configurar o DetailsView para dar suporte à edição, inserção e exclusão</span><span class="sxs-lookup"><span data-stu-id="c2e05-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>

<span data-ttu-id="c2e05-314">Assim como com o GridView, adicionar edição, inserção ou exclusão de suporte adiciona um CommandField ao DetailsView, como mostra a seguinte sintaxe declarativa:</span><span class="sxs-lookup"><span data-stu-id="c2e05-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample7.aspx)]

<span data-ttu-id="c2e05-315">Observe que para o DetailsView, o comando aparece no final da coleção de colunas por padrão.</span><span class="sxs-lookup"><span data-stu-id="c2e05-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="c2e05-316">Como os campos de DetailsView são renderizados como linhas, o CommandField é exibido como uma linha com os botões inserir, editar e excluir na parte inferior do DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>

<span data-ttu-id="c2e05-317">[![configurar o DetailsView para dar suporte à edição, inserção e exclusão](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span></span>

<span data-ttu-id="c2e05-318">**Figura 18**: configurar o DetailsView para dar suporte à edição, inserção e exclusão ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span></span>

<span data-ttu-id="c2e05-319">Clicar no botão excluir inicia a mesma sequência de eventos que com o GridView: um postback; seguido pelo DetailsView que preenche sua `DeleteParameters` de ObjectDataSource com base nos valores de `DataKeyNames`; e concluído com uma chamada de seu método de `Delete()` de ObjectDataSource, que, na verdade, remove o produto do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="c2e05-320">A edição no DetailsView também funciona de maneira idêntica à do GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="c2e05-321">Para inserção, o usuário final recebe um novo botão que, quando clicado, renderiza o DetailsView no "modo de inserção".</span><span class="sxs-lookup"><span data-stu-id="c2e05-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="c2e05-322">Com o "modo de inserção", o novo botão é substituído pelos botões inserir e cancelar e somente os BoundFields cuja propriedade `InsertVisible` está definida como `True` (o padrão) são exibidos.</span><span class="sxs-lookup"><span data-stu-id="c2e05-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `True` (the default) are displayed.</span></span> <span data-ttu-id="c2e05-323">Esses campos de dados identificados como campos de incremento automático, como `ProductID`, têm sua [propriedade InsertVisible](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) definida como `False` ao associar o DetailsView à fonte de dados por meio da marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `False` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="c2e05-324">Ao associar uma fonte de dados a um DetailsView por meio da marca inteligente, o Visual Studio define a propriedade `InsertVisible` como `False` somente para campos de incremento automático.</span><span class="sxs-lookup"><span data-stu-id="c2e05-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `False` only for auto-increment fields.</span></span> <span data-ttu-id="c2e05-325">Campos somente leitura, como `CategoryName` e `SupplierName`, serão exibidos na interface do usuário "modo de inserção", a menos que sua propriedade `InsertVisible` seja definida explicitamente como `False`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `False`.</span></span> <span data-ttu-id="c2e05-326">Reserve um momento para definir essas propriedades de `InsertVisible` de dois campos como `False`, por meio da sintaxe declarativa de DetailsView ou por meio do link editar campos na marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-326">Take a moment to set these two fields' `InsertVisible` properties to `False`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="c2e05-327">A Figura 19 mostra a definição das propriedades de `InsertVisible` como `False` clicando no link editar campos.</span><span class="sxs-lookup"><span data-stu-id="c2e05-327">Figure 19 shows setting the `InsertVisible` properties to `False` by clicking on the Edit Fields link.</span></span>

<span data-ttu-id="c2e05-328">[![Northwind Traders agora oferece a Acme chá](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span></span>

<span data-ttu-id="c2e05-329">**Figura 19**: a Northwind Traders agora oferece a Acme chá ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span></span>

<span data-ttu-id="c2e05-330">Depois de definir as propriedades de `InsertVisible`, exiba a página de `Basics.aspx` em um navegador e clique no botão novo.</span><span class="sxs-lookup"><span data-stu-id="c2e05-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="c2e05-331">A figura 20 mostra o DetailsView ao adicionar uma nova bebida, Acme chá, à nossa linha de produtos.</span><span class="sxs-lookup"><span data-stu-id="c2e05-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>

<span data-ttu-id="c2e05-332">[![Northwind Traders agora oferece a Acme chá](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span></span>

<span data-ttu-id="c2e05-333">**Figura 20**: a Northwind Traders agora oferece a Acme chá ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span></span>

<span data-ttu-id="c2e05-334">Depois de inserir os detalhes da Acme chá e clicar no botão Inserir, um postback massacre e o novo registro são adicionados à tabela `Products` banco de dados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="c2e05-335">Como este DetailsView lista os produtos na ordem em que eles existem na tabela de banco de dados, devemos paginar para o último produto a fim de ver o novo produto.</span><span class="sxs-lookup"><span data-stu-id="c2e05-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>

<span data-ttu-id="c2e05-336">[![detalhes do chá de Acme](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span></span>

<span data-ttu-id="c2e05-337">**Figura 21**: detalhes do chá de Acme ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-338">A [propriedade CurrentMode](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) de DetailsView indica a interface que está sendo exibida e pode ser um dos seguintes valores: `Edit`, `Insert`ou `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="c2e05-339">A [Propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) DefaultMode indica o modo em que o DetailsView retorna após uma edição ou inserção ter sido concluída e é útil para exibir um DetailsView que é permanentemente no modo Editar ou inserir.</span><span class="sxs-lookup"><span data-stu-id="c2e05-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>

<span data-ttu-id="c2e05-340">Os recursos de inserção e edição de ponto e clique do DetailsView sofrem com as mesmas limitações que o GridView: o usuário deve inserir `CategoryID` existentes e valores de `SupplierID` por meio de uma caixa de texto; a interface não tem nenhuma lógica de validação; todos os campos de produto que não permitem `NULL` valores ou que não têm um valor padrão especificado no nível de banco de dados devem ser incluídos na interface de inserção e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="c2e05-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="c2e05-341">As técnicas que examinaremos para estender e aprimorar a interface de edição de GridView em artigos futuros podem ser aplicadas às interfaces de edição e inserção do controle DetailsView também.</span><span class="sxs-lookup"><span data-stu-id="c2e05-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="c2e05-342">Usando o FormView para uma interface de usuário de modificação de dados mais flexível</span><span class="sxs-lookup"><span data-stu-id="c2e05-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="c2e05-343">O FormView oferece suporte interno para inserção, edição e exclusão de dados, mas como ele usa modelos em vez de campos, não há nenhum lugar para adicionar o BoundFields ou o CommandField usado pelos controles GridView e DetailsView para fornecer os dados interface de modificação.</span><span class="sxs-lookup"><span data-stu-id="c2e05-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="c2e05-344">Em vez disso, essa interface os controles da Web para coletar entrada do usuário ao adicionar um novo item ou editar um existente juntamente com os botões novo, editar, excluir, inserir, atualizar e cancelar devem ser adicionados manualmente aos modelos apropriados.</span><span class="sxs-lookup"><span data-stu-id="c2e05-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="c2e05-345">Felizmente, o Visual Studio criará automaticamente a interface necessária ao ligar o FormView a uma fonte de dados por meio da lista suspensa em sua marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="c2e05-346">Para ilustrar essas técnicas, comece adicionando um FormView à página `Basics.aspx` e, na marca inteligente do FormView, associe-o ao ObjectDataSource já criado.</span><span class="sxs-lookup"><span data-stu-id="c2e05-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="c2e05-347">Isso irá gerar um `EditItemTemplate`, `InsertItemTemplate`e `ItemTemplate` para o FormView com controles da Web TextBox para coletar os botões de entrada e de botão da Web do usuário para os novos, editar, excluir, inserir, atualizar e cancelar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="c2e05-348">Além disso, a propriedade `DataKeyNames` do FormView é definida como o campo de chave primária (`ProductID`) do objeto retornado pelo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="c2e05-349">Por fim, marque a opção habilitar paginação na marca inteligente do FormView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="c2e05-350">O seguinte mostra a marcação declarativa para o `ItemTemplate` do FormView após o FormView ter sido associado a ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="c2e05-351">Por padrão, cada campo de produto de valor não booliano é associado à propriedade `Text` de um controle de rótulo da Web, enquanto cada campo de valor booliano (`Discontinued`) é associado à propriedade `Checked` de um controle da Web de caixa de seleção desabilitado.</span><span class="sxs-lookup"><span data-stu-id="c2e05-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="c2e05-352">Para que os botões novo, editar e excluir disparem determinado comportamento de FormView quando clicados, é imperativo que seus `CommandName` valores sejam definidos como `New`, `Edit`e `Delete`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample8.aspx)]

<span data-ttu-id="c2e05-353">A Figura 22 mostra a `ItemTemplate` do FormView quando exibida por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="c2e05-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="c2e05-354">Cada campo de produto é listado com os botões novo, editar e excluir na parte inferior.</span><span class="sxs-lookup"><span data-stu-id="c2e05-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>

<span data-ttu-id="c2e05-355">[![ItemTemplate padrão FormView lista cada campo de produto juntamente com os botões novo, editar e excluir](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span></span>

<span data-ttu-id="c2e05-356">**Figura 22**: o `ItemTemplate` FormView padrão lista cada campo de produto juntamente com os botões novo, editar e excluir ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span></span>

<span data-ttu-id="c2e05-357">Assim como com GridView e DetailsView, clicar no botão Delete ou em qualquer Button, LinkButton ou ImageButton cuja propriedade `CommandName` está definida como delete causa um postback, popula o `DeleteParameters` do ObjectDataSource com base no valor de `DataKeyNames` do FormView e invoca o método `Delete()` do ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="c2e05-358">Quando o botão Editar é clicado em um postback massacre e os dados são reassociados ao `EditItemTemplate`, o que é responsável por renderizar a interface de edição.</span><span class="sxs-lookup"><span data-stu-id="c2e05-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="c2e05-359">Essa interface inclui os controles da Web para editar dados juntamente com os botões atualizar e cancelar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="c2e05-360">O `EditItemTemplate` padrão gerado pelo Visual Studio contém um rótulo para todos os campos de incremento automático (`ProductID`), uma caixa de texto para cada campo de valor não booliano e uma caixa de seleção para cada campo de valor booliano.</span><span class="sxs-lookup"><span data-stu-id="c2e05-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="c2e05-361">Esse comportamento é muito semelhante aos BoundFields gerados automaticamente nos controles GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-362">Um pequeno problema com a geração automática do FormView do `EditItemTemplate` é que ele processa controles da Web TextBox para os campos que são somente leitura, como `CategoryName` e `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="c2e05-363">Veremos como considerar isso em breve.</span><span class="sxs-lookup"><span data-stu-id="c2e05-363">We'll see how to account for this shortly.</span></span>

<span data-ttu-id="c2e05-364">Os controles de caixa de texto no `EditItemTemplate` têm sua propriedade `Text` associada ao valor de seu campo de dados correspondente usando *DataBinding bidirecional*.</span><span class="sxs-lookup"><span data-stu-id="c2e05-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="c2e05-365">A ligação de dados bidirecional, denotada por `<%# Bind("dataField") %>`, executa DataBinding ao associar dados ao modelo e ao preencher os parâmetros de ObjectDataSource para inserção ou edição de registros.</span><span class="sxs-lookup"><span data-stu-id="c2e05-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="c2e05-366">Ou seja, quando o usuário clica no botão Editar na `ItemTemplate`, o método `Bind()` retorna o valor do campo de dados especificado.</span><span class="sxs-lookup"><span data-stu-id="c2e05-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="c2e05-367">Depois que o usuário faz suas alterações e clica em atualizar, os valores postados que correspondem aos campos de dados especificados usando `Bind()` são aplicados à `UpdateParameters`de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="c2e05-368">Como alternativa, DataBinding unidirecional, indicada por `<%# Eval("dataField") %>`, recupera apenas os valores de campo de dados ao vincular dados ao modelo e *não* retorna os valores inseridos pelo usuário para os parâmetros da fonte de dados no postback.</span><span class="sxs-lookup"><span data-stu-id="c2e05-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="c2e05-369">A marcação declarativa a seguir mostra o `EditItemTemplate`do FormView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="c2e05-370">Observe que o método `Bind()` é usado na sintaxe DataBinding aqui e que os controles da Web do botão Update e Cancel têm suas propriedades `CommandName` definidas adequadamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample9.aspx)]

<span data-ttu-id="c2e05-371">Nosso `EditItemTemplate`, neste ponto, fará com que uma exceção seja gerada se tentarmos usá-la.</span><span class="sxs-lookup"><span data-stu-id="c2e05-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="c2e05-372">O problema é que os campos `CategoryName` e `SupplierName` são renderizados como controles da Web TextBox no `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="c2e05-373">Precisamos alterar esses TextBoxes para rótulos ou removê-los completamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="c2e05-374">Vamos simplesmente excluí-los totalmente da `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="c2e05-375">A Figura 23 mostra o FormView em um navegador depois que o botão de edição é clicado para Chai.</span><span class="sxs-lookup"><span data-stu-id="c2e05-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="c2e05-376">Observe que os campos `SupplierName` e `CategoryName` mostrados no `ItemTemplate` não estão mais presentes, pois nós acabamos de removê-los do `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="c2e05-377">Quando o botão de atualização é clicado, o FormView prossegue na mesma sequência de etapas que os controles GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>

<span data-ttu-id="c2e05-378">[![por padrão, o EditItemTemplate mostra cada campo de produto editável como uma caixa de texto ou caixa de seleção](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span></span>

<span data-ttu-id="c2e05-379">**Figura 23**: por padrão, a `EditItemTemplate` mostra cada campo de produto editável como uma caixa de texto ou caixa de seleção ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span></span>

<span data-ttu-id="c2e05-380">Quando o botão de inserção é clicado, o `ItemTemplate` do FormView é um massacre de postback.</span><span class="sxs-lookup"><span data-stu-id="c2e05-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="c2e05-381">No entanto, nenhum dado é associado ao FormView porque um novo registro está sendo adicionado.</span><span class="sxs-lookup"><span data-stu-id="c2e05-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="c2e05-382">A interface `InsertItemTemplate` inclui os controles da Web para adicionar um novo registro junto com os botões inserir e cancelar.</span><span class="sxs-lookup"><span data-stu-id="c2e05-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="c2e05-383">O `InsertItemTemplate` padrão gerado pelo Visual Studio contém uma caixa de texto para cada campo de valor não booliano e uma caixa de seleção para cada campo de valor booliano, semelhante à interface de `EditItemTemplate`gerada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="c2e05-384">Os controles TextBox têm sua propriedade `Text` associada ao valor de seu campo de dados correspondente usando DataBinding bidirecional.</span><span class="sxs-lookup"><span data-stu-id="c2e05-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="c2e05-385">A marcação declarativa a seguir mostra o `InsertItemTemplate`do FormView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="c2e05-386">Observe que o método `Bind()` é usado na sintaxe DataBinding aqui e que os controles da Web do botão Inserir e cancelar têm suas propriedades `CommandName` definidas adequadamente.</span><span class="sxs-lookup"><span data-stu-id="c2e05-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample10.aspx)]

<span data-ttu-id="c2e05-387">Há uma sutileza com a geração automática do FormView do `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="c2e05-388">Especificamente, os controles da Web TextBox são criados mesmo para aqueles campos que são somente leitura, como `CategoryName` e `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="c2e05-389">Assim como com o `EditItemTemplate`, precisamos remover essas caixas de textdas `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="c2e05-390">A figura 24 mostra o FormView em um navegador ao adicionar um novo produto, Acme Coffee.</span><span class="sxs-lookup"><span data-stu-id="c2e05-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="c2e05-391">Observe que os campos `SupplierName` e `CategoryName` mostrados no `ItemTemplate` não estão mais presentes, pois nós acabamos de removê-los.</span><span class="sxs-lookup"><span data-stu-id="c2e05-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="c2e05-392">Quando o botão de inserção é clicado, o FormView prossegue na mesma sequência de etapas que o controle DetailsView, adicionando um novo registro à tabela `Products`.</span><span class="sxs-lookup"><span data-stu-id="c2e05-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="c2e05-393">A figura 25 mostra os detalhes do produto da Acme Coffee no FormView depois que ele é inserido.</span><span class="sxs-lookup"><span data-stu-id="c2e05-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>

<span data-ttu-id="c2e05-394">[![o InsertItemTemplate determina a interface de inserção do FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span></span>

<span data-ttu-id="c2e05-395">**Figura 24**: a `InsertItemTemplate` determina a interface de inserção do FormView ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span></span>

<span data-ttu-id="c2e05-396">[![os detalhes do novo produto, Acme Coffee, são exibidos no FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="c2e05-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span></span>

<span data-ttu-id="c2e05-397">**Figura 25**: os detalhes do novo produto, Acme Coffee, são exibidos no FormView ([clique para exibir a imagem em tamanho normal](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span><span class="sxs-lookup"><span data-stu-id="c2e05-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span></span>

<span data-ttu-id="c2e05-398">Ao separar as interfaces somente leitura, editar e inserir em três modelos separados, o FormView permite um grau mais preciso de controle sobre essas interfaces do que o DetailsView e o GridView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="c2e05-399">Como o DetailsView, a propriedade `CurrentMode` do FormView indica a interface que está sendo exibida e sua propriedade `DefaultMode` indica o modo que FormView retorna após uma edição ou inserção ser concluída.</span><span class="sxs-lookup"><span data-stu-id="c2e05-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>

## <a name="summary"></a><span data-ttu-id="c2e05-400">Resumo</span><span class="sxs-lookup"><span data-stu-id="c2e05-400">Summary</span></span>

<span data-ttu-id="c2e05-401">Neste tutorial, examinamos as noções básicas de inserção, edição e exclusão de dados usando GridView, DetailsView e FormView.</span><span class="sxs-lookup"><span data-stu-id="c2e05-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="c2e05-402">Todos esses três controles fornecem algum nível de recursos de modificação de dados internos que podem ser utilizados sem escrever uma única linha de código na página ASP.NET graças aos controles da Web de dados e ao ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="c2e05-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="c2e05-403">No entanto, as técnicas simples de ponto e clique renderizam uma interface do usuário de modificação de dados bastante Frail e ingênua.</span><span class="sxs-lookup"><span data-stu-id="c2e05-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="c2e05-404">Para fornecer validação, injetar valores programáticos, tratar exceções normalmente, personalizar a interface do usuário e assim por diante, precisaremos contar com uma apresentação de técnicas que serão discutidas nos próximos vários tutoriais.</span><span class="sxs-lookup"><span data-stu-id="c2e05-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="c2e05-405">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="c2e05-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c2e05-406">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="c2e05-406">About the Author</span></span>

<span data-ttu-id="c2e05-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="c2e05-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c2e05-408">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="c2e05-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c2e05-409">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c2e05-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c2e05-410">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c2e05-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c2e05-411">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c2e05-411">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c2e05-412">[Anterior](limiting-data-modification-functionality-based-on-the-user-cs.md)
> [Próximo](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c2e05-412">[Previous](limiting-data-modification-functionality-based-on-the-user-cs.md)
[Next](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>
