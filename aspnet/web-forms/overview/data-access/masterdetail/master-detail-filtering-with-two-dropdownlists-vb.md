---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
title: Filtragem de mestre/detalhes com duas DropDownLists (VB) | Microsoft Docs
author: rick-anderson
description: Este tutorial expande a relação mestre/detalhes para adicionar uma terceira camada, usando dois controles DropDownList para selecionar o pai desejado e o avô superiores...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 11ae4f64-01ba-4823-95f4-a2fe1f84f7d7
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
msc.type: authoredcontent
ms.openlocfilehash: 166d6a7664a326361dc2a3f115eddb988cd39d20
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78528493"
---
# <a name="masterdetail-filtering-with-two-dropdownlists-vb"></a><span data-ttu-id="29b2a-103">Filtragem mestre/detalhes com duas DropDownLists (VB)</span><span class="sxs-lookup"><span data-stu-id="29b2a-103">Master/Detail Filtering With Two DropDownLists (VB)</span></span>

<span data-ttu-id="29b2a-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="29b2a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="29b2a-105">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) ou [baixar PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="29b2a-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span></span>

> <span data-ttu-id="29b2a-106">Este tutorial expande a relação mestre/detalhes para adicionar uma terceira camada, usando dois controles DropDownList para selecionar os registros pai e avô desejados.</span><span class="sxs-lookup"><span data-stu-id="29b2a-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>

## <a name="introduction"></a><span data-ttu-id="29b2a-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="29b2a-107">Introduction</span></span>

<span data-ttu-id="29b2a-108">No [tutorial anterior](master-detail-filtering-with-a-dropdownlist-vb.md) , examinamos como exibir um relatório mestre/detalhes simples usando uma única DropDownList populada com as categorias e um GridView mostrando os produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-vb.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="29b2a-109">Esse padrão de relatório funciona bem ao exibir registros que têm uma relação um-para-muitos e pode ser facilmente estendido para funcionar em cenários que incluem várias relações um-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="29b2a-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="29b2a-110">Por exemplo, um sistema de entrada de pedidos teria tabelas que correspondam a clientes, pedidos e itens de linha de pedido.</span><span class="sxs-lookup"><span data-stu-id="29b2a-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="29b2a-111">Um determinado cliente pode ter vários pedidos com cada pedido que consiste em vários itens.</span><span class="sxs-lookup"><span data-stu-id="29b2a-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="29b2a-112">Esses dados podem ser apresentados ao usuário com dois DropDownLists e um GridView.</span><span class="sxs-lookup"><span data-stu-id="29b2a-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="29b2a-113">A primeira DropDownList teria um item de lista para cada cliente no banco de dados com o conteúdo do segundo, sendo os pedidos feitos pelo cliente selecionado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="29b2a-114">Um GridView listaria os itens de linha da ordem selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="29b2a-115">Embora o banco de dados Northwind inclua as informações de detalhes canônicos de cliente/pedido/pedido em suas tabelas `Customers`, `Orders`e `Order Details`, essas tabelas não são capturadas em nossa arquitetura.</span><span class="sxs-lookup"><span data-stu-id="29b2a-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="29b2a-116">No entanto, ainda podemos ilustrar o uso de dois DropDownLists dependentes.</span><span class="sxs-lookup"><span data-stu-id="29b2a-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="29b2a-117">A primeira DropDownList listará as categorias e o segundo os produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="29b2a-118">Um DetailsView listará os detalhes do produto selecionado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="29b2a-119">Etapa 1: Criando e preenchendo as categorias DropDownList</span><span class="sxs-lookup"><span data-stu-id="29b2a-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="29b2a-120">Nosso primeiro objetivo é adicionar o DropDownList que lista as categorias.</span><span class="sxs-lookup"><span data-stu-id="29b2a-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="29b2a-121">Essas etapas foram examinadas em detalhes no tutorial anterior, mas são resumidas aqui para fins de integridade.</span><span class="sxs-lookup"><span data-stu-id="29b2a-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="29b2a-122">Abra a página `MasterDetailsDetails.aspx` na pasta `Filtering`, adicione uma DropDownList à página, defina sua propriedade `ID` como `Categories`e, em seguida, clique no link configurar fonte de dados em sua marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="29b2a-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="29b2a-123">No assistente de configuração da fonte de dados, escolha Adicionar uma nova fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="29b2a-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>

<span data-ttu-id="29b2a-124">[![adicionar uma nova fonte de dados para a DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span></span>

<span data-ttu-id="29b2a-125">**Figura 1**: adicionar uma nova fonte de dados para a DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span></span>

<span data-ttu-id="29b2a-126">A nova fonte de dados deve, naturalmente, ser um ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="29b2a-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="29b2a-127">Nomeie esse novo ObjectDataSource `CategoriesDataSource` e faça com que ele invoque o método de `GetCategories()` do objeto `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="29b2a-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>

<span data-ttu-id="29b2a-128">[![optar por usar a classe CategoriesBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span></span>

<span data-ttu-id="29b2a-129">**Figura 2**: escolha usar a classe `CategoriesBLL` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span></span>

<span data-ttu-id="29b2a-130">[![configurar o ObjectDataSource para usar o método GetCategories ()](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span></span>

<span data-ttu-id="29b2a-131">**Figura 3**: configurar o ObjectDataSource para usar o método `GetCategories()` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span></span>

<span data-ttu-id="29b2a-132">Depois de configurar o ObjectDataSource, ainda precisamos especificar qual campo de fonte de dados deve ser exibido no `Categories` DropDownList e qual deles deve ser configurado como o valor para o item de lista.</span><span class="sxs-lookup"><span data-stu-id="29b2a-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="29b2a-133">Defina o campo `CategoryName` como a exibição e `CategoryID` como o valor de cada item de lista.</span><span class="sxs-lookup"><span data-stu-id="29b2a-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="29b2a-134">[![fazer com que a DropDownList exiba o campo CategoryName e use CategoryID como o valor](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span></span>

<span data-ttu-id="29b2a-135">**Figura 4**: fazer com que a DropDownList exiba o campo `CategoryName` e use `CategoryID` como o valor ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span></span>

<span data-ttu-id="29b2a-136">Neste ponto, temos um controle DropDownList (`Categories`) que é populado com os registros da tabela `Categories`.</span><span class="sxs-lookup"><span data-stu-id="29b2a-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="29b2a-137">Quando o usuário escolhe uma nova categoria da DropDownList, queremos que um postback ocorra para atualizar o produto DropDownList que vamos criar na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="29b2a-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="29b2a-138">Portanto, marque a opção Habilitar AutoPostBack na marca inteligente da `categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="29b2a-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>

<span data-ttu-id="29b2a-139">[![habilitar AutoPostBack para as categorias DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span></span>

<span data-ttu-id="29b2a-140">**Figura 5**: habilitar AutoPostBack para o `Categories` DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span></span>

## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="29b2a-141">Etapa 2: exibindo os produtos da categoria selecionada em uma segunda DropDownList</span><span class="sxs-lookup"><span data-stu-id="29b2a-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="29b2a-142">Com a `Categories` DropDownList concluída, nossa próxima etapa é exibir uma DropDownList dos produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="29b2a-143">Para fazer isso, adicione outra DropDownList à página chamada `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="29b2a-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="29b2a-144">Assim como ocorre com o `Categories` DropDownList, crie um novo ObjectDataSource para o `ProductsByCategory` DropDownList chamado `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="29b2a-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>

<span data-ttu-id="29b2a-145">[![adicionar uma nova fonte de dados para o ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span></span>

<span data-ttu-id="29b2a-146">**Figura 6**: adicionar uma nova fonte de dados para o `ProductsByCategory` DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span></span>

<span data-ttu-id="29b2a-147">[![criar um novo ObjectDataSource chamado ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span></span>

<span data-ttu-id="29b2a-148">**Figura 7**: criar um novo ObjectDataSource chamado `ProductsByCategoryDataSource` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span></span>

<span data-ttu-id="29b2a-149">Como o `ProductsByCategory` DropDownList precisa exibir apenas os produtos que pertencem à categoria selecionada, faça com que o ObjectDataSource invoque o método `GetProductsByCategoryID(categoryID)` do objeto `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="29b2a-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>

<span data-ttu-id="29b2a-150">[![optar por usar a classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span></span>

<span data-ttu-id="29b2a-151">**Figura 8**: escolha usar a classe `ProductsBLL` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span></span>

<span data-ttu-id="29b2a-152">[![configurar o ObjectDataSource para usar o método GetProductsByCategoryID (categoryID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span></span>

<span data-ttu-id="29b2a-153">**Figura 9**: configurar o ObjectDataSource para usar o método `GetProductsByCategoryID(categoryID)` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span></span>

<span data-ttu-id="29b2a-154">Na etapa final do assistente, precisamos especificar o valor do parâmetro *`categoryID`* .</span><span class="sxs-lookup"><span data-stu-id="29b2a-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="29b2a-155">Atribua esse parâmetro ao item selecionado da `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="29b2a-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>

<span data-ttu-id="29b2a-156">[![extrair o valor do parâmetro categoryID das categorias DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span></span>

<span data-ttu-id="29b2a-157">**Figura 10**: efetuar pull do valor do parâmetro *`categoryID`* da `Categories` DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span></span>

<span data-ttu-id="29b2a-158">Com o ObjectDataSource configurado, tudo o que resta é especificar quais campos de fonte de dados são usados para a exibição e o valor dos itens da DropDownList.</span><span class="sxs-lookup"><span data-stu-id="29b2a-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="29b2a-159">Exiba o campo `ProductName` e use o campo `ProductID` como o valor.</span><span class="sxs-lookup"><span data-stu-id="29b2a-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>

<span data-ttu-id="29b2a-160">[![especificar os campos de fonte de dados usados para as propriedades Text e Value da DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span></span>

<span data-ttu-id="29b2a-161">**Figura 11**: especificar os campos de fonte de dados usados para as propriedades `ListItem` s `Text` e `Value` do DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span></span>

<span data-ttu-id="29b2a-162">Com o ObjectDataSource e `ProductsByCategory` DropDownList configurados, nossa página exibirá dois DropDownLists: o primeiro listará todas as categorias, enquanto a segunda listará os produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="29b2a-163">Quando o usuário selecionar uma nova categoria da primeira DropDownList, um postback será acontecerdo e a segunda DropDownList será reassociada, mostrando os produtos que pertencem à categoria selecionada recentemente.</span><span class="sxs-lookup"><span data-stu-id="29b2a-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="29b2a-164">As figuras 12 e 13 mostram `MasterDetailsDetails.aspx` em ação quando exibidas por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="29b2a-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>

<span data-ttu-id="29b2a-165">[![ao visitar a página pela primeira vez, a categoria bebidas está selecionada](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span></span>

<span data-ttu-id="29b2a-166">**Figura 12**: ao visitar a página pela primeira vez, a categoria bebidas é selecionada ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span></span>

<span data-ttu-id="29b2a-167">[![escolher uma categoria diferente exibe os produtos da nova categoria](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span></span>

<span data-ttu-id="29b2a-168">**Figura 13**: escolher uma categoria diferente exibe os produtos da nova categoria ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span></span>

<span data-ttu-id="29b2a-169">Atualmente, a `productsByCategory` DropDownList, quando alterada, *não* causa um postback.</span><span class="sxs-lookup"><span data-stu-id="29b2a-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="29b2a-170">No entanto, queremos que um postback ocorra depois de adicionar um DetailsView para exibir os detalhes do produto selecionado (etapa 3).</span><span class="sxs-lookup"><span data-stu-id="29b2a-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="29b2a-171">Portanto, marque a caixa de seleção Habilitar AutoPostBack na marca inteligente da `productsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="29b2a-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>

<span data-ttu-id="29b2a-172">[![habilitar o recurso AutoPostBack para o productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span></span>

<span data-ttu-id="29b2a-173">**Figura 14**: habilitar o recurso AutoPostBack para o `productsByCategory` DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span></span>

## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="29b2a-174">Etapa 3: usando um DetailsView para exibir detalhes do produto selecionado</span><span class="sxs-lookup"><span data-stu-id="29b2a-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="29b2a-175">A etapa final é exibir os detalhes do produto selecionado em um DetailsView.</span><span class="sxs-lookup"><span data-stu-id="29b2a-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="29b2a-176">Para fazer isso, adicione um DetailsView à página, defina sua propriedade `ID` como `ProductDetails`e crie um novo ObjectDataSource para ele.</span><span class="sxs-lookup"><span data-stu-id="29b2a-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="29b2a-177">Configure esse ObjectDataSource para efetuar pull de seus dados do método `GetProductByProductID(productID)` da classe `ProductsBLL` usando o valor selecionado do `ProductsByCategory` DropDownList para o valor do parâmetro *`productID`* .</span><span class="sxs-lookup"><span data-stu-id="29b2a-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>

<span data-ttu-id="29b2a-178">[![optar por usar a classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span></span>

<span data-ttu-id="29b2a-179">**Figura 15**: escolha usar a classe `ProductsBLL` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span></span>

<span data-ttu-id="29b2a-180">[![configurar o ObjectDataSource para usar o método GetProductByProductID (productID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span></span>

<span data-ttu-id="29b2a-181">**Figura 16**: configurar o ObjectDataSource para usar o método `GetProductByProductID(productID)` ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span></span>

<span data-ttu-id="29b2a-182">[![extrair o valor do parâmetro productID do ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span></span>

<span data-ttu-id="29b2a-183">**Figura 17**: efetuar pull do valor do parâmetro *`productID`* da `ProductsByCategory` DropDownList ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span></span>

<span data-ttu-id="29b2a-184">Você pode optar por exibir qualquer um dos campos disponíveis no `ProductDetails` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="29b2a-184">You can choose to display any of the available fields in the `ProductDetails` DetailsView.</span></span> <span data-ttu-id="29b2a-185">Eu optei por remover os campos `ProductID`, `SupplierID`e `CategoryID` e reordenados e formatados os campos restantes.</span><span class="sxs-lookup"><span data-stu-id="29b2a-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="29b2a-186">Além disso, Eu desmarquei as propriedades `Height` e `Width` de DetailsView, permitindo que o DetailsView expanda a largura necessária para exibir melhor seus dados em vez de tê-los restritos a um tamanho especificado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="29b2a-187">A marcação completa aparece abaixo:</span><span class="sxs-lookup"><span data-stu-id="29b2a-187">The full markup appears below:</span></span>

[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample1.aspx)]

<span data-ttu-id="29b2a-188">Reserve um tempo para experimentar a página `MasterDetailsDetails.aspx` em um navegador.</span><span class="sxs-lookup"><span data-stu-id="29b2a-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="29b2a-189">À primeira vista, pode parecer que tudo está funcionando conforme o desejado, mas há um problema sutil.</span><span class="sxs-lookup"><span data-stu-id="29b2a-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="29b2a-190">Quando você escolhe uma nova categoria, o `ProductsByCategory` DropDownList é atualizado para incluir esses produtos para a categoria selecionada, mas o `ProductDetails` DetailsView continuou a mostrar as informações do produto anterior.</span><span class="sxs-lookup"><span data-stu-id="29b2a-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="29b2a-191">O DetailsView é atualizado ao escolher um produto diferente para a categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="29b2a-192">Além disso, se você testar completamente o suficiente, descobrirá que, se você escolher continuamente novas categorias (como escolher bebidas do `Categories` DropDownList, depois condiments, então, doces) todas as outras seleções de categoria fazem com que o `ProductDetails` DetailsView seja atualizado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="29b2a-193">Para ajudar a concretizarr esse problema, vamos dar uma olhada em um exemplo específico.</span><span class="sxs-lookup"><span data-stu-id="29b2a-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="29b2a-194">Quando você visita a página pela primeira vez a categoria bebidas está selecionada e os produtos relacionados são carregados no `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="29b2a-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="29b2a-195">Chai é o produto selecionado e seus detalhes são exibidos no `ProductDetails` DetailsView, como mostra a Figura 18.</span><span class="sxs-lookup"><span data-stu-id="29b2a-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>

<span data-ttu-id="29b2a-196">[![os detalhes do produto selecionado são exibidos em um DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span></span>

<span data-ttu-id="29b2a-197">**Figura 18**: os detalhes do produto selecionado são exibidos em um DetailsView ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span></span>

<span data-ttu-id="29b2a-198">Se você alterar a seleção de categoria de bebidas para condiments, ocorrerá um postback e o `ProductsByCategory` DropDownList será atualizado de acordo, mas o DetailsView ainda exibirá detalhes de Chai.</span><span class="sxs-lookup"><span data-stu-id="29b2a-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>

<span data-ttu-id="29b2a-199">[![os detalhes do produto selecionado anteriormente ainda são exibidos](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span></span>

<span data-ttu-id="29b2a-200">**Figura 19**: os detalhes do produto selecionado anteriormente ainda são exibidos ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span></span>

<span data-ttu-id="29b2a-201">A escolha de um novo produto da lista atualiza o DetailsView conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="29b2a-202">Se você escolher uma nova categoria depois de alterar o produto, o DetailsView novamente não será atualizado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="29b2a-203">No entanto, se, em vez de escolher um novo produto, você selecionou uma nova categoria, o DetailsView seria atualizado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="29b2a-204">O que o mundo está acontecendo aqui?</span><span class="sxs-lookup"><span data-stu-id="29b2a-204">What in the world is going on here?</span></span>

<span data-ttu-id="29b2a-205">O problema é um problema de tempo no ciclo de vida da página.</span><span class="sxs-lookup"><span data-stu-id="29b2a-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="29b2a-206">Sempre que uma página é solicitada, ela prossegue por várias etapas como seu processamento.</span><span class="sxs-lookup"><span data-stu-id="29b2a-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="29b2a-207">Em uma dessas etapas, os controles ObjectDataSource verificam se algum de seus `SelectParameters` valores foram alterados.</span><span class="sxs-lookup"><span data-stu-id="29b2a-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="29b2a-208">Nesse caso, o controle da Web de dados associado ao ObjectDataSource sabe que ele precisa atualizar sua exibição.</span><span class="sxs-lookup"><span data-stu-id="29b2a-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="29b2a-209">Por exemplo, quando uma nova categoria é selecionada, o `ProductsByCategoryDataSource` ObjectDataSource detecta que seus valores de parâmetro foram alterados e o `ProductsByCategory` DropDownList se reassocia a si mesmo, obtendo os produtos para a categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="29b2a-210">O problema que surge nessa situação é que o ponto no ciclo de vida da página que os SQLDataSources verificam parâmetros alterados ocorre *antes* da reassociação dos controles da Web de dados associados.</span><span class="sxs-lookup"><span data-stu-id="29b2a-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="29b2a-211">Portanto, ao selecionar uma nova categoria, o `ProductsByCategoryDataSource` ObjectDataSource detecta uma alteração no valor do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="29b2a-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="29b2a-212">O ObjectDataSource usado pelo `ProductDetails` DetailsView, no entanto, não anota essas alterações porque o `ProductsByCategory` DropDownList ainda precisa ser reassociado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="29b2a-213">Posteriormente no ciclo de vida, o `ProductsByCategory` DropDownList será reassociado a seu ObjectDataSource, captando os produtos para a categoria selecionada recentemente.</span><span class="sxs-lookup"><span data-stu-id="29b2a-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="29b2a-214">Embora o valor da `ProductsByCategory` DropDownList tenha sido alterado, o ObjectDataSource da `ProductDetails` DetailsView já fez a verificação do valor do parâmetro; Portanto, o DetailsView exibe seus resultados anteriores.</span><span class="sxs-lookup"><span data-stu-id="29b2a-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="29b2a-215">Essa interação é descrita na Figura 20.</span><span class="sxs-lookup"><span data-stu-id="29b2a-215">This interaction is depicted in Figure 20.</span></span>

<span data-ttu-id="29b2a-216">[![o valor de DropDownList ProductsByCategory é alterado depois que o ObjectDataSource do ProductDetails DetailsView verifica se há alterações](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span></span>

<span data-ttu-id="29b2a-217">**Figura 20**: o valor `ProductsByCategory` DropDownList é alterado depois que o ObjectDataSource do `ProductDetails` DetailsView verifica se há alterações ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span></span>

<span data-ttu-id="29b2a-218">Para corrigir isso, precisamos reassociar explicitamente o `ProductDetails` DetailsView depois que o `ProductsByCategory` DropDownList tiver sido associado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="29b2a-219">Podemos fazer isso chamando o método `DataBind()` do `ProductDetails` DetailsView quando o evento `DataBound` do `ProductsByCategory` DropDownList é acionado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="29b2a-220">Adicione o seguinte código de manipulador de eventos à classe code-behind da página de `MasterDetailsDetails.aspx` (consulte "[definindo programaticamente os valores de parâmetro de ObjectDataSource](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" para obter uma discussão sobre como adicionar um manipulador de eventos):</span><span class="sxs-lookup"><span data-stu-id="29b2a-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>

[!code-vb[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample2.vb)]

<span data-ttu-id="29b2a-221">Depois que essa chamada explícita para o método `DataBind()` do `ProductDetails` DetailsView tiver sido adicionada, o tutorial funcionará conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="29b2a-222">A figura 21 realça como essa alteração corrigiu nosso problema anterior.</span><span class="sxs-lookup"><span data-stu-id="29b2a-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>

<span data-ttu-id="29b2a-223">[![o ProductDetails DetailsView é atualizado explicitamente quando o evento de ligação de eventos de ProductsByCategory DropDownList é acionado](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="29b2a-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span></span>

<span data-ttu-id="29b2a-224">**Figura 21**: a `ProductDetails` DetailsView é atualizada explicitamente quando o evento de `DataBound` da `ProductsByCategory` DropDownList é acionado ([clique para exibir a imagem em tamanho normal](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="29b2a-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span></span>

## <a name="summary"></a><span data-ttu-id="29b2a-225">Resumo</span><span class="sxs-lookup"><span data-stu-id="29b2a-225">Summary</span></span>

<span data-ttu-id="29b2a-226">O DropDownList serve como um elemento de interface de usuário ideal para relatórios mestre/detalhados em que há uma relação um-para-muitos entre os registros mestre e de detalhes.</span><span class="sxs-lookup"><span data-stu-id="29b2a-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="29b2a-227">No tutorial anterior, vimos como usar uma única DropDownList para filtrar os produtos exibidos pela categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="29b2a-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="29b2a-228">Neste tutorial, substituímos o GridView dos produtos por uma DropDownList e usavai um DetailsView para exibir os detalhes do produto selecionado.</span><span class="sxs-lookup"><span data-stu-id="29b2a-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="29b2a-229">Os conceitos discutidos neste tutorial podem ser facilmente estendidos para modelos de dados que envolvem várias relações um-para-muitos, como clientes, pedidos e itens de pedidos.</span><span class="sxs-lookup"><span data-stu-id="29b2a-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="29b2a-230">Em geral, você sempre pode adicionar uma DropDownList para cada uma das entidades "uma" nas relações um-para-muitos.</span><span class="sxs-lookup"><span data-stu-id="29b2a-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="29b2a-231">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="29b2a-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="29b2a-232">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="29b2a-232">About the Author</span></span>

<span data-ttu-id="29b2a-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="29b2a-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="29b2a-234">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="29b2a-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="29b2a-235">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="29b2a-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="29b2a-236">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="29b2a-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="29b2a-237">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="29b2a-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="29b2a-238">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="29b2a-238">Special Thanks To</span></span>

<span data-ttu-id="29b2a-239">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="29b2a-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="29b2a-240">O revisor de Lead para este tutorial foi Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="29b2a-240">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="29b2a-241">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="29b2a-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="29b2a-242">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="29b2a-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="29b2a-243">[Anterior](master-detail-filtering-with-a-dropdownlist-vb.md)
> [Próximo](master-detail-filtering-across-two-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="29b2a-243">[Previous](master-detail-filtering-with-a-dropdownlist-vb.md)
[Next](master-detail-filtering-across-two-pages-vb.md)</span></span>
