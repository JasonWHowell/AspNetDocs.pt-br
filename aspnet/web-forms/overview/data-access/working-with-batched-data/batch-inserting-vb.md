---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
title: Inserção em lote (VB) | Microsoft Docs
author: rick-anderson
description: Saiba como inserir vários registros de banco de dados em uma única operação. Na camada de interface do usuário, estendemos o GridView para permitir que o usuário insira vários n...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: 48e2a4ae-77ca-4208-a204-c38c690ffb59
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
msc.type: authoredcontent
ms.openlocfilehash: 413a0e209b1899414eaab70aff07ee0d3223f28f
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78618569"
---
# <a name="batch-inserting-vb"></a><span data-ttu-id="01cfc-104">Inserção em lote (VB)</span><span class="sxs-lookup"><span data-stu-id="01cfc-104">Batch Inserting (VB)</span></span>

<span data-ttu-id="01cfc-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="01cfc-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="01cfc-106">[Baixar código](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) ou [baixar PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="01cfc-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) or [Download PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span></span>

> <span data-ttu-id="01cfc-107">Saiba como inserir vários registros de banco de dados em uma única operação.</span><span class="sxs-lookup"><span data-stu-id="01cfc-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="01cfc-108">Na camada de interface do usuário, estendemos o GridView para permitir que o usuário insira vários novos registros.</span><span class="sxs-lookup"><span data-stu-id="01cfc-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="01cfc-109">Na camada de acesso a dados, Encapsulamos as várias operações de inserção em uma transação para garantir que todas as inserções tenham sucesso ou que todas as inserções sejam revertidas.</span><span class="sxs-lookup"><span data-stu-id="01cfc-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="01cfc-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="01cfc-110">Introduction</span></span>

<span data-ttu-id="01cfc-111">No tutorial de [atualização do lote](batch-updating-vb.md) , examinamos a personalização do controle GridView para apresentar uma interface em que vários registros eram editáveis.</span><span class="sxs-lookup"><span data-stu-id="01cfc-111">In the [Batch Updating](batch-updating-vb.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="01cfc-112">O usuário que está visitando a página pode fazer uma série de alterações e, em seguida, com um único clique de botão, executar uma atualização em lotes.</span><span class="sxs-lookup"><span data-stu-id="01cfc-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="01cfc-113">Para situações em que os usuários normalmente atualizam muitos registros em uma só vez, essa interface pode economizar inúmeros cliques e opções de contexto de teclado para mouse quando comparadas aos recursos de edição por linha padrão que foram explorados primeiro na [visão geral do tutorial inserir, atualizar e excluir dados](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="01cfc-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial.</span></span>

<span data-ttu-id="01cfc-114">Esse conceito também pode ser aplicado ao adicionar registros.</span><span class="sxs-lookup"><span data-stu-id="01cfc-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="01cfc-115">Imagine que, na Northwind Traders, geralmente recebemos remessas de fornecedores que contêm vários produtos para uma determinada categoria.</span><span class="sxs-lookup"><span data-stu-id="01cfc-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="01cfc-116">Por exemplo, podemos receber uma remessa de seis produtos de chá e café diferentes de Tokyo Traders.</span><span class="sxs-lookup"><span data-stu-id="01cfc-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="01cfc-117">Se um usuário inserir os seis produtos um por vez por meio de um controle DetailsView, ele terá que escolher muitos dos mesmos valores repetidamente: eles precisarão escolher a mesma categoria (bebidas), o mesmo fornecedor (Tokyo Traders), o mesmo valor descontinuado ( False) e as mesmas unidades no valor de ordem (0).</span><span class="sxs-lookup"><span data-stu-id="01cfc-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="01cfc-118">Essa entrada repetida de dados não é apenas demorada, mas está sujeita a erros.</span><span class="sxs-lookup"><span data-stu-id="01cfc-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="01cfc-119">Com um pouco de trabalho, podemos criar uma interface de inserção em lote que permite ao usuário escolher o fornecedor e a categoria uma vez, inserir uma série de nomes de produtos e preços unitários e, em seguida, clicar em um botão para adicionar os novos produtos ao banco de dados (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="01cfc-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="01cfc-120">À medida que cada produto é adicionado, seus campos de dados `ProductName` e `UnitPrice` são atribuídos aos valores inseridos nas caixas de caixa de entrada, enquanto seus valores `CategoryID` e `SupplierID` são atribuídos aos valores de DropDownLists na parte superior do formulário.</span><span class="sxs-lookup"><span data-stu-id="01cfc-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="01cfc-121">Os valores `Discontinued` e `UnitsOnOrder` são definidos como valores embutidos em código de `False` e 0, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `False` and 0, respectively.</span></span>

<span data-ttu-id="01cfc-122">[![a interface de inserção em lote](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-122">[![The Batch Inserting Interface](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span></span>

<span data-ttu-id="01cfc-123">**Figura 1**: a interface de inserção em lote ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-vb/_static/image3.png))</span></span>

<span data-ttu-id="01cfc-124">Neste tutorial, criaremos uma página que implementa a interface de inserção em lote mostrada na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="01cfc-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="01cfc-125">Assim como nos dois tutoriais anteriores, encapsularemos as inserções dentro do escopo de uma transação para garantir a atomicidade.</span><span class="sxs-lookup"><span data-stu-id="01cfc-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="01cfc-126">Vamos começar!</span><span class="sxs-lookup"><span data-stu-id="01cfc-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="01cfc-127">Etapa 1: criando a interface de vídeo</span><span class="sxs-lookup"><span data-stu-id="01cfc-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="01cfc-128">Este tutorial consistirá em uma única página dividida em duas regiões: uma região de exibição e uma região de inserção.</span><span class="sxs-lookup"><span data-stu-id="01cfc-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="01cfc-129">A interface de vídeo, que criaremos nesta etapa, mostra os produtos em um GridView e inclui um botão intitulado processo de remessa de produto.</span><span class="sxs-lookup"><span data-stu-id="01cfc-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="01cfc-130">Quando esse botão é clicado, a interface de vídeo é substituída pela interface de inserção, que é mostrada na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="01cfc-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="01cfc-131">A interface de exibição retorna depois que os botões Adicionar produtos de remessa ou cancelar são clicados.</span><span class="sxs-lookup"><span data-stu-id="01cfc-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="01cfc-132">Vamos criar a interface de inserção na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="01cfc-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="01cfc-133">Ao criar uma página que tem duas interfaces, apenas uma delas é visível de cada vez, cada interface normalmente é colocada dentro de um [controle Web Panel](http://www.w3schools.com/aspnet/control_panel.asp), que serve como um contêiner para outros controles.</span><span class="sxs-lookup"><span data-stu-id="01cfc-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="01cfc-134">Portanto, nossa página terá dois controles de painel um para cada interface.</span><span class="sxs-lookup"><span data-stu-id="01cfc-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="01cfc-135">Comece abrindo a página `BatchInsert.aspx` na pasta `BatchData` e arraste um painel da caixa de ferramentas para o designer (consulte a Figura 2).</span><span class="sxs-lookup"><span data-stu-id="01cfc-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="01cfc-136">Defina a propriedade `ID` do painel como `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="01cfc-137">Ao adicionar o painel ao designer, suas propriedades `Height` e `Width` são definidas como 50px e 125px, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="01cfc-138">Desmarque esses valores de propriedade da janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="01cfc-138">Clear out these property values from the Properties window.</span></span>

<span data-ttu-id="01cfc-139">[![arrastar um painel da caixa de ferramentas para o designer](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span></span>

<span data-ttu-id="01cfc-140">**Figura 2**: arraste um painel da caixa de ferramentas para o designer ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-vb/_static/image6.png))</span></span>

<span data-ttu-id="01cfc-141">Em seguida, arraste um botão e controle GridView para o painel.</span><span class="sxs-lookup"><span data-stu-id="01cfc-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="01cfc-142">Defina o botão s `ID` Propriedade como `ProcessShipment` e sua propriedade `Text` para processar a remessa do produto.</span><span class="sxs-lookup"><span data-stu-id="01cfc-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="01cfc-143">Defina a Propriedade GridView s `ID` como `ProductsGrid` e, em sua marca inteligente, associe-a a um novo ObjectDataSource chamado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="01cfc-144">Configure o ObjectDataSource para efetuar pull de seus dados do método de `GetProducts` da classe `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="01cfc-145">Como esse GridView é usado somente para exibir dados, defina as listas suspensas nas guias UPDATE, INSERT e DELETE como (None).</span><span class="sxs-lookup"><span data-stu-id="01cfc-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="01cfc-146">Clique em concluir para concluir o assistente para configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="01cfc-146">Click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="01cfc-147">[![exibir os dados retornados do método GetProducts da classe ProductsBLL](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span></span>

<span data-ttu-id="01cfc-148">**Figura 3**: exibir os dados retornados do método de `GetProducts` da classe `ProductsBLL` ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-vb/_static/image9.png))</span></span>

<span data-ttu-id="01cfc-149">[![definir as listas suspensas nas guias atualizar, inserir e excluir para (nenhum)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span></span>

<span data-ttu-id="01cfc-150">**Figura 4**: definir as listas suspensas nas guias atualizar, inserir e excluir para (nenhum) ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-vb/_static/image12.png))</span></span>

<span data-ttu-id="01cfc-151">Depois de concluir o assistente ObjectDataSource, o Visual Studio adicionará BoundFields e um CheckBoxField para os campos de dados do produto.</span><span class="sxs-lookup"><span data-stu-id="01cfc-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="01cfc-152">Remova todos os campos `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`e `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="01cfc-153">Sinta-se à vontade para fazer personalizações estética.</span><span class="sxs-lookup"><span data-stu-id="01cfc-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="01cfc-154">Decidi formatar o campo `UnitPrice` como um valor de moeda, reordenar os campos e renomear vários dos campos `HeaderText` valores.</span><span class="sxs-lookup"><span data-stu-id="01cfc-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="01cfc-155">Também configure o GridView para incluir o suporte de paginação e classificação marcando as caixas de seleção habilitar paginação e Habilitar classificação na marca inteligente s do GridView.</span><span class="sxs-lookup"><span data-stu-id="01cfc-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="01cfc-156">Depois de adicionar os controles Panel, Button, GridView e ObjectDataSource e personalizar os campos de GridView, a marcação declarativa de s de página deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="01cfc-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](batch-inserting-vb/samples/sample1.aspx)]

<span data-ttu-id="01cfc-157">Observe que a marcação do botão e do GridView aparece dentro das marcas de `<asp:Panel>` de abertura e fechamento.</span><span class="sxs-lookup"><span data-stu-id="01cfc-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="01cfc-158">Como esses controles estão dentro do painel de `DisplayInterface`, podemos ocultá-los simplesmente definindo a propriedade s `Visible` do painel como `False`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `False`.</span></span> <span data-ttu-id="01cfc-159">A etapa 3 examina a alteração programática da propriedade `Visible` do painel em resposta a um clique de botão para mostrar uma interface enquanto oculta a outra.</span><span class="sxs-lookup"><span data-stu-id="01cfc-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="01cfc-160">Reserve um tempo para exibir nosso progresso por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="01cfc-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="01cfc-161">Como mostra a Figura 5, você verá um botão processar remessa de produto acima de um GridView que lista os produtos dez de cada vez.</span><span class="sxs-lookup"><span data-stu-id="01cfc-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>

<span data-ttu-id="01cfc-162">[![o GridView lista os produtos e oferece recursos de classificação e paginação](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span></span>

<span data-ttu-id="01cfc-163">**Figura 5**: o GridView lista os produtos e oferece recursos de classificação e paginação ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-vb/_static/image15.png))</span></span>

## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="01cfc-164">Etapa 2: criando a interface de inserção</span><span class="sxs-lookup"><span data-stu-id="01cfc-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="01cfc-165">Com a interface de exibição concluída, estamos prontos para criar a interface de inserção.</span><span class="sxs-lookup"><span data-stu-id="01cfc-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="01cfc-166">Para este tutorial, vamos criar uma interface de inserção que solicita um único fornecedor e valor de categoria e, em seguida, permite que o usuário insira até cinco nomes de produtos e valores de preço unitários.</span><span class="sxs-lookup"><span data-stu-id="01cfc-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="01cfc-167">Com essa interface, o usuário pode adicionar um a cinco novos produtos que compartilham a mesma categoria e o mesmo fornecedor, mas têm preços e nomes de produtos exclusivos.</span><span class="sxs-lookup"><span data-stu-id="01cfc-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="01cfc-168">Comece arrastando um painel da caixa de ferramentas para o designer, colocando-o abaixo do painel de `DisplayInterface` existente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="01cfc-169">Defina a propriedade `ID` desse painel recém-adicionado para `InsertingInterface` e defina sua propriedade `Visible` como `False`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `False`.</span></span> <span data-ttu-id="01cfc-170">Vamos adicionar o código que define a propriedade `Visible` do painel de `InsertingInterface` como `True` na etapa 3.</span><span class="sxs-lookup"><span data-stu-id="01cfc-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `True` in Step 3.</span></span> <span data-ttu-id="01cfc-171">Além disso, desmarque as `Height` s de painel e `Width` valores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="01cfc-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="01cfc-172">Em seguida, precisamos criar a interface de inserção que foi mostrada de volta na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="01cfc-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="01cfc-173">Essa interface pode ser criada por meio de uma variedade de técnicas HTML, mas usaremos uma tabela razoavelmente simples: quatro colunas de sete linhas.</span><span class="sxs-lookup"><span data-stu-id="01cfc-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="01cfc-174">Ao inserir a marcação para elementos de `<table>` HTML, prefiro usar a exibição de código-fonte.</span><span class="sxs-lookup"><span data-stu-id="01cfc-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="01cfc-175">Embora o Visual Studio tenha ferramentas para adicionar elementos de `<table>` por meio do designer, o designer parece estar muito disposto a injetar as configurações de `style` não solicitadas na marcação.</span><span class="sxs-lookup"><span data-stu-id="01cfc-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="01cfc-176">Depois de criar a marcação de `<table>`, eu geralmente retorno ao designer para adicionar os controles da Web e definir suas propriedades.</span><span class="sxs-lookup"><span data-stu-id="01cfc-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="01cfc-177">Ao criar tabelas com colunas predeterminadas e linhas, prefiro usar HTML estático em vez do [controle da Web de tabela](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) , pois os controles da Web colocados em um controle da Web de tabela só podem ser acessados usando o padrão de `FindControl("controlID")`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="01cfc-178">No entanto, eu uso controles de tabela da Web para tabelas de tamanho dinâmico (aquelas cujas linhas ou colunas se baseiam em algum banco de dados ou em critérios especificados pelo usuário), já que o controle da Web da tabela pode ser construído programaticamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>

<span data-ttu-id="01cfc-179">Insira a seguinte marcação dentro das marcas de `<asp:Panel>` do painel de `InsertingInterface`:</span><span class="sxs-lookup"><span data-stu-id="01cfc-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>

[!code-html[Main](batch-inserting-vb/samples/sample2.html)]

<span data-ttu-id="01cfc-180">Essa marcação de `<table>` não inclui nenhum controle da Web ainda; vamos adicioná-las momentaneamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="01cfc-181">Observe que cada elemento de `<tr>` contém uma configuração de classe CSS específica: `BatchInsertHeaderRow` para a linha de cabeçalho onde o fornecedor e a categoria DropDownLists vão; `BatchInsertFooterRow` para a linha de rodapé onde os botões Adicionar produtos de remessa e cancelamento vão; e alternar `BatchInsertRow` e `BatchInsertAlternatingRow` valores para as linhas que conterão os controles de caixa de texto produto e preço unitário.</span><span class="sxs-lookup"><span data-stu-id="01cfc-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="01cfc-182">Eu criei classes CSS correspondentes no arquivo `Styles.css` para dar à interface de inserção uma aparência semelhante aos controles GridView e DetailsView que usamos em todos esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="01cfc-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="01cfc-183">Essas classes CSS são mostradas abaixo.</span><span class="sxs-lookup"><span data-stu-id="01cfc-183">These CSS classes are shown below.</span></span>

[!code-css[Main](batch-inserting-vb/samples/sample3.css)]

<span data-ttu-id="01cfc-184">Com essa marcação inserida, retorne ao modo de exibição de Design.</span><span class="sxs-lookup"><span data-stu-id="01cfc-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="01cfc-185">Essa `<table>` deve ser mostrada como uma tabela de quatro colunas de sete linhas no designer, como ilustra a Figura 6.</span><span class="sxs-lookup"><span data-stu-id="01cfc-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>

<span data-ttu-id="01cfc-186">[![a interface de inserção é composta de uma tabela de quatro colunas, de sete linhas](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span></span>

<span data-ttu-id="01cfc-187">**Figura 6**: a interface de inserção é composta de uma tabela de quatro colunas de sete linhas ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-vb/_static/image18.png))</span></span>

<span data-ttu-id="01cfc-188">Agora, estamos prontos para adicionar os controles da Web à interface de inserção.</span><span class="sxs-lookup"><span data-stu-id="01cfc-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="01cfc-189">Arraste dois DropDownLists da caixa de ferramentas para as células apropriadas na tabela um para o fornecedor e outro para a categoria.</span><span class="sxs-lookup"><span data-stu-id="01cfc-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="01cfc-190">Defina a propriedade do fornecedor DropDownList s `ID` como `Suppliers` e a associe a uma nova ObjectDataSource denominada `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="01cfc-191">Configure o novo ObjectDataSource para recuperar seus dados do método `SuppliersBLL` `GetSuppliers` classe e defina a lista suspensa da guia atualizar como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="01cfc-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="01cfc-192">Clique em Concluir para finalizar o assistente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-192">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="01cfc-193">[![configurar o ObjectDataSource para usar o método SuppliersBLL da classe s getsuppliers](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span></span>

<span data-ttu-id="01cfc-194">**Figura 7**: configurar o ObjectDataSource para usar o método de `GetSuppliers` da classe `SuppliersBLL` ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-vb/_static/image21.png))</span></span>

<span data-ttu-id="01cfc-195">Faça com que o `Suppliers` DropDownList exiba o `CompanyName` campo de dados e use o campo de dados `SupplierID` como seus valores de `ListItem` s.</span><span class="sxs-lookup"><span data-stu-id="01cfc-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>

<span data-ttu-id="01cfc-196">[![exibir o campo de dados CompanyName e usar CódigoDoFornecedor como o valor](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span></span>

<span data-ttu-id="01cfc-197">**Figura 8**: exibir o campo de dados `CompanyName` e usar `SupplierID` como o valor ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-vb/_static/image24.png))</span></span>

<span data-ttu-id="01cfc-198">Nomeie a segunda `Categories` DropDownList e associe-a a uma nova ObjectDataSource chamada `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="01cfc-199">Configurar o `CategoriesDataSource` ObjectDataSource para usar o método de `GetCategories` da classe `CategoriesBLL`; Defina as listas suspensas nas guias atualizar e excluir como (nenhum) e clique em concluir para concluir o assistente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="01cfc-200">Por fim, faça com que a DropDownList exiba o campo de dados `CategoryName` e use o `CategoryID` como o valor.</span><span class="sxs-lookup"><span data-stu-id="01cfc-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="01cfc-201">Depois que essas duas DropDownLists tiverem sido adicionadas e vinculadas às ObjectDataSource configuradas adequadamente, sua tela deverá ser semelhante à figura 9.</span><span class="sxs-lookup"><span data-stu-id="01cfc-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>

<span data-ttu-id="01cfc-202">[![a linha de cabeçalho agora contém os DropDownLists de fornecedores e categorias](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span></span>

<span data-ttu-id="01cfc-203">**Figura 9**: a linha de cabeçalho agora contém as `Suppliers` e `Categories` DropDownLists ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-vb/_static/image27.png))</span></span>

<span data-ttu-id="01cfc-204">Agora, precisamos criar as caixas de entrada para coletar o nome e o preço de cada novo produto.</span><span class="sxs-lookup"><span data-stu-id="01cfc-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="01cfc-205">Arraste um controle TextBox da caixa de ferramentas para o designer para cada um dos cinco linhas de preço e nome do produto.</span><span class="sxs-lookup"><span data-stu-id="01cfc-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="01cfc-206">Defina as propriedades `ID` das caixas de Textpara `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="01cfc-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="01cfc-207">Adicione um CompareValidator depois de cada uma das caixas de Textde preço unitário, definindo a propriedade `ControlToValidate` como o `ID`apropriado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="01cfc-208">Além disso, defina a propriedade `Operator` como `GreaterThanEqual`, `ValueToCompare` como 0 e `Type` para `Currency`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="01cfc-209">Essas configurações instruem o CompareValidator a garantir que o preço, se inserido, seja um valor de moeda válido maior ou igual a zero.</span><span class="sxs-lookup"><span data-stu-id="01cfc-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="01cfc-210">Defina a propriedade `Text` como \*e `ErrorMessage` como o preço deve ser maior ou igual a zero.</span><span class="sxs-lookup"><span data-stu-id="01cfc-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="01cfc-211">Além disso, omita os símbolos de moeda.</span><span class="sxs-lookup"><span data-stu-id="01cfc-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="01cfc-212">A interface de inserção não inclui nenhum controle de RequiredFieldValidator, mesmo que o campo `ProductName` na tabela de banco de dados `Products` não permita valores de `NULL`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="01cfc-213">Isso ocorre porque queremos permitir que o usuário insira até cinco produtos.</span><span class="sxs-lookup"><span data-stu-id="01cfc-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="01cfc-214">Por exemplo, se o usuário fosse fornecer o nome do produto e o preço unitário das três primeiras linhas, deixando as duas últimas linhas em branco, nós d apenas adicionaremos três novos produtos ao sistema.</span><span class="sxs-lookup"><span data-stu-id="01cfc-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="01cfc-215">Como `ProductName` é necessário, no entanto, precisaremos verificar programaticamente para garantir que, se um preço unitário for inserido, um valor de nome de produto correspondente será fornecido.</span><span class="sxs-lookup"><span data-stu-id="01cfc-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="01cfc-216">Resolveremos essa verificação na etapa 4.</span><span class="sxs-lookup"><span data-stu-id="01cfc-216">We'll tackle this check in Step 4.</span></span>

<span data-ttu-id="01cfc-217">Ao validar a entrada de s do usuário, o CompareValidator relatará dados inválidos se o valor contiver um símbolo de moeda.</span><span class="sxs-lookup"><span data-stu-id="01cfc-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="01cfc-218">Adicione um $ na frente de cada uma das caixas de pagamento de preço unitário para servir como uma indicação visual que instrui o usuário a omitir o símbolo de moeda ao inserir o preço.</span><span class="sxs-lookup"><span data-stu-id="01cfc-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="01cfc-219">Por fim, adicione um controle ValidationSummary dentro do painel de `InsertingInterface`, configurações sua propriedade `ShowMessageBox` como `True` e sua propriedade `ShowSummary` como `False`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="01cfc-220">Com essas configurações, se o usuário inserir um valor de preço unitário inválido, um asterisco será exibido ao lado dos controles de caixa de texto incorretos e o ValidationSummary exibirá uma MessageBox do lado do cliente que mostra a mensagem de erro especificada anteriormente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="01cfc-221">Neste ponto, a tela deve ser semelhante à figura 10.</span><span class="sxs-lookup"><span data-stu-id="01cfc-221">At this point, your screen should look similar to Figure 10.</span></span>

<span data-ttu-id="01cfc-222">[![a interface de inserção agora inclui caixas de Textpara os nomes de produtos e preços](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span></span>

<span data-ttu-id="01cfc-223">**Figura 10**: a interface de inserção agora inclui caixas de Textpara os nomes dos produtos e preços ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-vb/_static/image30.png))</span></span>

<span data-ttu-id="01cfc-224">Em seguida, precisamos adicionar os botões Adicionar produtos da remessa e cancelar à linha do rodapé.</span><span class="sxs-lookup"><span data-stu-id="01cfc-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="01cfc-225">Arraste dois controles de botão da caixa de ferramentas para o rodapé da interface de inserção, definindo os botões `ID` Propriedades para `AddProducts` e `CancelButton` e `Text` Propriedades para adicionar produtos da remessa e cancelar, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="01cfc-226">Além disso, defina o controle de `CancelButton` s `CausesValidation` Propriedade como `false`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="01cfc-227">Por fim, precisamos adicionar um controle rótulo da Web que exibirá mensagens de status para as duas interfaces.</span><span class="sxs-lookup"><span data-stu-id="01cfc-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="01cfc-228">Por exemplo, quando um usuário adiciona com êxito uma nova remessa de produtos, desejamos retornar à interface de vídeo e exibir uma mensagem de confirmação.</span><span class="sxs-lookup"><span data-stu-id="01cfc-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="01cfc-229">No entanto, se o usuário fornecer um preço para um novo produto, mas sair do nome do produto, precisaremos exibir uma mensagem de aviso, uma vez que o campo `ProductName` é necessário.</span><span class="sxs-lookup"><span data-stu-id="01cfc-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="01cfc-230">Como precisamos que essa mensagem seja exibida para ambas as interfaces, coloque-a na parte superior da página fora dos painéis.</span><span class="sxs-lookup"><span data-stu-id="01cfc-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="01cfc-231">Arraste um controle de rótulo da Web da caixa de ferramentas para a parte superior da página no designer.</span><span class="sxs-lookup"><span data-stu-id="01cfc-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="01cfc-232">Defina a propriedade `ID` como `StatusLabel`, desmarque a propriedade `Text` e defina as propriedades `Visible` e `EnableViewState` como `False`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `False`.</span></span> <span data-ttu-id="01cfc-233">Como vimos nos tutoriais anteriores, definir a propriedade `EnableViewState` como `False` nos permite alterar programaticamente os valores de Propriedade do rótulo e fazer com que eles revertam automaticamente para seus padrões no postback subsequente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `False` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="01cfc-234">Isso simplifica o código para mostrar uma mensagem de status em resposta a alguma ação do usuário que desaparece no postback subsequente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="01cfc-235">Por fim, defina o controle de `StatusLabel` s `CssClass` Propriedade como aviso, que é o nome de uma classe CSS definida em `Styles.css` que exibe o texto em uma fonte grande, em itálico, negrito e vermelho.</span><span class="sxs-lookup"><span data-stu-id="01cfc-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="01cfc-236">A Figura 11 mostra o designer do Visual Studio após o rótulo ter sido adicionado e configurado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>

<span data-ttu-id="01cfc-237">[![Coloque o controle StatusLabel acima dos dois controles de painel](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span></span>

<span data-ttu-id="01cfc-238">**Figura 11**: Coloque o controle de `StatusLabel` acima dos dois controles de painel ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-vb/_static/image33.png))</span></span>

## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="01cfc-239">Etapa 3: alternando entre as interfaces de exibição e de inserção</span><span class="sxs-lookup"><span data-stu-id="01cfc-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="01cfc-240">Neste ponto, concluímos a marcação para nossas interfaces de exibição e inserção, mas continuamos com duas tarefas:</span><span class="sxs-lookup"><span data-stu-id="01cfc-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="01cfc-241">Alternando entre as interfaces de exibição e de inserção</span><span class="sxs-lookup"><span data-stu-id="01cfc-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="01cfc-242">Adicionando os produtos na remessa ao banco de dados</span><span class="sxs-lookup"><span data-stu-id="01cfc-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="01cfc-243">Atualmente, a interface de exibição está visível, mas a interface de inserção está oculta.</span><span class="sxs-lookup"><span data-stu-id="01cfc-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="01cfc-244">Isso ocorre porque a propriedade `Visible` do painel de `DisplayInterface` é definida como `True` (o valor padrão), enquanto a propriedade `Visible` do painel `InsertingInterface` é definida como `False`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `True` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `False`.</span></span> <span data-ttu-id="01cfc-245">Para alternar entre as duas interfaces, precisamos apenas alternar cada controle `Visible` valor da propriedade.</span><span class="sxs-lookup"><span data-stu-id="01cfc-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="01cfc-246">Queremos mover da interface de exibição para a interface de inserção quando o botão processar remessa do produto for clicado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="01cfc-247">Portanto, crie um manipulador de eventos para esse botão `Click` evento que contenha o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="01cfc-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample4.vb)]

<span data-ttu-id="01cfc-248">Esse código simplesmente oculta o painel de `DisplayInterface` e mostra o painel de `InsertingInterface`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="01cfc-249">Em seguida, crie manipuladores de eventos para os controles Adicionar produtos de remessa e cancelar botão na interface de inserção.</span><span class="sxs-lookup"><span data-stu-id="01cfc-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="01cfc-250">Quando um desses botões é clicado, precisamos voltar para a interface de vídeo.</span><span class="sxs-lookup"><span data-stu-id="01cfc-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="01cfc-251">Crie `Click` manipuladores de eventos para ambos os controles de botão para que eles chamem `ReturnToDisplayInterface`, um método que adicionaremos momentaneamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="01cfc-252">Além de ocultar o painel de `InsertingInterface` e mostrar o painel de `DisplayInterface`, o método `ReturnToDisplayInterface` precisa retornar os controles da Web para o estado anterior à edição.</span><span class="sxs-lookup"><span data-stu-id="01cfc-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="01cfc-253">Isso envolve definir as propriedades de `SelectedIndex` de DropDownLists como 0 e limpar as propriedades `Text` dos controles TextBox.</span><span class="sxs-lookup"><span data-stu-id="01cfc-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="01cfc-254">Considere o que pode acontecer se não retornarmos os controles para seu estado de pré-edição antes de retornar à interface de vídeo.</span><span class="sxs-lookup"><span data-stu-id="01cfc-254">Consider what might happen if we didn't return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="01cfc-255">Um usuário pode clicar no botão processar remessa de produto, inserir os produtos da remessa e, em seguida, clicar em Adicionar produtos da remessa.</span><span class="sxs-lookup"><span data-stu-id="01cfc-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="01cfc-256">Isso adicionaria os produtos e retornará o usuário para a interface de exibição.</span><span class="sxs-lookup"><span data-stu-id="01cfc-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="01cfc-257">Neste ponto, o usuário pode querer adicionar outra remessa.</span><span class="sxs-lookup"><span data-stu-id="01cfc-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="01cfc-258">Ao clicar no botão processar remessa de produto, eles retornariam para a interface de inserção, mas as seleções de DropDownList e os valores de TextBox ainda seriam populados com seus valores anteriores.</span><span class="sxs-lookup"><span data-stu-id="01cfc-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample5.vb)]

<span data-ttu-id="01cfc-259">Ambos os manipuladores de eventos `Click` simplesmente chamam o método `ReturnToDisplayInterface`, embora Vamos retornar ao manipulador de eventos Add Products from `Click` de remessa na etapa 4 e adicionar código para salvar os produtos.</span><span class="sxs-lookup"><span data-stu-id="01cfc-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="01cfc-260">`ReturnToDisplayInterface` começa retornando o `Suppliers` e `Categories` DropDownLists para suas primeiras opções.</span><span class="sxs-lookup"><span data-stu-id="01cfc-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="01cfc-261">As duas constantes `firstControlID` e `lastControlID` marcam os valores de índice de controle inicial e final usados na nomeação das caixas de texto nome do produto e preço unitário na interface de inserção e são usados nos limites do loop `For` que define as propriedades `Text` dos controles TextBox de volta para uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="01cfc-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `For` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="01cfc-262">Por fim, os painéis `Visible` propriedades são redefinidos para que a interface de inserção esteja oculta e a interface de exibição mostrada.</span><span class="sxs-lookup"><span data-stu-id="01cfc-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="01cfc-263">Reserve um tempo para testar esta página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="01cfc-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="01cfc-264">Ao visitar a página pela primeira vez, você deverá ver a interface de exibição como foi mostrada na Figura 5.</span><span class="sxs-lookup"><span data-stu-id="01cfc-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="01cfc-265">Clique no botão processar remessa de produto.</span><span class="sxs-lookup"><span data-stu-id="01cfc-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="01cfc-266">A página será postback e você verá agora a interface de inserção, conforme mostrado na Figura 12.</span><span class="sxs-lookup"><span data-stu-id="01cfc-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="01cfc-267">Clicar nos botões Adicionar produtos da remessa ou cancelar retornará à interface de vídeo.</span><span class="sxs-lookup"><span data-stu-id="01cfc-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="01cfc-268">Ao exibir a interface de inserção, Reserve um tempo para testar o CompareValidators nas caixas de caixa de entrada de preço unitário.</span><span class="sxs-lookup"><span data-stu-id="01cfc-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="01cfc-269">Você deverá ver um aviso MessageBox do lado do cliente ao clicar no botão Adicionar produtos da remessa com valores de moeda ou preços inválidos com um valor menor que zero.</span><span class="sxs-lookup"><span data-stu-id="01cfc-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>

<span data-ttu-id="01cfc-270">[![a interface de inserção é exibida depois de clicar no botão processar remessa de produto](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span></span>

<span data-ttu-id="01cfc-271">**Figura 12**: a interface de inserção é exibida depois de clicar no botão processar remessa de produto ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-vb/_static/image36.png))</span></span>

## <a name="step-4-adding-the-products"></a><span data-ttu-id="01cfc-272">Etapa 4: adicionando os produtos</span><span class="sxs-lookup"><span data-stu-id="01cfc-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="01cfc-273">Tudo o que resta para este tutorial é salvar os produtos no banco de dados no botão Adicionar produtos da remessa s `Click` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="01cfc-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="01cfc-274">Isso pode ser feito criando um `ProductsDataTable` e adicionando uma instância de `ProductsRow` para cada um dos nomes de produtos fornecidos.</span><span class="sxs-lookup"><span data-stu-id="01cfc-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="01cfc-275">Depois que essas `ProductsRow` s foram adicionadas, faremos uma chamada para o método `ProductsBLL` classe s `UpdateWithTransaction` passando no `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="01cfc-276">Lembre-se de que o método `UpdateWithTransaction`, que foi criado de volta nas [modificações do banco de dados de disposição em um](wrapping-database-modifications-within-a-transaction-vb.md) tutorial de transação, passa o `ProductsDataTable` para o método `UpdateWithTransaction` do `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter`'s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="01cfc-277">A partir daí, uma transação ADO.NET é iniciada e o TableAdapter emite uma instrução `INSERT` ao banco de dados para cada `ProductsRow` adicionado na DataTable.</span><span class="sxs-lookup"><span data-stu-id="01cfc-277">From there, an ADO.NET transaction is started and the TableAdapter issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="01cfc-278">Supondo que todos os produtos sejam adicionados sem erros, a transação é confirmada, caso contrário, ela é revertida.</span><span class="sxs-lookup"><span data-stu-id="01cfc-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="01cfc-279">O código do botão Adicionar produtos da remessa s `Click` manipulador de eventos também precisa executar um pouco de verificação de erro.</span><span class="sxs-lookup"><span data-stu-id="01cfc-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="01cfc-280">Como não há nenhum RequiredFieldValidator usado na interface de inserção, um usuário poderia inserir um preço para um produto ao omitir seu nome.</span><span class="sxs-lookup"><span data-stu-id="01cfc-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="01cfc-281">Como o nome do produto é necessário, se essa condição for desdobrada, precisaremos alertar o usuário e não prosseguir com as inserções.</span><span class="sxs-lookup"><span data-stu-id="01cfc-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="01cfc-282">O código completo do manipulador de eventos `Click` segue:</span><span class="sxs-lookup"><span data-stu-id="01cfc-282">The complete `Click` event handler code follows:</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample6.vb)]

<span data-ttu-id="01cfc-283">O manipulador de eventos começa garantindo que a propriedade `Page.IsValid` retorna um valor de `True`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `True`.</span></span> <span data-ttu-id="01cfc-284">Se ele retornar `False`, isso significa que um ou mais dos CompareValidators estão relatando dados inválidos; Nesse caso, não queremos tentar inserir os produtos inseridos, ou terminaremos com uma exceção ao tentar atribuir o valor de preço unitário inserido pelo usuário à propriedade `ProductsRow` s `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-284">If it returns `False`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="01cfc-285">Em seguida, uma nova instância de `ProductsDataTable` é criada (`products`).</span><span class="sxs-lookup"><span data-stu-id="01cfc-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="01cfc-286">Um loop de `For` é usado para iterar pelas caixas de textnome do produto e preço unitário e as propriedades de `Text` são lidas nas variáveis locais `productName` e `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-286">A `For` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="01cfc-287">Se o usuário tiver inserido um valor para o preço unitário, mas não para o nome do produto correspondente, o `StatusLabel` exibirá a mensagem se você fornecer um preço unitário, também deverá incluir o nome do produto e o manipulador de eventos será encerrado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="01cfc-288">Se um nome de produto tiver sido fornecido, uma nova instância de `ProductsRow` será criada usando o método `ProductsDataTable` s `NewProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="01cfc-289">Essa nova propriedade `ProductsRow` `ProductName` da instância é definida como a caixa de texto nome do produto atual, enquanto as propriedades `SupplierID` e `CategoryID` são atribuídas às propriedades `SelectedValue` de DropDownLists no cabeçalho inserindo interface s.</span><span class="sxs-lookup"><span data-stu-id="01cfc-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="01cfc-290">Se o usuário inserir um valor para o preço do produto, ele será atribuído à propriedade `ProductsRow` s `UnitPrice` da instância; caso contrário, a propriedade será deixada sem atribuição, o que resultará em um valor `NULL` para `UnitPrice` no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="01cfc-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="01cfc-291">Por fim, as propriedades `Discontinued` e `UnitsOnOrder` são atribuídas aos valores embutidos `False` e 0, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `False` and 0, respectively.</span></span>

<span data-ttu-id="01cfc-292">Depois que as propriedades tiverem sido atribuídas à instância de `ProductsRow`, elas serão adicionadas à `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="01cfc-293">Na conclusão do loop de `For`, verificamos se algum produto foi adicionado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-293">At the completion of the `For` loop, we check whether any products have been added.</span></span> <span data-ttu-id="01cfc-294">O usuário pode, afinal, ter clicado em Adicionar produtos da remessa antes de inserir os nomes de produtos ou preços.</span><span class="sxs-lookup"><span data-stu-id="01cfc-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="01cfc-295">Se houver pelo menos um produto na `ProductsDataTable`, o método de `UpdateWithTransaction` da classe `ProductsBLL` será chamado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="01cfc-296">Em seguida, os dados são reassociados ao `ProductsGrid` GridView para que os produtos recém-adicionados apareçam na interface de vídeo.</span><span class="sxs-lookup"><span data-stu-id="01cfc-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="01cfc-297">O `StatusLabel` é atualizado para exibir uma mensagem de confirmação e o `ReturnToDisplayInterface` é invocado, ocultando a interface de inserção e mostrando a interface de vídeo.</span><span class="sxs-lookup"><span data-stu-id="01cfc-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="01cfc-298">Se nenhum produto tiver sido inserido, a interface de inserção permanecerá exibida, mas a mensagem nenhum produto foi adicionado.</span><span class="sxs-lookup"><span data-stu-id="01cfc-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="01cfc-299">Insira os nomes de produtos e os preços unitários nas caixas de caixa de exibição.</span><span class="sxs-lookup"><span data-stu-id="01cfc-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="01cfc-300">A Figura 13, 14 e 15 mostra as interfaces de inserção e exibição em ação.</span><span class="sxs-lookup"><span data-stu-id="01cfc-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="01cfc-301">Na Figura 13, o usuário inseriu um valor de preço unitário sem um nome de produto correspondente.</span><span class="sxs-lookup"><span data-stu-id="01cfc-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="01cfc-302">A Figura 14 mostra a interface de vídeo depois que três novos produtos foram adicionados com êxito, enquanto a Figura 15 mostra dois dos produtos recém-adicionados no GridView (o terceiro está na página anterior).</span><span class="sxs-lookup"><span data-stu-id="01cfc-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>

<span data-ttu-id="01cfc-303">[![um nome de produto é necessário ao inserir um preço unitário](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span></span>

<span data-ttu-id="01cfc-304">**Figura 13**: é necessário um nome de produto ao inserir um preço unitário ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-vb/_static/image39.png))</span></span>

<span data-ttu-id="01cfc-305">[![três novas veggies foram adicionadas para o fornecedor Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span></span>

<span data-ttu-id="01cfc-306">**Figura 14**: três novas veggies foram adicionadas para o fornecedor Mayumi s ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-vb/_static/image42.png))</span></span>

<span data-ttu-id="01cfc-307">[![os novos produtos podem ser encontrados na última página do GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="01cfc-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span></span>

<span data-ttu-id="01cfc-308">**Figura 15**: os novos produtos podem ser encontrados na última página do GridView ([clique para exibir a imagem em tamanho normal](batch-inserting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="01cfc-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-vb/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="01cfc-309">A lógica de inserção de lote usada neste tutorial encapsula as inserções dentro do escopo da transação.</span><span class="sxs-lookup"><span data-stu-id="01cfc-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="01cfc-310">Para verificar isso, introduza propositadamente um erro no nível do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="01cfc-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="01cfc-311">Por exemplo, em vez de atribuir a nova propriedade de `CategoryID` da instância `ProductsRow` s ao valor selecionado no `Categories` DropDownList, atribua-a a um valor como `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="01cfc-312">Aqui `i` é o indexador de loop e tem valores variando de 1 a 5.</span><span class="sxs-lookup"><span data-stu-id="01cfc-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="01cfc-313">Portanto, ao adicionar dois ou mais produtos no lote, o primeiro produto terá um valor de `CategoryID` válido (5), mas os produtos subsequentes terão `CategoryID` valores que não correspondem aos valores `CategoryID` na tabela `Categories`.</span><span class="sxs-lookup"><span data-stu-id="01cfc-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="01cfc-314">O efeito líquido é que, enquanto o primeiro `INSERT` terá êxito, os próximos falharão com uma violação de restrição de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="01cfc-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="01cfc-315">Como a inserção do lote é atômica, a primeira `INSERT` será revertida, retornando o banco de dados para seu estado antes do início do processo de inserção em lote.</span><span class="sxs-lookup"><span data-stu-id="01cfc-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>

## <a name="summary"></a><span data-ttu-id="01cfc-316">Resumo</span><span class="sxs-lookup"><span data-stu-id="01cfc-316">Summary</span></span>

<span data-ttu-id="01cfc-317">Além dos dois tutoriais anteriores, criamos interfaces que permitem a atualização, a exclusão e a inserção de lotes de dados, todos os quais usaram o suporte de transação que adicionamos à camada de acesso a dados nas [modificações de quebra de banco de base em um tutorial de transação](wrapping-database-modifications-within-a-transaction-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="01cfc-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial.</span></span> <span data-ttu-id="01cfc-318">Para determinados cenários, essas interfaces do usuário de processamento em lotes melhoram muito a eficiência do usuário final, reduzindo o número de cliques, postbacks e opções de contexto de teclado para mouse, mantendo também a integridade dos dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="01cfc-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="01cfc-319">Este tutorial conclui nossa visão do trabalho com dados em lote.</span><span class="sxs-lookup"><span data-stu-id="01cfc-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="01cfc-320">O próximo conjunto de tutoriais explora uma variedade de cenários de camada de acesso a dados avançados, incluindo o uso de procedimentos armazenados nos métodos TableAdapter s, a definição de configurações de nível de comando e conexão na DAL, criptografia de cadeias de conexão e muito mais!</span><span class="sxs-lookup"><span data-stu-id="01cfc-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="01cfc-321">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="01cfc-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="01cfc-322">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="01cfc-322">About the Author</span></span>

<span data-ttu-id="01cfc-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="01cfc-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="01cfc-324">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="01cfc-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="01cfc-325">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="01cfc-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="01cfc-326">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="01cfc-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="01cfc-327">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="01cfc-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="01cfc-328">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="01cfc-328">Special Thanks To</span></span>

<span data-ttu-id="01cfc-329">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="01cfc-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="01cfc-330">Os revisores potenciais para este tutorial foram Hilton Giesenow e S Ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="01cfc-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="01cfc-331">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="01cfc-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="01cfc-332">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="01cfc-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="01cfc-333">Anterior</span><span class="sxs-lookup"><span data-stu-id="01cfc-333">Previous</span></span>](batch-deleting-vb.md)
