---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-cs
title: Exibindo dados binários nos controles da WebC#de dados () | Microsoft Docs
author: rick-anderson
description: Neste tutorial, examinaremos as opções para apresentar dados binários em uma página da Web, incluindo a exibição de um arquivo de imagem e o provisionamento de um link de ' download ' f...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: 5cbeb9f8-5f92-4ba8-87ae-0b4d460ae6d4
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-cs
msc.type: authoredcontent
ms.openlocfilehash: f38de7adcd77b3dc2622759646168cf533b8308f
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74642460"
---
# <a name="displaying-binary-data-in-the-data-web-controls-c"></a><span data-ttu-id="cd985-103">Exibir dados binários nos controles de dados da Web (C#)</span><span class="sxs-lookup"><span data-stu-id="cd985-103">Displaying Binary Data in the Data Web Controls (C#)</span></span>

<span data-ttu-id="cd985-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cd985-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cd985-105">[Baixar o aplicativo de exemplo](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_CS.exe) ou [baixar PDF](displaying-binary-data-in-the-data-web-controls-cs/_static/datatutorial55cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cd985-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_CS.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-cs/_static/datatutorial55cs1.pdf)</span></span>

> <span data-ttu-id="cd985-106">Neste tutorial, examinaremos as opções para apresentar dados binários em uma página da Web, incluindo a exibição de um arquivo de imagem e o provisionamento de um link de "download" para um arquivo PDF.</span><span class="sxs-lookup"><span data-stu-id="cd985-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>

## <a name="introduction"></a><span data-ttu-id="cd985-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="cd985-107">Introduction</span></span>

<span data-ttu-id="cd985-108">No tutorial anterior, exploramos as duas técnicas para associar dados binários a um modelo de dados subjacente de aplicativo e usavam o controle FileUpload para carregar arquivos de um navegador para o sistema de arquivos do servidor Web.</span><span class="sxs-lookup"><span data-stu-id="cd985-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="cd985-109">Ainda vemos como associar os dados binários carregados ao modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="cd985-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="cd985-110">Ou seja, depois que um arquivo for carregado e salvo no sistema de arquivos, um caminho para o arquivo deverá ser armazenado no registro de banco de dados apropriado.</span><span class="sxs-lookup"><span data-stu-id="cd985-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="cd985-111">Se os dados estiverem sendo armazenados diretamente no banco de dados, não será necessário salvá-los no sistema de arquivos, mas eles deverão ser injetados no banco de dado.</span><span class="sxs-lookup"><span data-stu-id="cd985-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="cd985-112">Antes de observarmos a Associação dos dados com o modelo de dados, no entanto, vamos examinar primeiro como fornecer os dados binários para o usuário final.</span><span class="sxs-lookup"><span data-stu-id="cd985-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="cd985-113">A apresentação de dados de texto é simples o suficiente, mas como os dados binários devem ser apresentados?</span><span class="sxs-lookup"><span data-stu-id="cd985-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="cd985-114">Isso depende, é claro, sobre o tipo de dados binários.</span><span class="sxs-lookup"><span data-stu-id="cd985-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="cd985-115">Para imagens, provavelmente desejamos exibir a imagem; para PDFs, documentos do Microsoft Word, arquivos ZIP e outros tipos de dados binários, o fornecimento de um link de download é provavelmente mais apropriado.</span><span class="sxs-lookup"><span data-stu-id="cd985-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="cd985-116">Neste tutorial, veremos como apresentar os dados binários junto com seus dados de texto associados usando controles da Web de dados como GridView e DetailsView.</span><span class="sxs-lookup"><span data-stu-id="cd985-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="cd985-117">No próximo tutorial, vamos transformar nossa atenção para associar um arquivo carregado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="cd985-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="cd985-118">Etapa 1: fornecendo valores de`BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="cd985-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="cd985-119">A coluna `Picture` na tabela `Categories` já contém dados binários para as várias imagens de categoria.</span><span class="sxs-lookup"><span data-stu-id="cd985-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="cd985-120">Especificamente, a coluna `Picture` de cada registro contém o conteúdo binário de uma imagem de bitmap granular, de baixa qualidade e de 16 cores.</span><span class="sxs-lookup"><span data-stu-id="cd985-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="cd985-121">Cada imagem de categoria tem 172 pixels de largura e 120 pixels de altura e consome aproximadamente 11 KB.</span><span class="sxs-lookup"><span data-stu-id="cd985-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="cd985-122">Além disso, o conteúdo binário na coluna `Picture` inclui um cabeçalho [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) de 78 bytes que deve ser eliminado antes da exibição da imagem.</span><span class="sxs-lookup"><span data-stu-id="cd985-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="cd985-123">Essas informações de cabeçalho estão presentes porque o banco de dados Northwind tem suas raízes no Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="cd985-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="cd985-124">No Access, os dados binários são armazenados usando o tipo de dados objeto OLE, que se encontra nesse cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="cd985-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="cd985-125">Por enquanto, veremos como remover os cabeçalhos dessas imagens de baixa qualidade para exibir a imagem.</span><span class="sxs-lookup"><span data-stu-id="cd985-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="cd985-126">Em um tutorial futuro, criaremos uma interface para atualizar uma coluna de `Picture` de categoria e substituirei essas imagens de bitmap que usam cabeçalhos OLE por imagens JPG equivalentes sem os cabeçalhos OLE desnecessários.</span><span class="sxs-lookup"><span data-stu-id="cd985-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="cd985-127">No tutorial anterior, vimos como usar o controle FileUpload.</span><span class="sxs-lookup"><span data-stu-id="cd985-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="cd985-128">Portanto, você pode adicionar arquivos de folheto ao sistema de arquivos do servidor Web.</span><span class="sxs-lookup"><span data-stu-id="cd985-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="cd985-129">Isso, no entanto, não atualiza a coluna `BrochurePath` na tabela `Categories`.</span><span class="sxs-lookup"><span data-stu-id="cd985-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="cd985-130">No próximo tutorial, veremos como fazer isso, mas, por enquanto, precisamos fornecer valores manualmente para essa coluna.</span><span class="sxs-lookup"><span data-stu-id="cd985-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="cd985-131">Neste download do tutorial, você encontrará sete arquivos de folheto em PDF na pasta `~/Brochures`, um para cada uma das categorias, exceto frutos do mar.</span><span class="sxs-lookup"><span data-stu-id="cd985-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="cd985-132">Eu omiti propositadamente a adição de um folheto de frutos do mar para ilustrar como lidar com cenários em que nem todos os registros têm dados binários associados.</span><span class="sxs-lookup"><span data-stu-id="cd985-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="cd985-133">Para atualizar a tabela de `Categories` com esses valores, clique com o botão direito do mouse no nó `Categories` de Gerenciador de Servidores e escolha Mostrar dados da tabela.</span><span class="sxs-lookup"><span data-stu-id="cd985-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="cd985-134">Em seguida, insira os caminhos virtuais para os arquivos de folheto para cada categoria que tenha um folheto, como mostra a Figura 1.</span><span class="sxs-lookup"><span data-stu-id="cd985-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="cd985-135">Como não há um folheto para a categoria de frutos do mar, deixe seu valor de `BrochurePath` coluna s como `NULL`.</span><span class="sxs-lookup"><span data-stu-id="cd985-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>

<span data-ttu-id="cd985-136">[![Insira manualmente os valores para a coluna BrochurePath da tabela de categorias](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image1.png)</span></span>

<span data-ttu-id="cd985-137">**Figura 1**: Insira manualmente os valores para a coluna `Categories` s `BrochurePath` ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.png))</span></span>

## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="cd985-138">Etapa 2: fornecer um link de download para os folhetos em um GridView</span><span class="sxs-lookup"><span data-stu-id="cd985-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="cd985-139">Com os valores de `BrochurePath` fornecidos para a tabela `Categories`, estamos prontos para criar um GridView que liste cada categoria junto com um link para baixar o folheto da categoria.</span><span class="sxs-lookup"><span data-stu-id="cd985-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="cd985-140">Na etapa 4, estenderemos esse GridView para exibir também a imagem da categoria s.</span><span class="sxs-lookup"><span data-stu-id="cd985-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="cd985-141">Comece arrastando um GridView da caixa de ferramentas para o designer da página `DisplayOrDownloadData.aspx` na pasta `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="cd985-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="cd985-142">Defina as `ID` s GridView como `Categories` e por meio da marca inteligente GridView s, escolha associá-la a uma nova fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="cd985-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="cd985-143">Especificamente, associe-o a um ObjectDataSource chamado `CategoriesDataSource` que recupera dados usando o método `GetCategories()` do objeto `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="cd985-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>

<span data-ttu-id="cd985-144">[![criar um novo ObjectDataSource chamado CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-cs/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.png)</span></span>

<span data-ttu-id="cd985-145">**Figura 2**: criar um novo ObjectDataSource chamado `CategoriesDataSource` ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.png))</span></span>

<span data-ttu-id="cd985-146">[![configurar o ObjectDataSource para usar a classe CategoriesBLL](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-cs/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.png)</span></span>

<span data-ttu-id="cd985-147">**Figura 3**: configurar o ObjectDataSource para usar a classe `CategoriesBLL` ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image6.png))</span></span>

<span data-ttu-id="cd985-148">[![recuperar a lista de categorias usando o método GetCategories ()](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-cs/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.png)</span></span>

<span data-ttu-id="cd985-149">**Figura 4**: recuperar a lista de categorias usando o método `GetCategories()` ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.png))</span></span>

<span data-ttu-id="cd985-150">Depois de concluir o assistente para configurar fonte de dados, o Visual Studio adicionará automaticamente um BoundField ao `Categories` GridView para os `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`e `BrochurePath` `DataColumn` s.</span><span class="sxs-lookup"><span data-stu-id="cd985-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="cd985-151">Vá em frente e remova o `NumberOfProducts` BoundField, uma vez que a consulta `GetCategories()` método s não recupera essas informações.</span><span class="sxs-lookup"><span data-stu-id="cd985-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="cd985-152">Além disso, remova o `CategoryID` BoundField e renomeie o `CategoryName` e `BrochurePath` BoundFields `HeaderText` Propriedades para categoria e folheto, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="cd985-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="cd985-153">Depois de fazer essas alterações, a marcação declarativa de GridView e ObjectDataSource s deve ser parecida com a seguinte:</span><span class="sxs-lookup"><span data-stu-id="cd985-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample1.aspx)]

<span data-ttu-id="cd985-154">Exiba esta página por meio de um navegador (veja a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="cd985-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="cd985-155">Cada uma das oito categorias é listada.</span><span class="sxs-lookup"><span data-stu-id="cd985-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="cd985-156">As sete categorias com valores `BrochurePath` têm o valor de `BrochurePath` exibido no respectivo BoundField.</span><span class="sxs-lookup"><span data-stu-id="cd985-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="cd985-157">Frutos do mar, que tem um valor `NULL` para sua `BrochurePath`, exibe uma célula vazia.</span><span class="sxs-lookup"><span data-stu-id="cd985-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>

<span data-ttu-id="cd985-158">[![cada nome, descrição e valor de BrochurePath da categoria está listado](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-cs/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image9.png)</span></span>

<span data-ttu-id="cd985-159">**Figura 5**: cada nome de categoria, descrição e `BrochurePath` valor é listado ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.png))</span></span>

<span data-ttu-id="cd985-160">Em vez de exibir o texto da coluna `BrochurePath`, queremos criar um link para o folheto.</span><span class="sxs-lookup"><span data-stu-id="cd985-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="cd985-161">Para fazer isso, remova o `BrochurePath` BoundField e substitua-o por um HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="cd985-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="cd985-162">Defina a propriedade New HyperLinkField s `HeaderText` como panfleto, sua propriedade `Text` para exibir o folheto e sua propriedade `DataNavigateUrlFields` como `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="cd985-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>

![Adicionar um HyperLinkField para BrochurePath](displaying-binary-data-in-the-data-web-controls-cs/_static/image6.gif)

<span data-ttu-id="cd985-164">**Figura 6**: adicionar um HyperLinkField para `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="cd985-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>

<span data-ttu-id="cd985-165">Isso adicionará uma coluna de links ao GridView, como mostra a Figura 7.</span><span class="sxs-lookup"><span data-stu-id="cd985-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="cd985-166">Clicar em um link exibir folheto exibirá o PDF diretamente no navegador ou solicitará que o usuário Baixe o arquivo, dependendo se um leitor de PDF está instalado e as configurações do navegador.</span><span class="sxs-lookup"><span data-stu-id="cd985-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>

<span data-ttu-id="cd985-167">[![um folheto de categoria s pode ser exibido clicando no link exibir folheto](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-cs/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.png)</span></span>

<span data-ttu-id="cd985-168">**Figura 7**: um folheto de categoria s pode ser exibido clicando no link exibir folheto ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image12.png))</span></span>

<span data-ttu-id="cd985-169">[![o folheto da categoria s brochura é exibido](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-cs/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.png)</span></span>

<span data-ttu-id="cd985-170">**Figura 8**: a categoria PDF do folheto de categorias é exibida ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image14.png))</span></span>

## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="cd985-171">Ocultando o texto de folheto de exibição para categorias sem um folheto</span><span class="sxs-lookup"><span data-stu-id="cd985-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="cd985-172">Como mostra a Figura 7, o `BrochurePath` HyperLinkField exibe seu valor de propriedade `Text` (Visualizar folheto) para todos os registros, independentemente de um valor não`NULL` para `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="cd985-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="cd985-173">É claro que, se `BrochurePath` for `NULL`, o link será exibido somente como texto, como é o caso com a categoria de frutos do mar (consulte novamente a Figura 7).</span><span class="sxs-lookup"><span data-stu-id="cd985-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="cd985-174">Em vez de exibir o folheto de exibição de texto, pode ser interessante ter essas categorias sem um valor `BrochurePath` exibir algum texto alternativo, como nenhum folheto disponível.</span><span class="sxs-lookup"><span data-stu-id="cd985-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="cd985-175">Para fornecer esse comportamento, precisamos usar um TemplateField cujo conteúdo é gerado por meio de uma chamada para um método Page que emite a saída apropriada com base no valor `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="cd985-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="cd985-176">Primeiro exploramos essa técnica de formatação no tutorial [Usando TemplateFields no controle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="cd985-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial.</span></span>

<span data-ttu-id="cd985-177">Transforme o HyperLinkField em um TemplateField selecionando o `BrochurePath` HyperLinkField e clicando no link converter este campo em um TemplateField na caixa de diálogo Editar colunas.</span><span class="sxs-lookup"><span data-stu-id="cd985-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>

![Converter o HyperLinkField em um TemplateField](displaying-binary-data-in-the-data-web-controls-cs/_static/image9.gif)

<span data-ttu-id="cd985-179">**Figura 9**: converter o HyperLinkField em um TemplateField</span><span class="sxs-lookup"><span data-stu-id="cd985-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>

<span data-ttu-id="cd985-180">Isso criará um TemplateField com um `ItemTemplate` que contém um controle Web de hiperlink cuja propriedade `NavigateUrl` está associada ao valor `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="cd985-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="cd985-181">Substitua essa marcação por uma chamada para o método `GenerateBrochureLink`, passando o valor de `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="cd985-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample2.aspx)]

<span data-ttu-id="cd985-182">Em seguida, crie um método de `protected` na classe code-behind da página ASP.NET chamada `GenerateBrochureLink` que retorna um `string` e aceita um `object` como um parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="cd985-182">Next, create a `protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `string` and accepts an `object` as an input parameter.</span></span>

[!code-csharp[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample3.cs)]

<span data-ttu-id="cd985-183">Esse método determina se o valor de `object` passado é um banco de dados `NULL` e, em caso afirmativo, retorna uma mensagem indicando que a categoria não tem um folheto.</span><span class="sxs-lookup"><span data-stu-id="cd985-183">This method determines if the passed-in `object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="cd985-184">Caso contrário, se houver um valor `BrochurePath`, ele será exibido em um hiperlink.</span><span class="sxs-lookup"><span data-stu-id="cd985-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="cd985-185">Observe que, se o valor de `BrochurePath` estiver presente, ele será passado para o [método`ResolveUrl(url)`](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="cd985-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="cd985-186">Esse método resolve a *URL*passada, substituindo o `~` caractere pelo caminho virtual apropriado.</span><span class="sxs-lookup"><span data-stu-id="cd985-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="cd985-187">Por exemplo, se o aplicativo tiver raiz em `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` retornará `/Tutorial55/Brochures/Meat.pdf`.</span><span class="sxs-lookup"><span data-stu-id="cd985-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="cd985-188">A Figura 10 mostra a página após essas alterações terem sido aplicadas.</span><span class="sxs-lookup"><span data-stu-id="cd985-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="cd985-189">Observe que a categoria de frutos do mar `BrochurePath` campo agora exibe o texto sem folheto disponível.</span><span class="sxs-lookup"><span data-stu-id="cd985-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>

<span data-ttu-id="cd985-190">[![o texto nenhum folheto disponível é exibido para essas categorias sem um folheto](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-cs/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image15.png)</span></span>

<span data-ttu-id="cd985-191">**Figura 10**: o texto nenhum folheto disponível é exibido para essas categorias sem um folheto ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image16.png))</span></span>

## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="cd985-192">Etapa 3: adicionar uma página da Web para exibir uma imagem de categoria s</span><span class="sxs-lookup"><span data-stu-id="cd985-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="cd985-193">Quando um usuário visita uma página ASP.NET, ele recebe o HTML página s do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="cd985-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="cd985-194">O HTML recebido é apenas texto e não contém dados binários.</span><span class="sxs-lookup"><span data-stu-id="cd985-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="cd985-195">Quaisquer dados binários adicionais, como imagens, arquivos de som, aplicativos do Macromedia Flash, vídeos incorporados do Windows Media Player e assim por diante, existem como recursos separados no servidor Web.</span><span class="sxs-lookup"><span data-stu-id="cd985-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="cd985-196">O HTML contém referências a esses arquivos, mas não inclui o conteúdo real dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="cd985-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="cd985-197">Por exemplo, em HTML, o elemento `<img>` é usado para fazer referência a uma imagem, com o atributo `src` apontando para o arquivo de imagem da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="cd985-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>

[!code-html[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample4.html)]

<span data-ttu-id="cd985-198">Quando um navegador recebe esse HTML, ele faz outra solicitação ao servidor Web para recuperar o conteúdo binário do arquivo de imagem, que é exibido no navegador.</span><span class="sxs-lookup"><span data-stu-id="cd985-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="cd985-199">O mesmo conceito se aplica a qualquer dado binário.</span><span class="sxs-lookup"><span data-stu-id="cd985-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="cd985-200">Na etapa 2, o folheto não foi enviado para o navegador como parte da marcação HTML da página.</span><span class="sxs-lookup"><span data-stu-id="cd985-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="cd985-201">Em vez disso, o HTML renderizado forneceu hiperlinks que, quando clicados, fizeram com que o navegador solicitasse o documento PDF diretamente.</span><span class="sxs-lookup"><span data-stu-id="cd985-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="cd985-202">Para exibir ou permitir que os usuários baixem dados binários que residem dentro do banco de dado, precisamos criar uma página da Web separada que retorne os dados.</span><span class="sxs-lookup"><span data-stu-id="cd985-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="cd985-203">Para o nosso aplicativo, há apenas um campo de dados binários armazenado diretamente no banco do dados da categoria s Picture.</span><span class="sxs-lookup"><span data-stu-id="cd985-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="cd985-204">Portanto, precisamos de uma página que, quando chamada, retorna os dados da imagem para uma determinada categoria.</span><span class="sxs-lookup"><span data-stu-id="cd985-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="cd985-205">Adicione uma nova página do ASP.NET à pasta `BinaryData` chamada `DisplayCategoryPicture.aspx`.</span><span class="sxs-lookup"><span data-stu-id="cd985-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="cd985-206">Ao fazer isso, deixe a caixa de seleção selecionar página mestra desmarcada.</span><span class="sxs-lookup"><span data-stu-id="cd985-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="cd985-207">Esta página espera um valor `CategoryID` na QueryString e retorna os dados binários dessa categoria `Picture` coluna.</span><span class="sxs-lookup"><span data-stu-id="cd985-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="cd985-208">Como essa página retorna dados binários e nada mais, ela não precisa de nenhuma marcação na seção HTML.</span><span class="sxs-lookup"><span data-stu-id="cd985-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="cd985-209">Portanto, clique na guia origem no canto inferior esquerdo e remova todas as marcas de s da página, exceto a diretiva de `<%@ Page %>`.</span><span class="sxs-lookup"><span data-stu-id="cd985-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="cd985-210">Ou seja, `DisplayCategoryPicture.aspx` s marcação declarativa deve consistir em uma única linha:</span><span class="sxs-lookup"><span data-stu-id="cd985-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample5.aspx)]

<span data-ttu-id="cd985-211">Se você vir o atributo `MasterPageFile` na diretiva `<%@ Page %>`, remova-o.</span><span class="sxs-lookup"><span data-stu-id="cd985-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="cd985-212">Na classe s code-behind da página, adicione o seguinte código ao manipulador de eventos `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="cd985-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample6.cs)]

<span data-ttu-id="cd985-213">Esse código começa lendo o valor de `CategoryID` QueryString em uma variável chamada `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="cd985-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="cd985-214">Em seguida, os dados da imagem são recuperados por meio de uma chamada para o método de `GetCategoryWithBinaryDataByCategoryID(categoryID)` da classe `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="cd985-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="cd985-215">Esses dados são retornados ao cliente usando o método `Response.BinaryWrite(data)`, mas antes que isso seja chamado, o cabeçalho OLE do valor da coluna `Picture` deve ser removido.</span><span class="sxs-lookup"><span data-stu-id="cd985-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="cd985-216">Isso é feito com a criação de uma matriz de `byte` chamada `strippedImageData` que terá exatamente 78 caracteres abaixo do que está na coluna `Picture`.</span><span class="sxs-lookup"><span data-stu-id="cd985-216">This is accomplished by creating a `byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="cd985-217">O [método`Array.Copy`](https://msdn.microsoft.com/library/z50k9bft.aspx) é usado para copiar os dados de `category.Picture` começando na posição 78 para `strippedImageData`.</span><span class="sxs-lookup"><span data-stu-id="cd985-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="cd985-218">A propriedade `Response.ContentType` especifica o [tipo MIME](http://en.wikipedia.org/wiki/MIME) do conteúdo que está sendo retornado para que o navegador saiba como renderizá-lo.</span><span class="sxs-lookup"><span data-stu-id="cd985-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="cd985-219">Como a coluna de `Picture` da tabela `Categories` é uma imagem de bitmap, o tipo MIME de bitmap é usado aqui (Image/BMP).</span><span class="sxs-lookup"><span data-stu-id="cd985-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="cd985-220">Se você omitir o tipo MIME, a maioria dos navegadores ainda exibirá a imagem corretamente, pois eles podem inferir o tipo com base no conteúdo dos dados binários do arquivo de imagem.</span><span class="sxs-lookup"><span data-stu-id="cd985-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="cd985-221">No entanto, é prudente incluir o tipo MIME quando possível.</span><span class="sxs-lookup"><span data-stu-id="cd985-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="cd985-222">Consulte o [site da Internet Assigned Numbers s](http://www.iana.org/) para obter uma lista completa de [tipos de mídia MIME](http://www.iana.org/assignments/media-types/).</span><span class="sxs-lookup"><span data-stu-id="cd985-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="cd985-223">Com essa página criada, uma imagem de s de categoria específica pode ser exibida visitando `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="cd985-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="cd985-224">A Figura 11 mostra a imagem dos s categoria de bebidas, que pode ser exibida em `DisplayCategoryPicture.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="cd985-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="cd985-225">[![a imagem da categoria de bebidas é exibida](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-cs/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image17.png)</span></span>

<span data-ttu-id="cd985-226">**Figura 11**: a figura s da categoria bebidas é exibida ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image18.png))</span></span>

<span data-ttu-id="cd985-227">Se, ao visitar `DisplayCategoryPicture.aspx?CategoryID=categoryID`, você receberá uma exceção que lê não é possível converter o objeto do tipo ' System. DBNull ' no tipo ' System. Byte [] ', há duas coisas que podem estar causando isso.</span><span class="sxs-lookup"><span data-stu-id="cd985-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="cd985-228">Primeiro, a coluna de `Picture` da tabela `Categories` permite valores de `NULL`.</span><span class="sxs-lookup"><span data-stu-id="cd985-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="cd985-229">No entanto, a página de `DisplayCategoryPicture.aspx` pressupõe que há um valor não`NULL` presente.</span><span class="sxs-lookup"><span data-stu-id="cd985-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="cd985-230">A propriedade `Picture` da `CategoriesDataTable` não poderá ser acessada diretamente se tiver um valor `NULL`.</span><span class="sxs-lookup"><span data-stu-id="cd985-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="cd985-231">Se você quiser permitir `NULL` valores para a coluna `Picture`, você d deseja incluir a seguinte condição:</span><span class="sxs-lookup"><span data-stu-id="cd985-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>

[!code-csharp[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample7.cs)]

<span data-ttu-id="cd985-232">O código acima pressupõe que há um arquivo de imagem chamado `NoPictureAvailable.gif` na pasta `Images` que você deseja exibir para essas categorias sem uma imagem.</span><span class="sxs-lookup"><span data-stu-id="cd985-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="cd985-233">Essa exceção também pode ser causada se a instrução `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` foi revertida para a lista de colunas da consulta principal, o que pode acontecer se você estiver usando instruções SQL ad hoc e você salvar novamente o assistente para a consulta principal do TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="cd985-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="cd985-234">Verifique se `GetCategoryWithBinaryDataByCategoryID` instrução `SELECT` do método ainda inclui a coluna `Picture`.</span><span class="sxs-lookup"><span data-stu-id="cd985-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="cd985-235">Toda vez que o `DisplayCategoryPicture.aspx` é visitado, o banco de dados é acessado e a categoria especificada do s Picture data é retornada.</span><span class="sxs-lookup"><span data-stu-id="cd985-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="cd985-236">No entanto, se a categoria s Picture não foi alterada desde que o usuário o exibiu pela última vez, isso é um esforço desperdiçado.</span><span class="sxs-lookup"><span data-stu-id="cd985-236">If the category s picture hasn't changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="cd985-237">Felizmente, o HTTP permite *gets condicionais*.</span><span class="sxs-lookup"><span data-stu-id="cd985-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="cd985-238">Com um GET condicional, o cliente que faz a solicitação HTTP envia ao longo de um [cabeçalho http`If-Modified-Since`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) que fornece a data e a hora em que o cliente recuperou por último esse recurso do servidor Web.</span><span class="sxs-lookup"><span data-stu-id="cd985-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="cd985-239">Se o conteúdo não foi alterado desde essa data especificada, o servidor Web pode responder com um [código de status não modificado (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) e abrem mão enviar de volta o conteúdo de recurso s solicitado.</span><span class="sxs-lookup"><span data-stu-id="cd985-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="cd985-240">Resumindo, essa técnica alivia o servidor Web de ter que enviar o conteúdo de um recurso se ele não tiver sido modificado desde a última vez que o cliente o acessou.</span><span class="sxs-lookup"><span data-stu-id="cd985-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>

<span data-ttu-id="cd985-241">No entanto, para implementar esse comportamento, é necessário adicionar uma coluna `PictureLastModified` à tabela `Categories` para capturar quando a coluna de `Picture` foi atualizada pela última vez, bem como o código para verificar o cabeçalho de `If-Modified-Since`.</span><span class="sxs-lookup"><span data-stu-id="cd985-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="cd985-242">Para obter mais informações sobre o cabeçalho de `If-Modified-Since` e o fluxo de trabalho de obtenção condicional, consulte [http condicional get para hackers de RSS](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) e [uma análise mais profunda sobre como executar solicitações HTTP em uma página ASP.net](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="cd985-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="cd985-243">Etapa 4: exibindo as imagens de categoria em um GridView</span><span class="sxs-lookup"><span data-stu-id="cd985-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="cd985-244">Agora que temos uma página da Web para exibir uma imagem de uma categoria em particular, podemos exibi-la usando o [controle de imagem da Web](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) ou um elemento HTML `<img>` apontando para `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="cd985-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="cd985-245">As imagens cuja URL é determinada pelos dados do banco podem ser exibidas em GridView ou DetailsView usando o ImageField.</span><span class="sxs-lookup"><span data-stu-id="cd985-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="cd985-246">O ImageField contém as propriedades `DataImageUrlField` e `DataImageUrlFormatString` que funcionam como as propriedades `DataNavigateUrlFields` s HyperLinkField e `DataNavigateUrlFormatString`.</span><span class="sxs-lookup"><span data-stu-id="cd985-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="cd985-247">Vamos aumentar o `Categories` GridView em `DisplayOrDownloadData.aspx` adicionando um ImageField para mostrar cada imagem da categoria.</span><span class="sxs-lookup"><span data-stu-id="cd985-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="cd985-248">Basta adicionar o ImageField e definir suas propriedades `DataImageUrlField` e `DataImageUrlFormatString` como `CategoryID` e `DisplayCategoryPicture.aspx?CategoryID={0}`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="cd985-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="cd985-249">Isso criará uma coluna GridView que renderiza um elemento `<img>` cujo atributo `src` faz referência a `DisplayCategoryPicture.aspx?CategoryID={0}`, onde {0} é substituído pelo valor de `CategoryID` da linha GridView.</span><span class="sxs-lookup"><span data-stu-id="cd985-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>

![Adicionar um ImageField ao GridView](displaying-binary-data-in-the-data-web-controls-cs/_static/image12.gif)

<span data-ttu-id="cd985-251">**Figura 12**: adicionar um ImageField ao GridView</span><span class="sxs-lookup"><span data-stu-id="cd985-251">**Figure 12**: Add an ImageField to the GridView</span></span>

<span data-ttu-id="cd985-252">Depois de adicionar o ImageField, a sintaxe declarativa s de GridView deve ser semelhante a acalme a seguir:</span><span class="sxs-lookup"><span data-stu-id="cd985-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-cs/samples/sample8.aspx)]

<span data-ttu-id="cd985-253">Reserve um tempo para exibir esta página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="cd985-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="cd985-254">Observe como cada registro agora inclui uma imagem para a categoria.</span><span class="sxs-lookup"><span data-stu-id="cd985-254">Note how each record now includes a picture for the category.</span></span>

<span data-ttu-id="cd985-255">[![a figura s da categoria é exibida para cada linha](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="cd985-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-cs/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-cs/_static/image19.png)</span></span>

<span data-ttu-id="cd985-256">**Figura 13**: a figura s da categoria é exibida para cada linha ([clique para exibir a imagem em tamanho normal](displaying-binary-data-in-the-data-web-controls-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="cd985-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-cs/_static/image20.png))</span></span>

## <a name="summary"></a><span data-ttu-id="cd985-257">Resumo</span><span class="sxs-lookup"><span data-stu-id="cd985-257">Summary</span></span>

<span data-ttu-id="cd985-258">Neste tutorial, examinamos como apresentar dados binários.</span><span class="sxs-lookup"><span data-stu-id="cd985-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="cd985-259">A forma como os dados são apresentados depende do tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="cd985-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="cd985-260">Para os arquivos de folheto em PDF, oferecemos ao usuário um link exibir folheto que, quando clicado, levou o usuário diretamente para o arquivo PDF.</span><span class="sxs-lookup"><span data-stu-id="cd985-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="cd985-261">Para a categoria s Picture, primeiro criamos uma página para recuperar e retornar os dados binários do banco de dado e, em seguida, usamos essa página para exibir cada categoria de imagem em um GridView.</span><span class="sxs-lookup"><span data-stu-id="cd985-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="cd985-262">Agora que vimos como exibir dados binários, estamos prontos para examinar como executar inserções, atualizações e exclusões em relação ao banco de dados com o dado binário.</span><span class="sxs-lookup"><span data-stu-id="cd985-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="cd985-263">No próximo tutorial, veremos como associar um arquivo carregado com seu registro de banco de dados correspondente.</span><span class="sxs-lookup"><span data-stu-id="cd985-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="cd985-264">No tutorial depois disso, veremos como atualizar dados binários existentes, bem como como excluir os dados binários quando seu registro associado é removido.</span><span class="sxs-lookup"><span data-stu-id="cd985-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="cd985-265">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="cd985-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cd985-266">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="cd985-266">About the Author</span></span>

<span data-ttu-id="cd985-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP. net e fundador da [4guysfromrolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="cd985-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cd985-268">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="cd985-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cd985-269">Seu livro mais recente é que a [*Sams ensina a ASP.NET 2,0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="cd985-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cd985-270">Ele pode ser acessado em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cd985-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cd985-271">ou por meio de seu blog, que pode ser encontrado em [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="cd985-271">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cd985-272">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="cd985-272">Special Thanks To</span></span>

<span data-ttu-id="cd985-273">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="cd985-273">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cd985-274">Os revisores potenciais para este tutorial foram Teresa Murphy e Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="cd985-274">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="cd985-275">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="cd985-275">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cd985-276">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cd985-276">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cd985-277">[Anterior](uploading-files-cs.md)
> [Próximo](including-a-file-upload-option-when-adding-a-new-record-cs.md)</span><span class="sxs-lookup"><span data-stu-id="cd985-277">[Previous](uploading-files-cs.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-cs.md)</span></span>
