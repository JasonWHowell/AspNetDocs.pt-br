---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
title: Configurando propriedades de implantação para um ambiente de destino | Microsoft Docs
author: jrjlee
description: Este tópico descreve como configurar propriedades específicas do ambiente para implantar a solução de exemplo do Gerenciador de contatos em um ambiente de destino específico...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: b5b86e03-b8ed-46e6-90fa-e1da88ef34e9
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
msc.type: authoredcontent
ms.openlocfilehash: 9742be7d718384c1b108d5f2c0c43e8e8d4fe8a9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78636440"
---
# <a name="configuring-deployment-properties-for-a-target-environment"></a>Configuração de propriedades de implantação para um ambiente de destino

por [Jason Lee](https://github.com/jrjlee)

[Baixar PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> Este tópico descreve como configurar propriedades específicas do ambiente para implantar a solução de exemplo do Gerenciador de contatos em um ambiente de destino específico.

Este tópico faz parte de uma série de tutoriais com base em relação aos requisitos de implantação empresarial de uma empresa fictícia chamada Fabrikam, Inc. Esta série de tutoriais usa uma solução&#x2014;de exemplo da solução&#x2014; [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) para representar um aplicativo Web com um nível realista de complexidade, incluindo um aplicativo ASP.NET MVC 3, um serviço Windows Communication Foundation (WCF) e um projeto de banco de dados.

O método de implantação no coração desses tutoriais é baseado na abordagem de arquivo de projeto dividido descrita na [compreensão do processo de compilação](../web-deployment-in-the-enterprise/understanding-the-build-process.md), no qual o processo de compilação é controlado por dois&#x2014;arquivos de projeto, um contendo instruções de Build que se aplicam a todos os ambientes de destino e um contendo configurações específicas de ambiente e de implantação. No momento da compilação, o arquivo de projeto específico do ambiente é mesclado no arquivo de projeto independente do ambiente para formar um conjunto completo de instruções de compilação.

## <a name="process-overview"></a>Visão geral do processo

O arquivo de projeto que você usará para criar e implantar a solução do Gerenciador de contatos é dividido em dois arquivos físicos:

- Um que contém as configurações e instruções de Build universal (o arquivo *Publish. proj* ).
- Um que contém configurações de compilação específicas do ambiente (*env-dev. proj*, *env-Stage. proj*e assim por diante).

No momento da compilação, o arquivo apropriado do projeto específico do ambiente é mesclado no arquivo *Publish. proj* universal para formar um conjunto completo de instruções de compilação. Você pode configurar a implantação para ambientes de destino específicos criando ou Personalizando arquivos de projeto específicos do ambiente com configurações que descrevem seu próprio cenário de implantação.

Muitos desses valores são determinados pelo modo como o ambiente de destino é&#x2014;configurado em particular, se o servidor Web de destino está configurado para usar o serviço Web Deployment Agent (o agente remoto) ou o manipulador de implantação da Web. Para obter mais informações sobre essas abordagens e para obter orientação sobre como escolher a abordagem certa para seu próprio ambiente, consulte [escolhendo a abordagem certa para a implantação da Web](choosing-the-right-approach-to-web-deployment.md).

O [cenário do Gerenciador de contatos](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md) requer dois arquivos de projeto específicos do ambiente:

- Implantação em um ambiente de teste do desenvolvedor (*env-dev. proj*). O ambiente de teste do desenvolvedor é configurado para aceitar implantações remotas usando o agente remoto, conforme descrito em [cenário: Configurando um ambiente de teste para implantação na Web](scenario-configuring-a-test-environment-for-web-deployment.md). Esse arquivo precisa fornecer o endereço do ponto de extremidade do agente remoto, bem como configurações específicas do local, como cadeias de conexão e pontos de extremidades de serviço.
- Implantação em um ambiente de preparo (*env-Stage. proj*). O ambiente de preparo está configurado para aceitar implantações remotas usando o manipulador de Implantação da Web, conforme descrito em [cenário: Configurando um ambiente de preparo para implantação da Web](scenario-configuring-a-staging-environment-for-web-deployment.md). Esse arquivo precisa fornecer o endereço do ponto de extremidade do manipulador de Implantação da Web, bem como configurações específicas do local, como cadeias de conexão e pontos de extremidades de serviço.

É importante observar que as configurações definidas no arquivo de projeto específico do ambiente não afetam o conteúdo do próprio&#x2014;pacote da Web em vez disso, elas controlam como o pacote é implantado e quais valores de parâmetros são fornecidos quando o pacote é extraído. Você está importando o pacote da Web para o ambiente de produção manualmente, conforme descrito em [cenário: Configurando um ambiente de produção para implantação da Web](scenario-configuring-a-production-environment-for-web-deployment.md) e [Instalando manualmente pacotes da Web](../web-deployment-in-the-enterprise/manually-installing-web-packages.md), portanto, não importa quais configurações você usou no arquivo de projeto específico do ambiente quando você gerou o pacote. Serviços de Informações da Internet (IIS) Manager solicitará quaisquer valores parametrizados, como cadeias de conexão e pontos de extremidade de serviço, quando você importar o pacote.

Para implantar a solução do Gerenciador de contatos em seu próprio ambiente de destino, você pode personalizar esse arquivo ou usá-lo como um modelo e criar seu próprio arquivo.

**Para definir configurações de implantação específicas do ambiente para a solução do Gerenciador de contatos**

1. Abra a solução ContactManager-WCF no Visual Studio 2010.
2. Na janela **Gerenciador de soluções** , expanda a pasta **publicar** , expanda a pasta **EnvConfig** e clique duas vezes em **env-dev. proj**.

    ![](configuring-deployment-properties-for-a-target-environment/_static/image1.png)
3. Substitua os valores de propriedade no arquivo *env-dev. proj* pelos valores corretos para seu próprio ambiente de teste.

    > [!NOTE]
    > A tabela a seguir este procedimento fornece mais informações sobre cada uma dessas propriedades.
4. Salve seu trabalho e, em seguida, feche o arquivo *env-dev. proj* .

## <a name="choosing-the-right-deployment-properties"></a>Escolhendo as propriedades de implantação corretas

Esta tabela descreve a finalidade de cada propriedade no arquivo de projeto de exemplo específico do ambiente, *env-dev. proj*, e fornece algumas diretrizes sobre os valores que você deve fornecer.

|                                                        Nome da propriedade                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Detalhes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              <strong>MSDeployComputerName</strong> O nome do servidor Web de destino ou ponto de extremidade de serviço.               |                                                                                                                                                                                                                                              Se estiver implantando no serviço de agente remoto no servidor Web de destino, você poderá especificar o nome do computador de destino (por exemplo, <strong>TESTWEB1</strong> ou <strong>TESTWEB1.fabrikam.net</strong>) ou pode especificar o ponto de extremidade do agente remoto (por exemplo, `http://TESTWEB1/MSDEPLOYAGENTSERVICE`). A implantação funciona da mesma maneira em cada caso. Se você estiver implantando no manipulador de Implantação da Web no servidor Web de destino, deverá especificar o ponto de extremidade de serviço e incluir o nome do site do IIS como um parâmetro de cadeia de caracteres de consulta (por exemplo, `https://STAGEWEB1:8172/MSDeploy.axd?site=DemoSite`).                                                                                                                                                                                                                                              |
|         <strong>MSDeployAuth</strong> O método que Implantação da Web deve usar para autenticar no computador remoto.          |                                                                                                                                                                                                                          Isso deve ser definido como <strong>NTLM</strong> ou <strong>básico</strong>. Normalmente, você usará o <strong>NTLM</strong> se estiver implantando no serviço de agente remoto e <strong>básico</strong> se estiver implantando no manipulador de implantação da Web. Se você usar a autenticação básica, também precisará especificar o nome de usuário e a senha que a ferramenta de implantação da Web do IIS (Implantação da Web) deve representar para executar a implantação. Neste exemplo, esses valores são fornecidos por meio das propriedades <strong>MSDeployUsername</strong> e <strong>MSDeployPassword</strong> . Se você usar a autenticação NTLM, poderá omitir essas propriedades ou deixá-las em branco.                                                                                                                                                                                                                          |
| <strong>MSDeployUsername</strong> Se você usar a autenticação básica, Implantação da Web usará essa conta no computador remoto.  |                                                                                                                                                                                                                                                                                                                                                                                                                       Isso deve assumir o <em>domínio</em>\*nome de usuário * (por exemplo, <strong>FABRIKAM\matt</strong>). Esse valor só será usado se você especificar a autenticação básica. Se você usar a autenticação NTLM, a propriedade poderá ser omitida. Se um valor for fornecido, ele será ignorado.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <strong>MSDeployPassword</strong> Se você usar a autenticação básica, Implantação da Web usará essa senha no computador remoto. |                                                                                                                                                                                                                                                                                                                                                                                                                    Essa é a senha da conta de usuário que você especificou na propriedade <strong>MSDeployUsername</strong> . Esse valor só será usado se você especificar a autenticação básica. Se você usar a autenticação NTLM, a propriedade poderá ser omitida. Se um valor for fornecido, ele será ignorado.                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     <strong>ContactManagerIisPath</strong> O caminho do IIS no qual você deseja implantar o aplicativo MVC do Gerenciador de contatos.     |                                                                                                                                                                                                                                                                                                                                                                        Esse deve ser o caminho como aparece no Gerenciador do IIS, no formato [<em>nome do site do IIS</em>]/[nome do<em>aplicativo</em><em>Web</em>]. Lembre-se de que o site do IIS precisa existir antes de você implantar seu aplicativo. Por exemplo, se você tiver criado um site do IIS chamado DemoSite, poderá especificar o caminho do IIS para o aplicativo MVC como DemoSite/ContactManager.                                                                                                                                                                                                                                                                                                                                                                        |
|   <strong>ContactManagerServiceIisPath</strong> O caminho do IIS no qual você deseja implantar o serviço WCF do Gerenciador de contatos.    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Por exemplo, se você tiver criado um site do IIS chamado DemoSite, poderá especificar o caminho do IIS para o serviço WCF como <strong>DemoSite/ContactManagerService</strong>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                  <strong>ContactManagerTargetUrl</strong> A URL na qual o serviço WCF pode ser alcançado.                   |                                                                                                                                                     Isso usará o formato [<em>URL raiz do site do IIS</em>]/[<em>nome do aplicativo de serviço</em>]/[ponto de extremidade do<em>serviço</em>]. Por exemplo, se você tiver criado um site do IIS na porta 85, a URL levaria o formulário `http://localhost:85/ContactManagerService/ContactService.svc`. Lembre-se de que o aplicativo MVC e o serviço WCF são implantados no mesmo servidor. Como resultado, essa URL é acessada apenas do computador no qual está instalada. Por isso, é melhor usar localhost ou o endereço IP, em vez do nome do computador ou de um cabeçalho de host, na URL. Se você usar o nome do computador ou um cabeçalho de host, o recurso de segurança [verificação de auto-retorno](https://go.microsoft.com/?linkid=9805131) no IIS poderá bloquear a URL e retornar um erro <strong>http 401,1-não autorizado</strong> .                                                                                                                                                     |
|                  <strong>CmDatabaseConnectionString</strong> A cadeia de conexão para o servidor de banco de dados.                  | A cadeia de conexão determina as credenciais que VSDBCMD usarão para contatar o servidor de banco de dados e criar o banco de dados e as credenciais que o pool de aplicativos do servidor Web usará para contatar o servidor de banco de dados e interagir com o banco de dados. Essencialmente, você tem duas opções aqui. Você pode especificar <strong>Integrated Security = true</strong>; nesse caso, a autenticação integrada do Windows é usada: <strong>Data Source = TESTDB1; Integrated Security = true</strong> nesse caso, o banco de dados será criado usando as credenciais do usuário que executa o executável VSDBCMD e o aplicativo acessará o banco de dados usando a identidade da conta da máquina do servidor Web. Como alternativa, você pode especificar o nome de usuário e a senha de uma conta de SQL Server. Nesse caso, as credenciais de SQL Server são usadas tanto pelo VSDBCMD para criar o banco de dados e pelo pool de aplicativos para interagir com o Database: <strong>Data Source = TESTDB1; ID de usuário = ASqlUser; Senha = Pa $ $w 0rd</strong> as orientações neste tópico pressupõem que você usará a autenticação integrada do Windows. |
|        <strong>CmTargetDatabase</strong> O nome que você deseja dar ao banco de dados que você criará no servidor de banco de dados.        |                                                                                                                                                                                                                                                                                                                                                                                                                                                     O valor que você fornece aqui é adicionado ao comando VSDBCMD como um parâmetro. Ele também é usado para criar uma cadeia de conexão completa que o pool de aplicativos no servidor Web pode usar para interagir com o banco de dados.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

Esses exemplos mostram como você pode configurar essas propriedades para cenários de implantação específicos.

### <a name="example-1x2014deployment-to-the-remote-agent-service"></a>Exemplo 1&#x2014;implantação para o serviço de agente remoto

Neste exemplo:

- Você está implantando no serviço de agente remoto no TESTWEB1.
- Você está instruindo Implantação da Web a usar a autenticação NTLM. Implantação da Web será executado usando as credenciais usadas para invocar o Microsoft Build Engine (MSBuild).
- Você está usando a autenticação integrada para implantar o banco de dados **ContactManager** em TESTDB1. O banco de dados será implantado usando as credenciais usadas para invocar o MSBuild.

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample1.xml)]

### <a name="example-2x2014deployment-to-the-web-deploy-handler-endpoint"></a>Exemplo 2&#x2014;implantação para o ponto de extremidade do manipulador de implantação da Web

Neste exemplo:

- Você está implantando no ponto de extremidade de serviço do manipulador de Implantação da Web em STAGEWEB1.
- Você está instruindo Implantação da Web para usar a autenticação básica.
- Você está especificando que Implantação da Web deve representar a conta FABRIKAM\stagingdeployer no computador remoto.
- Você está usando SQL Server autenticação para implantar o banco de dados **ContactManager** em STAGEDB1.

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample2.xml)]

## <a name="conclusion"></a>Conclusão

Neste ponto, os arquivos de projeto são totalmente configurados para criar e implantar a solução Contact Manager em um ou mais ambientes de destino.

Para usar esses arquivos de projeto como parte de um processo de implantação de etapa única e repetível, você precisa executar o arquivo *Publish. proj* usando o MSBuild e passar o local do arquivo de projeto específico do ambiente como um parâmetro. Você pode fazer isso de várias maneiras:

- Para obter uma visão geral do MSBuild e uma introdução aos arquivos de projeto personalizados, consulte [noções básicas sobre o arquivo de projeto](../web-deployment-in-the-enterprise/understanding-the-project-file.md).
- Para obter informações sobre como formular um comando do MSBuild que executa seus arquivos de projeto personalizados, consulte [implantando pacotes da Web](../web-deployment-in-the-enterprise/deploying-web-packages.md).
- Para obter informações sobre como incorporar seus comandos do MSBuild em um arquivo de comando para implantações reproduzíveis e de única etapa, consulte [criando e executando um arquivo de comando de implantação](../web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file.md).
- Para obter informações sobre como executar seus arquivos de projeto personalizados do Team Build, consulte [criando uma definição de compilação que dá suporte à implantação](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).

> [!div class="step-by-step"]
> [Anterior](creating-a-server-farm-with-the-web-farm-framework.md)
