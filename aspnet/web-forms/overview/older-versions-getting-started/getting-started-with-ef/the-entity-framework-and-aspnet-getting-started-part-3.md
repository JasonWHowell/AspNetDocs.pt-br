---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
title: Introdução com Entity Framework 4,0 Database First e ASP.NET 4 Web Forms-parte 3 | Microsoft Docs
author: tdykstra
description: O aplicativo Web de exemplo Contoso University demonstra como criar ASP.NET Web Forms aplicativos usando o Entity Framework. O aplicativo de exemplo é...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ccdc3f8c-2568-40a7-8f8b-3c23d2e05388
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-3
msc.type: authoredcontent
ms.openlocfilehash: 88debb11a9157dce9ff000b1cb459b876dbceaf3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78643244"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-3"></a><span data-ttu-id="07a68-104">Introdução com Entity Framework 4,0 Database First e ASP.NET 4 Web Forms-parte 3</span><span class="sxs-lookup"><span data-stu-id="07a68-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 3</span></span>

<span data-ttu-id="07a68-105">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="07a68-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="07a68-106">O aplicativo Web de exemplo Contoso University demonstra como criar ASP.NET Web Forms aplicativos usando o Entity Framework 4,0 e o Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="07a68-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="07a68-107">Para obter informações sobre a série de tutoriais, consulte [o primeiro tutorial da série](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="07a68-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="filtering-ordering-and-grouping-data"></a><span data-ttu-id="07a68-108">Filtragem, ordenação e agrupamento de dados</span><span class="sxs-lookup"><span data-stu-id="07a68-108">Filtering, Ordering, and Grouping Data</span></span>

<span data-ttu-id="07a68-109">No tutorial anterior, você usou o controle de `EntityDataSource` para exibir e editar dados.</span><span class="sxs-lookup"><span data-stu-id="07a68-109">In the previous tutorial you used the `EntityDataSource` control to display and edit data.</span></span> <span data-ttu-id="07a68-110">Neste tutorial, você filtrará, ordenará e agrupará os dados.</span><span class="sxs-lookup"><span data-stu-id="07a68-110">In this tutorial you'll filter, order, and group data.</span></span> <span data-ttu-id="07a68-111">Quando você faz isso definindo as propriedades do controle de `EntityDataSource`, a sintaxe é diferente de outros controles de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="07a68-111">When you do this by setting properties of the `EntityDataSource` control, the syntax is different from other data source controls.</span></span> <span data-ttu-id="07a68-112">Como você verá, no entanto, você pode usar o controle de `QueryExtender` para minimizar essas diferenças.</span><span class="sxs-lookup"><span data-stu-id="07a68-112">As you'll see, however, you can use the `QueryExtender` control to minimize these differences.</span></span>

<span data-ttu-id="07a68-113">Você alterará a página *students. aspx* para filtrar os alunos, classificar por nome e pesquisar o nome.</span><span class="sxs-lookup"><span data-stu-id="07a68-113">You'll change the *Students.aspx* page to filter for students, sort by name, and search on name.</span></span> <span data-ttu-id="07a68-114">Você também alterará a página *courses. aspx* para exibir os cursos do departamento selecionado e procurar cursos por nome.</span><span class="sxs-lookup"><span data-stu-id="07a68-114">You'll also change the *Courses.aspx* page to display courses for the selected department and search for courses by name.</span></span> <span data-ttu-id="07a68-115">Por fim, você adicionará estatísticas de estudante à página *about. aspx* .</span><span class="sxs-lookup"><span data-stu-id="07a68-115">Finally, you'll add student statistics to the *About.aspx* page.</span></span>

<span data-ttu-id="07a68-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-116">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image1.png)</span></span>

<span data-ttu-id="07a68-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-117">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image3.png)</span></span>

<span data-ttu-id="07a68-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-118">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image5.png)</span></span>

<span data-ttu-id="07a68-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-119">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image7.png)</span></span>

## <a name="using-the-entitydatasource-where-property-to-filter-data"></a><span data-ttu-id="07a68-120">Usando a Propriedade EntityDataSource "Where" para filtrar dados</span><span class="sxs-lookup"><span data-stu-id="07a68-120">Using the EntityDataSource "Where" Property to Filter Data</span></span>

<span data-ttu-id="07a68-121">Abra a página *students. aspx* que você criou no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="07a68-121">Open the *Students.aspx* page that you created in the previous tutorial.</span></span> <span data-ttu-id="07a68-122">Como configurado atualmente, o controle de `GridView` na página exibe todos os nomes do conjunto de entidades de `People`.</span><span class="sxs-lookup"><span data-stu-id="07a68-122">As currently configured, the `GridView` control in the page displays all the names from the `People` entity set.</span></span> <span data-ttu-id="07a68-123">No entanto, você deseja mostrar somente os alunos, que podem ser encontrados selecionando `Person` entidades que têm datas de registro não nulas.</span><span class="sxs-lookup"><span data-stu-id="07a68-123">However, you want to show only students, which you can find by selecting `Person` entities that have non-null enrollment dates.</span></span>

<span data-ttu-id="07a68-124">Alterne para o modo de exibição de **design** e selecione o controle de `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="07a68-124">Switch to **Design** view and select the `EntityDataSource` control.</span></span> <span data-ttu-id="07a68-125">Na janela **Propriedades** , defina a propriedade `Where` como `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="07a68-125">In the **Properties** window, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>

<span data-ttu-id="07a68-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-126">[![Image01](the-entity-framework-and-aspnet-getting-started-part-3/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image9.png)</span></span>

<span data-ttu-id="07a68-127">A sintaxe usada na propriedade `Where` do controle de `EntityDataSource` é Entity SQL.</span><span class="sxs-lookup"><span data-stu-id="07a68-127">The syntax you use in the `Where` property of the `EntityDataSource` control is Entity SQL.</span></span> <span data-ttu-id="07a68-128">O Entity SQL é semelhante ao Transact-SQL, mas é personalizado para uso com entidades em vez de objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="07a68-128">Entity SQL is similar to Transact-SQL, but it's customized for use with entities rather than database objects.</span></span> <span data-ttu-id="07a68-129">No `it.EnrollmentDate is not null`de expressão, a palavra `it` representa uma referência à entidade retornada pela consulta.</span><span class="sxs-lookup"><span data-stu-id="07a68-129">In the expression `it.EnrollmentDate is not null`, the word `it` represents a reference to the entity returned by the query.</span></span> <span data-ttu-id="07a68-130">Portanto, `it.EnrollmentDate` se refere à propriedade `EnrollmentDate` da entidade `Person` que o controle de `EntityDataSource` retorna.</span><span class="sxs-lookup"><span data-stu-id="07a68-130">Therefore, `it.EnrollmentDate` refers to the `EnrollmentDate` property of the `Person` entity that the `EntityDataSource` control returns.</span></span>

<span data-ttu-id="07a68-131">Execute a página.</span><span class="sxs-lookup"><span data-stu-id="07a68-131">Run the page.</span></span> <span data-ttu-id="07a68-132">A lista de alunos agora contém apenas alunos.</span><span class="sxs-lookup"><span data-stu-id="07a68-132">The students list now contains only students.</span></span> <span data-ttu-id="07a68-133">(Não há linhas exibidas em que não haja nenhuma data de registro.)</span><span class="sxs-lookup"><span data-stu-id="07a68-133">(There are no rows displayed where there's no enrollment date.)</span></span>

<span data-ttu-id="07a68-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-3/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image11.png)</span></span>

## <a name="using-the-entitydatasource-orderby-property-to-order-data"></a><span data-ttu-id="07a68-135">Usando a propriedade de EntityDataSource "OrderBy" para ordenar dados</span><span class="sxs-lookup"><span data-stu-id="07a68-135">Using the EntityDataSource "OrderBy" Property to Order Data</span></span>

<span data-ttu-id="07a68-136">Você também deseja que essa lista esteja em ordem de nome quando for exibida pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="07a68-136">You also want this list to be in name order when it's first displayed.</span></span> <span data-ttu-id="07a68-137">Com a página *students. aspx* ainda aberta no modo **design** e com o controle de `EntityDataSource` ainda selecionado, na janela **Propriedades** , defina a propriedade **OrderBy** como `it.LastName`.</span><span class="sxs-lookup"><span data-stu-id="07a68-137">With the *Students.aspx* page still open in **Design** view, and with the `EntityDataSource` control still selected, in the **Properties** window set the **OrderBy** property to `it.LastName`.</span></span>

<span data-ttu-id="07a68-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-138">[![Image05](the-entity-framework-and-aspnet-getting-started-part-3/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image13.png)</span></span>

<span data-ttu-id="07a68-139">Execute a página.</span><span class="sxs-lookup"><span data-stu-id="07a68-139">Run the page.</span></span> <span data-ttu-id="07a68-140">A lista de alunos agora está em ordem por sobrenome.</span><span class="sxs-lookup"><span data-stu-id="07a68-140">The students list is now in order by last name.</span></span>

<span data-ttu-id="07a68-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-141">[![Image04](the-entity-framework-and-aspnet-getting-started-part-3/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image15.png)</span></span>

## <a name="using-a-control-parameter-to-set-the-where-property"></a><span data-ttu-id="07a68-142">Usando um parâmetro de controle para definir a propriedade "Where"</span><span class="sxs-lookup"><span data-stu-id="07a68-142">Using a Control Parameter to Set the "Where" Property</span></span>

<span data-ttu-id="07a68-143">Assim como ocorre com outros controles de fonte de dados, você pode passar valores de parâmetro para a propriedade `Where`.</span><span class="sxs-lookup"><span data-stu-id="07a68-143">As with other data source controls, you can pass parameter values to the `Where` property.</span></span> <span data-ttu-id="07a68-144">Na página *cursos. aspx* que você criou na parte 2 do tutorial, você pode usar esse método para exibir os cursos associados ao departamento que um usuário seleciona na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="07a68-144">On the *Courses.aspx* page that you created in part 2 of the tutorial, you can use this method to display courses that are associated with the department that a user selects from the drop-down list.</span></span>

<span data-ttu-id="07a68-145">Abra o *courses. aspx* e alterne para o modo de exibição de **design** .</span><span class="sxs-lookup"><span data-stu-id="07a68-145">Open *Courses.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="07a68-146">Adicione um segundo controle `EntityDataSource` à página e nomeie-o `CoursesEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="07a68-146">Add a second `EntityDataSource` control to the page, and name it `CoursesEntityDataSource`.</span></span> <span data-ttu-id="07a68-147">Conecte-o ao modelo de `SchoolEntities` e selecione `Courses` como o valor **EntitySetName** .</span><span class="sxs-lookup"><span data-stu-id="07a68-147">Connect it to the `SchoolEntities` model, and select `Courses` as the **EntitySetName** value.</span></span>

<span data-ttu-id="07a68-148">Na janela **Propriedades** , clique nas reticências na caixa de propriedade **Where** .</span><span class="sxs-lookup"><span data-stu-id="07a68-148">In the **Properties** window, click the ellipsis in the **Where** property box.</span></span> <span data-ttu-id="07a68-149">(Verifique se o controle de `CoursesEntityDataSource` ainda está selecionado antes de usar a janela **Propriedades** .)</span><span class="sxs-lookup"><span data-stu-id="07a68-149">(Make sure the `CoursesEntityDataSource` control is still selected before using the **Properties** window.)</span></span>

<span data-ttu-id="07a68-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-150">[![Image06](the-entity-framework-and-aspnet-getting-started-part-3/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image17.png)</span></span>

<span data-ttu-id="07a68-151">A caixa de diálogo **Editor de expressão** é exibida.</span><span class="sxs-lookup"><span data-stu-id="07a68-151">The **Expression Editor** dialog box is displayed.</span></span> <span data-ttu-id="07a68-152">Nessa caixa de diálogo, selecione **gerar automaticamente a expressão WHERE com base nos parâmetros fornecidos**e clique em **Adicionar parâmetro**.</span><span class="sxs-lookup"><span data-stu-id="07a68-152">In this dialog box, select **Automatically generate the Where expression based on the provided parameters**, and then click **Add Parameter**.</span></span> <span data-ttu-id="07a68-153">Nomeie o parâmetro `DepartmentID`, selecione **Control** como o valor de **origem do parâmetro** e selecione **DepartmentsDropDownList** como o valor de **ControlID** .</span><span class="sxs-lookup"><span data-stu-id="07a68-153">Name the parameter `DepartmentID`, select **Control** as the **Parameter source** value, and select **DepartmentsDropDownList** as the **ControlID** value.</span></span>

<span data-ttu-id="07a68-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-154">[![Image07](the-entity-framework-and-aspnet-getting-started-part-3/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image19.png)</span></span>

<span data-ttu-id="07a68-155">Clique em **mostrar propriedades avançadas**e, na janela **Propriedades** da caixa de diálogo **Editor de expressão** , altere a propriedade `Type` para `Int32`.</span><span class="sxs-lookup"><span data-stu-id="07a68-155">Click **Show advanced properties**, and in the **Properties** window of the **Expression Editor** dialog box, change the `Type` property to `Int32`.</span></span>

<span data-ttu-id="07a68-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-156">[![Image15](the-entity-framework-and-aspnet-getting-started-part-3/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image21.png)</span></span>

<span data-ttu-id="07a68-157">Quando terminar, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="07a68-157">When you're done, click **OK**.</span></span>

<span data-ttu-id="07a68-158">Abaixo da lista suspensa, adicione um controle de `GridView` à página e nomeie-o `CoursesGridView`.</span><span class="sxs-lookup"><span data-stu-id="07a68-158">Below the drop-down list, add a `GridView` control to the page and name it `CoursesGridView`.</span></span> <span data-ttu-id="07a68-159">Conecte-o ao controle da fonte de dados `CoursesEntityDataSource`, clique em **Atualizar esquema**, clique em **Editar colunas**e remova a coluna `DepartmentID`.</span><span class="sxs-lookup"><span data-stu-id="07a68-159">Connect it to the `CoursesEntityDataSource` data source control, click **Refresh Schema**, click **Edit Columns**, and remove the `DepartmentID` column.</span></span> <span data-ttu-id="07a68-160">A marcação de controle de `GridView` é semelhante ao exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="07a68-160">The `GridView` control markup resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample1.aspx)]

<span data-ttu-id="07a68-161">Quando o usuário altera o departamento selecionado na lista suspensa, você deseja que a lista de cursos associados seja alterada automaticamente.</span><span class="sxs-lookup"><span data-stu-id="07a68-161">When the user changes the selected department in the drop-down list, you want the list of associated courses to change automatically.</span></span> <span data-ttu-id="07a68-162">Para fazer isso acontecer, selecione a lista suspensa e, na janela **Propriedades** , defina a propriedade `AutoPostBack` como `True`.</span><span class="sxs-lookup"><span data-stu-id="07a68-162">To make this happen, select the drop-down list, and in the **Properties** window set the `AutoPostBack` property to `True`.</span></span>

<span data-ttu-id="07a68-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-163">[![Image08](the-entity-framework-and-aspnet-getting-started-part-3/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image23.png)</span></span>

<span data-ttu-id="07a68-164">Agora que você terminou de usar o designer, alterne para o modo de exibição de **origem** e substitua as propriedades de `ConnectionString` e de nome de `DefaultContainer` do controle de `CoursesEntityDataSource` pelo atributo `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="07a68-164">Now that you're finished using the designer, switch to **Source** view and replace the `ConnectionString` and `DefaultContainer` name properties of the `CoursesEntityDataSource` control with the `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="07a68-165">Quando você terminar, a marcação para o controle será semelhante ao exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="07a68-165">When you're done, the markup for the control will look like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample2.aspx)]

<span data-ttu-id="07a68-166">Execute a página e use a lista suspensa para selecionar diferentes departamentos.</span><span class="sxs-lookup"><span data-stu-id="07a68-166">Run the page and use the drop-down list to select different departments.</span></span> <span data-ttu-id="07a68-167">Somente os cursos que são oferecidos pelo departamento selecionado são exibidos no controle de `GridView`.</span><span class="sxs-lookup"><span data-stu-id="07a68-167">Only courses that are offered by the selected department are displayed in the `GridView` control.</span></span>

<span data-ttu-id="07a68-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-168">[![Image09](the-entity-framework-and-aspnet-getting-started-part-3/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image25.png)</span></span>

## <a name="using-the-entitydatasource-groupby-property-to-group-data"></a><span data-ttu-id="07a68-169">Usando a propriedade de EntityDataSource "GroupBy" para agrupar dados</span><span class="sxs-lookup"><span data-stu-id="07a68-169">Using the EntityDataSource "GroupBy" Property to Group Data</span></span>

<span data-ttu-id="07a68-170">Suponha que a Contoso University queira colocar algumas estatísticas de corpo de aluno em sua página About.</span><span class="sxs-lookup"><span data-stu-id="07a68-170">Suppose Contoso University wants to put some student-body statistics on its About page.</span></span> <span data-ttu-id="07a68-171">Especificamente, ele deseja mostrar uma divisão de números de alunos pela data em que eles foram registrados.</span><span class="sxs-lookup"><span data-stu-id="07a68-171">Specifically, it wants to show a breakdown of numbers of students by the date they enrolled.</span></span>

<span data-ttu-id="07a68-172">Abra *about. aspx*e, na exibição de **código-fonte** , substitua o conteúdo existente do controle de `BodyContent` por "estatísticas de corpo do aluno" entre marcas de `h2`:</span><span class="sxs-lookup"><span data-stu-id="07a68-172">Open *About.aspx*, and in **Source** view, replace the existing contents of the `BodyContent` control with "Student Body Statistics" between `h2` tags:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample3.aspx)]

<span data-ttu-id="07a68-173">Depois do título, adicione um controle de `EntityDataSource` e nomeie-o `StudentStatisticsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="07a68-173">After the heading, add an `EntityDataSource` control and name it `StudentStatisticsEntityDataSource`.</span></span> <span data-ttu-id="07a68-174">Conecte-o à `SchoolEntities`, selecione o conjunto de entidades de `People` e deixe a caixa de **seleção** no assistente inalterada.</span><span class="sxs-lookup"><span data-stu-id="07a68-174">Connect it to `SchoolEntities`, select the `People` entity set, and leave the **Select** box in the wizard unchanged.</span></span> <span data-ttu-id="07a68-175">Defina as seguintes propriedades na janela **Propriedades** :</span><span class="sxs-lookup"><span data-stu-id="07a68-175">Set the following properties in the **Properties** window:</span></span>

- <span data-ttu-id="07a68-176">Para filtrar somente para estudantes, defina a propriedade `Where` como `it.EnrollmentDate is not null`.</span><span class="sxs-lookup"><span data-stu-id="07a68-176">To filter for students only, set the `Where` property to `it.EnrollmentDate is not null`.</span></span>
- <span data-ttu-id="07a68-177">Para agrupar os resultados pela data de registro, defina a propriedade `GroupBy` como `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="07a68-177">To group the results by the enrollment date, set the `GroupBy` property to `it.EnrollmentDate`.</span></span>
- <span data-ttu-id="07a68-178">Para selecionar a data de registro e o número de alunos, defina a propriedade `Select` como `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span><span class="sxs-lookup"><span data-stu-id="07a68-178">To select the enrollment date and the number of students, set the `Select` property to `it.EnrollmentDate, Count(it.EnrollmentDate) AS NumberOfStudents`.</span></span>
- <span data-ttu-id="07a68-179">Para ordenar os resultados pela data de registro, defina a propriedade `OrderBy` como `it.EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="07a68-179">To order the results by the enrollment date, set the `OrderBy` property to `it.EnrollmentDate`.</span></span>

<span data-ttu-id="07a68-180">No modo de exibição de **origem** , substitua as propriedades de nome `ConnectionString` e `DefaultContainer` por uma propriedade `ContextTypeName`.</span><span class="sxs-lookup"><span data-stu-id="07a68-180">In **Source** view, replace the `ConnectionString` and `DefaultContainer` name properties with a `ContextTypeName` property.</span></span> <span data-ttu-id="07a68-181">A marcação de controle de `EntityDataSource` agora é semelhante ao exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="07a68-181">The `EntityDataSource` control markup now resembles the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample4.aspx)]

<span data-ttu-id="07a68-182">A sintaxe das propriedades `Select`, `GroupBy`e `Where` é semelhante a Transact-SQL, exceto para a palavra-chave `it` que especifica a entidade atual.</span><span class="sxs-lookup"><span data-stu-id="07a68-182">The syntax of the `Select`, `GroupBy`, and `Where` properties resembles Transact-SQL except for the `it` keyword that specifies the current entity.</span></span>

<span data-ttu-id="07a68-183">Adicione a marcação a seguir para criar um controle de `GridView` para exibir os dados.</span><span class="sxs-lookup"><span data-stu-id="07a68-183">Add the following markup to create a `GridView` control to display the data.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample5.aspx)]

<span data-ttu-id="07a68-184">Execute a página para ver uma lista que mostra o número de alunos por data de registro.</span><span class="sxs-lookup"><span data-stu-id="07a68-184">Run the page to see a list showing the number of students by enrollment date.</span></span>

<span data-ttu-id="07a68-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-185">[![Image10](the-entity-framework-and-aspnet-getting-started-part-3/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image27.png)</span></span>

## <a name="using-the-queryextender-control-for-filtering-and-ordering"></a><span data-ttu-id="07a68-186">Usando o controle QueryExtender para filtragem e ordenação</span><span class="sxs-lookup"><span data-stu-id="07a68-186">Using the QueryExtender Control for Filtering and Ordering</span></span>

<span data-ttu-id="07a68-187">O controle `QueryExtender` fornece uma maneira de especificar filtragem e classificação na marcação.</span><span class="sxs-lookup"><span data-stu-id="07a68-187">The `QueryExtender` control provides a way to specify filtering and sorting in markup.</span></span> <span data-ttu-id="07a68-188">A sintaxe é independente do DBMS (sistema de gerenciamento de banco de dados) que você está usando.</span><span class="sxs-lookup"><span data-stu-id="07a68-188">The syntax is independent of the database management system (DBMS) you're using.</span></span> <span data-ttu-id="07a68-189">Também é geralmente independente do Entity Framework, com a exceção de que a sintaxe usada para propriedades de navegação é exclusiva para o Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="07a68-189">It's also generally independent of the Entity Framework, with the exception that syntax you use for navigation properties is unique to the Entity Framework.</span></span>

<span data-ttu-id="07a68-190">Nesta parte do tutorial, você usará um controle `QueryExtender` para filtrar e ordenar dados, e um dos campos order-by será uma propriedade de navegação.</span><span class="sxs-lookup"><span data-stu-id="07a68-190">In this part of the tutorial you'll use a `QueryExtender` control to filter and order data, and one of the order-by fields will be a navigation property.</span></span>

<span data-ttu-id="07a68-191">(Se você preferir usar código em vez de marcação para estender as consultas que são geradas automaticamente pelo controle de `EntityDataSource`, você pode fazer isso manipulando o evento `QueryCreated`.</span><span class="sxs-lookup"><span data-stu-id="07a68-191">(If you prefer to use code instead of markup to extend the queries that are automatically generated by the `EntityDataSource` control, you can do that by handling the `QueryCreated` event.</span></span> <span data-ttu-id="07a68-192">É assim que o controle de `QueryExtender` estende `EntityDataSource` consultas de controle também.)</span><span class="sxs-lookup"><span data-stu-id="07a68-192">This is how the `QueryExtender` control extends `EntityDataSource` control queries also.)</span></span>

<span data-ttu-id="07a68-193">Abra a página *cursos. aspx* e, abaixo da marcação que você adicionou anteriormente, insira a marcação a seguir para criar um título, uma caixa de texto para inserir cadeias de caracteres de pesquisa, um botão de pesquisa e um `EntityDataSource` controle associado ao conjunto de entidades de `Courses`.</span><span class="sxs-lookup"><span data-stu-id="07a68-193">Open the *Courses.aspx* page, and below the markup you added previously, insert the following markup to create a heading, a text box for entering search strings, a search button, and an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample6.aspx)]

<span data-ttu-id="07a68-194">Observe que a propriedade `Include` do controle de `EntityDataSource` está definida como `Department`.</span><span class="sxs-lookup"><span data-stu-id="07a68-194">Notice that the `EntityDataSource` control's `Include` property is set to `Department`.</span></span> <span data-ttu-id="07a68-195">No banco de dados, a tabela `Course` não contém o nome do departamento; Ele contém um `DepartmentID` coluna de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="07a68-195">In the database, the `Course` table does not contain the department name; it contains a `DepartmentID` foreign key column.</span></span> <span data-ttu-id="07a68-196">Se você estava consultando o banco de dados diretamente, para obter o nome do departamento junto com os dado do curso, seria necessário unir as tabelas `Course` e `Department`.</span><span class="sxs-lookup"><span data-stu-id="07a68-196">If you were querying the database directly, to get the department name along with course data, you would have to join the `Course` and `Department` tables.</span></span> <span data-ttu-id="07a68-197">Ao definir a propriedade `Include` como `Department`, você especifica que a Entity Framework deve fazer o trabalho de obter a entidade de `Department` relacionada quando ela obtém uma entidade de `Course`.</span><span class="sxs-lookup"><span data-stu-id="07a68-197">By setting the `Include` property to `Department`, you specify that the Entity Framework should do the work of getting the related `Department` entity when it gets a `Course` entity.</span></span> <span data-ttu-id="07a68-198">Em seguida, a entidade `Department` é armazenada na propriedade de navegação `Department` da entidade `Course`.</span><span class="sxs-lookup"><span data-stu-id="07a68-198">The `Department` entity is then stored in the `Department` navigation property of the `Course` entity.</span></span> <span data-ttu-id="07a68-199">(Por padrão, a classe `SchoolEntities` que foi gerada pelo designer de modelo de dados recupera dados relacionados quando necessário, e você o controle da fonte de dados para essa classe, de modo que a definição da propriedade `Include` não é necessária.</span><span class="sxs-lookup"><span data-stu-id="07a68-199">(By default, the `SchoolEntities` class that was generated by the data model designer retrieves related data when it's needed, and you've bound the data source control to that class, so setting the `Include` property is not necessary.</span></span> <span data-ttu-id="07a68-200">No entanto, configurá-lo melhora o desempenho da página, pois, caso contrário, o Entity Framework faria chamadas separadas para o banco de dados a fim de recuperá-los para as entidades de `Course` e para as entidades de `Department` relacionadas.)</span><span class="sxs-lookup"><span data-stu-id="07a68-200">However, setting it improves performance of the page, because otherwise the Entity Framework would make separate calls to the database to retrieve data for the `Course` entities and for the related `Department` entities.)</span></span>

<span data-ttu-id="07a68-201">Após o controle de `EntityDataSource` que você acabou de criar, insira a marcação a seguir para criar um controle de `QueryExtender` associado a esse controle de `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="07a68-201">After the `EntityDataSource` control you just created, insert the following markup to create a `QueryExtender` control that's bound to that `EntityDataSource` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample7.aspx)]

<span data-ttu-id="07a68-202">O elemento `SearchExpression` especifica que você deseja selecionar os cursos cujos títulos correspondem ao valor inserido na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="07a68-202">The `SearchExpression` element specifies that you want to select courses whose titles match the value entered in the text box.</span></span> <span data-ttu-id="07a68-203">Somente quantos caracteres forem inseridos na caixa de texto serão comparados, pois a propriedade `SearchType` especifica `StartsWith`.</span><span class="sxs-lookup"><span data-stu-id="07a68-203">Only as many characters as are entered in the text box will be compared, because the `SearchType` property specifies `StartsWith`.</span></span>

<span data-ttu-id="07a68-204">O elemento `OrderByExpression` especifica que o conjunto de resultados será ordenado pelo título do curso dentro do nome do departamento.</span><span class="sxs-lookup"><span data-stu-id="07a68-204">The `OrderByExpression` element specifies that the result set will be ordered by course title within department name.</span></span> <span data-ttu-id="07a68-205">Observe como o nome do departamento é especificado: `Department.Name`.</span><span class="sxs-lookup"><span data-stu-id="07a68-205">Notice how department name is specified: `Department.Name`.</span></span> <span data-ttu-id="07a68-206">Como a associação entre a entidade de `Course` e a entidade `Department` é um-para-um, a propriedade de navegação `Department` contém uma entidade `Department`.</span><span class="sxs-lookup"><span data-stu-id="07a68-206">Because the association between the `Course` entity and the `Department` entity is one-to-one, the `Department` navigation property contains a `Department` entity.</span></span> <span data-ttu-id="07a68-207">(Se essa fosse uma relação um-para-muitos, a propriedade conteria uma coleção.) Para obter o nome do departamento, você deve especificar a propriedade `Name` da entidade `Department`.</span><span class="sxs-lookup"><span data-stu-id="07a68-207">(If this were a one-to-many relationship, the property would contain a collection.) To get the department name, you must specify the `Name` property of the `Department` entity.</span></span>

<span data-ttu-id="07a68-208">Por fim, adicione um controle de `GridView` para exibir a lista de cursos:</span><span class="sxs-lookup"><span data-stu-id="07a68-208">Finally, add a `GridView` control to display the list of courses:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample8.aspx)]

<span data-ttu-id="07a68-209">A primeira coluna é um campo de modelo que exibe o nome do departamento.</span><span class="sxs-lookup"><span data-stu-id="07a68-209">The first column is a template field that displays the department name.</span></span> <span data-ttu-id="07a68-210">A expressão DataBinding especifica `Department.Name`, assim como você viu no controle `QueryExtender`.</span><span class="sxs-lookup"><span data-stu-id="07a68-210">The databinding expression specifies `Department.Name`, just as you saw in the `QueryExtender` control.</span></span>

<span data-ttu-id="07a68-211">Execute a página.</span><span class="sxs-lookup"><span data-stu-id="07a68-211">Run the page.</span></span> <span data-ttu-id="07a68-212">A exibição inicial mostra uma lista de todos os cursos em ordem por departamento e, em seguida, por título do curso.</span><span class="sxs-lookup"><span data-stu-id="07a68-212">The initial display shows a list of all courses in order by department and then by course title.</span></span>

<span data-ttu-id="07a68-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-213">[![Image11](the-entity-framework-and-aspnet-getting-started-part-3/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image29.png)</span></span>

<span data-ttu-id="07a68-214">Insira um "m" e clique em **Pesquisar** para ver todos os cursos cujos títulos comecem com "m" (a pesquisa não diferencia maiúsculas de minúsculas).</span><span class="sxs-lookup"><span data-stu-id="07a68-214">Enter an "m" and click **Search** to see all courses whose titles begin with "m" (the search is not case sensitive).</span></span>

<span data-ttu-id="07a68-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-215">[![Image12](the-entity-framework-and-aspnet-getting-started-part-3/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image31.png)</span></span>

## <a name="using-the-like-operator-to-filter-data"></a><span data-ttu-id="07a68-216">Usando o operador "Like" para filtrar dados</span><span class="sxs-lookup"><span data-stu-id="07a68-216">Using the "Like" Operator to Filter Data</span></span>

<span data-ttu-id="07a68-217">Você pode obter um efeito semelhante aos tipos de pesquisa `StartsWith`, `Contains`e `EndsWith` do controle de `QueryExtender` usando um operador `Like` na propriedade `EntityDataSource` do controle `Where`.</span><span class="sxs-lookup"><span data-stu-id="07a68-217">You can achieve an effect similar to the `QueryExtender` control's `StartsWith`, `Contains`, and `EndsWith` search types by using a `Like` operator in the `EntityDataSource` control's `Where` property.</span></span> <span data-ttu-id="07a68-218">Nesta parte do tutorial, você verá como usar o operador de `Like` para procurar um estudante por nome.</span><span class="sxs-lookup"><span data-stu-id="07a68-218">In this part of the tutorial, you'll see how to use the `Like` operator to search for a student by name.</span></span>

<span data-ttu-id="07a68-219">Abra *students. aspx* na exibição de **código-fonte** .</span><span class="sxs-lookup"><span data-stu-id="07a68-219">Open *Students.aspx* in **Source** view.</span></span> <span data-ttu-id="07a68-220">Após o controle de `GridView`, adicione a seguinte marcação:</span><span class="sxs-lookup"><span data-stu-id="07a68-220">After the `GridView` control, add the following markup:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-3/samples/sample9.aspx)]

<span data-ttu-id="07a68-221">Essa marcação é semelhante ao que você viu anteriormente, exceto pelo valor da propriedade `Where`.</span><span class="sxs-lookup"><span data-stu-id="07a68-221">This markup is similar to what you've seen earlier except for the `Where` property value.</span></span> <span data-ttu-id="07a68-222">A segunda parte da expressão de `Where` define uma pesquisa de subcadeia de caracteres (`LIKE %FirstMidName% or LIKE %LastName%`) que pesquisa o nome e o sobrenome de qualquer coisa que seja inserida na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="07a68-222">The second part of the `Where` expression defines a substring search (`LIKE %FirstMidName% or LIKE %LastName%`) that searches both the first and last names for whatever is entered in the text box.</span></span>

<span data-ttu-id="07a68-223">Execute a página.</span><span class="sxs-lookup"><span data-stu-id="07a68-223">Run the page.</span></span> <span data-ttu-id="07a68-224">Inicialmente, você vê todos os alunos porque o valor padrão para o parâmetro `StudentName` é "%".</span><span class="sxs-lookup"><span data-stu-id="07a68-224">Initially you see all of the students because the default value for the `StudentName` parameter is "%".</span></span>

<span data-ttu-id="07a68-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-225">[![Image13](the-entity-framework-and-aspnet-getting-started-part-3/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image33.png)</span></span>

<span data-ttu-id="07a68-226">Insira a letra "g" na caixa de texto e clique em **Pesquisar**.</span><span class="sxs-lookup"><span data-stu-id="07a68-226">Enter the letter "g" in the text box and click **Search**.</span></span> <span data-ttu-id="07a68-227">Você verá uma lista de alunos que têm um "g" no nome ou sobrenome.</span><span class="sxs-lookup"><span data-stu-id="07a68-227">You see a list of students that have a "g" in either the first or last name.</span></span>

<span data-ttu-id="07a68-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="07a68-228">[![Image14](the-entity-framework-and-aspnet-getting-started-part-3/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-3/_static/image35.png)</span></span>

<span data-ttu-id="07a68-229">Agora você exibiu, atualizou, filtrou, pediu e agrupava dados de tabelas individuais.</span><span class="sxs-lookup"><span data-stu-id="07a68-229">You've now displayed, updated, filtered, ordered, and grouped data from individual tables.</span></span> <span data-ttu-id="07a68-230">No próximo tutorial, você começará a trabalhar com dados relacionados (cenários de detalhes mestre).</span><span class="sxs-lookup"><span data-stu-id="07a68-230">In the next tutorial you'll begin to work with related data (master-detail scenarios).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="07a68-231">[Anterior](the-entity-framework-and-aspnet-getting-started-part-2.md)
> [Próximo](the-entity-framework-and-aspnet-getting-started-part-4.md)</span><span class="sxs-lookup"><span data-stu-id="07a68-231">[Previous](the-entity-framework-and-aspnet-getting-started-part-2.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-4.md)</span></span>
