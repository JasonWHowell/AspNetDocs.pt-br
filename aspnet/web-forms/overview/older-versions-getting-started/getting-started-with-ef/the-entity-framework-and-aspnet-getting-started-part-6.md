---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-6
title: Introdução com Entity Framework 4,0 Database First e ASP.NET 4 Web Forms-parte 6 | Microsoft Docs
author: tdykstra
description: O aplicativo Web de exemplo Contoso University demonstra como criar ASP.NET Web Forms aplicativos usando o Entity Framework. O aplicativo de exemplo é...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: 994a5496-c648-4830-b03c-55bb43f325d2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-6
msc.type: authoredcontent
ms.openlocfilehash: 8bfbe74f90eb03ea9aab7610842ef2578e80d113
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78564221"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-6"></a><span data-ttu-id="98a37-104">Introdução com Entity Framework 4,0 Database First e ASP.NET 4 Web Forms-parte 6</span><span class="sxs-lookup"><span data-stu-id="98a37-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 6</span></span>

<span data-ttu-id="98a37-105">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="98a37-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="98a37-106">O aplicativo Web de exemplo Contoso University demonstra como criar ASP.NET Web Forms aplicativos usando o Entity Framework 4,0 e o Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="98a37-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="98a37-107">Para obter informações sobre a série de tutoriais, consulte [o primeiro tutorial da série](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="98a37-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="implementing-table-per-hierarchy-inheritance"></a><span data-ttu-id="98a37-108">Implementando a herança de tabela por hierarquia</span><span class="sxs-lookup"><span data-stu-id="98a37-108">Implementing Table-per-Hierarchy Inheritance</span></span>

<span data-ttu-id="98a37-109">No tutorial anterior, você trabalhou com dados relacionados adicionando e excluindo relações e adicionando uma nova entidade que tinha uma relação com uma entidade existente.</span><span class="sxs-lookup"><span data-stu-id="98a37-109">In the previous tutorial you worked with related data by adding and deleting relationships and by adding a new entity that had a relationship to an existing entity.</span></span> <span data-ttu-id="98a37-110">Este tutorial mostrará como implementar a herança no modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="98a37-110">This tutorial will show you how to implement inheritance in the data model.</span></span>

<span data-ttu-id="98a37-111">Na programação orientada a objeto, você pode usar a herança para facilitar o trabalho com classes relacionadas.</span><span class="sxs-lookup"><span data-stu-id="98a37-111">In object-oriented programming, you can use inheritance to make it easier to work with related classes.</span></span> <span data-ttu-id="98a37-112">Por exemplo, você pode criar `Instructor` e `Student` classes que derivam de uma classe base `Person`.</span><span class="sxs-lookup"><span data-stu-id="98a37-112">For example, you could create `Instructor` and `Student` classes that derive from a `Person` base class.</span></span> <span data-ttu-id="98a37-113">Você pode criar os mesmos tipos de estruturas de herança entre entidades no Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="98a37-113">You can create the same kinds of inheritance structures among entities in the Entity Framework.</span></span>

<span data-ttu-id="98a37-114">Nesta parte do tutorial, você não criará nenhuma nova página da Web.</span><span class="sxs-lookup"><span data-stu-id="98a37-114">In this part of the tutorial, you won't create any new web pages.</span></span> <span data-ttu-id="98a37-115">Em vez disso, você adicionará entidades derivadas ao modelo de dados e modificará as páginas existentes para usar as novas entidades.</span><span class="sxs-lookup"><span data-stu-id="98a37-115">Instead, you'll add derived entities to the data model and modify existing pages to use the new entities.</span></span>

## <a name="table-per-hierarchy-versus-table-per-type-inheritance"></a><span data-ttu-id="98a37-116">Herança de tabela por hierarquia versus de tabela por tipo</span><span class="sxs-lookup"><span data-stu-id="98a37-116">Table-per-Hierarchy versus Table-per-Type Inheritance</span></span>

<span data-ttu-id="98a37-117">Um banco de dados pode armazenar informações sobre objetos relacionados em uma tabela ou em várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="98a37-117">A database can store information about related objects in one table or in multiple tables.</span></span> <span data-ttu-id="98a37-118">Por exemplo, no banco de dados `School`, a tabela `Person` inclui informações sobre alunos e instrutores em uma única tabela.</span><span class="sxs-lookup"><span data-stu-id="98a37-118">For example, in the `School` database, the `Person` table includes information about both students and instructors in a single table.</span></span> <span data-ttu-id="98a37-119">Algumas das colunas aplicam-se somente aos instrutores (`HireDate`), alguns somente aos alunos (`EnrollmentDate`) e outros (`LastName``FirstName`).</span><span class="sxs-lookup"><span data-stu-id="98a37-119">Some of the columns apply only to instructors (`HireDate`), some only to students (`EnrollmentDate`), and some to both (`LastName`, `FirstName`).</span></span>

<span data-ttu-id="98a37-120">[![image11](the-entity-framework-and-aspnet-getting-started-part-6/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-120">[![image11](the-entity-framework-and-aspnet-getting-started-part-6/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image1.png)</span></span>

<span data-ttu-id="98a37-121">Você pode configurar o Entity Framework para criar `Instructor` e `Student` entidades que herdam da entidade `Person`.</span><span class="sxs-lookup"><span data-stu-id="98a37-121">You can configure the Entity Framework to create `Instructor` and `Student` entities that inherit from the `Person` entity.</span></span> <span data-ttu-id="98a37-122">Esse padrão de gerar uma estrutura de herança de entidade a partir de uma única tabela de banco de dados é chamada de herança de *tabela por hierarquia* (TPH).</span><span class="sxs-lookup"><span data-stu-id="98a37-122">This pattern of generating an entity inheritance structure from a single database table is called *table-per-hierarchy* (TPH) inheritance.</span></span>

<span data-ttu-id="98a37-123">Para cursos, o banco de dados `School` usa um padrão diferente.</span><span class="sxs-lookup"><span data-stu-id="98a37-123">For courses, the `School` database uses a different pattern.</span></span> <span data-ttu-id="98a37-124">Cursos online e cursos no local são armazenados em tabelas separadas, cada uma com uma chave estrangeira que aponta para a tabela de `Course`.</span><span class="sxs-lookup"><span data-stu-id="98a37-124">Online courses and onsite courses are stored in separate tables, each of which has a foreign key that points to the `Course` table.</span></span> <span data-ttu-id="98a37-125">As informações comuns a ambos os tipos de curso são armazenadas apenas na tabela `Course`.</span><span class="sxs-lookup"><span data-stu-id="98a37-125">Information common to both course types is stored only in the `Course` table.</span></span>

<span data-ttu-id="98a37-126">[![IMAGE12](the-entity-framework-and-aspnet-getting-started-part-6/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-126">[![image12](the-entity-framework-and-aspnet-getting-started-part-6/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image3.png)</span></span>

<span data-ttu-id="98a37-127">Você pode configurar o modelo de dados Entity Framework para que as entidades `OnlineCourse` e `OnsiteCourse` herdam da entidade `Course`.</span><span class="sxs-lookup"><span data-stu-id="98a37-127">You can configure the Entity Framework data model so that `OnlineCourse` and `OnsiteCourse` entities inherit from the `Course` entity.</span></span> <span data-ttu-id="98a37-128">Esse padrão de gerar uma estrutura de herança de entidade a partir de tabelas separadas para cada tipo, com cada tabela separada referindo-se a uma tabela que armazena dados comuns a todos os tipos, é chamada de herança de *tabela por tipo* (TPT).</span><span class="sxs-lookup"><span data-stu-id="98a37-128">This pattern of generating an entity inheritance structure from separate tables for each type, with each separate table referring back to a table that stores data common to all types, is called *table per type* (TPT) inheritance.</span></span>

<span data-ttu-id="98a37-129">Os padrões de herança TPH geralmente oferecem melhor desempenho no Entity Framework do que os padrões de herança do TPT, pois os padrões de TPT podem resultar em consultas de junção complexas.</span><span class="sxs-lookup"><span data-stu-id="98a37-129">TPH inheritance patterns generally deliver better performance in the Entity Framework than TPT inheritance patterns, because TPT patterns can result in complex join queries.</span></span> <span data-ttu-id="98a37-130">Este tutorial demonstra como implementar a herança TPH.</span><span class="sxs-lookup"><span data-stu-id="98a37-130">This walkthrough demonstrates how to implement TPH inheritance.</span></span> <span data-ttu-id="98a37-131">Você fará isso executando as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="98a37-131">You'll do that by performing the following steps:</span></span>

- <span data-ttu-id="98a37-132">Crie `Instructor` e `Student` tipos de entidade que derivam de `Person`.</span><span class="sxs-lookup"><span data-stu-id="98a37-132">Create `Instructor` and `Student` entity types that derive from `Person`.</span></span>
- <span data-ttu-id="98a37-133">Mova as propriedades que pertencem às entidades derivadas da entidade `Person` para as entidades derivadas.</span><span class="sxs-lookup"><span data-stu-id="98a37-133">Move properties that pertain to the derived entities from the `Person` entity to the derived entities.</span></span>
- <span data-ttu-id="98a37-134">Defina restrições em Propriedades nos tipos derivados.</span><span class="sxs-lookup"><span data-stu-id="98a37-134">Set constraints on properties in the derived types.</span></span>
- <span data-ttu-id="98a37-135">Torne a entidade de `Person` uma entidade abstrata.</span><span class="sxs-lookup"><span data-stu-id="98a37-135">Make the `Person` entity an abstract entity.</span></span>
- <span data-ttu-id="98a37-136">Mapeie cada entidade derivada para a tabela de `Person` com uma condição que especifica como determinar se uma linha de `Person` representa o tipo derivado.</span><span class="sxs-lookup"><span data-stu-id="98a37-136">Map each derived entity to the `Person` table with a condition that specifies how to determine whether a `Person` row represents that derived type.</span></span>

## <a name="adding-instructor-and-student-entities"></a><span data-ttu-id="98a37-137">Adicionando entidades do instrutor e Student</span><span class="sxs-lookup"><span data-stu-id="98a37-137">Adding Instructor and Student Entities</span></span>

<span data-ttu-id="98a37-138">Abra o arquivo <em>SchoolModel. edmx</em> , clique com o botão direito do mouse em uma área desocupada no designer, selecione <strong>Adicionar</strong>e, em seguida, selecione <strong>entidade</strong><em>.</em></span><span class="sxs-lookup"><span data-stu-id="98a37-138">Open the <em>SchoolModel.edmx</em> file, right-click an unoccupied area in the designer, select <strong>Add</strong>, then select <strong>Entity</strong><em>.</em></span></span>

<span data-ttu-id="98a37-139">[![image01](the-entity-framework-and-aspnet-getting-started-part-6/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-139">[![image01](the-entity-framework-and-aspnet-getting-started-part-6/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image5.png)</span></span>

<span data-ttu-id="98a37-140">Na caixa de diálogo **Adicionar entidade** , nomeie a entidade `Instructor` e defina sua opção de **tipo base** como `Person`.</span><span class="sxs-lookup"><span data-stu-id="98a37-140">In the **Add Entity** dialog box, name the entity `Instructor` and set its **Base type** option to `Person`.</span></span>

<span data-ttu-id="98a37-141">[![image02](the-entity-framework-and-aspnet-getting-started-part-6/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-141">[![image02](the-entity-framework-and-aspnet-getting-started-part-6/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image7.png)</span></span>

<span data-ttu-id="98a37-142">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="98a37-142">Click **OK**.</span></span> <span data-ttu-id="98a37-143">O designer cria uma entidade `Instructor` que deriva da entidade `Person`.</span><span class="sxs-lookup"><span data-stu-id="98a37-143">The designer creates an `Instructor` entity that derives from the `Person` entity.</span></span> <span data-ttu-id="98a37-144">A nova entidade ainda não tem nenhuma propriedade.</span><span class="sxs-lookup"><span data-stu-id="98a37-144">The new entity does not yet have any properties.</span></span>

<span data-ttu-id="98a37-145">[![image03](the-entity-framework-and-aspnet-getting-started-part-6/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-145">[![image03](the-entity-framework-and-aspnet-getting-started-part-6/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image9.png)</span></span>

<span data-ttu-id="98a37-146">Repita o procedimento para criar uma entidade de `Student` que também deriva de `Person`.</span><span class="sxs-lookup"><span data-stu-id="98a37-146">Repeat the procedure to create a `Student` entity that also derives from `Person`.</span></span>

<span data-ttu-id="98a37-147">Somente instrutores têm datas de contratação, portanto, você precisa mover essa propriedade da entidade `Person` para a entidade `Instructor`.</span><span class="sxs-lookup"><span data-stu-id="98a37-147">Only instructors have hire dates, so you need to move that property from the `Person` entity to the `Instructor` entity.</span></span> <span data-ttu-id="98a37-148">Na entidade `Person`, clique com o botão direito do mouse na propriedade `HireDate` e clique em **recortar**.</span><span class="sxs-lookup"><span data-stu-id="98a37-148">In the `Person` entity, right-click the `HireDate` property and click **Cut**.</span></span> <span data-ttu-id="98a37-149">Em seguida, clique com o botão direito do mouse em **Propriedades** na entidade `Instructor` e clique em **colar**.</span><span class="sxs-lookup"><span data-stu-id="98a37-149">Then right-click **Properties** in the `Instructor` entity and click **Paste**.</span></span>

<span data-ttu-id="98a37-150">[![image04](the-entity-framework-and-aspnet-getting-started-part-6/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-150">[![image04](the-entity-framework-and-aspnet-getting-started-part-6/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image11.png)</span></span>

<span data-ttu-id="98a37-151">A data de contratação de uma entidade de `Instructor` não pode ser nula.</span><span class="sxs-lookup"><span data-stu-id="98a37-151">The hire date of an `Instructor` entity cannot be null.</span></span> <span data-ttu-id="98a37-152">Clique com o botão direito do mouse na propriedade `HireDate`, clique em **Propriedades**e, na janela **propriedades** , altere `Nullable` para `False`.</span><span class="sxs-lookup"><span data-stu-id="98a37-152">Right-click the `HireDate` property, click **Properties**, and then in the **Properties** window change `Nullable` to `False`.</span></span>

<span data-ttu-id="98a37-153">[![image05](the-entity-framework-and-aspnet-getting-started-part-6/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-153">[![image05](the-entity-framework-and-aspnet-getting-started-part-6/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image13.png)</span></span>

<span data-ttu-id="98a37-154">Repita o procedimento para mover a propriedade `EnrollmentDate` da entidade `Person` para a entidade `Student`.</span><span class="sxs-lookup"><span data-stu-id="98a37-154">Repeat the procedure to move the `EnrollmentDate` property from the `Person` entity to the `Student` entity.</span></span> <span data-ttu-id="98a37-155">Certifique-se de também definir `Nullable` como `False` para a propriedade `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="98a37-155">Make sure that you also set `Nullable` to `False` for the `EnrollmentDate` property.</span></span>

<span data-ttu-id="98a37-156">Agora que uma entidade `Person` tem apenas as propriedades que são comuns a `Instructor` e `Student` entidades (além das propriedades de navegação, que você não está movendo), a entidade só pode ser usada como uma entidade base na estrutura de herança.</span><span class="sxs-lookup"><span data-stu-id="98a37-156">Now that a `Person` entity has only the properties that are common to `Instructor` and `Student` entities (aside from navigation properties, which you're not moving), the entity can only be used as a base entity in the inheritance structure.</span></span> <span data-ttu-id="98a37-157">Portanto, você precisa garantir que nunca seja tratado como uma entidade independente.</span><span class="sxs-lookup"><span data-stu-id="98a37-157">Therefore, you need to ensure that it's never treated as an independent entity.</span></span> <span data-ttu-id="98a37-158">Clique com o botão direito do mouse na entidade `Person`, selecione **Propriedades**e, na janela **Propriedades** , altere o valor da propriedade **abstract** para **true**.</span><span class="sxs-lookup"><span data-stu-id="98a37-158">Right-click the `Person` entity, select **Properties**, and then in the **Properties** window change the value of the **Abstract** property to **True**.</span></span>

<span data-ttu-id="98a37-159">[![image06](the-entity-framework-and-aspnet-getting-started-part-6/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-159">[![image06](the-entity-framework-and-aspnet-getting-started-part-6/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image15.png)</span></span>

## <a name="mapping-instructor-and-student-entities-to-the-person-table"></a><span data-ttu-id="98a37-160">Mapeando entidades do instrutor e aluno para a tabela Person</span><span class="sxs-lookup"><span data-stu-id="98a37-160">Mapping Instructor and Student Entities to the Person Table</span></span>

<span data-ttu-id="98a37-161">Agora você precisa informar ao Entity Framework como diferenciar entre `Instructor` e `Student` entidades no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="98a37-161">Now you need to tell the Entity Framework how to differentiate between `Instructor` and `Student` entities in the database.</span></span>

<span data-ttu-id="98a37-162">Clique com o botão direito do mouse na entidade `Instructor` e selecione **mapeamento de tabela**.</span><span class="sxs-lookup"><span data-stu-id="98a37-162">Right-click the `Instructor` entity and select **Table Mapping**.</span></span> <span data-ttu-id="98a37-163">Na janela **detalhes do mapeamento** , clique em **Adicionar uma tabela ou exibição** e selecione **pessoa**.</span><span class="sxs-lookup"><span data-stu-id="98a37-163">In the **Mapping Details** window, click **Add a Table or View** and select **Person**.</span></span>

<span data-ttu-id="98a37-164">[![image07](the-entity-framework-and-aspnet-getting-started-part-6/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-164">[![image07](the-entity-framework-and-aspnet-getting-started-part-6/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image17.png)</span></span>

<span data-ttu-id="98a37-165">Clique em **Adicionar uma condição**e, em seguida, selecione **HireDate**.</span><span class="sxs-lookup"><span data-stu-id="98a37-165">Click **Add a Condition**, and then select **HireDate**.</span></span>

<span data-ttu-id="98a37-166">[![image09](the-entity-framework-and-aspnet-getting-started-part-6/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-166">[![image09](the-entity-framework-and-aspnet-getting-started-part-6/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image19.png)</span></span>

<span data-ttu-id="98a37-167">Altere o **operador** para **is** e **Value/Property** para **NOT NULL**.</span><span class="sxs-lookup"><span data-stu-id="98a37-167">Change **Operator** to **Is** and **Value / Property** to **Not Null**.</span></span>

<span data-ttu-id="98a37-168">[![image10](the-entity-framework-and-aspnet-getting-started-part-6/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-168">[![image10](the-entity-framework-and-aspnet-getting-started-part-6/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image21.png)</span></span>

<span data-ttu-id="98a37-169">Repita o procedimento para a entidade `Students`, especificando que essa entidade mapeia para a tabela `Person` quando a coluna `EnrollmentDate` não é nula.</span><span class="sxs-lookup"><span data-stu-id="98a37-169">Repeat the procedure for the `Students` entity, specifying that this entity maps to the `Person` table when the `EnrollmentDate` column is not null.</span></span> <span data-ttu-id="98a37-170">Em seguida, salve e feche o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="98a37-170">Then save and close the data model.</span></span>

<span data-ttu-id="98a37-171">Compile o projeto para criar as novas entidades como classes e torná-las disponíveis no designer.</span><span class="sxs-lookup"><span data-stu-id="98a37-171">Build the project in order to create the new entities as classes and make them available in the designer.</span></span>

## <a name="using-the-instructor-and-student-entities"></a><span data-ttu-id="98a37-172">Usando as entidades do instrutor e do aluno</span><span class="sxs-lookup"><span data-stu-id="98a37-172">Using the Instructor and Student Entities</span></span>

<span data-ttu-id="98a37-173">Quando você criou as páginas da Web que funcionam com os dados do aluno e do instrutor, você os vinculados ao conjunto de entidades de `Person` e filtrados na propriedade `HireDate` ou `EnrollmentDate` para restringir os dados retornados aos alunos ou instrutores.</span><span class="sxs-lookup"><span data-stu-id="98a37-173">When you created the web pages that work with student and instructor data, you databound them to the `Person` entity set, and you filtered on the `HireDate` or `EnrollmentDate` property to restrict the returned data to students or instructors.</span></span> <span data-ttu-id="98a37-174">No entanto, agora, ao associar cada controle da fonte de dados ao conjunto de entidades `Person`, você pode especificar que somente `Student` ou `Instructor` tipos de entidade devem ser selecionados.</span><span class="sxs-lookup"><span data-stu-id="98a37-174">However, now when you bind each data source control to the `Person` entity set, you can specify that only `Student` or `Instructor` entity types should be selected.</span></span> <span data-ttu-id="98a37-175">Como o Entity Framework sabe como diferenciar alunos e instrutores no conjunto de entidades de `Person`, você pode remover as configurações de propriedade de `Where` que você inseriu manualmente para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="98a37-175">Because the Entity Framework knows how to differentiate students and instructors in the `Person` entity set, you can remove the `Where` property settings you entered manually to do that.</span></span>

<span data-ttu-id="98a37-176">No designer do Visual Studio, você pode especificar o tipo de entidade que um controle de `EntityDataSource` deve selecionar na caixa suspensa **EntityTypeFilter** do assistente de `Configure Data Source`, conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="98a37-176">In the Visual Studio Designer, you can specify the entity type that an `EntityDataSource` control should select in the **EntityTypeFilter** drop-down box of the `Configure Data Source` wizard, as shown in the following example.</span></span>

<span data-ttu-id="98a37-177">[![image13](the-entity-framework-and-aspnet-getting-started-part-6/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-177">[![image13](the-entity-framework-and-aspnet-getting-started-part-6/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image23.png)</span></span>

<span data-ttu-id="98a37-178">E, na janela **Propriedades** , você pode remover `Where` valores de cláusula que não são mais necessários, conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="98a37-178">And in the **Properties** window you can remove `Where` clause values that are no longer needed, as shown in the following example.</span></span>

<span data-ttu-id="98a37-179">[![image14](the-entity-framework-and-aspnet-getting-started-part-6/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-179">[![image14](the-entity-framework-and-aspnet-getting-started-part-6/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image25.png)</span></span>

<span data-ttu-id="98a37-180">No entanto, como você alterou a marcação para `EntityDataSource` controles para usar o atributo `ContextTypeName`, não é possível executar o assistente para **Configurar fonte de dados** em controles de `EntityDataSource` que você já criou.</span><span class="sxs-lookup"><span data-stu-id="98a37-180">However, because you've changed the markup for `EntityDataSource` controls to use the `ContextTypeName` attribute, you cannot run the **Configure Data Source** wizard on `EntityDataSource` controls that you've already created.</span></span> <span data-ttu-id="98a37-181">Portanto, você fará as alterações necessárias alterando a marcação em vez disso.</span><span class="sxs-lookup"><span data-stu-id="98a37-181">Therefore, you'll make the required changes by changing markup instead.</span></span>

<span data-ttu-id="98a37-182">Abra a página *students. aspx* .</span><span class="sxs-lookup"><span data-stu-id="98a37-182">Open the *Students.aspx* page.</span></span> <span data-ttu-id="98a37-183">No controle `StudentsEntityDataSource`, remova o atributo `Where` e adicione um atributo `EntityTypeFilter="Student"`.</span><span class="sxs-lookup"><span data-stu-id="98a37-183">In the `StudentsEntityDataSource` control, remove the `Where` attribute and add an `EntityTypeFilter="Student"` attribute.</span></span> <span data-ttu-id="98a37-184">A marcação agora será semelhante ao exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="98a37-184">The markup will now resemble the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample1.aspx)]

<span data-ttu-id="98a37-185">Definir o atributo `EntityTypeFilter` garante que o controle de `EntityDataSource` selecionará apenas o tipo de entidade especificado.</span><span class="sxs-lookup"><span data-stu-id="98a37-185">Setting the `EntityTypeFilter` attribute ensures that the `EntityDataSource` control will select only the specified entity type.</span></span> <span data-ttu-id="98a37-186">Se você quisesse recuperar os tipos de entidade `Student` e `Instructor`, você não definiria esse atributo.</span><span class="sxs-lookup"><span data-stu-id="98a37-186">If you wanted to retrieve both `Student` and `Instructor` entity types, you would not set this attribute.</span></span> <span data-ttu-id="98a37-187">(Você tem a opção de recuperar vários tipos de entidade com apenas um controle `EntityDataSource` se estiver usando o controle para acesso a dados somente leitura.</span><span class="sxs-lookup"><span data-stu-id="98a37-187">(You have the option of retrieving multiple entity types with one `EntityDataSource` control only if you're using the control for read-only data access.</span></span> <span data-ttu-id="98a37-188">Se você estiver usando um controle de `EntityDataSource` para inserir, atualizar ou excluir entidades e se o conjunto de entidades a que está associado puder conter vários tipos, você só poderá trabalhar com um tipo de entidade e precisará definir esse atributo.)</span><span class="sxs-lookup"><span data-stu-id="98a37-188">If you're using an `EntityDataSource` control to insert, update, or delete entities, and if the entity set it's bound to can contain multiple types, you can only work with one entity type, and you have to set this attribute.)</span></span>

<span data-ttu-id="98a37-189">Repita o procedimento para o controle `SearchEntityDataSource`, exceto remover apenas a parte do atributo `Where` que seleciona entidades `Student` em vez de remover a propriedade completamente.</span><span class="sxs-lookup"><span data-stu-id="98a37-189">Repeat the procedure for the `SearchEntityDataSource` control, except remove only the part of the `Where` attribute that selects `Student` entities instead of removing the property altogether.</span></span> <span data-ttu-id="98a37-190">A marca de abertura do controle agora será semelhante ao exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="98a37-190">The opening tag of the control will now resemble the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample2.aspx)]

<span data-ttu-id="98a37-191">Execute a página para verificar se ela ainda funciona como antes.</span><span class="sxs-lookup"><span data-stu-id="98a37-191">Run the page to verify that it still works as it did before.</span></span>

<span data-ttu-id="98a37-192">[![image15](the-entity-framework-and-aspnet-getting-started-part-6/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-192">[![image15](the-entity-framework-and-aspnet-getting-started-part-6/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image27.png)</span></span>

<span data-ttu-id="98a37-193">Atualize as páginas a seguir que você criou nos tutoriais anteriores para que eles usem as novas entidades `Student` e `Instructor` em vez de `Person` entidades e, em seguida, execute-as para verificar se elas funcionam como faziam antes:</span><span class="sxs-lookup"><span data-stu-id="98a37-193">Update the following pages that you created in earlier tutorials so that they use the new `Student` and `Instructor` entities instead of `Person` entities, then run them to verify that they work as they did before:</span></span>

- <span data-ttu-id="98a37-194">Em *StudentsAdd. aspx*, adicione `EntityTypeFilter="Student"` ao controle de `StudentsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="98a37-194">In *StudentsAdd.aspx*, add `EntityTypeFilter="Student"` to the `StudentsEntityDataSource` control.</span></span> <span data-ttu-id="98a37-195">A marcação agora será semelhante ao exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="98a37-195">The markup will now resemble the following example:</span></span> 

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample3.aspx)]

    <span data-ttu-id="98a37-196">[![image16](the-entity-framework-and-aspnet-getting-started-part-6/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-196">[![image16](the-entity-framework-and-aspnet-getting-started-part-6/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image29.png)</span></span>
- <span data-ttu-id="98a37-197">Em *about. aspx*, adicione `EntityTypeFilter="Student"` ao controle de `StudentStatisticsEntityDataSource` e remova `Where="it.EnrollmentDate is not null"`.</span><span class="sxs-lookup"><span data-stu-id="98a37-197">In *About.aspx*, add `EntityTypeFilter="Student"` to the `StudentStatisticsEntityDataSource` control and remove `Where="it.EnrollmentDate is not null"`.</span></span> <span data-ttu-id="98a37-198">A marcação agora será semelhante ao exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="98a37-198">The markup will now resemble the following example:</span></span> 

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample4.aspx)]

    <span data-ttu-id="98a37-199">[![image17](the-entity-framework-and-aspnet-getting-started-part-6/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-199">[![image17](the-entity-framework-and-aspnet-getting-started-part-6/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image31.png)</span></span>
- <span data-ttu-id="98a37-200">Em *instrutores. aspx* e *InstructorsCourses. aspx*, adicione `EntityTypeFilter="Instructor"` ao controle de `InstructorsEntityDataSource` e remova `Where="it.HireDate is not null"`.</span><span class="sxs-lookup"><span data-stu-id="98a37-200">In *Instructors.aspx* and *InstructorsCourses.aspx*, add `EntityTypeFilter="Instructor"` to the `InstructorsEntityDataSource` control and remove `Where="it.HireDate is not null"`.</span></span> <span data-ttu-id="98a37-201">A marcação em *instrutores. aspx* agora é semelhante ao exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="98a37-201">The markup in *Instructors.aspx* now resembles the following example:</span></span> 

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample5.aspx)]

    <span data-ttu-id="98a37-202">[![image18](the-entity-framework-and-aspnet-getting-started-part-6/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-202">[![image18](the-entity-framework-and-aspnet-getting-started-part-6/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image33.png)</span></span>

    <span data-ttu-id="98a37-203">A marcação em *InstructorsCourses. aspx* agora se parecerá com o exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="98a37-203">The markup in *InstructorsCourses.aspx* will now resemble the following example:</span></span>

    [!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-6/samples/sample6.aspx)]

    <span data-ttu-id="98a37-204">[![image19](the-entity-framework-and-aspnet-getting-started-part-6/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="98a37-204">[![image19](the-entity-framework-and-aspnet-getting-started-part-6/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-6/_static/image35.png)</span></span>

<span data-ttu-id="98a37-205">Como resultado dessas alterações, você melhorou a manutenção do aplicativo da Contoso University de várias maneiras.</span><span class="sxs-lookup"><span data-stu-id="98a37-205">As a result of these changes, you've improved the Contoso University application's maintainability in several ways.</span></span> <span data-ttu-id="98a37-206">Você moveu a seleção e a lógica de validação da camada da interface do usuário (marcação *. aspx* ) e fez com que ela fosse parte integrante da camada de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="98a37-206">You've moved selection and validation logic out of the UI layer (*.aspx* markup) and made it an integral part of the data access layer.</span></span> <span data-ttu-id="98a37-207">Isso ajuda a isolar o código do aplicativo de alterações que você pode fazer no futuro no esquema de banco de dados ou no modelo de dado.</span><span class="sxs-lookup"><span data-stu-id="98a37-207">This helps to isolate your application code from changes that you might make in the future to the database schema or the data model.</span></span> <span data-ttu-id="98a37-208">Por exemplo, você pode decidir que os alunos podem ser contratados como auxílios dos professores e, portanto, obterão uma data de contratação.</span><span class="sxs-lookup"><span data-stu-id="98a37-208">For example, you could decide that students might be hired as teachers' aids and therefore would get a hire date.</span></span> <span data-ttu-id="98a37-209">Você poderia então adicionar uma nova propriedade para diferenciar os alunos dos instrutores e atualizar o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="98a37-209">You could then add a new property to differentiate students from instructors and update the data model.</span></span> <span data-ttu-id="98a37-210">Nenhum código no aplicativo Web precisaria ser alterado, exceto onde você quisesse mostrar uma data de contratação para os alunos.</span><span class="sxs-lookup"><span data-stu-id="98a37-210">No code in the web application would need to change except where you wanted to show a hire date for students.</span></span> <span data-ttu-id="98a37-211">Outro benefício de adicionar entidades de `Instructor` e `Student` é que seu código é mais compreensível do que quando se trata de `Person` objetos que, na verdade, são estudantes ou instrutores.</span><span class="sxs-lookup"><span data-stu-id="98a37-211">Another benefit of adding `Instructor` and `Student` entities is that your code is more readily understandable than when it referred to `Person` objects that were actually students or instructors.</span></span>

<span data-ttu-id="98a37-212">Agora você viu uma maneira de implementar um padrão de herança no Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="98a37-212">You've now seen one way to implement an inheritance pattern in the Entity Framework.</span></span> <span data-ttu-id="98a37-213">No tutorial a seguir, você aprenderá a usar procedimentos armazenados para ter mais controle sobre como o Entity Framework acessa o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="98a37-213">In the following tutorial, you'll learn how to use stored procedures in order to have more control over how the Entity Framework accesses the database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="98a37-214">[Anterior](the-entity-framework-and-aspnet-getting-started-part-5.md)
> [Próximo](the-entity-framework-and-aspnet-getting-started-part-7.md)</span><span class="sxs-lookup"><span data-stu-id="98a37-214">[Previous](the-entity-framework-and-aspnet-getting-started-part-5.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-7.md)</span></span>
