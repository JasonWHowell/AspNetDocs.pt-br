---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: Especificando a página mestra programaticamente (VB) | Microsoft Docs
author: rick-anderson
description: Examina a configuração da página mestra da página de conteúdo programaticamente por meio do manipulador de eventos PreInit.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74618598"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="afd6e-103">Especificar a página mestra programaticamente (VB)</span><span class="sxs-lookup"><span data-stu-id="afd6e-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="afd6e-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="afd6e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="afd6e-105">[Baixar código](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) ou [baixar PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="afd6e-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="afd6e-106">Examina a configuração da página mestra da página de conteúdo programaticamente por meio do manipulador de eventos PreInit.</span><span class="sxs-lookup"><span data-stu-id="afd6e-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="afd6e-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="afd6e-107">Introduction</span></span>

<span data-ttu-id="afd6e-108">Como o exemplo inaugural na [*criação de um layout de todo o site usando páginas mestras*](creating-a-site-wide-layout-using-master-pages-vb.md), todas as páginas de conteúdo referenciaram sua página mestra declarativamente por meio do atributo `MasterPageFile` na diretiva `@Page`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="afd6e-109">Por exemplo, a diretiva de `@Page` a seguir vincula a página de conteúdo à página mestra `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="afd6e-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="afd6e-110">A [classe`Page`](https://msdn.microsoft.com/library/system.web.ui.page.aspx) no namespace `System.Web.UI` inclui uma [Propriedade`MasterPageFile`](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) que retorna o caminho para a página mestra da página de conteúdo; é essa propriedade definida pela diretiva `@Page`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="afd6e-111">Essa propriedade também pode ser usada para especificar programaticamente a página mestra da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="afd6e-112">Essa abordagem será útil se você quiser atribuir dinamicamente a página mestra com base em fatores externos, como o usuário visitando a página.</span><span class="sxs-lookup"><span data-stu-id="afd6e-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="afd6e-113">Neste tutorial, adicionamos uma segunda página mestra ao nosso site e decidimos dinamicamente qual página mestra usar no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="afd6e-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="afd6e-114">Etapa 1: uma olhada no ciclo de vida da página</span><span class="sxs-lookup"><span data-stu-id="afd6e-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="afd6e-115">Sempre que uma solicitação chega ao servidor Web para uma página ASP.NET que é uma página de conteúdo, o mecanismo ASP.NET deve fundir os controles de conteúdo da página aos controles ContentPlaceHolder correspondentes da página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="afd6e-116">Essa fusão cria uma única hierarquia de controle que pode prosseguir pelo ciclo de vida típico da página.</span><span class="sxs-lookup"><span data-stu-id="afd6e-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="afd6e-117">A Figura 1 ilustra essa fusão.</span><span class="sxs-lookup"><span data-stu-id="afd6e-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="afd6e-118">A etapa 1 da Figura 1 mostra o conteúdo inicial e as hierarquias de controle da página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="afd6e-119">Na extremidade final do estágio PreInit, os controles de conteúdo na página são adicionados aos ContentPlaceHolders correspondentes na página mestra (etapa 2).</span><span class="sxs-lookup"><span data-stu-id="afd6e-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="afd6e-120">Após essa fusão, a página mestra serve como a raiz da hierarquia de controle com fusível.</span><span class="sxs-lookup"><span data-stu-id="afd6e-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="afd6e-121">Essa hierarquia de controle com fusível é adicionada à página para produzir a hierarquia de controle finalizada (etapa 3).</span><span class="sxs-lookup"><span data-stu-id="afd6e-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="afd6e-122">O resultado líquido é que a hierarquia de controle da página inclui a hierarquia de controle com fusível.</span><span class="sxs-lookup"><span data-stu-id="afd6e-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="afd6e-123">[![as hierarquias de controle da página mestra e da página de conteúdo são combinadas em conjunto durante o estágio PreInit](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="afd6e-124">**Figura 01**: a página mestra e as hierarquias de controle da página de conteúdo são combinadas em conjunto durante o estágio PreInit ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="afd6e-125">Etapa 2: definindo a propriedade`MasterPageFile`do código</span><span class="sxs-lookup"><span data-stu-id="afd6e-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="afd6e-126">O que a página mestra partakes nessa fusão depende do valor da propriedade `MasterPageFile` do objeto de `Page`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="afd6e-127">Definir o atributo `MasterPageFile` na diretiva `@Page` tem o efeito líquido de atribuir a propriedade `MasterPageFile` do `Page`durante o estágio de inicialização, que é o primeiro estágio do ciclo de vida da página.</span><span class="sxs-lookup"><span data-stu-id="afd6e-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="afd6e-128">Como alternativa, podemos definir essa propriedade programaticamente.</span><span class="sxs-lookup"><span data-stu-id="afd6e-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="afd6e-129">No entanto, é imperativo que essa propriedade seja definida antes que a fusão da Figura 1 ocorra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="afd6e-130">No início do estágio PreInit, o objeto `Page` gera seu [evento`PreInit`](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) e chama seu [método`OnPreInit`](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span><span class="sxs-lookup"><span data-stu-id="afd6e-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="afd6e-131">Para definir a página mestra programaticamente, podemos criar um manipulador de eventos para o evento `PreInit` ou substituir o método `OnPreInit`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="afd6e-132">Vamos examinar ambas as abordagens.</span><span class="sxs-lookup"><span data-stu-id="afd6e-132">Let's look at both approaches.</span></span>

<span data-ttu-id="afd6e-133">Comece abrindo `Default.aspx.vb`, o arquivo de classe code-behind para a home page do nosso site.</span><span class="sxs-lookup"><span data-stu-id="afd6e-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="afd6e-134">Adicione um manipulador de eventos para o evento de `PreInit` da página digitando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="afd6e-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="afd6e-135">Aqui, podemos definir a propriedade `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="afd6e-136">Atualize o código para que ele atribua o valor "~/site.Master" à propriedade `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="afd6e-137">Se você definir um ponto de interrupção e começar com a depuração, verá que sempre que a página de `Default.aspx` for visitada ou sempre que houver um postback para essa página, o manipulador de eventos de `Page_PreInit` será executado e a propriedade `MasterPageFile` será atribuída a "~/site.Master".</span><span class="sxs-lookup"><span data-stu-id="afd6e-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="afd6e-138">Como alternativa, você pode substituir o método `OnPreInit` da classe `Page` e definir a propriedade `MasterPageFile` lá.</span><span class="sxs-lookup"><span data-stu-id="afd6e-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="afd6e-139">Para este exemplo, não vamos definir a página mestra em uma página específica, mas em vez de `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="afd6e-140">Lembre-se de que criamos uma classe de página de base personalizada (`BasePage`) de volta nos tutoriais [*especificando o título, as marcas meta e outros cabeçalhos HTML no tutorial da página mestra*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="afd6e-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="afd6e-141">Atualmente `BasePage` substitui o método `OnLoadComplete` da classe `Page`, em que ele define a propriedade `Title` da página com base nos dados do mapa do site.</span><span class="sxs-lookup"><span data-stu-id="afd6e-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="afd6e-142">Vamos atualizar `BasePage` também substituir o método `OnPreInit` para especificar programaticamente a página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="afd6e-143">Como todas as nossas páginas de conteúdo derivam de `BasePage`, todas elas agora têm sua página mestra programaticamente atribuída.</span><span class="sxs-lookup"><span data-stu-id="afd6e-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="afd6e-144">Neste ponto, o manipulador de eventos `PreInit` no `Default.aspx.vb` é supérfluo; Fique à vontade para removê-lo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="afd6e-145">E quanto à diretiva de`@Page`?</span><span class="sxs-lookup"><span data-stu-id="afd6e-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="afd6e-146">O que pode ser um pouco confuso é que as propriedades de `MasterPageFile` das páginas de conteúdo agora estão sendo especificadas em dois locais: programaticamente no método `OnPreInit` da classe `BasePage`, bem como pelo atributo `MasterPageFile` na diretiva `@Page` de cada página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="afd6e-147">O primeiro estágio no ciclo de vida da página é o estágio de inicialização.</span><span class="sxs-lookup"><span data-stu-id="afd6e-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="afd6e-148">Durante esse estágio, a propriedade `MasterPageFile` do objeto de `Page` é atribuída ao valor do atributo `MasterPageFile` na diretiva `@Page` (se for fornecida).</span><span class="sxs-lookup"><span data-stu-id="afd6e-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="afd6e-149">O estágio PreInit segue o estágio de inicialização e está aqui onde definimos de forma programática a propriedade `MasterPageFile` do objeto de `Page`, substituindo assim o valor atribuído da diretiva `@Page`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="afd6e-150">Como estamos definindo a propriedade de `MasterPageFile` do objeto de `Page` de forma programática, poderíamos remover o atributo `MasterPageFile` da diretiva `@Page` sem afetar a experiência do usuário final.</span><span class="sxs-lookup"><span data-stu-id="afd6e-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="afd6e-151">Para convencê-lo, vá em frente e remova o atributo `MasterPageFile` da diretiva `@Page` no `Default.aspx` e visite a página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="afd6e-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="afd6e-152">Como esperado, a saída é a mesma de antes de o atributo ser removido.</span><span class="sxs-lookup"><span data-stu-id="afd6e-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="afd6e-153">Se a propriedade de `MasterPageFile` é definida por meio da diretiva de `@Page` ou programaticamente, é irrelevante para a experiência do usuário final.</span><span class="sxs-lookup"><span data-stu-id="afd6e-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="afd6e-154">No entanto, o atributo `MasterPageFile` na diretiva `@Page` é usado pelo Visual Studio durante o tempo de design para produzir a exibição WYSIWYG no designer.</span><span class="sxs-lookup"><span data-stu-id="afd6e-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="afd6e-155">Se você retornar para `Default.aspx` no Visual Studio e navegar até o designer, verá a mensagem "erro de página mestra: a página tem controles que exigem uma referência de página mestra, mas nenhum é especificado" (consulte a Figura 2).</span><span class="sxs-lookup"><span data-stu-id="afd6e-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="afd6e-156">Em suma, você precisa deixar o atributo `MasterPageFile` na diretiva `@Page` para desfrutar de uma experiência de tempo de design rica no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="afd6e-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="afd6e-157">[![o Visual Studio usa o atributo MasterPagefile da diretiva de @Page para renderizar a exibição de design](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="afd6e-158">**Figura 02**: o Visual Studio usa o atributo `MasterPageFile` da diretiva de `@Page` para renderizar o modo de exibição de design ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="afd6e-159">Etapa 3: criando uma página mestra alternativa</span><span class="sxs-lookup"><span data-stu-id="afd6e-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="afd6e-160">Como a página mestra de uma página de conteúdo pode ser definida programaticamente em tempo de execução, é possível carregar dinamicamente uma determinada página mestra com base em alguns critérios externos.</span><span class="sxs-lookup"><span data-stu-id="afd6e-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="afd6e-161">Essa funcionalidade pode ser útil em situações em que o layout do site precisa variar com base no usuário.</span><span class="sxs-lookup"><span data-stu-id="afd6e-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="afd6e-162">Por exemplo, um aplicativo Web do mecanismo de blog pode permitir que seus usuários escolham um layout para seu blog, onde cada layout é associado a uma página mestra diferente.</span><span class="sxs-lookup"><span data-stu-id="afd6e-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="afd6e-163">Em tempo de execução, quando um visitante estiver visualizando o blog de um usuário, o aplicativo Web precisará determinar o layout do blog e associar dinamicamente a página mestra correspondente à página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="afd6e-164">Vamos examinar como carregar dinamicamente uma página mestra no tempo de execução com base em alguns critérios externos.</span><span class="sxs-lookup"><span data-stu-id="afd6e-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="afd6e-165">Nosso site contém atualmente apenas uma página mestra (`Site.master`).</span><span class="sxs-lookup"><span data-stu-id="afd6e-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="afd6e-166">Precisamos de outra página mestra para ilustrar a escolha de uma página mestra em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="afd6e-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="afd6e-167">Esta etapa se concentra na criação e configuração da nova página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="afd6e-168">A etapa 4 examina a determinação da página mestra a ser usada no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="afd6e-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="afd6e-169">Crie uma nova página mestra na pasta raiz chamada `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="afd6e-170">Além disso, adicione uma nova folha de estilo ao site denominada `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="afd6e-171">[![adicionar outra página mestra e arquivo CSS ao site](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="afd6e-172">**Figura 03**: adicionar outra página mestra e arquivo CSS ao site ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="afd6e-173">Eu projetei a página mestra de `Alternate.master` para que o título seja exibido na parte superior da página, centralizada e em um plano de fundo azul.</span><span class="sxs-lookup"><span data-stu-id="afd6e-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="afd6e-174">Eu despercebii da coluna esquerda e movi esse conteúdo sob o controle `MainContent` ContentPlaceHolder, que agora abrange toda a largura da página.</span><span class="sxs-lookup"><span data-stu-id="afd6e-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="afd6e-175">Além disso, eu nixed a lista de lições não ordenadas e a substituai por uma lista horizontal acima `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="afd6e-176">Também atualizei as fontes e cores usadas pela página mestra (e, por extensão, suas páginas de conteúdo).</span><span class="sxs-lookup"><span data-stu-id="afd6e-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="afd6e-177">A Figura 4 mostra `Default.aspx` ao usar a página mestra de `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="afd6e-178">O ASP.NET inclui a capacidade de definir *temas*.</span><span class="sxs-lookup"><span data-stu-id="afd6e-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="afd6e-179">Um tema é uma coleção de imagens, arquivos CSS e configurações de propriedade de controle da Web relacionadas a estilo que podem ser aplicadas a uma página em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="afd6e-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="afd6e-180">Os temas são a melhor opção se os layouts do site diferirem apenas nas imagens exibidas e por suas regras de CSS.</span><span class="sxs-lookup"><span data-stu-id="afd6e-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="afd6e-181">Se os layouts diferem mais substancialmente, como usar diferentes controles da Web ou ter um layout radicalmente diferente, você precisará usar páginas mestras separadas.</span><span class="sxs-lookup"><span data-stu-id="afd6e-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="afd6e-182">Consulte a seção leitura adicional no final deste tutorial para obter mais informações sobre temas.</span><span class="sxs-lookup"><span data-stu-id="afd6e-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="afd6e-183">[![nossas páginas de conteúdo agora podem usar uma nova aparência](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="afd6e-184">**Figura 04**: nossas páginas de conteúdo agora podem usar uma nova aparência ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="afd6e-185">Quando a marcação mestre e as páginas de conteúdo são combinadas, a classe `MasterPage` verifica se cada controle de conteúdo na página de conteúdo faz referência a um ContentPlaceHolder na página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="afd6e-186">Uma exceção será gerada se um controle de conteúdo que faz referência a um ContentPlaceHolder não existente for encontrado.</span><span class="sxs-lookup"><span data-stu-id="afd6e-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="afd6e-187">Em outras palavras, é imperativo que a página mestra que está sendo atribuída à página de conteúdo tenha um ContentPlaceHolder para cada controle de conteúdo na página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="afd6e-188">A página mestra de `Site.master` inclui quatro controles ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="afd6e-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="afd6e-189">Algumas das páginas de conteúdo em nosso site incluem apenas um ou dois controles de conteúdo; Outras incluem um controle de conteúdo para cada um dos ContentPlaceHolders disponíveis.</span><span class="sxs-lookup"><span data-stu-id="afd6e-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="afd6e-190">Se nossa nova página mestra (`Alternate.master`) pode ser atribuída a essas páginas de conteúdo que têm controles de conteúdo para todos os ContentPlaceHolders em `Site.master`, é essencial que `Alternate.master` também inclua os mesmos controles ContentPlaceHolder que `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="afd6e-191">Para que sua página mestra de `Alternate.master` seja semelhante a minha (consulte a Figura 4), Comece definindo os estilos da página mestra na folha estilo `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="afd6e-192">Adicione as seguintes regras ao `AlternateStyles.css`:</span><span class="sxs-lookup"><span data-stu-id="afd6e-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="afd6e-193">Em seguida, adicione a seguinte marcação declarativa a `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="afd6e-194">Como você pode ver, `Alternate.master` contém quatro controles ContentPlaceHolder com os mesmos valores de `ID` que os controles ContentPlaceHolder em `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="afd6e-195">Além disso, ele inclui um controle ScriptManager, que é necessário para essas páginas em nosso site que usam a estrutura AJAX do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="afd6e-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="afd6e-196">Testando a nova página mestra</span><span class="sxs-lookup"><span data-stu-id="afd6e-196">Testing the New Master Page</span></span>

<span data-ttu-id="afd6e-197">Para testar essa nova página mestra, atualize o método `OnPreInit` da classe `BasePage` de forma que a propriedade `MasterPageFile` receba o valor `"~/Alternate.maser"` e visite o site.</span><span class="sxs-lookup"><span data-stu-id="afd6e-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="afd6e-198">Cada página deve funcionar sem erro, exceto duas: `~/Admin/AddProduct.aspx` e `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="afd6e-199">Adicionar um produto ao DetailsView no `~/Admin/AddProduct.aspx` resulta em um `NullReferenceException` da linha de código que tenta definir a propriedade `GridMessageText` da página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="afd6e-200">Ao visitar `~/Admin/Products.aspx` um `InvalidCastException` é gerado no carregamento da página com a mensagem: "não é possível converter o objeto do tipo ' ASP. Alternate\_mestre ' para o tipo ' ASP. site\_Master '."</span><span class="sxs-lookup"><span data-stu-id="afd6e-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="afd6e-201">Esses erros ocorrem porque a classe code-behind `Site.master` inclui eventos públicos, propriedades e métodos que não são definidos no `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="afd6e-202">A parte de marcação dessas duas páginas tem uma diretiva `@MasterType` que faz referência à página mestra `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="afd6e-203">Além disso, o manipulador de eventos de `ItemInserted` do DetailsView em `~/Admin/AddProduct.aspx` inclui o código que converte a propriedade de `Page.Master` de tipo flexível em um objeto de tipos `Site`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="afd6e-204">A diretiva de `@MasterType` (usada dessa forma) e a conversão no manipulador de eventos `ItemInserted` acopla rigidamente as páginas `~/Admin/AddProduct.aspx` e `~/Admin/Products.aspx` à página mestra de `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="afd6e-205">Para interromper esse acoplamento rígido, podemos ter `Site.master` e `Alternate.master` derivar de uma classe base comum que contém definições para os membros públicos.</span><span class="sxs-lookup"><span data-stu-id="afd6e-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="afd6e-206">Depois disso, podemos atualizar a diretiva `@MasterType` para fazer referência a esse tipo base comum.</span><span class="sxs-lookup"><span data-stu-id="afd6e-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="afd6e-207">Criando uma classe de página mestra de base personalizada</span><span class="sxs-lookup"><span data-stu-id="afd6e-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="afd6e-208">Adicione um novo arquivo de classe à pasta `App_Code` chamada `BaseMasterPage.vb` e faça com que ela derive de `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="afd6e-209">Precisamos definir o método `RefreshRecentProductsGrid` e a propriedade `GridMessageText` em `BaseMasterPage`, mas não podemos simplesmente movê-los para o `Site.master` porque esses membros trabalham com controles da Web que são específicos para a `Site.master` página mestra (o `RecentProducts` GridView e `GridMessage` rótulo).</span><span class="sxs-lookup"><span data-stu-id="afd6e-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="afd6e-210">O que precisamos fazer é configurar `BaseMasterPage` de forma que esses membros sejam definidos lá, mas que são realmente implementados pelas classes derivadas de `BaseMasterPage`(`Site.master` e `Alternate.master`).</span><span class="sxs-lookup"><span data-stu-id="afd6e-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="afd6e-211">Esse tipo de herança é possível marcando a classe como `MustInherit` e seus membros como `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="afd6e-212">Em suma, adicionar essas palavras-chave à classe e seus dois membros anuncia que `BaseMasterPage` não implementou `RefreshRecentProductsGrid` e `GridMessageText`, mas que suas classes derivadas irão.</span><span class="sxs-lookup"><span data-stu-id="afd6e-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="afd6e-213">Também precisamos definir o evento `PricesDoubled` em `BaseMasterPage` e fornecer um meio pelas classes derivadas para gerar o evento.</span><span class="sxs-lookup"><span data-stu-id="afd6e-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="afd6e-214">O padrão usado no .NET Framework para facilitar esse comportamento é criar um evento público na classe base e adicionar um método protegido e substituível chamado `OnEventName`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="afd6e-215">Classes derivadas podem então chamar esse método para gerar o evento ou pode substituí-lo para executar o código imediatamente antes ou depois que o evento é gerado.</span><span class="sxs-lookup"><span data-stu-id="afd6e-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="afd6e-216">Atualize sua classe de `BaseMasterPage` para que ela contenha o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="afd6e-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="afd6e-217">Em seguida, vá para a classe code-behind `Site.master` e faça com que ela derive de `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="afd6e-218">Como `BaseMasterPage` contém membros marcados `MustOverride` precisamos substituir esses membros aqui no `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="afd6e-219">Adicione a palavra-chave `Overrides` às definições de método e propriedade.</span><span class="sxs-lookup"><span data-stu-id="afd6e-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="afd6e-220">Além disso, atualize o código que gera o evento `PricesDoubled` no manipulador de eventos `Click` do botão `DoublePrice` com uma chamada para o método `OnPricesDoubled` da classe base.</span><span class="sxs-lookup"><span data-stu-id="afd6e-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="afd6e-221">Depois dessas modificações, a classe code-behind `Site.master` deve conter o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="afd6e-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="afd6e-222">Também precisamos atualizar a classe code-behind de `Alternate.master`para derivar de `BaseMasterPage` e substituir os dois membros `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="afd6e-223">Mas como `Alternate.master` não contém um GridView que lista os produtos mais recentes nem um rótulo que exibe uma mensagem depois que um novo produto é adicionado ao banco de dados, esses métodos não precisam fazer nada.</span><span class="sxs-lookup"><span data-stu-id="afd6e-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="afd6e-224">Referenciando a classe de página mestra de base</span><span class="sxs-lookup"><span data-stu-id="afd6e-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="afd6e-225">Agora que concluímos a classe `BaseMasterPage` e temos duas páginas mestras que a estendem, nossa etapa final é atualizar as páginas `~/Admin/AddProduct.aspx` e `~/Admin/Products.aspx` para fazer referência a esse tipo comum.</span><span class="sxs-lookup"><span data-stu-id="afd6e-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="afd6e-226">Comece alterando a diretiva `@MasterType` em ambas as páginas de:</span><span class="sxs-lookup"><span data-stu-id="afd6e-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="afd6e-227">Para:</span><span class="sxs-lookup"><span data-stu-id="afd6e-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="afd6e-228">Em vez de referenciar um caminho de arquivo, a propriedade `@MasterType` agora faz referência ao tipo base (`BaseMasterPage`).</span><span class="sxs-lookup"><span data-stu-id="afd6e-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="afd6e-229">Consequentemente, a propriedade de `Master` fortemente tipada usada em classes code-behind de páginas agora é do tipo `BaseMasterPage` (em vez do tipo `Site`).</span><span class="sxs-lookup"><span data-stu-id="afd6e-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="afd6e-230">Com essa alteração em vigor, reveja `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="afd6e-231">Anteriormente, isso resultou em um erro de conversão porque a página está configurada para usar a página mestra de `Alternate.master`, mas a diretiva `@MasterType` referenciou o arquivo `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="afd6e-232">Mas agora a página é renderizada sem erro.</span><span class="sxs-lookup"><span data-stu-id="afd6e-232">But now the page renders without error.</span></span> <span data-ttu-id="afd6e-233">Isso ocorre porque a página mestra de `Alternate.master` pode ser convertida em um objeto do tipo `BaseMasterPage` (já que ela a estende).</span><span class="sxs-lookup"><span data-stu-id="afd6e-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="afd6e-234">Há uma pequena alteração que precisa ser feita em `~/Admin/AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="afd6e-235">O manipulador de eventos de `ItemInserted` do controle DetailsView usa a propriedade `Master` fortemente tipada e a propriedade `Page.Master` com rigidez de tipos.</span><span class="sxs-lookup"><span data-stu-id="afd6e-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="afd6e-236">Corrigimos a referência fortemente tipada quando atualizamos a diretiva `@MasterType`, mas ainda precisamos atualizar a referência com rigidez de tipos.</span><span class="sxs-lookup"><span data-stu-id="afd6e-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="afd6e-237">Substitua a seguinte linha de código:</span><span class="sxs-lookup"><span data-stu-id="afd6e-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="afd6e-238">Com o seguinte, que converte `Page.Master` para o tipo base:</span><span class="sxs-lookup"><span data-stu-id="afd6e-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="afd6e-239">Etapa 4: determinando qual página mestra associar às páginas de conteúdo</span><span class="sxs-lookup"><span data-stu-id="afd6e-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="afd6e-240">Nossa classe de `BasePage` atualmente define todas as propriedades de `MasterPageFile` de páginas de conteúdo para um valor embutido no estágio PreInit do ciclo de vida da página.</span><span class="sxs-lookup"><span data-stu-id="afd6e-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="afd6e-241">Podemos atualizar esse código para basear a página mestra em algum fator externo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="afd6e-242">Talvez a página mestra a ser carregada dependa das preferências do usuário conectado no momento.</span><span class="sxs-lookup"><span data-stu-id="afd6e-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="afd6e-243">Nesse caso, seria necessário escrever código no método `OnPreInit` no `BasePage` que pesquisa as preferências da página mestra do usuário que está visitando no momento.</span><span class="sxs-lookup"><span data-stu-id="afd6e-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="afd6e-244">Vamos criar uma página da Web que permita ao usuário escolher qual página mestra usar-`Site.master` ou `Alternate.master`-e salvar essa opção em uma variável de sessão.</span><span class="sxs-lookup"><span data-stu-id="afd6e-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="afd6e-245">Comece criando uma nova página da Web no diretório raiz chamado `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="afd6e-246">Ao criar esta página (ou quaisquer outras páginas de conteúdo daqui em diante), você não precisa associá-la a uma página mestra porque a página mestra está definida programaticamente no `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="afd6e-247">No entanto, se você não associar a nova página a uma página mestra, a marcação declarativa padrão da nova página conterá um formulário da Web e outro conteúdo fornecido pela página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="afd6e-248">Você precisará substituir manualmente essa marcação pelos controles de conteúdo apropriados.</span><span class="sxs-lookup"><span data-stu-id="afd6e-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="afd6e-249">Por esse motivo, acho mais fácil associar a nova página ASP.NET a uma página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="afd6e-250">Como `Site.master` e `Alternate.master` têm o mesmo conjunto de controles ContentPlaceHolder, não importa qual página mestra você escolhe ao criar a página novo conteúdo.</span><span class="sxs-lookup"><span data-stu-id="afd6e-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="afd6e-251">Para fins de consistência, sugiro o uso de `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="afd6e-252">[![adicionar uma nova página de conteúdo ao site](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="afd6e-253">**Figura 05**: adicionar uma nova página de conteúdo ao site ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="afd6e-254">Atualize o arquivo de `Web.sitemap` para incluir uma entrada para esta lição.</span><span class="sxs-lookup"><span data-stu-id="afd6e-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="afd6e-255">Adicione a seguinte marcação abaixo do `<siteMapNode>` para as páginas mestras e a lição do ASP.NET AJAX:</span><span class="sxs-lookup"><span data-stu-id="afd6e-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="afd6e-256">Antes de adicionar qualquer conteúdo à página de `ChooseMasterPage.aspx` Reserve um tempo para atualizar a classe code-behind da página para que ela seja derivada de `BasePage` (em vez de `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="afd6e-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="afd6e-257">Em seguida, adicione um controle DropDownList à página, defina sua propriedade `ID` como `MasterPageChoice`e adicione duas ListItems com os valores de `Text` de "~/site.Master" e "~/Alternate.Master".</span><span class="sxs-lookup"><span data-stu-id="afd6e-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="afd6e-258">Adicione um controle Web de botão à página e defina suas propriedades `ID` e `Text` como `SaveLayout` e "salvar layout Choice", respectivamente.</span><span class="sxs-lookup"><span data-stu-id="afd6e-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="afd6e-259">Neste ponto, a marcação declarativa de sua página deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="afd6e-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="afd6e-260">Quando a página é visitada pela primeira vez, precisamos exibir a opção de página mestra selecionada no momento do usuário.</span><span class="sxs-lookup"><span data-stu-id="afd6e-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="afd6e-261">Crie um manipulador de eventos `Page_Load` e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="afd6e-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="afd6e-262">O código acima é executado somente na primeira página de visita (e não em postbacks subsequentes).</span><span class="sxs-lookup"><span data-stu-id="afd6e-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="afd6e-263">Ele verifica primeiro se a variável de sessão `MyMasterPage` existe.</span><span class="sxs-lookup"><span data-stu-id="afd6e-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="afd6e-264">Se tiver, ele tentará localizar o ListItem correspondente no `MasterPageChoice` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="afd6e-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="afd6e-265">Se um ListItem correspondente for encontrado, sua propriedade `Selected` será definida como `True`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="afd6e-266">Também precisamos de um código que salve a opção do usuário na variável de sessão `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="afd6e-267">Crie um manipulador de eventos para o evento de `Click` do botão de `SaveLayout` e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="afd6e-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="afd6e-268">No momento em que o manipulador de eventos de `Click` é executado no postback, a página mestra já foi selecionada.</span><span class="sxs-lookup"><span data-stu-id="afd6e-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="afd6e-269">Portanto, a seleção de lista suspensa do usuário não estará em vigor até que a próxima página seja visitada.</span><span class="sxs-lookup"><span data-stu-id="afd6e-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="afd6e-270">O `Response.Redirect` força o navegador a solicitar novamente `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="afd6e-271">Com a página de `ChooseMasterPage.aspx` concluída, nossa tarefa final é ter `BasePage` atribuir a propriedade `MasterPageFile` com base no valor da variável de sessão `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="afd6e-272">Se a variável de sessão não estiver definida, `BasePage` padrão será `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="afd6e-273">Movi o código que atribui a propriedade `MasterPageFile` do objeto de `Page` do manipulador de eventos `OnPreInit` e em dois métodos separados.</span><span class="sxs-lookup"><span data-stu-id="afd6e-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="afd6e-274">Esse primeiro método, `SetMasterPageFile`, atribui a propriedade `MasterPageFile` ao valor retornado pelo segundo método, `GetMasterPageFileFromSession`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="afd6e-275">Eu marcoui o método `SetMasterPageFile` `Overridable` para que as classes futuras que estendem `BasePage` possam opcionalmente substituí-lo para implementar a lógica personalizada, se necessário.</span><span class="sxs-lookup"><span data-stu-id="afd6e-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="afd6e-276">Veremos um exemplo de substituição da propriedade `SetMasterPageFile` do `BasePage`no próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="afd6e-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="afd6e-277">Com esse código em vigor, visite a página `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="afd6e-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="afd6e-278">Inicialmente, a página mestra de `Site.master` é selecionada (veja a Figura 6), mas o usuário pode escolher uma página mestra diferente na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="afd6e-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="afd6e-279">[![páginas de conteúdo são exibidas usando a página mestra site. Master](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="afd6e-280">**Figura 06**: as páginas de conteúdo são exibidas usando o `Site.master` página mestra ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="afd6e-281">[![páginas de conteúdo são exibidas agora usando a página mestra. Master mestre](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="afd6e-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="afd6e-282">**Figura 07**: as páginas de conteúdo agora são exibidas usando a página mestra de `Alternate.master` ([clique para exibir a imagem em tamanho normal](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="afd6e-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="afd6e-283">Resumo</span><span class="sxs-lookup"><span data-stu-id="afd6e-283">Summary</span></span>

<span data-ttu-id="afd6e-284">Quando uma página de conteúdo é visitada, seus controles de conteúdo são fundidos com os controles ContentPlaceHolder da página mestra.</span><span class="sxs-lookup"><span data-stu-id="afd6e-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="afd6e-285">A página mestra da página de conteúdo é indicada pela propriedade `MasterPageFile` da classe `Page`, que é atribuída ao atributo `MasterPageFile` da diretiva de `@Page` durante o estágio de inicialização.</span><span class="sxs-lookup"><span data-stu-id="afd6e-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="afd6e-286">Como mostra este tutorial, podemos atribuir um valor à propriedade `MasterPageFile`, desde que possamos fazer isso antes do final do estágio PreInit.</span><span class="sxs-lookup"><span data-stu-id="afd6e-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="afd6e-287">Ser capaz de especificar programaticamente a página mestra abre a porta para cenários mais avançados, como associar dinamicamente uma página de conteúdo a uma página mestra com base em fatores externos.</span><span class="sxs-lookup"><span data-stu-id="afd6e-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="afd6e-288">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="afd6e-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="afd6e-289">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="afd6e-289">Further Reading</span></span>

<span data-ttu-id="afd6e-290">Para obter mais informações sobre os tópicos discutidos neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="afd6e-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="afd6e-291">Diagrama de ciclo de vida da página ASP.NET</span><span class="sxs-lookup"><span data-stu-id="afd6e-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="afd6e-292">Visão geral do ciclo de vida da página ASP.NET</span><span class="sxs-lookup"><span data-stu-id="afd6e-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="afd6e-293">Visão geral de temas e capas do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="afd6e-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="afd6e-294">Páginas mestras: dicas, truques e armadilhas</span><span class="sxs-lookup"><span data-stu-id="afd6e-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="afd6e-295">Temas no ASP.NET</span><span class="sxs-lookup"><span data-stu-id="afd6e-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="afd6e-296">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="afd6e-296">About the Author</span></span>

<span data-ttu-id="afd6e-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de vários livros sobre ASP/ASP. net e fundador da 4GuysFromRolla.com, tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="afd6e-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="afd6e-298">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="afd6e-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="afd6e-299">Seu livro mais recente é que a [*Sams ensina a ASP.NET 3,5 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="afd6e-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="afd6e-300">Scott pode ser contatado em [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog em [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="afd6e-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="afd6e-301">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="afd6e-301">Special Thanks To</span></span>

<span data-ttu-id="afd6e-302">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="afd6e-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="afd6e-303">O revisor de Lead para este tutorial foi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="afd6e-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="afd6e-304">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="afd6e-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="afd6e-305">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="afd6e-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="afd6e-306">[Anterior](master-pages-and-asp-net-ajax-vb.md)
> [Próximo](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="afd6e-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
