---
uid: web-forms/overview/older-versions-security/membership/creating-user-accounts-vb
title: Criando contas de usuário (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, exploraremos o uso da estrutura de associação (por meio do SqlMembershipProvider) para criar novas contas de usuário. Veremos como criar novos nós...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 9ef3e893-bebe-4b13-9fe5-8b71720dd85e
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-user-accounts-vb
msc.type: authoredcontent
ms.openlocfilehash: 01be198c329f372ddcd529ad8a369f2d3426a9fc
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74628082"
---
# <a name="creating-user-accounts-vb"></a><span data-ttu-id="ecd98-104">Criação de contas de usuário (VB)</span><span class="sxs-lookup"><span data-stu-id="ecd98-104">Creating User Accounts (VB)</span></span>

<span data-ttu-id="ecd98-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ecd98-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ecd98-106">[Baixar código](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_VB.zip) ou [baixar PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="ecd98-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_vb.pdf)</span></span>

> <span data-ttu-id="ecd98-107">Neste tutorial, exploraremos o uso da estrutura de associação (por meio do SqlMembershipProvider) para criar novas contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-107">In this tutorial we will explore using the Membership framework (via the SqlMembershipProvider) to create new user accounts.</span></span> <span data-ttu-id="ecd98-108">Veremos como criar novos usuários programaticamente e por meio do ASP. Controle CreateUserWizard interno da rede.</span><span class="sxs-lookup"><span data-stu-id="ecd98-108">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

## <a name="introduction"></a><span data-ttu-id="ecd98-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="ecd98-109">Introduction</span></span>

<span data-ttu-id="ecd98-110"><a id="_msoanchor_1"> </a>No [tutorial anterior](creating-the-membership-schema-in-sql-server-vb.md) , instalamos o esquema de serviços de aplicativos em um banco de dados, que adicionou as tabelas, exibições e procedimentos armazenados necessários para o `SqlMembershipProvider` e `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-110">In the <a id="_msoanchor_1"></a>[preceding tutorial](creating-the-membership-schema-in-sql-server-vb.md) we installed the application services schema in a database, which added the tables, views, and stored procedures needed by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span> <span data-ttu-id="ecd98-111">Isso criou a infraestrutura que precisaremos para o restante dos tutoriais desta série.</span><span class="sxs-lookup"><span data-stu-id="ecd98-111">This created the infrastructure we will need for the remainder of the tutorials in this series.</span></span> <span data-ttu-id="ecd98-112">Neste tutorial, exploraremos o uso da estrutura de associação (por meio do `SqlMembershipProvider`) para criar novas contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-112">In this tutorial we will explore using the Membership framework (via the `SqlMembershipProvider`) to create new user accounts.</span></span> <span data-ttu-id="ecd98-113">Veremos como criar novos usuários programaticamente e por meio do ASP. Controle CreateUserWizard interno da rede.</span><span class="sxs-lookup"><span data-stu-id="ecd98-113">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

<span data-ttu-id="ecd98-114">Além de aprender como criar novas contas de usuário, também precisaremos atualizar o site de demonstração que criamos primeiro na *<a id="_msoanchor_2"></a>[visão geral do tutorial de autenticação de formulários](../introduction/an-overview-of-forms-authentication-vb.md)* e, em seguida, aprimorado no tutorial *<a id="_msoanchor_3"></a>[configuração de autenticação de formulários e tópicos avançados](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="ecd98-114">In addition to learning how to create new user accounts, we will also need to update the demo website we first created in the *<a id="_msoanchor_2"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)* tutorial and then enhanced in the *<a id="_msoanchor_3"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* tutorial.</span></span> <span data-ttu-id="ecd98-115">Nosso aplicativo Web de demonstração tem uma página de logon que valida as credenciais dos usuários em relação a pares de nome de usuário/senha embutidos em código.</span><span class="sxs-lookup"><span data-stu-id="ecd98-115">Our demo web application has a login page that validates users' credentials against hard-coded username/password pairs.</span></span> <span data-ttu-id="ecd98-116">Além disso, `Global.asax` inclui um código que cria `IPrincipal` personalizados e objetos de `IIdentity` para usuários autenticados.</span><span class="sxs-lookup"><span data-stu-id="ecd98-116">Moreover, `Global.asax` includes code that creates custom `IPrincipal` and `IIdentity` objects for authenticated users.</span></span> <span data-ttu-id="ecd98-117">Atualizaremos a página de logon para validar as credenciais dos usuários em relação à estrutura de associação e remover a lógica de identidade e entidade personalizada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-117">We will update the login page to validate users' credentials against the Membership framework and remove the custom principal and identity logic.</span></span>

<span data-ttu-id="ecd98-118">Vamos começar!</span><span class="sxs-lookup"><span data-stu-id="ecd98-118">Let's get started!</span></span>

## <a name="the-forms-authentication-and-membership-checklist"></a><span data-ttu-id="ecd98-119">A lista de verificação de autenticação e Associação de formulários</span><span class="sxs-lookup"><span data-stu-id="ecd98-119">The Forms Authentication and Membership Checklist</span></span>

<span data-ttu-id="ecd98-120">Antes de começarmos a trabalhar com a estrutura de associação, vamos examinar as etapas importantes que levamos para chegar a esse ponto.</span><span class="sxs-lookup"><span data-stu-id="ecd98-120">Before we begin working with the Membership framework, let's take a moment to review the important steps we have taken to reach this point.</span></span> <span data-ttu-id="ecd98-121">Ao usar a estrutura de associação com o `SqlMembershipProvider` em um cenário de autenticação baseada em formulários, as etapas a seguir precisam ser executadas antes de implementar a funcionalidade de associação em seu aplicativo Web:</span><span class="sxs-lookup"><span data-stu-id="ecd98-121">When using the Membership framework with the `SqlMembershipProvider` in a forms-based authentication scenario, the following steps need to be performed prior to implementing Membership functionality in your web application:</span></span>

1. <span data-ttu-id="ecd98-122">**Habilite a autenticação baseada em formulários.**</span><span class="sxs-lookup"><span data-stu-id="ecd98-122">**Enable forms-based authentication.**</span></span> <span data-ttu-id="ecd98-123">Como discutimos em *<a id="_msoanchor_4"></a>[uma visão geral da autenticação de formulários](../introduction/an-overview-of-forms-authentication-vb.md)* , a autenticação de formulários é habilitada editando `Web.config` e definindo o atributo `<authentication>` do elemento `mode` como `Forms`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-123">As we discussed in *<a id="_msoanchor_4"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)*, forms authentication is enabled by editing `Web.config` and setting the `<authentication>` element's `mode` attribute to `Forms`.</span></span> <span data-ttu-id="ecd98-124">Com a autenticação de formulários habilitada, cada solicitação de entrada é examinada para um *tíquete de autenticação de formulários*, que, se presente, identifica o solicitante.</span><span class="sxs-lookup"><span data-stu-id="ecd98-124">With forms authentication enabled, each incoming request is examined for a *forms authentication ticket*, which, if present, identifies the requestor.</span></span>
2. <span data-ttu-id="ecd98-125">**Adicione o esquema de serviços de aplicativos ao banco de dados apropriado.**</span><span class="sxs-lookup"><span data-stu-id="ecd98-125">**Add the application services schema to the appropriate database.**</span></span> <span data-ttu-id="ecd98-126">Ao usar o `SqlMembershipProvider` precisamos instalar o esquema de serviços de aplicativo em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ecd98-126">When using the `SqlMembershipProvider` we need to install the application services schema to a database.</span></span> <span data-ttu-id="ecd98-127">Normalmente, esse esquema é adicionado ao mesmo banco de dados que contém o modelo de dado do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ecd98-127">Usually this schema is added to the same database that holds the application's data model.</span></span> <span data-ttu-id="ecd98-128">O *<a id="_msoanchor_5"></a>[tutorial Criando o esquema de associação no SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* examinou o uso da ferramenta `aspnet_regsql.exe` para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="ecd98-128">The *<a id="_msoanchor_5"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial looked at using the `aspnet_regsql.exe` tool to accomplish this.</span></span>
3. <span data-ttu-id="ecd98-129">**Personalize as configurações do aplicativo Web para fazer referência ao banco de dados da etapa 2.**</span><span class="sxs-lookup"><span data-stu-id="ecd98-129">**Customize the Web Application's Settings to reference the database from step 2.**</span></span> <span data-ttu-id="ecd98-130">O tutorial *criando o esquema de associação no SQL Server* mostrou duas maneiras de configurar o aplicativo Web para que o `SqlMembershipProvider` use o banco de dados selecionado na etapa 2: modificando o nome da cadeia de conexão `LocalSqlServer`; ou adicionando um novo provedor registrado à lista de provedores de estrutura de associação e personalizando esse novo provedor para usar o banco de dados da etapa 2.</span><span class="sxs-lookup"><span data-stu-id="ecd98-130">The *Creating the Membership Schema in SQL Server* tutorial showed two ways to configure the web application so that the `SqlMembershipProvider` would use the database selected in step 2: by modifying the `LocalSqlServer` connection string name; or by adding a new registered provider to the list of Membership framework providers and customizing that new provider to use the database from step 2.</span></span>

<span data-ttu-id="ecd98-131">Ao criar um aplicativo Web que usa a `SqlMembershipProvider` e a autenticação baseada em formulários, você precisará executar essas três etapas antes de usar a classe `Membership` ou os controles da Web de logon ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ecd98-131">When building a web application that uses the `SqlMembershipProvider` and forms-based authentication, you will need to perform these three steps before using the `Membership` class or the ASP.NET Login Web controls.</span></span> <span data-ttu-id="ecd98-132">Como já realizamos essas etapas nos tutoriais anteriores, estamos prontos para começar a usar a estrutura de associação!</span><span class="sxs-lookup"><span data-stu-id="ecd98-132">Since we already performed these steps in previous tutorials, we are ready to start using the Membership framework!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="ecd98-133">Etapa 1: Adicionando novas páginas ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ecd98-133">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="ecd98-134">Neste tutorial e nos próximos três, examinaremos várias funções e recursos relacionados à associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-134">In this tutorial and the next three we will be examining various Membership-related functions and capabilities.</span></span> <span data-ttu-id="ecd98-135">Precisaremos de uma série de páginas do ASP.NET para implementar os tópicos examinados em todos esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="ecd98-135">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="ecd98-136">Vamos criar essas páginas e, em seguida, um arquivo de mapa do site `(Web.sitemap)`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-136">Let's create those pages and then a site map file `(Web.sitemap)`.</span></span>

<span data-ttu-id="ecd98-137">Comece criando uma nova pasta no projeto chamada `Membership`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-137">Start by creating a new folder in the project named `Membership`.</span></span> <span data-ttu-id="ecd98-138">Em seguida, adicione cinco novas páginas ASP.NET à pasta `Membership`, vinculando cada página com a `Site.master` página mestra.</span><span class="sxs-lookup"><span data-stu-id="ecd98-138">Next, add five new ASP.NET pages to the `Membership` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="ecd98-139">Nomeie as páginas:</span><span class="sxs-lookup"><span data-stu-id="ecd98-139">Name the pages:</span></span>

- `CreatingUserAccounts.aspx`
- `UserBasedAuthorization.aspx`
- `EnhancedCreateUserWizard.aspx`
- `AdditionalUserInfo.aspx`
- `Guestbook.aspx`

<span data-ttu-id="ecd98-140">Neste ponto, o Gerenciador de Soluções do seu projeto deve ser semelhante à captura de tela mostrada na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="ecd98-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="ecd98-141">[![cinco novas páginas foram adicionadas à pasta de associação](creating-user-accounts-vb/_static/image2.png)](creating-user-accounts-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-141">[![Five New Pages Have Been Added to the Membership Folder](creating-user-accounts-vb/_static/image2.png)](creating-user-accounts-vb/_static/image1.png)</span></span>

<span data-ttu-id="ecd98-142">**Figura 1**: Cinco novas páginas foram adicionadas à pasta `Membership` ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-142">**Figure 1**: Five New Pages Have Been Added to the `Membership` Folder ([Click to view full-size image](creating-user-accounts-vb/_static/image3.png))</span></span>

<span data-ttu-id="ecd98-143">Cada página deve, neste ponto, ter os dois controles de conteúdo, um para cada um dos ContentPlaceHolders da página mestra: `MainContent` e `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-143">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample1.aspx)]

<span data-ttu-id="ecd98-144">Lembre-se de que a marcação padrão do `LoginContent` ContentPlaceHolder exibe um link para fazer logon ou logoff do site, dependendo se o usuário está autenticado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-144">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="ecd98-145">No entanto, a presença do controle de conteúdo de `Content2` substitui a marcação padrão da página mestra.</span><span class="sxs-lookup"><span data-stu-id="ecd98-145">The presence of the `Content2` Content control, however, overrides the master page's default markup.</span></span> <span data-ttu-id="ecd98-146">Como discutimos em *<a id="_msoanchor_6"></a>[uma visão geral do tutorial de autenticação de formulários](../introduction/an-overview-of-forms-authentication-vb.md)* , isso é útil em páginas em que não queremos exibir opções relacionadas ao logon na coluna à esquerda.</span><span class="sxs-lookup"><span data-stu-id="ecd98-146">As we discussed in *<a id="_msoanchor_6"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)* tutorial, this is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="ecd98-147">Para essas cinco páginas, no entanto, queremos mostrar a marcação padrão da página mestra para o `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="ecd98-147">For these five pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="ecd98-148">Portanto, remova a marcação declarativa para o controle de conteúdo `Content2`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-148">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="ecd98-149">Depois de fazer isso, cada uma das cinco marcas da página deve conter apenas um controle de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="ecd98-149">After doing so, each of the five page's markup should contain just one Content control.</span></span>

## <a name="step-2-creating-the-site-map"></a><span data-ttu-id="ecd98-150">Etapa 2: Criando o mapa do site</span><span class="sxs-lookup"><span data-stu-id="ecd98-150">Step 2: Creating the Site Map</span></span>

<span data-ttu-id="ecd98-151">Todos, exceto os sites mais triviais, precisam implementar alguma forma de uma interface de usuário de navegação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-151">All but the most trivial websites need to implement some form of a navigational user interface.</span></span> <span data-ttu-id="ecd98-152">A interface do usuário de navegação pode ser uma lista simples de links para as várias seções do site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-152">The navigation user interface may be a simple list of links to the various sections of the site.</span></span> <span data-ttu-id="ecd98-153">Como alternativa, esses links podem ser organizados em menus ou exibições de árvore.</span><span class="sxs-lookup"><span data-stu-id="ecd98-153">Alternatively, these links may be arranged into menus or tree views.</span></span> <span data-ttu-id="ecd98-154">Como os desenvolvedores de páginas, a criação da interface do usuário de navegação é apenas metade da história.</span><span class="sxs-lookup"><span data-stu-id="ecd98-154">As page developers, creating the navigational user interface is only half of the story.</span></span> <span data-ttu-id="ecd98-155">Também precisamos de alguns meios para definir a estrutura lógica do site de maneira passível de manutenção e atualizável.</span><span class="sxs-lookup"><span data-stu-id="ecd98-155">We also need some means to define the site's logical structure in a maintainable and updateable fashion.</span></span> <span data-ttu-id="ecd98-156">À medida que novas páginas são adicionadas ou as páginas existentes são removidas, queremos poder atualizar uma única fonte – o mapa do site-e fazer com que essas modificações sejam refletidas na interface do usuário de navegação do site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-156">As new pages are added or existing pages removed, we want to be able to update a single source - the site map - and have those modifications reflected across the site's navigational user interface.</span></span>

<span data-ttu-id="ecd98-157">Essas duas tarefas – definir o mapa do site e implementar uma interface do usuário de navegação baseada no mapa do site – são fáceis de realizar graças à estrutura do mapa do site e aos controles da Web de navegação adicionados no ASP.NET versão 2,0.</span><span class="sxs-lookup"><span data-stu-id="ecd98-157">These two tasks - defining the site map and implementing a navigational user interface based on the site map - are easy to accomplish thanks to the Site Map framework and the Navigation Web controls added in ASP.NET version 2.0.</span></span> <span data-ttu-id="ecd98-158">A estrutura do mapa do site permite que um desenvolvedor defina um mapa do site e, em seguida, acesse-o por meio de uma API programática (a [classe`SiteMap`](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span><span class="sxs-lookup"><span data-stu-id="ecd98-158">The Site Map framework allows for a developer to define a site map and then to access it through a programmatic API (the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span></span> <span data-ttu-id="ecd98-159">Os controles da Web de navegação internos incluem um [controle de menu](https://msdn.microsoft.com/library/bz09dy46.aspx), o [controle TreeView](https://msdn.microsoft.com/library/3eafky27.aspx)e o [controle SiteMapPath](https://msdn.microsoft.com/library/3eafky27.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-159">The built-in Navigation Web controls include a [Menu control](https://msdn.microsoft.com/library/bz09dy46.aspx), the [TreeView control](https://msdn.microsoft.com/library/3eafky27.aspx), and the [SiteMapPath control](https://msdn.microsoft.com/library/3eafky27.aspx).</span></span>

<span data-ttu-id="ecd98-160">Assim como as estruturas de associação e de funções, a estrutura do mapa do site é criada sobre o [modelo do provedor](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-160">Like the Membership and Roles frameworks, the Site Map framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span></span> <span data-ttu-id="ecd98-161">O trabalho da classe do provedor do mapa do site é gerar a estrutura na memória usada pela classe `SiteMap` de um armazenamento de dados persistente, como um arquivo XML ou uma tabela de banco de dado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-161">The job of the Site Map provider class is to generate the in-memory structure used by the `SiteMap` class from a persistent data store, such as an XML file or a database table.</span></span> <span data-ttu-id="ecd98-162">O .NET Framework é fornecido com um provedor de mapa do site padrão que lê os dados do mapa do site de um arquivo XML ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), e esse é o provedor que usaremos neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="ecd98-162">The .NET Framework ships with a default Site Map provider that reads the site map data from an XML file ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), and this is the provider we will be using in this tutorial.</span></span> <span data-ttu-id="ecd98-163">Para algumas implementações alternativas do provedor do mapa do site, consulte a seção leituras adicionais no final deste tutorial.</span><span class="sxs-lookup"><span data-stu-id="ecd98-163">For some alternate Site Map provider implementations, refer to the Further Readings section at the end of this tutorial.</span></span>

<span data-ttu-id="ecd98-164">O provedor de mapa do site padrão espera um arquivo XML formatado corretamente chamado `Web.sitemap` para existir no diretório raiz.</span><span class="sxs-lookup"><span data-stu-id="ecd98-164">The default Site Map provider expects a properly-formatted XML file named `Web.sitemap` to exist the root directory.</span></span> <span data-ttu-id="ecd98-165">Como estamos usando esse provedor padrão, precisamos adicionar esse arquivo e definir a estrutura do mapa do site no formato XML apropriado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-165">Since we are using this default provider, we need to add such a file and define the site map's structure in the appropriate XML format.</span></span> <span data-ttu-id="ecd98-166">Para adicionar o arquivo, clique com o botão direito do mouse no nome do projeto em Gerenciador de Soluções e escolha Adicionar novo item.</span><span class="sxs-lookup"><span data-stu-id="ecd98-166">To add the file, right-click on the project name in Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="ecd98-167">Na caixa de diálogo, opte por adicionar um arquivo do tipo site map chamado `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-167">From the dialog box, opt to add a file of type Site Map named `Web.sitemap`.</span></span>

<span data-ttu-id="ecd98-168">[![adicionar um arquivo chamado Web. sitemap ao diretório raiz do projeto](creating-user-accounts-vb/_static/image5.png)](creating-user-accounts-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-168">[![Add a File Named Web.sitemap to the Project's Root Directory](creating-user-accounts-vb/_static/image5.png)](creating-user-accounts-vb/_static/image4.png)</span></span>

<span data-ttu-id="ecd98-169">**Figura 2**: Adicione um arquivo chamado `Web.sitemap` ao diretório raiz do projeto ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-169">**Figure 2**: Add a File Named `Web.sitemap` to the Project's Root Directory ([Click to view full-size image](creating-user-accounts-vb/_static/image6.png))</span></span>

<span data-ttu-id="ecd98-170">O arquivo do mapa do site XML define a estrutura do site como uma hierarquia.</span><span class="sxs-lookup"><span data-stu-id="ecd98-170">The XML site map file defines the website's structure as a hierarchy.</span></span> <span data-ttu-id="ecd98-171">Essa relação hierárquica é modelada no arquivo XML por meio do ancestrais dos elementos de `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-171">This hierarchical relationship is modeled in the XML file via the ancestry of the `<siteMapNode>` elements.</span></span> <span data-ttu-id="ecd98-172">O `Web.sitemap` deve começar com um nó pai de `<siteMap>` que tenha exatamente um `<siteMapNode>` filho.</span><span class="sxs-lookup"><span data-stu-id="ecd98-172">The `Web.sitemap` must start with a `<siteMap>` parent node that has precisely one `<siteMapNode>` child.</span></span> <span data-ttu-id="ecd98-173">Esse elemento de `<siteMapNode>` de nível superior representa a raiz da hierarquia e pode ter um número arbitrário de nós descendentes.</span><span class="sxs-lookup"><span data-stu-id="ecd98-173">This top-level `<siteMapNode>` element represents the root of the hierarchy, and may have an arbitrary number of descendent nodes.</span></span> <span data-ttu-id="ecd98-174">Cada elemento de `<siteMapNode>` deve incluir um atributo `title` e pode, opcionalmente, incluir `url` e `description` atributos, entre outros; cada atributo de `url` não vazio deve ser exclusivo.</span><span class="sxs-lookup"><span data-stu-id="ecd98-174">Each `<siteMapNode>` element must include a `title` attribute and may optionally include `url` and `description` attributes, among others; each non-empty `url` attribute must be unique.</span></span>

<span data-ttu-id="ecd98-175">Insira o seguinte XML no arquivo de `Web.sitemap`:</span><span class="sxs-lookup"><span data-stu-id="ecd98-175">Enter the following XML into the `Web.sitemap` file:</span></span>

[!code-xml[Main](creating-user-accounts-vb/samples/sample2.xml)]

<span data-ttu-id="ecd98-176">A marcação do mapa do site acima define a hierarquia mostrada na Figura 3.</span><span class="sxs-lookup"><span data-stu-id="ecd98-176">The above site map markup defines the hierarchy shown in Figure 3.</span></span>

<span data-ttu-id="ecd98-177">[![o mapa do site representa uma estrutura de navegação hierárquica](creating-user-accounts-vb/_static/image8.png)](creating-user-accounts-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-177">[![The Site Map Represents a Hierarchical Navigational Structure](creating-user-accounts-vb/_static/image8.png)](creating-user-accounts-vb/_static/image7.png)</span></span>

<span data-ttu-id="ecd98-178">**Figura 3**: O mapa do site representa uma estrutura de navegação hierárquica ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-178">**Figure 3**: The Site Map Represents a Hierarchical Navigational Structure ([Click to view full-size image](creating-user-accounts-vb/_static/image9.png))</span></span>

## <a name="step-3-updating-the-master-page-to-include-a-navigational-user-interface"></a><span data-ttu-id="ecd98-179">Etapa 3: Atualizando a página mestra para incluir uma interface do usuário de navegação</span><span class="sxs-lookup"><span data-stu-id="ecd98-179">Step 3: Updating the Master Page to Include a Navigational User Interface</span></span>

<span data-ttu-id="ecd98-180">O ASP.NET inclui vários controles da Web relacionados à navegação para a criação de uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-180">ASP.NET includes a number of navigation-related Web controls for designing a user interface.</span></span> <span data-ttu-id="ecd98-181">Isso inclui os controles menu, TreeView e SiteMapPath.</span><span class="sxs-lookup"><span data-stu-id="ecd98-181">These include the Menu, TreeView, and the SiteMapPath controls.</span></span> <span data-ttu-id="ecd98-182">O menu e os controles TreeView renderizam a estrutura do mapa do site em um menu ou em uma árvore, respectivamente, enquanto o SiteMapPath exibe um breadcrumb que mostra o nó atual que está sendo visitado, bem como seus ancestrais.</span><span class="sxs-lookup"><span data-stu-id="ecd98-182">The Menu and TreeView controls render the site map structure in a menu or a tree, respectively, whereas the SiteMapPath displays a breadcrumb that shows the current node being visited as well as its ancestors.</span></span> <span data-ttu-id="ecd98-183">Os dados do mapa do site podem ser associados a outros controles da Web de dados usando SiteMapDataSource e podem ser acessados programaticamente por meio da classe `SiteMap`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-183">The site map data can be bound to other data Web controls using the SiteMapDataSource and can be accessed programmatically via the `SiteMap` class.</span></span>

<span data-ttu-id="ecd98-184">Como uma discussão completa sobre a estrutura do mapa do site e os controles de navegação está além do escopo desta série de tutoriais, em vez de gastar tempo criando nossa própria interface do usuário de navegação, vamos, em vez disso, usar um controle Repeater para exibir uma lista de links de navegação *[2,0 em](../../data-access/index.md)* duas profundidade, como mostra a Figura 4.</span><span class="sxs-lookup"><span data-stu-id="ecd98-184">Since a thorough discussion of the Site Map framework and the Navigation controls is beyond the scope of this tutorial series, rather than spend time crafting our own navigational user interface let's instead borrow the one used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series, which uses a Repeater control to display a two-deep bulleted list of navigation links, as shown in Figure 4.</span></span>

### <a name="adding-a-two-level-list-of-links-in-the-left-column"></a><span data-ttu-id="ecd98-185">Adicionando uma lista de dois níveis de links na coluna à esquerda</span><span class="sxs-lookup"><span data-stu-id="ecd98-185">Adding a Two-Level List of Links in the Left Column</span></span>

<span data-ttu-id="ecd98-186">Para criar essa interface, adicione a seguinte marcação declarativa à coluna esquerda da `Site.master` página mestra em que o texto TODO: O menu vai aqui... atualmente reside.</span><span class="sxs-lookup"><span data-stu-id="ecd98-186">To create this interface, add the following declarative markup to the `Site.master` master page's left column where the text TODO: Menu will go here... currently resides.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample3.aspx)]

<span data-ttu-id="ecd98-187">A marcação acima associa um controle Repeater chamado `menu` a SiteMapDataSource, que retorna a hierarquia do mapa do site definida em `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-187">The above markup binds a Repeater control named `menu` to a SiteMapDataSource, which returns the site map hierarchy defined in `Web.sitemap`.</span></span> <span data-ttu-id="ecd98-188">Como a [propriedade`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) do controle SiteMapDataSource é definida como false, ela começa a retornar a hierarquia do mapa do site, começando com os descendentes do nó inicial.</span><span class="sxs-lookup"><span data-stu-id="ecd98-188">Since the SiteMapDataSource control's [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) is set to False it starts returning the site map's hierarchy starting with the descendents of the Home node.</span></span> <span data-ttu-id="ecd98-189">O Repeater exibe cada um desses nós (atualmente apenas associação) em um elemento `<li>`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-189">The Repeater displays each of these nodes (currently just Membership ) in an `<li>` element.</span></span> <span data-ttu-id="ecd98-190">Outro, o repetidor interno, em seguida, exibe os filhos do nó atual em uma lista não ordenada aninhada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-190">Another, inner Repeater then displays the current node's children in a nested unordered list.</span></span>

<span data-ttu-id="ecd98-191">A Figura 4 mostra a saída renderizada da marcação acima com a estrutura do mapa do site que criamos na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="ecd98-191">Figure 4 shows the above markup's rendered output with the site map structure we created in Step 2.</span></span> <span data-ttu-id="ecd98-192">O Repeater renderiza marcação de lista não ordenada da baunilha; as regras de folha de estilos em cascata definidas na `Styles.css` são responsáveis pelo layout de estética.</span><span class="sxs-lookup"><span data-stu-id="ecd98-192">The Repeater renders vanilla unordered list markup; the cascading style sheet rules defined in `Styles.css` are responsible for the aesthetically-pleasing layout.</span></span> <span data-ttu-id="ecd98-193">Para obter uma descrição mais detalhada de como a marcação acima funciona, consulte as [páginas mestras e](https://asp.net/learn/data-access/tutorial-03-vb.aspx) o tutorial de navegação do site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-193">For a more detailed description of how the above markup works, refer to the [Master Pages and Site Navigation](https://asp.net/learn/data-access/tutorial-03-vb.aspx) tutorial.</span></span>

<span data-ttu-id="ecd98-194">[![a interface do usuário de navegação é renderizada usando listas não ordenadas aninhadas](creating-user-accounts-vb/_static/image11.png)](creating-user-accounts-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-194">[![The Navigational User Interface is Rendered Using Nested Unordered Lists](creating-user-accounts-vb/_static/image11.png)](creating-user-accounts-vb/_static/image10.png)</span></span>

<span data-ttu-id="ecd98-195">**Figura 4**: A interface do usuário de navegação é renderizada usando listas não ordenadas aninhadas ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-195">**Figure 4**: The Navigational User Interface is Rendered Using Nested Unordered Lists ([Click to view full-size image](creating-user-accounts-vb/_static/image12.png))</span></span>

### <a name="adding-breadcrumb-navigation"></a><span data-ttu-id="ecd98-196">Adicionando navegação de trilha</span><span class="sxs-lookup"><span data-stu-id="ecd98-196">Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="ecd98-197">Além da lista de links na coluna à esquerda, também vamos fazer com que cada página exiba um [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span><span class="sxs-lookup"><span data-stu-id="ecd98-197">In addition to the list of links in the left column, let's also have each page display a [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span></span> <span data-ttu-id="ecd98-198">Um breadcrumb é um elemento de interface do usuário de navegação que mostra rapidamente aos usuários sua posição atual na hierarquia do site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-198">A breadcrumb is a navigational user interface element that quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="ecd98-199">O controle SiteMapPath usa a estrutura do mapa do site para determinar o local da página atual no mapa do site e, em seguida, exibe uma trilha com base nessas informações.</span><span class="sxs-lookup"><span data-stu-id="ecd98-199">The SiteMapPath control uses the Site Map framework to determine the current page's location in the site map and then displays a breadcrumb based on this information.</span></span>

<span data-ttu-id="ecd98-200">Especificamente, adicione um elemento `<span>` ao elemento de cabeçalho `<div>` da página mestra e defina o atributo `class` do novo elemento `<span>` como breadcrumb.</span><span class="sxs-lookup"><span data-stu-id="ecd98-200">Specifically, add a `<span>` element to the master page's header `<div>` element, and set the new `<span>` element's `class` attribute to breadcrumb.</span></span> <span data-ttu-id="ecd98-201">(A classe `Styles.css` contém uma regra para uma classe de navegação estrutural.) Em seguida, adicione um SiteMapPath a esse novo elemento `<span>`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-201">(The `Styles.css` class contains a rule for a breadcrumb class.) Next, add a SiteMapPath to this new `<span>` element.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample4.aspx)]

<span data-ttu-id="ecd98-202">A Figura 5 mostra a saída do SiteMapPath ao visitar `~/Membership/CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-202">Figure 5 shows the output of the SiteMapPath when visiting `~/Membership/CreatingUserAccounts.aspx`.</span></span>

<span data-ttu-id="ecd98-203">[![o breadcrumb exibe a página atual e seus ancestrais no mapa do site](creating-user-accounts-vb/_static/image14.png)](creating-user-accounts-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-203">[![The Breadcrumb Displays the Current Page and its Ancestors in the Site Map](creating-user-accounts-vb/_static/image14.png)](creating-user-accounts-vb/_static/image13.png)</span></span>

<span data-ttu-id="ecd98-204">**Figura 5**: O breadcrumb exibe a página atual e seus ancestrais no mapa do site ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-204">**Figure 5**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map ([Click to view full-size image](creating-user-accounts-vb/_static/image15.png))</span></span>

## <a name="step-4-removing-the-custom-principal-and-identity-logic"></a><span data-ttu-id="ecd98-205">Etapa 4: Removendo a entidade personalizada e a lógica de identidade</span><span class="sxs-lookup"><span data-stu-id="ecd98-205">Step 4: Removing the Custom Principal and Identity Logic</span></span>

<span data-ttu-id="ecd98-206">No tutorial *<a id="_msoanchor_7"></a>[configuração de autenticação de formulários e tópicos avançados](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* , vimos como associar objetos de identidade e entidade personalizados ao usuário autenticado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-206">In the *<a id="_msoanchor_7"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* tutorial we saw how to associate custom principal and identity objects to the authenticated user.</span></span> <span data-ttu-id="ecd98-207">Fizemos isso criando um manipulador de eventos em `Global.asax` para o evento `PostAuthenticateRequest` do aplicativo, que é acionado após a `FormsAuthenticationModule` ter autenticado o usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-207">We accomplished this by creating an event handler in `Global.asax` for the application's `PostAuthenticateRequest` event, which fires after the `FormsAuthenticationModule` has authenticated the user.</span></span> <span data-ttu-id="ecd98-208">Nesse manipulador de eventos, substituímos os objetos `GenericPrincipal` e `FormsIdentity` adicionados pelo `FormsAuthenticationModule` com os objetos `CustomPrincipal` e `CustomIdentity` que criamos nesse tutorial.</span><span class="sxs-lookup"><span data-stu-id="ecd98-208">In this event handler we replaced the `GenericPrincipal` and `FormsIdentity` objects added by the `FormsAuthenticationModule` with the `CustomPrincipal` and `CustomIdentity` objects we created in that tutorial.</span></span>

<span data-ttu-id="ecd98-209">Embora objetos de identidade e entidade personalizados sejam úteis em determinados cenários, na maioria dos casos, os objetos `GenericPrincipal` e `FormsIdentity` são suficientes.</span><span class="sxs-lookup"><span data-stu-id="ecd98-209">While custom principal and identity objects are useful in certain scenarios, in most cases the `GenericPrincipal` and `FormsIdentity` objects are sufficient.</span></span> <span data-ttu-id="ecd98-210">Consequentemente, acho que vale a pena retornar ao comportamento padrão.</span><span class="sxs-lookup"><span data-stu-id="ecd98-210">Consequently, I think it would be worthwhile to return to the default behavior.</span></span> <span data-ttu-id="ecd98-211">Faça essa alteração removendo ou comentando o manipulador de eventos `PostAuthenticateRequest` ou excluindo o arquivo de `Global.asax` totalmente.</span><span class="sxs-lookup"><span data-stu-id="ecd98-211">Make this change by either removing or commenting out the `PostAuthenticateRequest` event handler or by deleting the `Global.asax` file entirely.</span></span>

> [!NOTE]
> <span data-ttu-id="ecd98-212">Depois de ter comentado ou removido o código em `Global.asax`, você precisará comentar o código na classe code-behind `Default.aspx's` que converte a propriedade `User.Identity` em uma instância de `CustomIdentity`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-212">Once you've commented or removed the code in `Global.asax`, you will need to comment out the code in `Default.aspx's` code-behind class that casts the `User.Identity` property to a `CustomIdentity` instance.</span></span>

## <a name="step-5-programmatically-creating-a-new-user"></a><span data-ttu-id="ecd98-213">Etapa 5: Criando programaticamente um novo usuário</span><span class="sxs-lookup"><span data-stu-id="ecd98-213">Step 5: Programmatically Creating a New User</span></span>

<span data-ttu-id="ecd98-214">Para criar uma nova conta de usuário por meio da estrutura de associação, use o [método`CreateUser`](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx)da classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-214">To create a new user account through the Membership framework use the `Membership` class's [`CreateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx).</span></span> <span data-ttu-id="ecd98-215">Esse método tem parâmetros de entrada para o nome de usuário, a senha e outros campos relacionados a usuários.</span><span class="sxs-lookup"><span data-stu-id="ecd98-215">This method has input parameters for the username, password, and other user-related fields.</span></span> <span data-ttu-id="ecd98-216">Na invocação, ele delega a criação da nova conta de usuário para o provedor de associação configurado e, em seguida, retorna um [objeto de`MembershipUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) que representa a conta de usuário recém criada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-216">On invocation, it delegates the creation of the new user account to the configured Membership provider and then returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) representing the just-created user account.</span></span>

<span data-ttu-id="ecd98-217">O método `CreateUser` tem quatro sobrecargas, cada uma aceitando um número diferente de parâmetros de entrada:</span><span class="sxs-lookup"><span data-stu-id="ecd98-217">The `CreateUser` method has four overloads, each accepting a different number of input parameters:</span></span>

- [`CreateUser(username, password)`](https://msdn.microsoft.com/library/d8t4h2es.aspx)
- [`CreateUser(username, password, email)`](https://msdn.microsoft.com/library/t8yy6w3h.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, MembershipCreateStatus)`](https://msdn.microsoft.com/library/82xx2e62.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, MembershipCreateStatus)`](https://msdn.microsoft.com/library/ms152012.aspx)

<span data-ttu-id="ecd98-218">Essas quatro sobrecargas diferem na quantidade de informações coletadas.</span><span class="sxs-lookup"><span data-stu-id="ecd98-218">These four overloads differ on the amount of information that is collected.</span></span> <span data-ttu-id="ecd98-219">A primeira sobrecarga, por exemplo, requer apenas o nome de usuário e a senha para a nova conta de usuários, enquanto a segunda também requer o endereço de email do usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-219">The first overload, for example, requires just the username and password for the new user account, whereas the second one also requires the user's email address.</span></span>

<span data-ttu-id="ecd98-220">Essas sobrecargas existem porque as informações necessárias para criar uma nova conta de usuário dependem das definições de configuração do provedor de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-220">These overloads exist because the information needed to create a new user account depends on the Membership provider's configuration settings.</span></span> <span data-ttu-id="ecd98-221">No tutorial *<a id="_msoanchor_8"></a>[criando o esquema de associação no SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* examinamos a especificação das definições de configuração do provedor de associação no `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-221">In the *<a id="_msoanchor_8"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial we examined specifying Membership provider configuration settings in `Web.config`.</span></span> <span data-ttu-id="ecd98-222">A tabela 2 incluía uma lista completa dos parâmetros de configuração.</span><span class="sxs-lookup"><span data-stu-id="ecd98-222">Table 2 included a complete list of the configuration settings.</span></span>

<span data-ttu-id="ecd98-223">Uma dessas definições de configuração do provedor de associação que afeta o que `CreateUser` sobrecargas podem ser usadas é a configuração de `requiresQuestionAndAnswer`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-223">One such Membership provider configuration setting that impacts what `CreateUser` overloads may be used is the `requiresQuestionAndAnswer` setting.</span></span> <span data-ttu-id="ecd98-224">Se `requiresQuestionAndAnswer` for definido como `true` (o padrão), ao criar uma nova conta de usuário, será necessário especificar uma pergunta de segurança e uma resposta.</span><span class="sxs-lookup"><span data-stu-id="ecd98-224">If `requiresQuestionAndAnswer` is set to `true` (the default), then when creating a new user account we must specify a security question and answer.</span></span> <span data-ttu-id="ecd98-225">Essas informações serão usadas posteriormente se o usuário precisar redefinir ou alterar sua senha.</span><span class="sxs-lookup"><span data-stu-id="ecd98-225">This information is later used if the user needs to reset or change their password.</span></span> <span data-ttu-id="ecd98-226">Especificamente, nesse momento eles são mostrados a pergunta de segurança e devem inserir a resposta correta para redefinir ou alterar sua senha.</span><span class="sxs-lookup"><span data-stu-id="ecd98-226">Specifically, at that time they are shown the security question and they must enter the correct answer in order to reset or change their password.</span></span> <span data-ttu-id="ecd98-227">Consequentemente, se a `requiresQuestionAndAnswer` for definida como `true` chamando uma das duas primeiras `CreateUser` sobrecargas resultará em uma exceção porque a pergunta e a resposta de segurança estão ausentes.</span><span class="sxs-lookup"><span data-stu-id="ecd98-227">Consequently, if the `requiresQuestionAndAnswer` is set to `true` then calling either of the first two `CreateUser` overloads results in an exception because the security question and answer are missing.</span></span> <span data-ttu-id="ecd98-228">Como nosso aplicativo está atualmente configurado para exigir uma pergunta e resposta de segurança, precisaremos usar uma das duas últimas sobrecargas ao criar o usuário de forma programática.</span><span class="sxs-lookup"><span data-stu-id="ecd98-228">Since our application is currently configured to require a security question and answer, we will need to use one of the latter two overloads when creating user's programmatically.</span></span>

<span data-ttu-id="ecd98-229">Para ilustrar o uso do método `CreateUser`, vamos criar uma interface do usuário onde solicitamos ao usuário seu nome, senha, email e uma resposta a uma pergunta de segurança predefinida.</span><span class="sxs-lookup"><span data-stu-id="ecd98-229">To illustrate using the `CreateUser` method, let's create a user interface where we prompt the user for their name, password, email, and an answer to a pre-defined security question.</span></span> <span data-ttu-id="ecd98-230">Abra a página `CreatingUserAccounts.aspx` na pasta `Membership` e adicione os seguintes controles da Web ao controle de conteúdo:</span><span class="sxs-lookup"><span data-stu-id="ecd98-230">Open the `CreatingUserAccounts.aspx` page in the `Membership` folder and add the following Web controls to the Content control:</span></span>

- <span data-ttu-id="ecd98-231">Uma caixa de texto chamada `Username`</span><span class="sxs-lookup"><span data-stu-id="ecd98-231">A TextBox named `Username`</span></span>
- <span data-ttu-id="ecd98-232">Uma caixa de texto chamada `Password`, cuja propriedade `TextMode` está definida como `Password`</span><span class="sxs-lookup"><span data-stu-id="ecd98-232">A TextBox named `Password`, whose `TextMode` property is set to `Password`</span></span>
- <span data-ttu-id="ecd98-233">Uma caixa de texto chamada `Email`</span><span class="sxs-lookup"><span data-stu-id="ecd98-233">A TextBox named `Email`</span></span>
- <span data-ttu-id="ecd98-234">Um rótulo chamado `SecurityQuestion` com sua propriedade `Text` desmarcada</span><span class="sxs-lookup"><span data-stu-id="ecd98-234">A Label named `SecurityQuestion` with its `Text` property cleared out</span></span>
- <span data-ttu-id="ecd98-235">Uma caixa de texto chamada `SecurityAnswer`</span><span class="sxs-lookup"><span data-stu-id="ecd98-235">A TextBox named `SecurityAnswer`</span></span>
- <span data-ttu-id="ecd98-236">Um botão chamado `CreateAccountButton` cuja propriedade `Text` está definida para criar a conta de usuário</span><span class="sxs-lookup"><span data-stu-id="ecd98-236">A Button named `CreateAccountButton` whose `Text` property is set to Create the User Account</span></span>
- <span data-ttu-id="ecd98-237">Um controle de rótulo chamado `CreateAccountResults` com sua propriedade `Text` desmarcada</span><span class="sxs-lookup"><span data-stu-id="ecd98-237">A Label control named `CreateAccountResults` with its `Text` property cleared out</span></span>

<span data-ttu-id="ecd98-238">Neste ponto, sua tela deve ser semelhante à captura de tela mostrada na Figura 6.</span><span class="sxs-lookup"><span data-stu-id="ecd98-238">At this point your screen should look similar to the screen shot shown in Figure 6.</span></span>

<span data-ttu-id="ecd98-239">[![adicionar vários controles da Web à página CreatingUserAccounts. aspx](creating-user-accounts-vb/_static/image17.png)](creating-user-accounts-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-239">[![Add the Various Web Controls to the CreatingUserAccounts.aspx Page](creating-user-accounts-vb/_static/image17.png)](creating-user-accounts-vb/_static/image16.png)</span></span>

<span data-ttu-id="ecd98-240">**Figura 6**: Adicione os vários controles da Web ao `CreatingUserAccounts.aspx Page` ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-240">**Figure 6**: Add the Various Web Controls to the `CreatingUserAccounts.aspx Page` ([Click to view full-size image](creating-user-accounts-vb/_static/image18.png))</span></span>

<span data-ttu-id="ecd98-241">O rótulo de `SecurityQuestion` e a caixa de texto `SecurityAnswer` devem exibir uma pergunta de segurança predefinida e coletar a resposta do usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-241">The `SecurityQuestion` Label and `SecurityAnswer` TextBox are intended to display a pre-defined security question and collect the user's answer.</span></span> <span data-ttu-id="ecd98-242">Observe que tanto a pergunta de segurança quanto a resposta são armazenadas em uma base de usuário por usuário, portanto, é possível permitir que cada usuário defina sua própria pergunta de segurança.</span><span class="sxs-lookup"><span data-stu-id="ecd98-242">Note that both the security question and answer are stored on a user-by-user basis, so it is possible to allow each user to define their own security question.</span></span> <span data-ttu-id="ecd98-243">No entanto, para este exemplo, decidi usar uma pergunta de segurança universal, a saber: Qual é sua cor favorita?</span><span class="sxs-lookup"><span data-stu-id="ecd98-243">However, for this example I have decided to use a universal security question, namely: What is your favorite color?</span></span>

<span data-ttu-id="ecd98-244">Para implementar essa pergunta de segurança predefinida, adicione uma constante à classe code-behind da página chamada `passwordQuestion`, atribuindo a ela a pergunta de segurança.</span><span class="sxs-lookup"><span data-stu-id="ecd98-244">To implement this pre-defined security question, add a constant to the page's code-behind class named `passwordQuestion`, assigning it the security question.</span></span> <span data-ttu-id="ecd98-245">Em seguida, no manipulador de eventos `Page_Load`, atribua essa constante à propriedade `Text` do rótulo de `SecurityQuestion`:</span><span class="sxs-lookup"><span data-stu-id="ecd98-245">Then, in the `Page_Load` event handler, assign this constant to the `SecurityQuestion` Label's `Text` property:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample5.vb)]

<span data-ttu-id="ecd98-246">Em seguida, crie um manipulador de eventos para o evento `CreateAccountButton'` s `Click` e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="ecd98-246">Next, create an event handler for the `CreateAccountButton'` s `Click` event and add the following code:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample6.vb)]

<span data-ttu-id="ecd98-247">O manipulador de eventos `Click` começa definindo uma variável chamada `createStatus` do tipo [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-247">The `Click` event handler starts by defining a variable named `createStatus` of type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span></span> <span data-ttu-id="ecd98-248">`MembershipCreateStatus` é uma enumeração que indica o status da operação de `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-248">`MembershipCreateStatus` is an enumeration that indicates the status of the `CreateUser` operation.</span></span> <span data-ttu-id="ecd98-249">Por exemplo, se a conta de usuário for criada com êxito, a instância de `MembershipCreateStatus` resultante será definida com um valor de `Success;`, por outro lado, se a operação falhar porque já existe um usuário com o mesmo nome, ele será definido como um valor de `DuplicateUserName`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-249">For example, if the user account is created successfully, the resulting `MembershipCreateStatus` instance will be set to a value of `Success;` on the other hand, if the operation fails because there already exists a user with the same username, it will be set to a value of `DuplicateUserName`.</span></span> <span data-ttu-id="ecd98-250">Na sobrecarga de `CreateUser` que usamos, precisamos passar uma instância de `MembershipCreateStatus` para o método.</span><span class="sxs-lookup"><span data-stu-id="ecd98-250">In the `CreateUser` overload we use, we need to pass a `MembershipCreateStatus` instance into the method.</span></span> <span data-ttu-id="ecd98-251">Esse parâmetro é definido como o valor apropriado dentro do método `CreateUser`, e podemos examinar seu valor após a chamada de método para determinar se a conta de usuário foi criada com êxito.</span><span class="sxs-lookup"><span data-stu-id="ecd98-251">This parameter is set to the appropriate value within the `CreateUser` method, and we can examine its value after the method call to determine whether the user account was successfully created.</span></span>

<span data-ttu-id="ecd98-252">Depois de chamar `CreateUser`, passando `createStatus`, uma instrução `Select Case` é usada para gerar uma mensagem apropriada, dependendo do valor atribuído a `createStatus`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-252">After calling `CreateUser`, passing in `createStatus`, a `Select Case` statement is used to output an appropriate message depending on the value assigned to `createStatus`.</span></span> <span data-ttu-id="ecd98-253">As figuras 7 mostram a saída quando um novo usuário foi criado com êxito.</span><span class="sxs-lookup"><span data-stu-id="ecd98-253">Figures 7 shows the output when a new user has successfully been created.</span></span> <span data-ttu-id="ecd98-254">As figuras 8 e 9 mostram a saída quando a conta de usuário não é criada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-254">Figures 8 and 9 show the output when the user account is not created.</span></span> <span data-ttu-id="ecd98-255">Na Figura 8, o visitante inseriu uma senha de cinco letras, que não atende aos requisitos de força de senha descritos nas definições de configuração do provedor de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-255">In Figure 8, the visitor entered a five-letter password, which does not meet the password strength requirements spelled out in the Membership provider's configuration settings.</span></span> <span data-ttu-id="ecd98-256">Na Figura 9, o visitante está tentando criar uma conta de usuário com um username existente (aquele criado na Figura 7).</span><span class="sxs-lookup"><span data-stu-id="ecd98-256">In Figure 9, the visitor is attempting to create a user account with an existing username (the one created in Figure 7).</span></span>

<span data-ttu-id="ecd98-257">[![uma nova conta de usuário foi criada com êxito](creating-user-accounts-vb/_static/image20.png)](creating-user-accounts-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-257">[![A New User Account is Successfully Created](creating-user-accounts-vb/_static/image20.png)](creating-user-accounts-vb/_static/image19.png)</span></span>

<span data-ttu-id="ecd98-258">**Figura 7**: Uma nova conta de usuário foi criada com êxito ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-258">**Figure 7**: A New User Account is Successfully Created  ([Click to view full-size image](creating-user-accounts-vb/_static/image21.png))</span></span>

<span data-ttu-id="ecd98-259">[![a conta de usuário não for criada porque a senha fornecida é muito fraca](creating-user-accounts-vb/_static/image23.png)](creating-user-accounts-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-259">[![The User Account is Not Created Because the Supplied Password is Too Weak](creating-user-accounts-vb/_static/image23.png)](creating-user-accounts-vb/_static/image22.png)</span></span>

<span data-ttu-id="ecd98-260">**Figura 8**: A conta de usuário não foi criada porque a senha fornecida é muito fraca ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-260">**Figure 8**: The User Account is Not Created Because the Supplied Password is Too Weak ([Click to view full-size image](creating-user-accounts-vb/_static/image24.png))</span></span>

<span data-ttu-id="ecd98-261">[![a conta de usuário não for criada porque o nome de usuário já está em uso](creating-user-accounts-vb/_static/image26.png)](creating-user-accounts-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-261">[![The User Account is Not Created Because the Username is Already in Use](creating-user-accounts-vb/_static/image26.png)](creating-user-accounts-vb/_static/image25.png)</span></span>

<span data-ttu-id="ecd98-262">**Figura 9**: A conta de usuário não foi criada porque o nome de usuários já está em uso ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-262">**Figure 9**: The User Account is Not Created Because the Username is Already in Use ([Click to view full-size image](creating-user-accounts-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ecd98-263">Você pode estar se perguntando como determinar o êxito ou a falha ao usar um dos dois primeiros `CreateUser` sobrecargas de método, nenhum dos quais tem um parâmetro do tipo `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-263">You may be wondering how to determine success or failure when using one of the first two `CreateUser` method overloads, neither of which has a parameter of type `MembershipCreateStatus`.</span></span> <span data-ttu-id="ecd98-264">Essas duas primeiras sobrecargas lançam uma [`MembershipCreateUserException` exceção](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) em face de uma falha, que inclui uma [Propriedade`StatusCode`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) do tipo `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-264">These first two overloads throw a [`MembershipCreateUserException` exception](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in the face of a failure, which includes a [`StatusCode` property](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) of type `MembershipCreateStatus`.</span></span>

<span data-ttu-id="ecd98-265">Depois de criar algumas contas de usuário, verifique se as contas foram criadas, listando o conteúdo das tabelas `aspnet_Users` e `aspnet_Membership` no banco de dados `SecurityTutorials.mdf`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-265">After creating a few user accounts, verify that the accounts have been created by listing the contents of the `aspnet_Users` and `aspnet_Membership` tables in the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="ecd98-266">Como mostra a Figura 10, adicionei dois usuários por meio da página `CreatingUserAccounts.aspx`: Tito e Bruce.</span><span class="sxs-lookup"><span data-stu-id="ecd98-266">As Figure 10 shows, I have added two users via the `CreatingUserAccounts.aspx` page: Tito and Bruce.</span></span>

<span data-ttu-id="ecd98-267">[![há dois usuários no repositório de usuários da associação: Tito e Bruce](creating-user-accounts-vb/_static/image29.png)](creating-user-accounts-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-267">[![There are Two Users in the Membership User Store: Tito and Bruce](creating-user-accounts-vb/_static/image29.png)](creating-user-accounts-vb/_static/image28.png)</span></span>

<span data-ttu-id="ecd98-268">**Figura 10**: Há dois usuários no repositório de usuários da associação: Tito e Bruce ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-268">**Figure 10**: There are Two Users in the Membership User Store: Tito and Bruce ([Click to view full-size image](creating-user-accounts-vb/_static/image30.png))</span></span>

<span data-ttu-id="ecd98-269">Embora o armazenamento do usuário da Associação agora inclua as informações da conta Bruce e Tito, ainda implementamos a funcionalidade que permite que Bruce ou Tito façam logon no site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-269">While the Membership user store now includes Bruce and Tito's account information, we have yet to implement functionality that allows for Bruce or Tito to log on to the site.</span></span> <span data-ttu-id="ecd98-270">Atualmente, `Login.aspx` valida as credenciais do usuário em relação a um conjunto embutido de pares de nome de usuário/senha-ele *não valida as* credenciais fornecidas em relação à estrutura de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-270">Currently, `Login.aspx` validates the user's credentials against a hard-coded set of username/password pairs - it does *not* validate the supplied credentials against the Membership framework.</span></span> <span data-ttu-id="ecd98-271">Por ora, ver as novas contas de usuário nas tabelas `aspnet_Users` e `aspnet_Membership` precisará ser suficiente.</span><span class="sxs-lookup"><span data-stu-id="ecd98-271">For now seeing the new user accounts in the `aspnet_Users` and `aspnet_Membership` tables will have to suffice.</span></span> <span data-ttu-id="ecd98-272">No próximo tutorial, *<a id="_msoanchor_9"></a>[validando as credenciais do usuário em relação ao armazenamento do usuário da Associação](validating-user-credentials-against-the-membership-user-store-vb.md)* , atualizaremos a página de logon para validar em relação ao repositório de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-272">In the next tutorial, *<a id="_msoanchor_9"></a>[Validating User Credentials Against the Membership User Store](validating-user-credentials-against-the-membership-user-store-vb.md)*, we will update the login page to validate against the Membership store.</span></span>

> [!NOTE]
> <span data-ttu-id="ecd98-273">Se você não vir nenhum usuário em seu `SecurityTutorials.mdf` banco de dados, pode ser porque seu aplicativo Web está usando o provedor de associação padrão, `AspNetSqlMembershipProvider`, que usa o banco de dados `ASPNETDB.mdf` como seu armazenamento de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-273">If you do not see any users in your `SecurityTutorials.mdf` database, it may be because your web application is using the default Membership provider, `AspNetSqlMembershipProvider`, which uses the `ASPNETDB.mdf` database as its user store.</span></span> <span data-ttu-id="ecd98-274">Para determinar se esse é o problema, clique no botão atualizar na Gerenciador de Soluções.</span><span class="sxs-lookup"><span data-stu-id="ecd98-274">To determine if this is the problem, click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="ecd98-275">Se um banco de dados chamado `ASPNETDB.mdf` tiver sido adicionado à pasta `App_Data`, esse será o problema.</span><span class="sxs-lookup"><span data-stu-id="ecd98-275">If a database named `ASPNETDB.mdf` has been added to the `App_Data` folder, this is the problem.</span></span> <span data-ttu-id="ecd98-276">Retorne à etapa 4 do tutorial *<a id="_msoanchor_10"></a>[criando o esquema de associação no SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* para obter instruções sobre como configurar corretamente o provedor de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-276">Return to Step 4 of the *<a id="_msoanchor_10"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial for instructions on how to properly configure the Membership provider.</span></span>

<span data-ttu-id="ecd98-277">Na maioria dos cenários de criação de conta de usuário, o visitante recebe alguma interface para inserir seu nome de usuário, senha, email e outras informações essenciais. nesse ponto, uma nova conta é criada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-277">In most create user account scenarios, the visitor is presented with some interface to enter their username, password, email, and other essential information, at which point a new account is created.</span></span> <span data-ttu-id="ecd98-278">Nesta etapa, examinamos a criação dessa interface manualmente e vimos como usar o método `Membership.CreateUser` para adicionar programaticamente a nova conta de usuário com base nas entradas do usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-278">In this step we looked at building such an interface by hand and then saw how to use the `Membership.CreateUser` method to programmatically add the new user account based on the user's inputs.</span></span> <span data-ttu-id="ecd98-279">Nosso código, no entanto, acabou de criar a nova conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-279">Our code, however, just created the new user account.</span></span> <span data-ttu-id="ecd98-280">Ele não executou nenhuma ação de acompanhamento, como fazer logon do usuário no site sob a conta de usuário recém-criada ou enviar um email de confirmação para o usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-280">It did not perform any follow up actions, like logging in the user to the site under the just-created user account, or sending a confirmation email to the user.</span></span> <span data-ttu-id="ecd98-281">Essas etapas adicionais exigirão código adicional no manipulador de eventos de `Click` do botão.</span><span class="sxs-lookup"><span data-stu-id="ecd98-281">These additional steps would require additional code in the Button's `Click` event handler.</span></span>

<span data-ttu-id="ecd98-282">O ASP.NET é fornecido com o controle CreateUserWizard, que é projetado para lidar com o processo de criação da conta do usuário, desde o processamento de uma interface do usuário para a criação de novas contas de usuário até a criação da conta na estrutura de associação e a execução de pós-instalação tarefas de criação, como enviar um email de confirmação e registrar em log o usuário recém-criado no site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-282">ASP.NET ships with the CreateUserWizard control, which is designed to handle the user account creation process, from rendering a user interface for creating new user accounts, to creating the account in the Membership framework and performing post-account creation tasks, such as sending a confirmation email and logging the just-created user into the site.</span></span> <span data-ttu-id="ecd98-283">O uso do controle CreateUserWizard é tão simples quanto arrastar o controle CreateUserWizard da caixa de ferramentas para uma página e, em seguida, definir algumas propriedades.</span><span class="sxs-lookup"><span data-stu-id="ecd98-283">Using the CreateUserWizard control is as simple as dragging the CreateUserWizard control from the Toolbox onto a page, and then setting a few properties.</span></span> <span data-ttu-id="ecd98-284">Na maioria dos casos, você não precisará escrever uma única linha de código.</span><span class="sxs-lookup"><span data-stu-id="ecd98-284">In most cases, you won't need to write a single line of code.</span></span> <span data-ttu-id="ecd98-285">Exploraremos esse controle inteligente em detalhes na etapa 6.</span><span class="sxs-lookup"><span data-stu-id="ecd98-285">We will explore this nifty control in detail in Step 6.</span></span>

<span data-ttu-id="ecd98-286">Se novas contas de usuário forem criadas apenas por meio de uma página da Web de criação de conta típica, é improvável que você precise escrever código que usa o método `CreateUser`, pois o controle CreateUserWizard provavelmente atenderá às suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="ecd98-286">If new user accounts are only created through a typical Create Account web page, it is unlikely that you will ever need to write code that uses the `CreateUser` method, as the CreateUserWizard control will likely meet your needs.</span></span> <span data-ttu-id="ecd98-287">No entanto, o método `CreateUser` é útil em cenários em que você precisa de uma experiência de usuário de criação de conta altamente personalizada ou quando você precisa criar programaticamente novas contas de usuário por meio de uma interface alternativa.</span><span class="sxs-lookup"><span data-stu-id="ecd98-287">However, the `CreateUser` method is handy in scenarios where you need a highly customized Create Account user experience or when you need to programmatically create new user accounts through an alternative interface.</span></span> <span data-ttu-id="ecd98-288">Por exemplo, você pode ter uma página que permite que um usuário carregue um arquivo XML que contém informações do usuário de algum outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ecd98-288">For example, you might have a page that allows a user to upload an XML file that contains user information from some other application.</span></span> <span data-ttu-id="ecd98-289">A página pode analisar o conteúdo do arquivo XML carregado e criar uma nova conta para cada usuário representado no XML chamando o método `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-289">The page might parses the contents of the uploaded XML file and create a new account for each user represented in the XML by calling the `CreateUser` method.</span></span>

## <a name="step-6-creating-a-new-user-with-the-createuserwizard-control"></a><span data-ttu-id="ecd98-290">Etapa 6: Criando um novo usuário com o controle CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="ecd98-290">Step 6: Creating a New User with the CreateUserWizard Control</span></span>

<span data-ttu-id="ecd98-291">O ASP.NET é fornecido com vários controles da Web de logon.</span><span class="sxs-lookup"><span data-stu-id="ecd98-291">ASP.NET ships with a number of Login Web controls.</span></span> <span data-ttu-id="ecd98-292">Esses controles auxiliam em muitos cenários comuns relacionados à conta de usuário e ao logon.</span><span class="sxs-lookup"><span data-stu-id="ecd98-292">These controls aid in many common user account- and login-related scenarios.</span></span> <span data-ttu-id="ecd98-293">O [controle CreateUserWizard](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) é um desses controles que é projetado para apresentar uma interface do usuário para adicionar uma nova conta de usuário à estrutura de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-293">The [CreateUserWizard control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) is one such control that is designed to present a user interface for adding a new user account to the Membership framework.</span></span>

<span data-ttu-id="ecd98-294">Como muitos dos outros controles da Web relacionados ao logon, o CreateUserWizard pode ser usado sem escrever uma única linha de código.</span><span class="sxs-lookup"><span data-stu-id="ecd98-294">Like many of the other Login-related Web controls, the CreateUserWizard can be used without writing a single line of code.</span></span> <span data-ttu-id="ecd98-295">Ele fornece intuitivamente uma interface do usuário com base nas definições de configuração do provedor de associação e chama internamente o método `CreateUser` da classe `Membership` depois que o usuário insere as informações necessárias e clica no botão criar usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-295">It intuitively provides a user interface based on the Membership provider's configuration settings and internally calls the `Membership` class's `CreateUser` method after the user enters the necessary information and clicks the Create User button.</span></span> <span data-ttu-id="ecd98-296">O controle CreateUserWizard é extremamente personalizável.</span><span class="sxs-lookup"><span data-stu-id="ecd98-296">The CreateUserWizard control is extremely customizable.</span></span> <span data-ttu-id="ecd98-297">Há um host de eventos que são acionados durante vários estágios do processo de criação da conta.</span><span class="sxs-lookup"><span data-stu-id="ecd98-297">There are a host of events that fire during various stages of the account creation process.</span></span> <span data-ttu-id="ecd98-298">Podemos criar manipuladores de eventos, conforme necessário, para injetar lógica personalizada no fluxo de trabalho de criação de conta.</span><span class="sxs-lookup"><span data-stu-id="ecd98-298">We can create event handlers, as needed, to inject custom logic into the account creation workflow.</span></span> <span data-ttu-id="ecd98-299">Além disso, a aparência do CreateUserWizard é muito flexível.</span><span class="sxs-lookup"><span data-stu-id="ecd98-299">Furthermore, the CreateUserWizard's appearance is very flexible.</span></span> <span data-ttu-id="ecd98-300">Há várias propriedades que definem a aparência da interface padrão; se necessário, o controle pode ser convertido em um modelo ou etapas de registro de usuário adicionais podem ser adicionadas.</span><span class="sxs-lookup"><span data-stu-id="ecd98-300">There are a number of properties that define the appearance of the default interface; if necessary, the control can be converted into a template or additional user registration steps may be added.</span></span>

<span data-ttu-id="ecd98-301">Vamos começar com uma olhada no uso da interface e do comportamento padrão do controle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="ecd98-301">Let's start with a look at using the CreateUserWizard control's default interface and behavior.</span></span> <span data-ttu-id="ecd98-302">Em seguida, exploraremos como personalizar a aparência por meio de propriedades e eventos do controle.</span><span class="sxs-lookup"><span data-stu-id="ecd98-302">We'll then explore how to customize the appearance via the control's properties and events.</span></span>

### <a name="examining-the-createuserwizards-default-interface-and-behavior"></a><span data-ttu-id="ecd98-303">Examinando a interface padrão e o comportamento do CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="ecd98-303">Examining the CreateUserWizard's Default Interface and Behavior</span></span>

<span data-ttu-id="ecd98-304">Retorne à página `CreatingUserAccounts.aspx` na pasta `Membership`, alterne para o modo de design ou divisão e, em seguida, adicione um controle CreateUserWizard à parte superior da página.</span><span class="sxs-lookup"><span data-stu-id="ecd98-304">Return to the `CreatingUserAccounts.aspx` page in the `Membership` folder, switch to the Design or Split mode, and then add a CreateUserWizard control to the top of the page.</span></span> <span data-ttu-id="ecd98-305">O controle CreateUserWizard é arquivado na seção controles de logon da caixa de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="ecd98-305">The CreateUserWizard control is filed under the Toolbox's Login controls section.</span></span> <span data-ttu-id="ecd98-306">Depois de adicionar o controle, defina sua propriedade `ID` como `RegisterUser`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-306">After adding the control, set its `ID` property to `RegisterUser`.</span></span> <span data-ttu-id="ecd98-307">Como mostra a captura de tela na Figura 11, o CreateUserWizard renderiza uma interface com caixas de correio para o nome de usuário, a senha, o endereço de email e a pergunta e a resposta de segurança.</span><span class="sxs-lookup"><span data-stu-id="ecd98-307">As the screen shot in Figure 11 shows, the CreateUserWizard renders an interface with textboxes for the new user's username, password, email address, and security question and answer.</span></span>

<span data-ttu-id="ecd98-308">[![o controle CreateUserWizard renderiza uma interface de usuário de criação genérica](creating-user-accounts-vb/_static/image32.png)](creating-user-accounts-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-308">[![The CreateUserWizard Control Renders a Generic Create User Interface](creating-user-accounts-vb/_static/image32.png)](creating-user-accounts-vb/_static/image31.png)</span></span>

<span data-ttu-id="ecd98-309">**Figura 11**: O controle CreateUserWizard renderiza uma interface de usuário de criação genérica ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-309">**Figure 11**: The CreateUserWizard Control Renders a Generic Create User Interface ([Click to view full-size image](creating-user-accounts-vb/_static/image33.png))</span></span>

<span data-ttu-id="ecd98-310">Vamos reservar um momento para comparar a interface do usuário padrão gerada pelo controle CreateUserWizard com a interface que criamos na etapa 5.</span><span class="sxs-lookup"><span data-stu-id="ecd98-310">Let's take a moment to compare the default user interface generated by the CreateUserWizard control with the interface we created in Step 5.</span></span> <span data-ttu-id="ecd98-311">Para iniciantes, o controle CreateUserWizard permite que o visitante especifique a pergunta e a resposta de segurança, enquanto nossa interface criada manualmente usou uma pergunta de segurança predefinida.</span><span class="sxs-lookup"><span data-stu-id="ecd98-311">For starters, the CreateUserWizard control allows the visitor to specify both the security question and answer, whereas our manually-created interface used a pre-defined security question.</span></span> <span data-ttu-id="ecd98-312">A interface do controle CreateUserWizard também inclui controles de validação, enquanto ainda tínhamos de implementar a validação nos campos de formulário de nossa interface.</span><span class="sxs-lookup"><span data-stu-id="ecd98-312">The CreateUserWizard control's interface also includes validation controls, whereas we had yet to implement validation on our interface's form fields.</span></span> <span data-ttu-id="ecd98-313">E a interface de controle CreateUserWizard inclui uma caixa de texto de confirmação de senha (junto com um CompareValidator para garantir que o texto digitado a senha e as caixas de textos de comparação de senha sejam iguais).</span><span class="sxs-lookup"><span data-stu-id="ecd98-313">And the CreateUserWizard control interface includes a Confirm Password textbox (along with a CompareValidator to ensure that the text entered the Password and Compare Password textboxes are equal).</span></span>

<span data-ttu-id="ecd98-314">O interessante é que o controle CreateUserWizard consulte as definições de configuração do provedor de associação ao renderizar sua interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-314">What's interesting is that the CreateUserWizard control consults the Membership provider's configuration settings when rendering its user interface.</span></span> <span data-ttu-id="ecd98-315">Por exemplo, as caixas de textpergunta de segurança e resposta só serão exibidas se `requiresQuestionAndAnswer` for definido como true.</span><span class="sxs-lookup"><span data-stu-id="ecd98-315">For example, the security question and answer textboxes are only displayed if `requiresQuestionAndAnswer` is set to True.</span></span> <span data-ttu-id="ecd98-316">Da mesma forma, o CreateUserWizard adiciona automaticamente um controle RegularExpressionValidator para garantir que os requisitos de força de senha sejam atendidos e define suas propriedades `ErrorMessage` e `ValidationExpression` com base nas definições de configuração `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`e `passwordStrengthRegularExpression`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-316">Likewise, CreateUserWizard automatically adds a RegularExpressionValidator control to ensure that the password strength requirements are met, and sets its `ErrorMessage` and `ValidationExpression` properties based on the `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`, and `passwordStrengthRegularExpression` configuration settings.</span></span>

<span data-ttu-id="ecd98-317">O controle CreateUserWizard, como o nome indica, é derivado do [controle Wizard](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-317">The CreateUserWizard control, as its name implies, is derived from the [Wizard control](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span></span> <span data-ttu-id="ecd98-318">Os controles do assistente são projetados para fornecer uma interface para concluir tarefas de várias etapas.</span><span class="sxs-lookup"><span data-stu-id="ecd98-318">Wizard controls are designed to provide an interface for completing multi-step tasks.</span></span> <span data-ttu-id="ecd98-319">Um controle Wizard pode ter um número arbitrário de `WizardSteps`, cada um dos quais é um modelo que define o HTML e os controles da Web para essa etapa.</span><span class="sxs-lookup"><span data-stu-id="ecd98-319">A Wizard control may have an arbitrary number of `WizardSteps`, each of which is a template that defines the HTML and Web controls for that step.</span></span> <span data-ttu-id="ecd98-320">O controle Wizard inicialmente exibe a primeira `WizardStep`, juntamente com os controles de navegação que permitem que o usuário prossiga de uma etapa para outra ou para retornar às etapas anteriores.</span><span class="sxs-lookup"><span data-stu-id="ecd98-320">The Wizard control initially displays the first `WizardStep`, along with navigation controls that permit the user to proceed from one step to the next, or to return to previous steps.</span></span>

<span data-ttu-id="ecd98-321">Como a marcação declarativa na Figura 11 mostra, a interface padrão do controle CreateUserWizard inclui duas `WizardStep` s:</span><span class="sxs-lookup"><span data-stu-id="ecd98-321">As the declarative markup in Figure 11 shows, the CreateUserWizard control's default interface includes two `WizardStep` s:</span></span>

- <span data-ttu-id="ecd98-322">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) ?</span><span class="sxs-lookup"><span data-stu-id="ecd98-322">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) ?</span></span> <span data-ttu-id="ecd98-323">Renderiza a interface para coletar informações para criar a nova conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-323">renders the interface to collect information for creating the new user account.</span></span> <span data-ttu-id="ecd98-324">Esta é a etapa mostrada na Figura 11.</span><span class="sxs-lookup"><span data-stu-id="ecd98-324">This is the step shown in Figure 11.</span></span>
- <span data-ttu-id="ecd98-325">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) ?</span><span class="sxs-lookup"><span data-stu-id="ecd98-325">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) ?</span></span> <span data-ttu-id="ecd98-326">renderiza uma mensagem indicando que a conta foi criada com êxito.</span><span class="sxs-lookup"><span data-stu-id="ecd98-326">renders a message indicating that the account has successfully been created.</span></span>

<span data-ttu-id="ecd98-327">A aparência e o comportamento do CreateUserWizard podem ser modificados convertendo qualquer uma dessas etapas em modelos ou adicionando seus próprios `WizardStep` s.</span><span class="sxs-lookup"><span data-stu-id="ecd98-327">The CreateUserWizard's appearance and behavior can be modified by converting either of these steps to templates, or by adding your own `WizardStep` s.</span></span> <span data-ttu-id="ecd98-328">Veremos como adicionar um `WizardStep` à interface de registro no tutorial *armazenamento de informações adicionais do usuário* .</span><span class="sxs-lookup"><span data-stu-id="ecd98-328">We will look at adding a `WizardStep` to the registration interface in the *Storing Additional User Information* tutorial.</span></span>

<span data-ttu-id="ecd98-329">Vamos ver o controle CreateUserWizard em ação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-329">Let's see the CreateUserWizard control in action.</span></span> <span data-ttu-id="ecd98-330">Visite a página `CreatingUserAccounts.aspx` por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="ecd98-330">Visit the `CreatingUserAccounts.aspx` page through a browser.</span></span> <span data-ttu-id="ecd98-331">Comece inserindo alguns valores inválidos na interface do CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="ecd98-331">Start by entering some invalid values into the CreateUserWizard's interface.</span></span> <span data-ttu-id="ecd98-332">Tente inserir uma senha que não esteja de acordo com os requisitos de força de senha ou deixando a caixa de texto nome de usuário vazia.</span><span class="sxs-lookup"><span data-stu-id="ecd98-332">Try entering a password that doesn't conform to the password strength requirements, or leaving the User Name textbox empty.</span></span> <span data-ttu-id="ecd98-333">O CreateUserWizard exibirá uma mensagem de erro apropriada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-333">The CreateUserWizard will display an appropriate error message.</span></span> <span data-ttu-id="ecd98-334">A Figura 12 mostra a saída ao tentar criar um usuário com uma senha forte insuficiente.</span><span class="sxs-lookup"><span data-stu-id="ecd98-334">Figure 12 shows the output when attempting to create a user with an insufficiently strong password.</span></span>

<span data-ttu-id="ecd98-335">[![o CreateUserWizard injeta automaticamente os controles de validação](creating-user-accounts-vb/_static/image35.png)](creating-user-accounts-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-335">[![The CreateUserWizard Automatically Injects Validation Controls](creating-user-accounts-vb/_static/image35.png)](creating-user-accounts-vb/_static/image34.png)</span></span>

<span data-ttu-id="ecd98-336">**Figura 12**: O CreateUserWizard injeta automaticamente controles de validação ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-336">**Figure 12**: The CreateUserWizard Automatically Injects Validation Controls ([Click to view full-size image](creating-user-accounts-vb/_static/image36.png))</span></span>

<span data-ttu-id="ecd98-337">Em seguida, insira os valores apropriados no CreateUserWizard e clique no botão criar usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-337">Next, enter appropriate values into the CreateUserWizard and click the Create User button.</span></span> <span data-ttu-id="ecd98-338">Supondo que os campos obrigatórios tenham sido inseridos e a força da senha seja suficiente, o CreateUserWizard criará uma nova conta de usuário por meio da estrutura de associação e, em seguida, exibirá a interface do `CompleteWizardStep`(consulte a Figura 13).</span><span class="sxs-lookup"><span data-stu-id="ecd98-338">Assuming the required fields have been entered and the password's strength is sufficient, the CreateUserWizard will create a new user account through the Membership framework and then display the `CompleteWizardStep`'s interface (see Figure 13).</span></span> <span data-ttu-id="ecd98-339">Nos bastidores, o CreateUserWizard chama o método `Membership.CreateUser`, exatamente como fizemos na etapa 5.</span><span class="sxs-lookup"><span data-stu-id="ecd98-339">Behind the scenes, the CreateUserWizard calls the `Membership.CreateUser` method, just like we did in Step 5.</span></span>

<span data-ttu-id="ecd98-340">[![uma nova conta de usuário foi criada com êxito](creating-user-accounts-vb/_static/image38.png)](creating-user-accounts-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-340">[![A New User Account has Successfully Been Created](creating-user-accounts-vb/_static/image38.png)](creating-user-accounts-vb/_static/image37.png)</span></span>

<span data-ttu-id="ecd98-341">**Figura 13**: Uma nova conta de usuário foi criada com êxito ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-341">**Figure 13**: A New User Account has Successfully Been Created ([Click to view full-size image](creating-user-accounts-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ecd98-342">Como mostra a Figura 13, a interface do `CompleteWizardStep`inclui um botão continuar.</span><span class="sxs-lookup"><span data-stu-id="ecd98-342">As Figure 13 shows, the `CompleteWizardStep`'s interface includes a Continue button.</span></span> <span data-ttu-id="ecd98-343">No entanto, nesse ponto, clicar nele apenas executa um postback, deixando o visitante na mesma página.</span><span class="sxs-lookup"><span data-stu-id="ecd98-343">However, at this point clicking it just performs a postback, leaving the visitor on the same page.</span></span> <span data-ttu-id="ecd98-344">Na personalização da aparência e do comportamento do CreateUserWizard por meio de sua seção Propriedades, veremos como você pode fazer com que esse botão envie o visitante para `Default.aspx` (ou alguma outra página).</span><span class="sxs-lookup"><span data-stu-id="ecd98-344">In the Customizing the CreateUserWizard's Appearance and Behavior Through Its Properties section we will look at how you can have this button send the visitor to `Default.aspx` (or some other page).</span></span>

<span data-ttu-id="ecd98-345">Depois de criar uma nova conta de usuário, retorne ao Visual Studio e examine as `aspnet_Users` e `aspnet_Membership` tabelas como fizemos na Figura 10 para verificar se a conta foi criada com êxito.</span><span class="sxs-lookup"><span data-stu-id="ecd98-345">After creating a new user account, return to Visual Studio and examine the `aspnet_Users` and `aspnet_Membership` tables like we did in Figure 10 to verify that the account was successfully created.</span></span>

### <a name="customizing-the-createuserwizards-behavior-and-appearance-through-its-properties"></a><span data-ttu-id="ecd98-346">Personalizando o comportamento e a aparência do CreateUserWizard por meio de suas propriedades</span><span class="sxs-lookup"><span data-stu-id="ecd98-346">Customizing the CreateUserWizard's Behavior and Appearance Through Its Properties</span></span>

<span data-ttu-id="ecd98-347">O CreateUserWizard pode ser personalizado de várias maneiras, por meio de propriedades, `WizardStep` s e manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="ecd98-347">The CreateUserWizard can be customized in a variety of ways, through properties, `WizardStep` s, and event handlers.</span></span> <span data-ttu-id="ecd98-348">Nesta seção, veremos como personalizar a aparência do controle por meio de suas propriedades; a próxima seção analisa a extensão do comportamento do controle por meio de manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="ecd98-348">In this section we will look at how to customize the control's appearance through its properties; the next section looks at extending the control's behavior through event handlers.</span></span>

<span data-ttu-id="ecd98-349">Praticamente todo o texto exibido na interface do usuário padrão do controle CreateUserWizard pode ser personalizado por meio de sua infinidade de propriedades.</span><span class="sxs-lookup"><span data-stu-id="ecd98-349">Virtually all of the text displayed in the CreateUserWizard control's default user interface can be customized through its plethora of properties.</span></span> <span data-ttu-id="ecd98-350">Por exemplo, os rótulos nome de usuário, senha, confirmar senha, email, pergunta de segurança e resposta de segurança exibidos à esquerda das caixas de correio podem ser personalizados pelas propriedades [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx)e [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ecd98-350">For example, the User Name, Password, Confirm Password, E-mail, Security Question, and Security Answer labels displayed to the left of the textboxes can be customized by the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx), and [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) properties, respectively.</span></span> <span data-ttu-id="ecd98-351">Da mesma forma, há propriedades para especificar o texto para os botões criar usuário e continuar na `CreateUserWizardStep` e `CompleteWizardStep`, bem como se esses botões são renderizados como botões, LinkButtons ou ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="ecd98-351">Likewise, there are properties for specifying the text for the Create User and Continue buttons in the `CreateUserWizardStep` and `CompleteWizardStep`, as well as if these buttons are rendered as Buttons, LinkButtons, or ImageButtons.</span></span>

<span data-ttu-id="ecd98-352">As cores, bordas, fontes e outros elementos visuais são configuráveis por meio de um host de propriedades de estilo.</span><span class="sxs-lookup"><span data-stu-id="ecd98-352">The colors, borders, fonts, and other visual elements are configurable through a host of style properties.</span></span> <span data-ttu-id="ecd98-353">O controle CreateUserWizard em si tem as propriedades comuns de estilo de controle da Web-`BackColor`, `BorderStyle`, `CssClass`, `Font`e assim por diante – e há várias propriedades de estilo para definir a aparência de seções específicas da interface do CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="ecd98-353">The CreateUserWizard control itself has the common Web control style properties - `BackColor`, `BorderStyle`, `CssClass`, `Font`, and so on - and there are a number of style properties for defining the appearance for particular sections of the CreateUserWizard's interface.</span></span> <span data-ttu-id="ecd98-354">A [propriedade`TextBoxStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), por exemplo, define os estilos para as caixas de textno `CreateUserWizardStep`, enquanto a [Propriedade`TitleTextStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) define o estilo do título (Inscreva-se para sua nova conta).</span><span class="sxs-lookup"><span data-stu-id="ecd98-354">The [`TextBoxStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), for instance, defines the styles for the textboxes in the `CreateUserWizardStep`, while the [`TitleTextStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) defines the style for the title ( Sign Up for Your New Account ).</span></span>

<span data-ttu-id="ecd98-355">Além das propriedades relacionadas à aparência, há várias propriedades que afetam o comportamento do controle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="ecd98-355">In addition to the appearance-related properties, there are a number of properties that affect the CreateUserWizard control's behavior.</span></span> <span data-ttu-id="ecd98-356">A [propriedade`DisplayCancelButton`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), se definida como true, exibe um botão Cancelar ao lado do botão criar usuário (o valor padrão é false).</span><span class="sxs-lookup"><span data-stu-id="ecd98-356">The [`DisplayCancelButton` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), if set to True, displays a Cancel button next to the Create User button (the default value is False).</span></span> <span data-ttu-id="ecd98-357">Se você exibir o botão Cancelar, certifique-se também de definir a [propriedade`CancelDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), que especifica a página para a qual o usuário será enviado depois de clicar em cancelar.</span><span class="sxs-lookup"><span data-stu-id="ecd98-357">If you display the Cancel button, be sure to also set the [`CancelDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), which specifies the page the user is sent to after clicking Cancel.</span></span> <span data-ttu-id="ecd98-358">Conforme observado na seção anterior, o botão continuar na interface do `CompleteWizardStep`causa um postback, mas deixa o visitante na mesma página.</span><span class="sxs-lookup"><span data-stu-id="ecd98-358">As noted in the previous section, the Continue button in the `CompleteWizardStep`'s interface causes a postback, but leaves the visitor on the same page.</span></span> <span data-ttu-id="ecd98-359">Para enviar o visitante para alguma outra página depois de clicar no botão continuar, basta especificar a URL na [propriedade`ContinueDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-359">To send the visitor to some other page after clicking the Continue button, simply specify the URL in the [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span>

<span data-ttu-id="ecd98-360">Vamos atualizar o controle CreateUserWizard `RegisterUser` para mostrar um botão Cancelar e enviar o visitante para `Default.aspx` quando os botões cancelar ou continuar forem clicados.</span><span class="sxs-lookup"><span data-stu-id="ecd98-360">Let's update the `RegisterUser` CreateUserWizard control to show a Cancel button and to send the visitor to `Default.aspx` when the Cancel or Continue buttons are clicked.</span></span> <span data-ttu-id="ecd98-361">Para fazer isso, defina a propriedade `DisplayCancelButton` como true e as propriedades `CancelDestinationPageUrl` e `ContinueDestinationPageUrl` como ~/default.aspx.</span><span class="sxs-lookup"><span data-stu-id="ecd98-361">To accomplish this, set the `DisplayCancelButton` property to True and both the `CancelDestinationPageUrl` and `ContinueDestinationPageUrl` properties to ~/Default.aspx.</span></span> <span data-ttu-id="ecd98-362">A Figura 14 mostra o CreateUserWizard atualizado quando exibido por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="ecd98-362">Figure 14 shows the updated CreateUserWizard when viewed through a browser.</span></span>

<span data-ttu-id="ecd98-363">[![o CreateUserWizardStep inclui um botão Cancelar](creating-user-accounts-vb/_static/image41.png)](creating-user-accounts-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-363">[![The CreateUserWizardStep Includes a Cancel Button](creating-user-accounts-vb/_static/image41.png)](creating-user-accounts-vb/_static/image40.png)</span></span>

<span data-ttu-id="ecd98-364">**Figura 14**: O `CreateUserWizardStep` inclui um botão de cancelamento ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-364">**Figure 14**: The `CreateUserWizardStep` Includes a Cancel Button ([Click to view full-size image](creating-user-accounts-vb/_static/image42.png))</span></span>

<span data-ttu-id="ecd98-365">Quando um visitante insere um nome de usuário, uma senha, um endereço de email e uma pergunta e resposta de segurança e clica em Create User, uma nova conta de usuário é criada e o visitante é conectado como aquele usuário recém-criado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-365">When a visitor enters a username, password, email address, and security question and answer and clicks Create User, a new user account is created and the visitor is logged in as that newly created user.</span></span> <span data-ttu-id="ecd98-366">Supondo que a pessoa que visita a página está criando uma nova conta para si mesma, esse é provavelmente o comportamento desejado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-366">Assuming that the person visiting the page is creating a new account for themselves, this is likely the desired behavior.</span></span> <span data-ttu-id="ecd98-367">No entanto, talvez você queira permitir que os administradores adicionem novas contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-367">However, you may want to allow Administrators to add new user accounts.</span></span> <span data-ttu-id="ecd98-368">Ao fazer isso, a conta de usuário seria criada, mas o administrador permaneceria conectado como administrador (e não como a conta recém-criada).</span><span class="sxs-lookup"><span data-stu-id="ecd98-368">In doing so, the user account would be created, but the Administrator would remain logged in as an Administrator (and not as the newly created account).</span></span> <span data-ttu-id="ecd98-369">Esse comportamento pode ser modificado por meio da [Propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx)booliana`LoginCreatedUser`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-369">This behavior can be modified through the Boolean [`LoginCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span>

<span data-ttu-id="ecd98-370">As contas de usuário na estrutura de associação contêm um sinalizador aprovado; os usuários que não estão aprovados não podem fazer logon no site.</span><span class="sxs-lookup"><span data-stu-id="ecd98-370">User accounts in the Membership framework contain an approved flag; users who are not approved are unable to log into the site.</span></span> <span data-ttu-id="ecd98-371">Por padrão, uma conta recém-criada é marcada como aprovada, permitindo que o usuário faça logon no site imediatamente.</span><span class="sxs-lookup"><span data-stu-id="ecd98-371">By default, a newly created account is marked as approved, allowing the user to log into the site immediately.</span></span> <span data-ttu-id="ecd98-372">No entanto, é possível ter novas contas de usuário marcadas como não aprovadas.</span><span class="sxs-lookup"><span data-stu-id="ecd98-372">It is possible, however, to have new user accounts marked as unapproved.</span></span> <span data-ttu-id="ecd98-373">Talvez você queira que um administrador aprove manualmente os novos usuários antes que eles possam fazer logon; ou talvez você queira verificar se o endereço de email inserido na inscrição é válido antes de permitir que um usuário faça logon.</span><span class="sxs-lookup"><span data-stu-id="ecd98-373">Perhaps you want an Administrator to manually approve new users before they can log in; or maybe you want to verify that the email address entered at signup is valid before permitting a user to log on.</span></span> <span data-ttu-id="ecd98-374">Seja qual for o caso, você pode ter a conta de usuário recém-criada marcada como não aprovada definindo a [propriedade de`DisableCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) do controle CreateUserWizard como true (o padrão é false).</span><span class="sxs-lookup"><span data-stu-id="ecd98-374">Whatever the case may be, you can have the newly created user account marked as unapproved by setting the CreateUserWizard control's [`DisableCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) to True (the default is False).</span></span>

<span data-ttu-id="ecd98-375">Outras propriedades relacionadas ao comportamento de observação incluem `AutoGeneratePassword` e `MailDefinition`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-375">Other behavior-related properties of note include `AutoGeneratePassword` and `MailDefinition`.</span></span> <span data-ttu-id="ecd98-376">Se a [propriedade`AutoGeneratePassword`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) for definida como true, a `CreateUserWizardStep` não exibirá as caixas de entrada senha e confirmar senha; em vez disso, a senha do usuário recém criada é gerada automaticamente usando o [método`GeneratePassword`](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx)da classe `Membership`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-376">If the [`AutoGeneratePassword` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) is set to True, the `CreateUserWizardStep` does not display the Password and Confirm Password textboxes; instead, the newly-created user's password is automatically generated using the `Membership` class's [`GeneratePassword` method](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx).</span></span> <span data-ttu-id="ecd98-377">O método `GeneratePassword` constrói uma senha de um comprimento especificado e com um número suficiente de caracteres não alfanuméricos para atender aos requisitos de força de senha configurados.</span><span class="sxs-lookup"><span data-stu-id="ecd98-377">The `GeneratePassword` method constructs a password of a specified length and with a sufficient number of non-alphanumeric characters to satisfy the configured password strength requirements.</span></span>

<span data-ttu-id="ecd98-378">A [propriedade`MailDefinition`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) será útil se você quiser enviar um email para o endereço de email especificado durante o processo de criação de conta.</span><span class="sxs-lookup"><span data-stu-id="ecd98-378">The [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) is useful if you want to send an email to the email address specified during the account creation process.</span></span> <span data-ttu-id="ecd98-379">A propriedade `MailDefinition` inclui uma série de subpropriedades para definir informações sobre a mensagem de email construída.</span><span class="sxs-lookup"><span data-stu-id="ecd98-379">The `MailDefinition` property includes a series of subproperties for defining information about the constructed email message.</span></span> <span data-ttu-id="ecd98-380">Essas subpropriedades incluem opções como `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`e `BodyFileName`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-380">These subproperties include options like `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`, and `BodyFileName`.</span></span> <span data-ttu-id="ecd98-381">A [propriedade`BodyFileName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) aponta para um arquivo de texto ou HTML que contém o corpo da mensagem de email.</span><span class="sxs-lookup"><span data-stu-id="ecd98-381">The [`BodyFileName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) points to a text or HTML file that contains the body for the email message.</span></span> <span data-ttu-id="ecd98-382">O corpo dá suporte a dois espaços reservados predefinidos: `<%UserName%>` e `<%Password%>`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-382">The body supports two pre-defined placeholders: `<%UserName%>` and `<%Password%>`.</span></span> <span data-ttu-id="ecd98-383">Esses espaços reservados, se presentes no arquivo de `BodyFileName`, serão substituídos pelo nome e senha do usuário recém-criado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-383">These placeholders, if present in the `BodyFileName` file, will be replaced with the just-created user's name and password.</span></span>

> [!NOTE]
> <span data-ttu-id="ecd98-384">A propriedade `MailDefinition` do controle de `CreateUserWizard` especifica apenas detalhes sobre a mensagem de email que é enviada quando uma nova conta é criada.</span><span class="sxs-lookup"><span data-stu-id="ecd98-384">The `CreateUserWizard` control's `MailDefinition` property just specifies details about the email message that is sent when a new account is created.</span></span> <span data-ttu-id="ecd98-385">Ele não inclui detalhes sobre como a mensagem de email é realmente enviada (ou seja, se um servidor SMTP ou diretório de recebimento de email é usado, todas as informações de autenticação e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="ecd98-385">It does not include any details on how the email message is actually sent (that is, whether an SMTP server or mail drop directory is used, any authentication information, and so on).</span></span> <span data-ttu-id="ecd98-386">Esses detalhes de baixo nível precisam ser definidos na seção `<system.net>` em `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-386">These low-level details need to be defined in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="ecd98-387">Para obter mais informações sobre essas definições de configuração e sobre como enviar email do ASP.NET 2,0 em geral, consulte as [perguntas frequentes em SystemNetMail.com](http://www.systemnetmail.com/) e meu artigo, [enviando email no ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-387">For more information on these configuration settings and on sending email from ASP.NET 2.0 in general, refer to the [FAQs at SystemNetMail.com](http://www.systemnetmail.com/) and my article, [Sending Email in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>

### <a name="extending-the-createuserwizards-behavior-using-event-handlers"></a><span data-ttu-id="ecd98-388">Estendendo o comportamento do CreateUserWizard usando manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="ecd98-388">Extending the CreateUserWizard's Behavior Using Event Handlers</span></span>

<span data-ttu-id="ecd98-389">O controle CreateUserWizard gera vários eventos durante seu fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ecd98-389">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="ecd98-390">Por exemplo, depois que um visitante inserir seu nome de usuário, senha e outras informações pertinentes e clicar no botão criar usuário, o controle CreateUserWizard gerará seu [evento de`CreatingUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="ecd98-390">For example, after a visitor enters their username, password, and other pertinent information and clicks the Create User button, the CreateUserWizard control raises its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="ecd98-391">Se houver um problema durante o processo de criação, o [evento de`CreateUserError`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) será acionado; no entanto, se o usuário for criado com êxito, o [evento`CreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) será gerado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-391">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="ecd98-392">Há eventos de controle CreateUserWizard adicionais que são gerados, mas esses são os três mais alemão.</span><span class="sxs-lookup"><span data-stu-id="ecd98-392">There are additional CreateUserWizard control events that get raised, but these are the three most germane ones.</span></span>

<span data-ttu-id="ecd98-393">Em determinados cenários, talvez queiramos explorar o fluxo de trabalho CreateUserWizard, que podemos fazer criando um manipulador de eventos para o evento apropriado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-393">In certain scenarios we may want to tap into the CreateUserWizard workflow, which we can do by creating an event handler for the appropriate event.</span></span> <span data-ttu-id="ecd98-394">Para ilustrar isso, vamos aprimorar o controle CreateUserWizard de `RegisterUser` para incluir alguma validação personalizada no nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="ecd98-394">To illustrate this, let's enhance the `RegisterUser` CreateUserWizard control to include some custom validation on the username and password.</span></span> <span data-ttu-id="ecd98-395">Em particular, vamos aprimorar nosso CreateUserWizard para que os nomes de usuário não possam conter espaços à esquerda ou à direita, e o nome de acessador não pode aparecer em nenhum lugar da senha.</span><span class="sxs-lookup"><span data-stu-id="ecd98-395">In particular, let's enhance our CreateUserWizard so that usernames cannot contain leading or trailing spaces and the username cannot appear anywhere in the password.</span></span> <span data-ttu-id="ecd98-396">Em suma, queremos impedir que alguém crie um nome de usuário como "Scott" ou tenha uma combinação de nome de usuário/senha como Scott e Scott. 1234.</span><span class="sxs-lookup"><span data-stu-id="ecd98-396">In short, we want to prevent someone from creating a username like "Scott ", or having a username/password combination like Scott and Scott.1234 .</span></span>

<span data-ttu-id="ecd98-397">Para fazer isso, criaremos um manipulador de eventos para o evento `CreatingUser` para executar nossas verificações de validação extras.</span><span class="sxs-lookup"><span data-stu-id="ecd98-397">To accomplish this we will create an event handler for the `CreatingUser` event to perform our extra validation checks.</span></span> <span data-ttu-id="ecd98-398">Se os dados fornecidos não forem válidos, será necessário cancelar o processo de criação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-398">If the supplied data is not valid we need to cancel the creation process.</span></span> <span data-ttu-id="ecd98-399">Também precisamos adicionar um controle rótulo da Web à página para exibir uma mensagem explicando que o nome de usuário ou a senha são inválidos.</span><span class="sxs-lookup"><span data-stu-id="ecd98-399">We also need to add a Label Web control to the page to display a message explaining that the username or password is invalid.</span></span> <span data-ttu-id="ecd98-400">Comece adicionando um controle rótulo abaixo do controle CreateUserWizard, definindo sua propriedade `ID` como `InvalidUserNameOrPasswordMessage` e sua propriedade `ForeColor` como `Red`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-400">Start by adding a Label control beneath the CreateUserWizard control, setting its `ID` property to `InvalidUserNameOrPasswordMessage` and its `ForeColor` property to `Red`.</span></span> <span data-ttu-id="ecd98-401">Desmarque sua propriedade `Text` e defina suas propriedades `EnableViewState` e `Visible` como false.</span><span class="sxs-lookup"><span data-stu-id="ecd98-401">Clear out its `Text` property and set its `EnableViewState` and `Visible` properties to False.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample7.aspx)]

<span data-ttu-id="ecd98-402">Em seguida, crie um manipulador de eventos para o evento de `CreatingUser` do controle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="ecd98-402">Next, create an event handler for the CreateUserWizard control's `CreatingUser` event.</span></span> <span data-ttu-id="ecd98-403">Para criar um manipulador de eventos, selecione o controle no designer e, em seguida, vá para a janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="ecd98-403">To create an event handler, select the control in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="ecd98-404">A partir daí, clique no ícone de raio e clique duas vezes no evento apropriado para criar o manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ecd98-404">From there, click on the lightning bolt icon and then double-click the appropriate event to create the event handler.</span></span>

<span data-ttu-id="ecd98-405">Adicione o seguinte código ao manipulador de eventos do `CreatingUser`:</span><span class="sxs-lookup"><span data-stu-id="ecd98-405">Add the following code to the `CreatingUser` event handler:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample8.vb)]

<span data-ttu-id="ecd98-406">Observe que o nome de usuário e a senha inseridos no controle CreateUserWizard estão disponíveis por meio de suas propriedades [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) e [`Password`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ecd98-406">Note that the username and password entered into the CreateUserWizard control are available through its [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectively.</span></span> <span data-ttu-id="ecd98-407">Usamos essas propriedades no manipulador de eventos acima para determinar se o nome de usuário fornecido contém espaços à esquerda ou à direita e se o nome de usuário é encontrado dentro da senha.</span><span class="sxs-lookup"><span data-stu-id="ecd98-407">We use these properties in the above event handler to determine whether the supplied username contains leading or trailing spaces and whether the username is found within the password.</span></span> <span data-ttu-id="ecd98-408">Se uma dessas condições for atendida, uma mensagem de erro será exibida no rótulo `InvalidUserNameOrPasswordMessage` e a propriedade `e.Cancel` do manipulador de eventos será definida como `True`.</span><span class="sxs-lookup"><span data-stu-id="ecd98-408">If either of these conditions is met, an error message is displayed in the `InvalidUserNameOrPasswordMessage` Label and the event handler's `e.Cancel` property is set to `True`.</span></span> <span data-ttu-id="ecd98-409">Se `e.Cancel` for definido como `True`, o CreateUserWizard de curto-Circuit seu fluxo de trabalho, cancelando efetivamente o processo de criação da conta do usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-409">If `e.Cancel` is set to `True`, the CreateUserWizard short-circuits its workflow, effectively cancelling the user account creation process.</span></span>

<span data-ttu-id="ecd98-410">A Figura 15 mostra uma captura de tela de `CreatingUserAccounts.aspx` quando o usuário insere um nome de usuário com espaços à esquerda.</span><span class="sxs-lookup"><span data-stu-id="ecd98-410">Figure 15 shows a screen shot of `CreatingUserAccounts.aspx` when the user enters a username with leading spaces.</span></span>

<span data-ttu-id="ecd98-411">[Não são permitidos ![nomes de acessados com espaços à esquerda ou à direita](creating-user-accounts-vb/_static/image44.png)](creating-user-accounts-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="ecd98-411">[![Usernames with Leading or Trailing Spaces are not Permitted](creating-user-accounts-vb/_static/image44.png)](creating-user-accounts-vb/_static/image43.png)</span></span>

<span data-ttu-id="ecd98-412">**Figura 15**: Não são permitidos nomes de acessados com espaços à esquerda ou à direita ([clique para exibir a imagem em tamanho normal](creating-user-accounts-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="ecd98-412">**Figure 15**: Usernames with Leading or Trailing Spaces are not Permitted ([Click to view full-size image](creating-user-accounts-vb/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ecd98-413">Veremos um exemplo de como usar o evento de `CreatedUser` do controle CreateUserWizard no tutorial *<a id="_msoanchor_11"></a>[armazenamento de informações adicionais do usuário](storing-additional-user-information-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="ecd98-413">We will see an example of using the CreateUserWizard control's `CreatedUser` event in the *<a id="_msoanchor_11"></a>[Storing Additional User Information](storing-additional-user-information-vb.md)* tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="ecd98-414">Resumo</span><span class="sxs-lookup"><span data-stu-id="ecd98-414">Summary</span></span>

<span data-ttu-id="ecd98-415">O método `CreateUser` da classe `Membership` cria uma nova conta de usuário na estrutura de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-415">The `Membership` class's `CreateUser` method creates a new user account in the Membership framework.</span></span> <span data-ttu-id="ecd98-416">Ele faz isso delegando a chamada para o provedor de associação configurado.</span><span class="sxs-lookup"><span data-stu-id="ecd98-416">It does so by delegating the call to the configured Membership provider.</span></span> <span data-ttu-id="ecd98-417">No caso do `SqlMembershipProvider`, o método `CreateUser` adiciona um registro às tabelas `aspnet_Users` e `aspnet_Membership` banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ecd98-417">In the case of the `SqlMembershipProvider`, the `CreateUser` method adds a record to the `aspnet_Users` and `aspnet_Membership` database tables.</span></span>

<span data-ttu-id="ecd98-418">Embora novas contas de usuário possam ser criadas programaticamente (como vimos na etapa 5), uma abordagem mais rápida e fácil é usar o controle CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="ecd98-418">While new user accounts can be created programmatically (as we saw in Step 5), a faster and easier approach is to use the CreateUserWizard control.</span></span> <span data-ttu-id="ecd98-419">Esse controle renderiza uma interface do usuário de várias etapas para coletar informações do usuário e criar um novo usuário na estrutura de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-419">This control renders a multi-step user interface for collecting user information and creating a new user in the Membership framework.</span></span> <span data-ttu-id="ecd98-420">Nos bastidores, esse controle usa o mesmo método `Membership.CreateUser`, conforme examinado na etapa 5, mas o controle cria a interface do usuário, controles de validação e responde a erros de criação de conta de usuário sem precisar escrever uma lique de código.</span><span class="sxs-lookup"><span data-stu-id="ecd98-420">Underneath the covers, this control uses the same `Membership.CreateUser` method as examined in Step 5, but the control creates the user interface, validation controls, and responds to user account creation errors without having to write a lick of code.</span></span>

<span data-ttu-id="ecd98-421">Neste ponto, temos a funcionalidade em vigor para criar novas contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="ecd98-421">At this point we have the functionality in place to create new user accounts.</span></span> <span data-ttu-id="ecd98-422">No entanto, a página de logon ainda está validando as credenciais embutidas em código que especificamos de volta no segundo tutorial.</span><span class="sxs-lookup"><span data-stu-id="ecd98-422">However, the login page still is validating against those hard-coded credentials we specified back in the second tutorial.</span></span> <span data-ttu-id="ecd98-423"><a id="_msoanchor_12"> </a>No [próximo tutorial](validating-user-credentials-against-the-membership-user-store-vb.md) , atualizaremos `Login.aspx` para validar as credenciais fornecidas pelo usuário em relação à estrutura de associação.</span><span class="sxs-lookup"><span data-stu-id="ecd98-423">In the <a id="_msoanchor_12"></a>[next tutorial](validating-user-credentials-against-the-membership-user-store-vb.md) we will update `Login.aspx` to validate the user's supplied credentials against the Membership framework.</span></span>

<span data-ttu-id="ecd98-424">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="ecd98-424">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="ecd98-425">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="ecd98-425">Further Reading</span></span>

<span data-ttu-id="ecd98-426">Para obter mais informações sobre os tópicos discutidos neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="ecd98-426">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ecd98-427">Documentação técnica do `CreateUser`</span><span class="sxs-lookup"><span data-stu-id="ecd98-427">`CreateUser` Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.security.membershipprovider.createuser.aspx)
- [<span data-ttu-id="ecd98-428">Visão geral do controle CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="ecd98-428">CreateUserWizard Control Overview</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)
- [<span data-ttu-id="ecd98-429">Criando um provedor de mapa do site baseado no sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="ecd98-429">Creating a File System-Based Site Map Provider</span></span>](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)
- [<span data-ttu-id="ecd98-430">Criando uma interface do usuário passo a passo com o controle do assistente ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="ecd98-430">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="ecd98-431">Examinando a navegação do site do ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="ecd98-431">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="ecd98-432">Páginas mestras e navegação do site</span><span class="sxs-lookup"><span data-stu-id="ecd98-432">Master Pages and Site Navigation</span></span>](https://asp.net/learn/data-access/tutorial-03-vb.aspx)
- [<span data-ttu-id="ecd98-433">O provedor de mapa do site do SQL que você está esperando</span><span class="sxs-lookup"><span data-stu-id="ecd98-433">The SQL Site Map Provider You've Been Waiting For</span></span>](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="ecd98-434">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="ecd98-434">About the Author</span></span>

<span data-ttu-id="ecd98-435">Scott Mitchell, autor de vários livros sobre ASP/ASP. NET e fundador da 4GuysFromRolla.com, tem trabalhado com tecnologias Web da Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="ecd98-435">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ecd98-436">Scott trabalha como consultor, instrutor e escritor independentes.</span><span class="sxs-lookup"><span data-stu-id="ecd98-436">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ecd98-437">Seu livro mais recente é que a *[Sams ensina a ASP.NET 2,0 em 24 horas](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="ecd98-437">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="ecd98-438">Scott pode ser contatado em [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) ou por meio de seu blog em [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="ecd98-438">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="ecd98-439">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="ecd98-439">Special Thanks To</span></span>

<span data-ttu-id="ecd98-440">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="ecd98-440">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ecd98-441">O revisor de Lead para este tutorial foi Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="ecd98-441">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="ecd98-442">Está interessado em revisar meus artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="ecd98-442">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ecd98-443">Em caso afirmativo, solte-me uma linha em [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span><span class="sxs-lookup"><span data-stu-id="ecd98-443">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ecd98-444">[Anterior](creating-the-membership-schema-in-sql-server-vb.md)
> [Próximo](validating-user-credentials-against-the-membership-user-store-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ecd98-444">[Previous](creating-the-membership-schema-in-sql-server-vb.md)
[Next](validating-user-credentials-against-the-membership-user-store-vb.md)</span></span>
