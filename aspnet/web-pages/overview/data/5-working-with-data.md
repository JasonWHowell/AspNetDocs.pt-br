---
uid: web-pages/overview/data/5-working-with-data
title: Introdução ao trabalho com um banco de dados em sites Páginas da Web do ASP.NET (Razor) | Microsoft Docs
author: Rick-Anderson
description: Este capítulo descreve como acessar dados de um banco de dado e exibi-los usando Páginas da Web do ASP.NET.
ms.author: riande
ms.date: 02/18/2014
ms.assetid: 673d502f-2c16-4a6f-bb63-dbfd9a77ef47
msc.legacyurl: /web-pages/overview/data/5-working-with-data
msc.type: authoredcontent
ms.openlocfilehash: 45e988d037465e59ad352bb9444af2c69fd3cd70
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78586530"
---
# <a name="introduction-to-working-with-a-database-in-aspnet-web-pages-razor-sites"></a><span data-ttu-id="e3dc4-103">Introdução ao trabalho com um banco de dados em sites Páginas da Web do ASP.NET (Razor)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-103">Introduction to Working with a Database in ASP.NET Web Pages (Razor) Sites</span></span>

<span data-ttu-id="e3dc4-104">por [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="e3dc4-105">Este artigo descreve como usar as ferramentas do Microsoft WebMatrix para criar um banco de dados em um site Páginas da Web do ASP.NET (Razor) e como criar páginas que permitem exibir, adicionar, editar e excluir dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-105">This article describes how to use Microsoft WebMatrix tools to create a database in an ASP.NET Web Pages (Razor) website, and how to create pages that let you display, add, edit, and delete data.</span></span>
> 
> <span data-ttu-id="e3dc4-106">**O que você aprenderá:**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-106">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="e3dc4-107">Como criar um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-107">How to create a database.</span></span>
> - <span data-ttu-id="e3dc4-108">Como se conectar a um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-108">How to connect to a database.</span></span>
> - <span data-ttu-id="e3dc4-109">Como exibir dados em uma página da Web.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-109">How to display data in a web page.</span></span>
> - <span data-ttu-id="e3dc4-110">Como inserir, atualizar e excluir registros de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-110">How to insert, update, and delete database records.</span></span>
> 
> <span data-ttu-id="e3dc4-111">Estes são os recursos apresentados no artigo:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-111">These are the features introduced in the article:</span></span>
> 
> - <span data-ttu-id="e3dc4-112">Trabalhando com um banco de dados do Microsoft SQL Server Compact Edition.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-112">Working with a Microsoft SQL Server Compact Edition database.</span></span>
> - <span data-ttu-id="e3dc4-113">Trabalhando com consultas SQL.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-113">Working with SQL queries.</span></span>
> - <span data-ttu-id="e3dc4-114">A classe `Database`.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-114">The `Database` class.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="e3dc4-115">Versões de software usadas no tutorial</span><span class="sxs-lookup"><span data-stu-id="e3dc4-115">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="e3dc4-116">Páginas da Web do ASP.NET (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="e3dc4-116">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="e3dc4-117">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="e3dc4-117">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="e3dc4-118">Este tutorial também funciona com o WebMatrix 3.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-118">This tutorial also works with WebMatrix 3.</span></span> <span data-ttu-id="e3dc4-119">Você pode usar Páginas da Web do ASP.NET 3 e Visual Studio 2013 (ou Visual Studio Express 2013 para Web); no entanto, a interface do usuário será diferente.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-119">You can use ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web); however, the user interface will be different.</span></span>

## <a name="introduction-to-databases"></a><span data-ttu-id="e3dc4-120">Introdução aos bancos de dados</span><span class="sxs-lookup"><span data-stu-id="e3dc4-120">Introduction to Databases</span></span>

<span data-ttu-id="e3dc4-121">Imagine um catálogo de endereços típico.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-121">Imagine a typical address book.</span></span> <span data-ttu-id="e3dc4-122">Para cada entrada no catálogo de endereços (ou seja, para cada pessoa), você tem várias informações, como nome, sobrenome, endereço, endereço de email e número de telefone.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-122">For each entry in the address book (that is, for each person) you have several pieces of information such as first name, last name, address, email address, and phone number.</span></span>

<span data-ttu-id="e3dc4-123">Uma maneira comum de imagem de dados como essa é uma tabela com linhas e colunas.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-123">A typical way to picture data like this is as a table with rows and columns.</span></span> <span data-ttu-id="e3dc4-124">Em termos de banco de dados, cada linha é geralmente chamada de registro.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-124">In database terms, each row is often referred to as a record.</span></span> <span data-ttu-id="e3dc4-125">Cada coluna (às vezes conhecida como campos) contém um valor para cada tipo de dados: nome, sobrenome e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-125">Each column (sometimes referred to as fields) contains a value for each type of data: first name, last name, and so on.</span></span>

| <span data-ttu-id="e3dc4-126">**ID**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-126">**ID**</span></span> | <span data-ttu-id="e3dc4-127">**Nome**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-127">**FirstName**</span></span> | <span data-ttu-id="e3dc4-128">**Sobrenome**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-128">**LastName**</span></span> | <span data-ttu-id="e3dc4-129">**Endereço**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-129">**Address**</span></span> | <span data-ttu-id="e3dc4-130">**Email**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-130">**Email**</span></span> | <span data-ttu-id="e3dc4-131">**Telefone**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-131">**Phone**</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="e3dc4-132">1</span><span class="sxs-lookup"><span data-stu-id="e3dc4-132">1</span></span> | <span data-ttu-id="e3dc4-133">Jim</span><span class="sxs-lookup"><span data-stu-id="e3dc4-133">Jim</span></span> | <span data-ttu-id="e3dc4-134">Abrus</span><span class="sxs-lookup"><span data-stu-id="e3dc4-134">Abrus</span></span> | <span data-ttu-id="e3dc4-135">210 100º St SE orcas WA 98031</span><span class="sxs-lookup"><span data-stu-id="e3dc4-135">210 100th St SE Orcas WA 98031</span></span> | jim@contoso.com | <span data-ttu-id="e3dc4-136">555 0100</span><span class="sxs-lookup"><span data-stu-id="e3dc4-136">555 0100</span></span> |
| <span data-ttu-id="e3dc4-137">2</span><span class="sxs-lookup"><span data-stu-id="e3dc4-137">2</span></span> | <span data-ttu-id="e3dc4-138">Terry</span><span class="sxs-lookup"><span data-stu-id="e3dc4-138">Terry</span></span> | <span data-ttu-id="e3dc4-139">Adams</span><span class="sxs-lookup"><span data-stu-id="e3dc4-139">Adams</span></span> | <span data-ttu-id="e3dc4-140">1234 principal St. Seattle WA 99011</span><span class="sxs-lookup"><span data-stu-id="e3dc4-140">1234 Main St. Seattle WA 99011</span></span> | terry@cohowinery.com | <span data-ttu-id="e3dc4-141">555 0101</span><span class="sxs-lookup"><span data-stu-id="e3dc4-141">555 0101</span></span> |

<span data-ttu-id="e3dc4-142">Para a maioria das tabelas de banco de dados, a tabela deve ter uma coluna que contenha um identificador exclusivo, como um número de cliente, um número de conta, etc. Isso é conhecido como a *chave primária*da tabela e você o usa para identificar cada linha na tabela.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-142">For most database tables, the table has to have a column that contains a unique identifier, like a customer number, account number, etc. This is known as the table's *primary key*, and you use it to identify each row in the table.</span></span> <span data-ttu-id="e3dc4-143">No exemplo, a coluna ID é a chave primária para o catálogo de endereços.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-143">In the example, the ID column is the primary key for the address book.</span></span>

<span data-ttu-id="e3dc4-144">Com essa compreensão básica dos bancos de dados, você está pronto para aprender a criar um banco de dados simples e executar operações, como adicionar, modificar e excluir.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-144">With this basic understanding of databases, you're ready to learn how to create a simple database and perform operations such as adding, modifying, and deleting data.</span></span>

> [!TIP] 
> 
> <span data-ttu-id="e3dc4-145">**Bancos de dados relacionais**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-145">**Relational Databases**</span></span>
> 
> <span data-ttu-id="e3dc4-146">Você pode armazenar dados de várias maneiras, incluindo arquivos de texto e planilhas.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-146">You can store data in lots of ways, including text files and spreadsheets.</span></span> <span data-ttu-id="e3dc4-147">No entanto, para a maioria dos usos comerciais, os dados são armazenados em um banco de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-147">For most business uses, though, data is stored in a relational database.</span></span>
> 
> <span data-ttu-id="e3dc4-148">Este artigo não se aprofunda muito em bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-148">This article doesn't go very deeply into databases.</span></span> <span data-ttu-id="e3dc4-149">No entanto, pode ser útil entender um pouco sobre eles.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-149">However, you might find it useful to understand a little about them.</span></span> <span data-ttu-id="e3dc4-150">Em um banco de dados relacional, as informações são divididas logicamente em tabelas separadas.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-150">In a relational database, information is logically divided into separate tables.</span></span> <span data-ttu-id="e3dc4-151">Por exemplo, um banco de dados para uma escola pode conter tabelas separadas para estudantes e ofertas de classe.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-151">For example, a database for a school might contain separate tables for students and for class offerings.</span></span> <span data-ttu-id="e3dc4-152">O software de banco de dados (como SQL Server) oferece suporte a comandos poderosos que permitem estabelecer relações dinamicamente entre as tabelas.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-152">The database software (such as SQL Server) supports powerful commands that let you dynamically establish relationships between the tables.</span></span> <span data-ttu-id="e3dc4-153">Por exemplo, você pode usar o banco de dados relacional para estabelecer uma relação lógica entre alunos e classes a fim de criar uma agenda.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-153">For example, you can use the relational database to establish a logical relationship between students and classes in order to create a schedule.</span></span> <span data-ttu-id="e3dc4-154">O armazenamento de dados em tabelas separadas reduz a complexidade da estrutura da tabela e reduz a necessidade de manter dados redundantes em tabelas.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-154">Storing data in separate tables reduces the complexity of the table structure and reduces the need to keep redundant data in tables.</span></span>

## <a name="creating-a-database"></a><span data-ttu-id="e3dc4-155">Criar um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e3dc4-155">Creating a Database</span></span>

<span data-ttu-id="e3dc4-156">Este procedimento mostra como criar um banco de dados chamado SmallBakery usando a ferramenta de design de banco de dados SQL Server Compact que está incluída no WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-156">This procedure shows you how to create a database named SmallBakery by using the SQL Server Compact Database design tool that's included in WebMatrix.</span></span> <span data-ttu-id="e3dc4-157">Embora você possa criar um banco de dados usando código, é mais comum criar o banco de dados e as tabelas de banco de dados usando uma ferramenta de design como o WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-157">Although you can create a database using code, it's more typical to create the database and database tables using a design tool like WebMatrix.</span></span>

1. <span data-ttu-id="e3dc4-158">Inicie o WebMatrix e, na página Início Rápido, clique em **site do modelo**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-158">Start WebMatrix, and on the Quick Start page, click **Site From Template**.</span></span>
2. <span data-ttu-id="e3dc4-159">Selecione **site vazio**e, na caixa **nome do site** , digite "SmallBakery" e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-159">Select **Empty Site**, and in the **Site Name** box enter "SmallBakery" and then click **OK**.</span></span> <span data-ttu-id="e3dc4-160">O site é criado e exibido no WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-160">The site is created and displayed in WebMatrix.</span></span>
3. <span data-ttu-id="e3dc4-161">No painel esquerdo, clique no espaço de trabalho **bancos de dados** .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-161">In the left pane, click the **Databases** workspace.</span></span>
4. <span data-ttu-id="e3dc4-162">Na faixa de faixas, clique em **novo banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-162">In the ribbon, click **New Database**.</span></span> <span data-ttu-id="e3dc4-163">Um banco de dados vazio é criado com o mesmo nome do seu site.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-163">An empty database is created with the same name as your site.</span></span>
5. <span data-ttu-id="e3dc4-164">No painel esquerdo, expanda o nó **SmallBakery. sdf** e clique em **tabelas**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-164">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
6. <span data-ttu-id="e3dc4-165">Na faixa de faixas, clique em **nova tabela**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-165">In the ribbon, click **New Table**.</span></span> <span data-ttu-id="e3dc4-166">O WebMatrix abre o designer de tabela.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-166">WebMatrix opens the table designer.</span></span>

    ![[imagem]](5-working-with-data/_static/image1.jpg)
7. <span data-ttu-id="e3dc4-168">Clique na coluna **nome** e insira &quot;ID&quot;.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-168">Click in the **Name** column and enter &quot;Id&quot;.</span></span>
8. <span data-ttu-id="e3dc4-169">Na coluna **tipo de dados** , selecione **int**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-169">In the **Data Type** column, select **int**.</span></span>
9. <span data-ttu-id="e3dc4-170">Define a **chave primária?** e **está identificando?** opções para **Sim**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-170">Set the **Is Primary Key?** and **Is Identify?** options to **Yes**.</span></span>

    <span data-ttu-id="e3dc4-171">Como o nome sugere, a **chave primária** informa ao banco de dados que essa será a chave primária da tabela.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-171">As the name suggests, **Is Primary Key** tells the database that this will be the table's primary key.</span></span> <span data-ttu-id="e3dc4-172">**Is Identity** diz ao banco de dados para criar automaticamente um número de identificação para cada novo registro e atribuir a ele o próximo número sequencial (começando em 1).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-172">**Is Identity** tells the database to automatically create an ID number for every new record and to assign it the next sequential number (starting at 1).</span></span>
10. <span data-ttu-id="e3dc4-173">Clique na próxima linha.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-173">Click in the next row.</span></span> <span data-ttu-id="e3dc4-174">O editor inicia uma nova definição de coluna.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-174">The editor starts a new column definition.</span></span>
11. <span data-ttu-id="e3dc4-175">Para o valor de nome, insira &quot;nome&quot;.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-175">For the Name value, enter &quot;Name&quot;.</span></span>
12. <span data-ttu-id="e3dc4-176">Para **tipo de dados**, escolha &quot;nvarchar&quot; e defina o comprimento como 50.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-176">For **Data Type**, choose &quot;nvarchar&quot; and set the length to 50.</span></span> <span data-ttu-id="e3dc4-177">A parte de *var* de `nvarchar` informa ao banco de dados que o dado para essa coluna será uma cadeia de caracteres cujo tamanho pode variar de registro para registro.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-177">The *var* part of `nvarchar` tells the database that the data for this column will be a string whose size might vary from record to record.</span></span> <span data-ttu-id="e3dc4-178">(O prefixo *n* representa *National*, indicando que o campo pode conter dados de caractere que representem qualquer alfabeto &#8212; ou sistema de escrita, que o campo contém dados Unicode.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-178">(The *n* prefix represents *national*, indicating that the field can hold character data that represents any alphabet or writing system &#8212; that is, that the field holds Unicode data.)</span></span>
13. <span data-ttu-id="e3dc4-179">Defina a opção **permitir nulos** como **não**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-179">Set the **Allow Nulls** option to **No**.</span></span> <span data-ttu-id="e3dc4-180">Isso irá impor que a coluna de *nome* não seja deixada em branco.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-180">This will enforce that the *Name* column is not left blank.</span></span>
14. <span data-ttu-id="e3dc4-181">Usando esse mesmo processo, crie uma coluna chamada *Descrição*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-181">Using this same process, create a column named *Description*.</span></span> <span data-ttu-id="e3dc4-182">Defina o **tipo de dados** como "nvarchar" e 50 para o comprimento e defina **permitir nulos** como falso.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-182">Set **Data Type** to "nvarchar" and 50 for the length, and set **Allow Nulls** to false.</span></span>
15. <span data-ttu-id="e3dc4-183">Crie uma coluna denominada *Price*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-183">Create a column named *Price*.</span></span> <span data-ttu-id="e3dc4-184">Defina o **tipo de dados como "Money"** e defina **permitir nulos** como false.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-184">Set **Data Type to "money"** and set **Allow Nulls** to false.</span></span>
16. <span data-ttu-id="e3dc4-185">Na caixa na parte superior, nomeie a tabela &quot;produto&quot;.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-185">In the box at the top, name the table &quot;Product&quot;.</span></span>

    <span data-ttu-id="e3dc4-186">Quando terminar, a definição terá a seguinte aparência:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-186">When you're done, the definition will look like this:</span></span>

    ![[imagem]](5-working-with-data/_static/image2.png)
17. <span data-ttu-id="e3dc4-188">Pressione Ctrl + S para salvar a tabela.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-188">Press Ctrl+S to save the table.</span></span>

## <a name="adding-data-to-the-database"></a><span data-ttu-id="e3dc4-189">Adicionando dados ao banco de dado</span><span class="sxs-lookup"><span data-stu-id="e3dc4-189">Adding Data to the Database</span></span>

<span data-ttu-id="e3dc4-190">Agora você pode adicionar alguns dados de exemplo ao banco de dado com o qual você trabalhará posteriormente neste artigo.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-190">Now you can add some sample data to your database that you'll work with later in the article.</span></span>

1. <span data-ttu-id="e3dc4-191">No painel esquerdo, expanda o nó **SmallBakery. sdf** e clique em **tabelas**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-191">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
2. <span data-ttu-id="e3dc4-192">Clique com o botão direito do mouse na tabela Product e clique em **Data**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-192">Right-click the Product table and then click **Data**.</span></span>
3. <span data-ttu-id="e3dc4-193">No painel Editar, insira os seguintes registros:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-193">In the edit pane, enter the following records:</span></span>

    | <span data-ttu-id="e3dc4-194">**Nome**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-194">**Name**</span></span> | <span data-ttu-id="e3dc4-195">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-195">**Description**</span></span> | <span data-ttu-id="e3dc4-196">**Preço**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-196">**Price**</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="e3dc4-197">Pão</span><span class="sxs-lookup"><span data-stu-id="e3dc4-197">Bread</span></span> | <span data-ttu-id="e3dc4-198">Inclusas atualizado todos os dias.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-198">Baked fresh every day.</span></span> | <span data-ttu-id="e3dc4-199">2,99</span><span class="sxs-lookup"><span data-stu-id="e3dc4-199">2.99</span></span> |
    | <span data-ttu-id="e3dc4-200">Shortcake de morango</span><span class="sxs-lookup"><span data-stu-id="e3dc4-200">Strawberry Shortcake</span></span> | <span data-ttu-id="e3dc4-201">Feito com morangos orgânica de nosso jardim.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-201">Made with organic strawberries from our garden.</span></span> | <span data-ttu-id="e3dc4-202">9.99</span><span class="sxs-lookup"><span data-stu-id="e3dc4-202">9.99</span></span> |
    | <span data-ttu-id="e3dc4-203">Pizza da Apple</span><span class="sxs-lookup"><span data-stu-id="e3dc4-203">Apple Pie</span></span> | <span data-ttu-id="e3dc4-204">Segundo somente na pizza da sua mãe.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-204">Second only to your mom's pie.</span></span> | <span data-ttu-id="e3dc4-205">12.99</span><span class="sxs-lookup"><span data-stu-id="e3dc4-205">12.99</span></span> |
    | <span data-ttu-id="e3dc4-206">Pizza pecan</span><span class="sxs-lookup"><span data-stu-id="e3dc4-206">Pecan Pie</span></span> | <span data-ttu-id="e3dc4-207">Se você gosta de pecans, isso é para você.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-207">If you like pecans, this is for you.</span></span> | <span data-ttu-id="e3dc4-208">10.99</span><span class="sxs-lookup"><span data-stu-id="e3dc4-208">10.99</span></span> |
    | <span data-ttu-id="e3dc4-209">Pizza de casca de limão</span><span class="sxs-lookup"><span data-stu-id="e3dc4-209">Lemon Pie</span></span> | <span data-ttu-id="e3dc4-210">Feito com as melhores Limãos do mundo.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-210">Made with the best lemons in the world.</span></span> | <span data-ttu-id="e3dc4-211">11.99</span><span class="sxs-lookup"><span data-stu-id="e3dc4-211">11.99</span></span> |
    | <span data-ttu-id="e3dc4-212">Cupcakes</span><span class="sxs-lookup"><span data-stu-id="e3dc4-212">Cupcakes</span></span> | <span data-ttu-id="e3dc4-213">Seus filhos e o infantil em vocês vão adorar isso.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-213">Your kids and the kid in you will love these.</span></span> | <span data-ttu-id="e3dc4-214">7.99</span><span class="sxs-lookup"><span data-stu-id="e3dc4-214">7.99</span></span> |

    <span data-ttu-id="e3dc4-215">Lembre-se de que você não precisa inserir nada para a coluna de *ID* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-215">Remember that you don't have to enter anything for the *Id* column.</span></span> <span data-ttu-id="e3dc4-216">Quando você criou a coluna *ID* , você define sua propriedade **Identity** como true, o que faz com que ela seja preenchida automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-216">When you created the *Id* column, you set its **Is Identity** property to true, which causes it to automatically be filled in.</span></span>

    <span data-ttu-id="e3dc4-217">Quando você terminar de inserir os dados, o designer de tabela terá a seguinte aparência:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-217">When you're finished entering the data, the table designer will look like this:</span></span>

    ![[imagem]](5-working-with-data/_static/image3.jpg)
4. <span data-ttu-id="e3dc4-219">Feche a guia que contém os dados do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-219">Close the tab that contains the database data.</span></span>

## <a name="displaying-data-from-a-database"></a><span data-ttu-id="e3dc4-220">Exibindo dados de um banco</span><span class="sxs-lookup"><span data-stu-id="e3dc4-220">Displaying Data from a Database</span></span>

<span data-ttu-id="e3dc4-221">Uma vez que você tenha um banco de dados com um, você pode exibir os dados em uma página da Web do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-221">Once you've got a database with data in it, you can display the data in an ASP.NET web page.</span></span> <span data-ttu-id="e3dc4-222">Para selecionar as linhas da tabela a serem exibidas, use uma instrução SQL, que é um comando que você passa para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-222">To select the table rows to display, you use a SQL statement, which is a command that you pass to the database.</span></span>

1. <span data-ttu-id="e3dc4-223">No painel esquerdo, clique no espaço de trabalho **arquivos** .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-223">In the left pane, click the **Files** workspace.</span></span>
2. <span data-ttu-id="e3dc4-224">Na raiz do site, crie uma nova página CSHTML chamada *ListProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-224">In the root of the website, create a new CSHTML page named *ListProducts.cshtml*.</span></span>
3. <span data-ttu-id="e3dc4-225">Substitua a marcação existente pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-225">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample1.cshtml)]

    <span data-ttu-id="e3dc4-226">No primeiro bloco de código, você abre o arquivo *SmallBakery. sdf* (banco de dados) que você criou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-226">In the first code block, you open the *SmallBakery.sdf* file (database) that you created earlier.</span></span> <span data-ttu-id="e3dc4-227">O método `Database.Open` pressupõe que o arquivo *. sdf* esteja na pasta de *dados do aplicativo\_* do seu site.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-227">The `Database.Open` method assumes that the *.sdf* file is in your website's *App\_Data* folder.</span></span> <span data-ttu-id="e3dc4-228">(Observe que você não precisa especificar a &#8212; extensão *. sdf* na verdade, se você fizer isso, o método `Open` não funcionará.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-228">(Notice that you don't need to specify the *.sdf* extension &#8212; in fact, if you do, the `Open` method won't work.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="e3dc4-229">A pasta de *dados de\_de aplicativo* é uma pasta especial no ASP.NET que é usada para armazenar arquivos de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-229">The *App\_Data* folder is a special folder in ASP.NET that's used to store data files.</span></span> <span data-ttu-id="e3dc4-230">Para obter mais informações, consulte [conectar-se a um banco de dados](#SB_ConnectingToADatabase) mais adiante neste artigo.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-230">For more information, see [Connecting to a Database](#SB_ConnectingToADatabase) later in this article.</span></span>

    <span data-ttu-id="e3dc4-231">Em seguida, faça uma solicitação para consultar o banco de dados usando a seguinte instrução SQL `Select`:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-231">You then make a request to query the database using the following SQL `Select` statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample2.sql)]

    <span data-ttu-id="e3dc4-232">Na instrução, `Product` identifica a tabela a ser consultada.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-232">In the statement, `Product` identifies the table to query.</span></span> <span data-ttu-id="e3dc4-233">O caractere `*` especifica que a consulta deve retornar todas as colunas da tabela.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-233">The `*` character specifies that the query should return all the columns from the table.</span></span> <span data-ttu-id="e3dc4-234">(Você também pode listar colunas individualmente, separadas por vírgulas, se quisesse ver apenas algumas das colunas.) A cláusula `Order By` indica como os dados devem ser classificados &#8212; nesse caso, pela coluna *Name* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-234">(You could also list columns individually, separated by commas, if you wanted to see only some of the columns.) The `Order By` clause indicates how the data should be sorted &#8212; in this case, by the *Name* column.</span></span> <span data-ttu-id="e3dc4-235">Isso significa que os dados são classificados alfabeticamente com base no valor da coluna *Name* para cada linha.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-235">This means that the data is sorted alphabetically based on the value of the *Name* column for each row.</span></span>

    <span data-ttu-id="e3dc4-236">No corpo da página, a marcação cria uma tabela HTML que será usada para exibir os dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-236">In the body of the page, the markup creates an HTML table that will be used to display the data.</span></span> <span data-ttu-id="e3dc4-237">Dentro do elemento `<tbody>`, você usa um loop `foreach` para obter individualmente cada linha de dados retornada pela consulta.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-237">Inside the `<tbody>` element, you use a `foreach` loop to individually get each data row that's returned by the query.</span></span> <span data-ttu-id="e3dc4-238">Para cada linha de dados, você cria uma linha de tabela HTML (elemento`<tr>`).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-238">For each data row, you create an HTML table row (`<tr>` element).</span></span> <span data-ttu-id="e3dc4-239">Em seguida, você cria células de tabela HTML (elementos`<td>`) para cada coluna.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-239">Then you create HTML table cells (`<td>` elements) for each column.</span></span> <span data-ttu-id="e3dc4-240">Cada vez que você passa pelo loop, a próxima linha disponível do banco de dados está na variável `row` (configurada na instrução `foreach`).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-240">Each time you go through the loop, the next available row from the database is in the `row` variable (you set this up in the `foreach` statement).</span></span> <span data-ttu-id="e3dc4-241">Para obter uma coluna individual da linha, você pode usar `row.Name` ou `row.Description` ou qualquer que seja o nome da coluna desejada.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-241">To get an individual column from the row, you can use `row.Name` or `row.Description` or whatever the name is of the column you want.</span></span>
4. <span data-ttu-id="e3dc4-242">Execute a página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-242">Run the page in a browser.</span></span> <span data-ttu-id="e3dc4-243">(Verifique se a página está selecionada no espaço de trabalho **arquivos** antes de executá-la.) A página exibe uma lista semelhante à seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-243">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays a list like the following:</span></span>

    ![[imagem]](5-working-with-data/_static/image4.jpg)

> [!TIP] 
> 
> <span data-ttu-id="e3dc4-245">**SQL (Structured Query Language)**</span><span class="sxs-lookup"><span data-stu-id="e3dc4-245">**Structured Query Language (SQL)**</span></span>
> 
> <span data-ttu-id="e3dc4-246">O SQL é uma linguagem que é usada na maioria dos bancos de dados relacionais para o gerenciamento em um banco de dado.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-246">SQL is a language that's used in most relational databases for managing data in a database.</span></span> <span data-ttu-id="e3dc4-247">Ele inclui comandos que permitem que você recupere dados e atualize-os e que permitem criar, modificar e gerenciar tabelas de banco de dado.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-247">It includes commands that let you retrieve data and update it, and that let you create, modify, and manage database tables.</span></span> <span data-ttu-id="e3dc4-248">O SQL é diferente de uma linguagem de programação (como a que você está usando no WebMatrix) porque, com o SQL, a ideia é que você informa ao banco de dados o que você deseja, e é o trabalho do banco de dado descobrir como obter ou executar a tarefa.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-248">SQL is different than a programming language (like the one you're using in WebMatrix) because with SQL, the idea is that you tell the database what you want, and it's the database's job to figure out how to get the data or perform the task.</span></span> <span data-ttu-id="e3dc4-249">Aqui estão exemplos de alguns comandos SQL e o que eles fazem:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-249">Here are examples of some SQL commands and what they do:</span></span>
> 
> `SELECT Id, Name, Price FROM Product WHERE Price > 10.00 ORDER BY Name`
> 
> <span data-ttu-id="e3dc4-250">Isso buscará as colunas *ID*, *nome*e *preço* dos registros na tabela *produto* se o valor do *preço* for maior que 10 e retornará os resultados em ordem alfabética com base nos valores da coluna *nome* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-250">This fetches the *Id*, *Name*, and *Price* columns from records in the *Product* table if the value of *Price* is more than 10, and returns the results in alphabetical order based on the values of the *Name* column.</span></span> <span data-ttu-id="e3dc4-251">Esse comando retornará um conjunto de resultados que contém os registros que atendem aos critérios ou um conjunto vazio se nenhum registro corresponder.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-251">This command will return a result set that contains the records that meet the criteria, or an empty set if no records match.</span></span>
> 
> `INSERT INTO Product (Name, Description, Price) VALUES ("Croissant", "A flaky delight", 1.99)`
> 
> <span data-ttu-id="e3dc4-252">Isso insere um novo registro na tabela *produto* , definindo a coluna *nome* como &quot;croissant&quot;, a coluna *Descrição* para &quot;um fascinam de instável&quot;e o preço como 1,99.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-252">This inserts a new record into the *Product* table, setting the *Name* column to &quot;Croissant&quot;, the *Description* column to &quot;A flaky delight&quot;, and the price to 1.99.</span></span>
> 
> `DELETE FROM Product WHERE ExpirationDate < "01/01/2008"`
> 
> <span data-ttu-id="e3dc4-253">Este comando exclui os registros na tabela *Product* cuja coluna data de expiração é anterior a 1º de janeiro de 2008.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-253">This command deletes records in the *Product* table whose expiration date column is earlier than January 1, 2008.</span></span> <span data-ttu-id="e3dc4-254">(Isso pressupõe que a tabela de *produtos* tenha uma coluna como essa, é claro). A data é inserida aqui no formato MM/DD/AAAA, mas deve ser inserida no formato usado para sua localidade.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-254">(This assumes that the *Product* table has such a column, of course.) The date is entered here in MM/DD/YYYY format, but it should be entered in the format that's used for your locale.</span></span>
> 
> <span data-ttu-id="e3dc4-255">Os comandos `Insert Into` e `Delete` não retornam conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-255">The `Insert Into` and `Delete` commands don't return result sets.</span></span> <span data-ttu-id="e3dc4-256">Em vez disso, eles retornam um número que informa quantos registros foram afetados pelo comando.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-256">Instead, they return a number that tells you how many records were affected by the command.</span></span>
> 
> <span data-ttu-id="e3dc4-257">Para algumas dessas operações (como inserção e exclusão de registros), o processo que está solicitando a operação deve ter as permissões apropriadas no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-257">For some of these operations (like inserting and deleting records), the process that's requesting the operation has to have appropriate permissions in the database.</span></span> <span data-ttu-id="e3dc4-258">É por isso que, para bancos de dados de produção, você geralmente precisa fornecer um nome de usuário e uma senha ao se conectar ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-258">This is why for production databases you often have to supply a username and password when you connect to the database.</span></span>
> 
> <span data-ttu-id="e3dc4-259">Há dezenas de comandos SQL, mas todos seguem um padrão como esse.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-259">There are dozens of SQL commands, but they all follow a pattern like this.</span></span> <span data-ttu-id="e3dc4-260">Você pode usar comandos SQL para criar tabelas de banco de dados, contar o número de registros em uma tabela, calcular preços e executar muitas outras operações.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-260">You can use SQL commands to create database tables, count the number of records in a table, calculate prices, and perform many more operations.</span></span>

## <a name="inserting-data-in-a-database"></a><span data-ttu-id="e3dc4-261">Inserindo dados em um banco de dado</span><span class="sxs-lookup"><span data-stu-id="e3dc4-261">Inserting Data in a Database</span></span>

<span data-ttu-id="e3dc4-262">Esta seção mostra como criar uma página que permite aos usuários adicionar um novo produto à tabela de banco de dados do *produto* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-262">This section shows how to create a page that lets users add a new product to the *Product* database table.</span></span> <span data-ttu-id="e3dc4-263">Depois que um novo registro de produto é inserido, a página exibe a tabela atualizada usando a página *ListProducts. cshtml* criada na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-263">After a new product record is inserted, the page displays the updated table using the *ListProducts.cshtml* page that you created in the previous section.</span></span>

<span data-ttu-id="e3dc4-264">A página inclui validação para certificar-se de que os dados inseridos pelo usuário são válidos para o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-264">The page includes validation to make sure that the data that the user enters is valid for the database.</span></span> <span data-ttu-id="e3dc4-265">Por exemplo, o código na página garante que um valor tenha sido inserido para todas as colunas necessárias.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-265">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>

1. <span data-ttu-id="e3dc4-266">No site, crie um novo arquivo CSHTML chamado *InsertProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-266">In the website, create a new CSHTML file named *InsertProducts.cshtml*.</span></span>
2. <span data-ttu-id="e3dc4-267">Substitua a marcação existente pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-267">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample3.cshtml)]

    <span data-ttu-id="e3dc4-268">O corpo da página contém um formulário HTML com três caixas de texto que permitem aos usuários inserir um nome, uma descrição e um preço.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-268">The body of the page contains an HTML form with three text boxes that let users enter a name, description, and price.</span></span> <span data-ttu-id="e3dc4-269">Quando os usuários clicam no botão **Inserir** , o código na parte superior da página abre uma conexão com o banco de dados *SmallBakery. sdf* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-269">When users click the **Insert** button, the code at the top of the page opens a connection to the *SmallBakery.sdf* database.</span></span> <span data-ttu-id="e3dc4-270">Em seguida, você obtém os valores que o usuário enviou usando o objeto `Request` e atribui esses valores a variáveis locais.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-270">You then get the values that the user has submitted by using the `Request` object and assign those values to local variables.</span></span>

    <span data-ttu-id="e3dc4-271">Para validar que o usuário inseriu um valor para cada coluna necessária, registre cada elemento `<input>` que você deseja validar:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-271">To validate that the user entered a value for each required column, you register each `<input>` element that you want to validate:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample4.cs)]

    <span data-ttu-id="e3dc4-272">O auxiliar de `Validation` verifica se há um valor em cada um dos campos que você registrou.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-272">The `Validation` helper checks that there is a value in each of the fields that you've registered.</span></span> <span data-ttu-id="e3dc4-273">Você pode testar se todos os campos passaram na validação verificando `Validation.IsValid()`, o que normalmente faz antes de processar as informações obtidas do usuário:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-273">You can test whether all the fields passed validation by checking `Validation.IsValid()`, which you typically do before you process the information you get from the user:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample5.cs)]

    <span data-ttu-id="e3dc4-274">(O operador de `&&` significa e – esse teste *se é um envio de formulário e todos os campos passaram na validação*.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-274">(The `&&` operator means AND — this test is *If this is a form submission AND all the fields have passed validation*.)</span></span>

    <span data-ttu-id="e3dc4-275">Se todas as colunas forem validadas (nenhuma estava vazia), você vai criar uma instrução SQL para inserir os dados e, em seguida, executá-los conforme mostrado a seguir:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-275">If all the columns validated (none were empty), you go ahead and create a SQL statement to insert the data and then execute it as shown next:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample6.cs)]

    <span data-ttu-id="e3dc4-276">Para os valores a serem inseridos, você inclui espaços reservados de parâmetro (`@0`, `@1`, `@2`).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-276">For the values to insert, you include parameter placeholders (`@0`, `@1`, `@2`).</span></span>

    > [!NOTE]
    > <span data-ttu-id="e3dc4-277">Como uma precaução de segurança, sempre transmita valores para uma instrução SQL usando parâmetros, como você vê no exemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-277">As a security precaution, always pass values to a SQL statement using parameters, as you see in the preceding example.</span></span> <span data-ttu-id="e3dc4-278">Isso lhe dá a chance de validar os dados do usuário, além de ajudar a proteger contra tentativas de enviar comandos mal-intencionados para seu banco de dado (às vezes chamados de ataques de injeção de SQL).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-278">This gives you a chance to validate the user's data, plus it helps protect against attempts to send malicious commands to your database (sometimes referred to as SQL injection attacks).</span></span>

    <span data-ttu-id="e3dc4-279">Para executar a consulta, você usa essa instrução, passando a ela as variáveis que contêm os valores a serem substituídos pelos espaços reservados:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-279">To execute the query, you use this statement, passing to it the variables that contain the values to substitute for the placeholders:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample7.cs)]

    <span data-ttu-id="e3dc4-280">Depois que a instrução de `Insert Into` for executada, você enviará o usuário para a página que lista os produtos usando esta linha:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-280">After the `Insert Into` statement has executed, you send the user to the page that lists the products using this line:</span></span>

    [!code-javascript[Main](5-working-with-data/samples/sample8.js)]

    <span data-ttu-id="e3dc4-281">Se a validação não tiver sido concluída com sucesso, você ignorará a inserção.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-281">If validation didn't succeed, you skip the insert.</span></span> <span data-ttu-id="e3dc4-282">Em vez disso, você tem um auxiliar na página que pode exibir as mensagens de erro acumuladas (se houver):</span><span class="sxs-lookup"><span data-stu-id="e3dc4-282">Instead, you have a helper in the page that can display the accumulated error messages (if any):</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample9.cshtml)]

    <span data-ttu-id="e3dc4-283">Observe que o bloco style na marcação inclui uma definição de classe CSS chamada `.validation-summary-errors`.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-283">Notice that the style block in the markup includes a CSS class definition named `.validation-summary-errors`.</span></span> <span data-ttu-id="e3dc4-284">Esse é o nome da classe CSS que é usada por padrão para o elemento `<div>` que contém quaisquer erros de validação.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-284">This is the name of the CSS class that's used by default for the `<div>` element that contains any validation errors.</span></span> <span data-ttu-id="e3dc4-285">Nesse caso, a classe CSS especifica que os erros de Resumo de validação são exibidos em vermelho e em negrito, mas você pode definir a classe de `.validation-summary-errors` para exibir qualquer formatação que desejar.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-285">In this case, the CSS class specifies that validation summary errors are displayed in red and in bold, but you can define the `.validation-summary-errors` class to display any formatting you like.</span></span>

### <a name="testing-the-insert-page"></a><span data-ttu-id="e3dc4-286">Testando a página de inserção</span><span class="sxs-lookup"><span data-stu-id="e3dc4-286">Testing the Insert Page</span></span>

1. <span data-ttu-id="e3dc4-287">Exibir a página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-287">View the page in a browser.</span></span> <span data-ttu-id="e3dc4-288">A página exibe um formulário semelhante ao que é mostrado na ilustração a seguir.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-288">The page displays a form that's similar to the one that's shown in the following illustration.</span></span>

    ![[imagem]](5-working-with-data/_static/image5.jpg)
2. <span data-ttu-id="e3dc4-290">Insira valores para todas as colunas, mas certifique-se de deixar a coluna de *preço* em branco.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-290">Enter values for all the columns, but make sure that you leave the *Price* column blank.</span></span>
3. <span data-ttu-id="e3dc4-291">Clique em **Inserir**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-291">Click **Insert**.</span></span> <span data-ttu-id="e3dc4-292">A página exibe uma mensagem de erro, conforme mostrado na ilustração a seguir.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-292">The page displays an error message, as shown in the following illustration.</span></span> <span data-ttu-id="e3dc4-293">(Nenhum novo registro é criado.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-293">(No new record is created.)</span></span>

    ![[imagem]](5-working-with-data/_static/image6.jpg)
4. <span data-ttu-id="e3dc4-295">Preencha o formulário completamente e, em seguida, clique em **Inserir**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-295">Fill the form out completely, and then click **Insert**.</span></span> <span data-ttu-id="e3dc4-296">Desta vez, a página *ListProducts. cshtml* é exibida e mostra o novo registro.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-296">This time, the *ListProducts.cshtml* page is displayed and shows the new record.</span></span>

## <a name="updating-data-in-a-database"></a><span data-ttu-id="e3dc4-297">Atualizando dados em um banco de dado</span><span class="sxs-lookup"><span data-stu-id="e3dc4-297">Updating Data in a Database</span></span>

<span data-ttu-id="e3dc4-298">Depois que os dados tiverem sido inseridos em uma tabela, talvez seja necessário atualizá-los.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-298">After data has been entered into a table, you might need to update it.</span></span> <span data-ttu-id="e3dc4-299">Este procedimento mostra como criar duas páginas semelhantes àquelas que você criou para a inserção de dados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-299">This procedure shows you how to create two pages that are similar to the ones you created for data insertion earlier.</span></span> <span data-ttu-id="e3dc4-300">A primeira página exibe produtos e permite que os usuários selecionem um para alterar.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-300">The first page displays products and lets users select one to change.</span></span> <span data-ttu-id="e3dc4-301">A segunda página permite que os usuários realmente façam as edições e as salvem.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-301">The second page lets the users actually make the edits and save them.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="e3dc4-302">**Importante** Em um site de produção, você normalmente restringe quem tem permissão para fazer alterações nos dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-302">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="e3dc4-303">Para obter informações sobre como configurar a associação e sobre maneiras de autorizar os usuários a executar tarefas no site, consulte [adicionando segurança e associação a um site páginas da Web do ASP.net](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-303">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="e3dc4-304">No site, crie um novo arquivo CSHTML chamado *EditProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-304">In the website, create a new CSHTML file named *EditProducts.cshtml*.</span></span>
2. <span data-ttu-id="e3dc4-305">Substitua a marcação existente no arquivo pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-305">Replace the existing markup in the file with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample10.cshtml)]

    <span data-ttu-id="e3dc4-306">A única diferença entre essa página e a página *ListProducts. cshtml* do anterior é que a tabela HTML nessa página inclui uma coluna extra que exibe um link de **edição** .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-306">The only difference between this page and the *ListProducts.cshtml* page from earlier is that the HTML table in this page includes an extra column that displays an **Edit** link.</span></span> <span data-ttu-id="e3dc4-307">Quando você clica nesse link, ele leva você para a página *UpdateProducts. cshtml* (que você criará em seguida), em que você pode editar o registro selecionado.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-307">When you click this link, it takes you to the *UpdateProducts.cshtml* page (which you'll create next) where you can edit the selected record.</span></span>

    <span data-ttu-id="e3dc4-308">Examine o código que cria o link de **edição** :</span><span class="sxs-lookup"><span data-stu-id="e3dc4-308">Look at the code that creates the **Edit** link:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample11.cshtml)]

    <span data-ttu-id="e3dc4-309">Isso cria um elemento `<a>` HTML cujo atributo `href` é definido dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-309">This creates an HTML `<a>` element whose `href` attribute is set dynamically.</span></span> <span data-ttu-id="e3dc4-310">O atributo `href` especifica a página a ser exibida quando o usuário clica no link.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-310">The `href` attribute specifies the page to display when the user clicks the link.</span></span> <span data-ttu-id="e3dc4-311">Ele também passa o valor `Id` da linha atual para o link.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-311">It also passes the `Id` value of the current row to the link.</span></span> <span data-ttu-id="e3dc4-312">Quando a página é executada, a origem da página pode conter links como estes:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-312">When the page runs, the page source might contain links like these:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample12.html)]

    <span data-ttu-id="e3dc4-313">Observe que o atributo `href` é definido como `UpdateProducts/n`, em que *n* é um número de produto.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-313">Notice that the `href` attribute is set to `UpdateProducts/n`, where *n* is a product number.</span></span> <span data-ttu-id="e3dc4-314">Quando um usuário clica em um desses links, a URL resultante terá uma aparência semelhante a esta:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-314">When a user clicks one of these links, the resulting URL will look something like this:</span></span>

    `http://localhost:18816/UpdateProducts/6`

    <span data-ttu-id="e3dc4-315">Em outras palavras, o número do produto a ser editado será passado na URL.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-315">In other words, the product number to be edited will be passed in the URL.</span></span>
3. <span data-ttu-id="e3dc4-316">Exibir a página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-316">View the page in a browser.</span></span> <span data-ttu-id="e3dc4-317">A página exibe os dados em um formato como este:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-317">The page displays the data in a format like this:</span></span>

    ![[imagem]](5-working-with-data/_static/image7.jpg)

    <span data-ttu-id="e3dc4-319">Em seguida, você criará a página que permite aos usuários realmente atualizar os dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-319">Next, you'll create the page that lets users actually update the data.</span></span> <span data-ttu-id="e3dc4-320">A página de atualização inclui validação para validar os dados que o usuário insere.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-320">The update page includes validation to validate the data that the user enters.</span></span> <span data-ttu-id="e3dc4-321">Por exemplo, o código na página garante que um valor tenha sido inserido para todas as colunas necessárias.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-321">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>
4. <span data-ttu-id="e3dc4-322">No site, crie um novo arquivo CSHTML chamado *UpdateProducts. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-322">In the website, create a new CSHTML file named *UpdateProducts.cshtml*.</span></span>
5. <span data-ttu-id="e3dc4-323">Substitua a marcação existente no arquivo pelo seguinte.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-323">Replace the existing markup in the file with the following.</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample13.cshtml)]

    <span data-ttu-id="e3dc4-324">O corpo da página contém um formulário HTML em que um produto é exibido e onde os usuários podem editá-lo.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-324">The body of the page contains an HTML form where a product is displayed and where users can edit it.</span></span> <span data-ttu-id="e3dc4-325">Para obter o produto a ser exibido, use esta instrução SQL:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-325">To get the product to display, you use this SQL statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample14.sql)]

    <span data-ttu-id="e3dc4-326">Isso selecionará o produto cuja ID corresponde ao valor passado no parâmetro `@0`.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-326">This will select the product whose ID matches the value that's passed in the `@0` parameter.</span></span> <span data-ttu-id="e3dc4-327">(Como *ID* é a chave primária e, portanto, deve ser exclusivo, somente um registro de produto pode ser selecionado dessa maneira.) Para obter o valor de ID a ser transmitido para esta instrução de `Select`, você pode ler o valor que é passado para a página como parte da URL, usando a seguinte sintaxe:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-327">(Because *Id* is the primary key and therefore must be unique, only one product record can ever be selected this way.) To get the ID value to pass to this `Select` statement, you can read the value that's passed to the page as part of the URL, using the following syntax:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample15.cs)]

    <span data-ttu-id="e3dc4-328">Para realmente buscar o registro do produto, use o método `QuerySingle`, que retornará apenas um registro:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-328">To actually fetch the product record, you use the `QuerySingle` method, which will return just one record:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample16.cs)]

    <span data-ttu-id="e3dc4-329">A única linha é retornada para a variável `row`.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-329">The single row is returned into the `row` variable.</span></span> <span data-ttu-id="e3dc4-330">Você pode obter dados de cada coluna e atribuí-los a variáveis locais como esta:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-330">You can get data out of each column and assign it to local variables like this:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample17.cs)]

    <span data-ttu-id="e3dc4-331">Na marcação do formulário, esses valores são exibidos automaticamente em caixas de texto individuais usando um código inserido como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-331">In the markup for the form, these values are displayed automatically in individual text boxes by using embedded code like the following:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample18.html)]

    <span data-ttu-id="e3dc4-332">Essa parte do código exibe o registro do produto a ser atualizado.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-332">That part of the code displays the product record to be updated.</span></span> <span data-ttu-id="e3dc4-333">Depois que o registro tiver sido exibido, o usuário poderá editar colunas individuais.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-333">Once the record has been displayed, the user can edit individual columns.</span></span>

    <span data-ttu-id="e3dc4-334">Quando o usuário envia o formulário clicando no botão **Atualizar** , o código no bloco de `if(IsPost)` é executado.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-334">When the user submits the form by clicking the **Update** button, the code in the `if(IsPost)` block runs.</span></span> <span data-ttu-id="e3dc4-335">Isso obtém os valores do usuário do objeto `Request`, armazena os valores em variáveis e valida que cada coluna foi preenchida.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-335">This gets the user's values from the `Request` object, stores the values in variables, and validates that each column has been filled in.</span></span> <span data-ttu-id="e3dc4-336">Se a validação for aprovada, o código criará a seguinte instrução SQL Update:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-336">If validation passes, the code creates the following SQL Update statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample19.sql)]

    <span data-ttu-id="e3dc4-337">Em uma instrução SQL `Update`, você especifica cada coluna a ser atualizada e o valor para o qual defini-la.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-337">In a SQL `Update` statement, you specify each column to update and the value to set it to.</span></span> <span data-ttu-id="e3dc4-338">Nesse código, os valores são especificados usando os espaços reservados de parâmetro `@0`, `@1`, `@2`e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-338">In this code, the values are specified using the parameter placeholders `@0`, `@1`, `@2`, and so on.</span></span> <span data-ttu-id="e3dc4-339">(Conforme observado anteriormente, por segurança, você deve sempre passar valores para uma instrução SQL usando parâmetros.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-339">(As noted earlier, for security, you should always pass values to a SQL statement by using parameters.)</span></span>

    <span data-ttu-id="e3dc4-340">Ao chamar o método `db.Execute`, você passa as variáveis que contêm os valores na ordem que corresponde aos parâmetros na instrução SQL:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-340">When you call the `db.Execute` method, you pass the variables that contain the values in the order that corresponds to the parameters in the SQL statement:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample20.cs)]

    <span data-ttu-id="e3dc4-341">Depois que a instrução de `Update` tiver sido executada, você chamará o seguinte método para redirecionar o usuário de volta para a página de edição:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-341">After the `Update` statement has been executed, you call the following method in order to redirect the user back to the edit page:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample21.cshtml)]

    <span data-ttu-id="e3dc4-342">O efeito é que o usuário vê uma listagem atualizada dos dados no banco de dados e pode editar outro produto.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-342">The effect is that the user sees an updated listing of the data in the database and can edit another product.</span></span>
6. <span data-ttu-id="e3dc4-343">Salve a página.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-343">Save the page.</span></span>
7. <span data-ttu-id="e3dc4-344">Execute a página *EditProducts. cshtml* (não a página de atualização) e clique em **Editar** para selecionar um produto a ser editado.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-344">Run the *EditProducts.cshtml* page (not the update page) and then click **Edit** to select a product to edit.</span></span> <span data-ttu-id="e3dc4-345">A página *UpdateProducts. cshtml* é exibida, mostrando o registro que você selecionou.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-345">The *UpdateProducts.cshtml* page is displayed, showing the record you selected.</span></span>

    ![[imagem]](5-working-with-data/_static/image8.jpg)
8. <span data-ttu-id="e3dc4-347">Faça uma alteração e clique em **Atualizar**.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-347">Make a change and click **Update**.</span></span> <span data-ttu-id="e3dc4-348">A lista de produtos é mostrada novamente com seus dados atualizados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-348">The products list is shown again with your updated data.</span></span>

## <a name="deleting-data-in-a-database"></a><span data-ttu-id="e3dc4-349">Excluindo dados em um banco de dado</span><span class="sxs-lookup"><span data-stu-id="e3dc4-349">Deleting Data in a Database</span></span>

<span data-ttu-id="e3dc4-350">Esta seção mostra como permitir que os usuários excluam um produto da tabela de banco de dados do *produto* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-350">This section shows how to let users delete a product from the *Product* database table.</span></span> <span data-ttu-id="e3dc4-351">O exemplo consiste em duas páginas.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-351">The example consists of two pages.</span></span> <span data-ttu-id="e3dc4-352">Na primeira página, os usuários selecionam um registro para excluir.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-352">In the first page, users select a record to delete.</span></span> <span data-ttu-id="e3dc4-353">O registro a ser excluído é exibido em uma segunda página que permite confirmar que eles desejam excluir o registro.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-353">The record to be deleted is then displayed in a second page that lets them confirm that they want to delete the record.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="e3dc4-354">**Importante** Em um site de produção, você normalmente restringe quem tem permissão para fazer alterações nos dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-354">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="e3dc4-355">Para obter informações sobre como configurar a associação e sobre maneiras de autorizar o usuário a executar tarefas no site, consulte [adicionando segurança e associação a um site páginas da Web do ASP.net](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-355">For information about how to set up membership and about ways to authorize user to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="e3dc4-356">No site, crie um novo arquivo CSHTML chamado *ListProductsForDelete. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-356">In the website, create a new CSHTML file named *ListProductsForDelete.cshtml*.</span></span>
2. <span data-ttu-id="e3dc4-357">Substitua a marcação existente pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-357">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample22.cshtml)]

    <span data-ttu-id="e3dc4-358">Esta página é semelhante à página *EditProducts. cshtml* anterior.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-358">This page is similar to the *EditProducts.cshtml* page from earlier.</span></span> <span data-ttu-id="e3dc4-359">No entanto, em vez de exibir um link de **edição** para cada produto, ele exibe um link de **exclusão** .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-359">However, instead of displaying an **Edit** link for each product, it displays a **Delete** link.</span></span> <span data-ttu-id="e3dc4-360">O link **excluir** é criado usando o seguinte código inserido na marcação:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-360">The **Delete** link is created using the following embedded code in the markup:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample23.cshtml)]

    <span data-ttu-id="e3dc4-361">Isso cria uma URL semelhante a esta quando os usuários clicam no link:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-361">This creates a URL that looks like this when users click the link:</span></span>

    `http://<server>/DeleteProduct/4`

    <span data-ttu-id="e3dc4-362">A URL chama uma página chamada *DeleteProduct. cshtml* (que você criará em seguida) e a passa para a ID do produto a ser excluída (aqui, 4).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-362">The URL calls a page named *DeleteProduct.cshtml* (which you'll create next) and passes it the ID of the product to delete (here, 4).</span></span>
3. <span data-ttu-id="e3dc4-363">Salve o arquivo, mas deixe-o aberto.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-363">Save the file, but leave it open.</span></span>
4. <span data-ttu-id="e3dc4-364">Crie outro arquivo CHTML chamado *DeleteProduct. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-364">Create another CHTML file named *DeleteProduct.cshtml*.</span></span> <span data-ttu-id="e3dc4-365">Substitua o conteúdo existente pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-365">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample24.cshtml)]

    <span data-ttu-id="e3dc4-366">Essa página é chamada por *ListProductsForDelete. cshtml* e permite que os usuários confirmem que desejam excluir um produto.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-366">This page is called by *ListProductsForDelete.cshtml* and lets users confirm that they want to delete a product.</span></span> <span data-ttu-id="e3dc4-367">Para listar o produto a ser excluído, você obtém a ID do produto a ser excluída da URL usando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-367">To list the product to be deleted, you get the ID of the product to delete from the URL using the following code:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample25.cs)]

    <span data-ttu-id="e3dc4-368">Em seguida, a página solicita que o usuário clique em um botão para realmente excluir o registro.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-368">The page then asks the user to click a button to actually delete the record.</span></span> <span data-ttu-id="e3dc4-369">Essa é uma medida de segurança importante: quando você executa operações confidenciais em seu site, como atualizar ou excluir dados, essas operações sempre devem ser feitas usando uma operação POST, não uma operação GET.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-369">This is an important security measure: when you perform sensitive operations in your website like updating or deleting data, these operations should always be done using a POST operation, not a GET operation.</span></span> <span data-ttu-id="e3dc4-370">Se seu site estiver configurado para que uma operação de exclusão possa ser executada usando uma operação GET, qualquer pessoa poderá passar uma URL como `http://<server>/DeleteProduct/4` e excluir tudo o que quiser de seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-370">If your site is set up so that a delete operation can be performed using a GET operation, anyone can pass a URL like `http://<server>/DeleteProduct/4` and delete anything they want from your database.</span></span> <span data-ttu-id="e3dc4-371">Adicionando a confirmação e codificando a página para que a exclusão possa ser executada somente usando uma POSTAgem, você adiciona uma medida de segurança ao seu site.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-371">By adding the confirmation and coding the page so that the deletion can be performed only by using a POST, you add a measure of security to your site.</span></span>

    <span data-ttu-id="e3dc4-372">A operação de exclusão real é executada usando o código a seguir, que primeiro confirma que esta é uma operação post e que a ID não está vazia:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-372">The actual delete operation is performed using the following code, which first confirms that this is a post operation and that the ID isn't empty:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample26.cs)]

    <span data-ttu-id="e3dc4-373">O código executa uma instrução SQL que exclui o registro especificado e, em seguida, redireciona o usuário de volta para a página de listagem.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-373">The code runs a SQL statement that deletes the specified record and then redirects the user back to the listing page.</span></span>
5. <span data-ttu-id="e3dc4-374">Execute *ListProductsForDelete. cshtml* em um navegador.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-374">Run *ListProductsForDelete.cshtml* in a browser.</span></span>

    ![[imagem]](5-working-with-data/_static/image9.jpg)
6. <span data-ttu-id="e3dc4-376">Clique no link **excluir** para um dos produtos.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-376">Click the **Delete** link for one of the products.</span></span> <span data-ttu-id="e3dc4-377">A página *DeleteProduct. cshtml* é exibida para confirmar que você deseja excluir esse registro.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-377">The *DeleteProduct.cshtml* page is displayed to confirm that you want to delete that record.</span></span>
7. <span data-ttu-id="e3dc4-378">Clique no botão **Excluir** .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-378">Click the **Delete** button.</span></span> <span data-ttu-id="e3dc4-379">O registro do produto é excluído e a página é atualizada com uma listagem de produtos atualizada.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-379">The product record is deleted and the page is refreshed with an updated product listing.</span></span>

> [!TIP]
> 
> <a id="SB_ConnectingToADatabase"></a>
> ### <a name="connecting-to-a-database"></a><span data-ttu-id="e3dc4-380">Conectando a um banco de dados</span><span class="sxs-lookup"><span data-stu-id="e3dc4-380">Connecting to a Database</span></span>
> 
> <span data-ttu-id="e3dc4-381">Você pode se conectar a um banco de dados de duas maneiras.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-381">You can connect to a database in two ways.</span></span> <span data-ttu-id="e3dc4-382">A primeira é usar o método `Database.Open` e especificar o nome do arquivo de banco de dados (menos a extensão *. sdf* ):</span><span class="sxs-lookup"><span data-stu-id="e3dc4-382">The first is to use the `Database.Open` method and to specify the name of the database file (less the *.sdf* extension):</span></span>
> 
> `var db = Database.Open("SmallBakery");`
> 
> <span data-ttu-id="e3dc4-383">O método `Open` pressupõe que o. o arquivo *SDF* está na pasta de *dados do aplicativo\_* do site.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-383">The `Open` method assumes that the .*sdf* file is in the website's *App\_Data* folder.</span></span> <span data-ttu-id="e3dc4-384">Essa pasta foi projetada especificamente para conter dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-384">This folder is designed specifically for holding data.</span></span> <span data-ttu-id="e3dc4-385">Por exemplo, ele tem as permissões apropriadas para permitir que o site Leia e grave dados e, como medida de segurança, o WebMatrix não permite o acesso a arquivos dessa pasta.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-385">For example, it has appropriate permissions to allow the website to read and write data, and as a security measure, WebMatrix does not allow access to files from this folder.</span></span>
> 
> <span data-ttu-id="e3dc4-386">A segunda maneira é usar uma cadeia de conexão.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-386">The second way is to use a connection string.</span></span> <span data-ttu-id="e3dc4-387">Uma cadeia de conexão contém informações sobre como conectar a um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-387">A connection string contains information about how to connect to a database.</span></span> <span data-ttu-id="e3dc4-388">Isso pode incluir um caminho de arquivo ou pode incluir o nome de um banco de dados SQL Server em um servidor local ou remoto, juntamente com um nome de usuário e senha para se conectar a esse servidor.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-388">This can include a file path, or it can include the name of a SQL Server database on a local or remote server, along with a user name and password to connect to that server.</span></span> <span data-ttu-id="e3dc4-389">(Se você mantiver dados em uma versão gerenciada centralmente do SQL Server, como no site de um provedor de hospedagem, você sempre usa uma cadeia de conexão para especificar as informações de conexão de banco de dados.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-389">(If you keep data in a centrally managed version of SQL Server, such as on a hosting provider's site, you always use a connection string to specify the database connection information.)</span></span>
> 
> <span data-ttu-id="e3dc4-390">No WebMatrix, cadeias de conexão geralmente são armazenadas em um arquivo XML chamado *Web. config*. Como o nome indica, você pode usar um arquivo *Web. config* na raiz do seu site para armazenar as informações de configuração do site, incluindo quaisquer cadeias de conexão que seu site possa exigir.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-390">In WebMatrix, connection strings are usually stored in an XML file named *Web.config*. As the name implies, you can use a *Web.config* file in the root of your website to store the site's configuration information, including any connection strings that your site might require.</span></span> <span data-ttu-id="e3dc4-391">Um exemplo de uma cadeia de conexão em um arquivo *Web. config* pode ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-391">An example of a connection string in a *Web.config* file might look like the following:</span></span>
> 
> [!code-xml[Main](5-working-with-data/samples/sample27.xml)]
> 
> <span data-ttu-id="e3dc4-392">No exemplo, a cadeia de conexão aponta para um banco de dados em uma instância do SQL Server que está sendo executado em um servidor em algum lugar (em oposição a um arquivo *. sdf* local).</span><span class="sxs-lookup"><span data-stu-id="e3dc4-392">In the example, the connection string points to a database in an instance of SQL Server that's running on a server somewhere (as opposed to a local *.sdf* file).</span></span> <span data-ttu-id="e3dc4-393">Você precisa substituir os nomes apropriados para `myServer` e `myDatabase`e especificar SQL Server valores de logon para `username` e `password`.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-393">You would need to substitute the appropriate names for `myServer` and `myDatabase`, and specify SQL Server login values for `username` and `password`.</span></span> <span data-ttu-id="e3dc4-394">(Os valores de nome de usuário e senha não são necessariamente os mesmos que as suas credenciais do Windows ou como os valores que seu provedor de hospedagem forneceu para fazer logon em seus servidores.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-394">(The username and password values are not necessarily the same as your Windows credentials or as the values that your hosting provider has given you for logging in to their servers.</span></span> <span data-ttu-id="e3dc4-395">Verifique com o administrador os valores exatos de que você precisa.)</span><span class="sxs-lookup"><span data-stu-id="e3dc4-395">Check with the administrator for the exact values you need.)</span></span>
> 
> <span data-ttu-id="e3dc4-396">O método `Database.Open` é flexível, pois permite que você passe o nome de um arquivo *. sdf* de banco de dados ou o nome de uma cadeia de conexão que é armazenada no arquivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-396">The `Database.Open` method is flexible, because it lets you pass either the name of a database *.sdf* file or the name of a connection string that's stored in the *Web.config* file.</span></span> <span data-ttu-id="e3dc4-397">O exemplo a seguir mostra como se conectar ao banco de dados usando a cadeia de conexão ilustrada no exemplo anterior:</span><span class="sxs-lookup"><span data-stu-id="e3dc4-397">The following example shows how to connect to the database using the connection string illustrated in the previous example:</span></span>
> 
> [!code-cshtml[Main](5-working-with-data/samples/sample28.cshtml)]
> 
> <span data-ttu-id="e3dc4-398">Como observado, o método `Database.Open` permite que você passe um nome de banco de dados ou uma cadeia de conexão, e ele descobrirá qual deles usar.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-398">As noted, the `Database.Open` method lets you pass either a database name or a connection string, and it'll figure out which to use.</span></span> <span data-ttu-id="e3dc4-399">Isso é muito útil quando você implanta (publica) seu site.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-399">This is very useful when you deploy (publish) your website.</span></span> <span data-ttu-id="e3dc4-400">Você pode usar um arquivo *. sdf* na pasta de *dados do\_de aplicativos* quando estiver desenvolvendo e testando seu site.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-400">You can use an *.sdf* file in the *App\_Data* folder when you're developing and testing your site.</span></span> <span data-ttu-id="e3dc4-401">Em seguida, ao mover seu site para um servidor de produção, você pode usar uma cadeia de conexão no arquivo *Web. config* que tem o mesmo nome que o arquivo *. sdf* , mas que aponta para o banco &#8212; de dados do provedor de hospedagem sem precisar alterar seu código.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-401">Then when you move your site to a production server, you can use a connection string in the *Web.config* file that has the same name as your *.sdf* file but that points to the hosting provider's database &#8212; all without having to change your code.</span></span>
> 
> <span data-ttu-id="e3dc4-402">Por fim, se você quiser trabalhar diretamente com uma cadeia de conexão, poderá chamar o método `Database.OpenConnectionString` e passá-lo para a cadeia de conexão real, em vez de apenas o nome de um no arquivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="e3dc4-402">Finally, if you want to work directly with a connection string, you can call the `Database.OpenConnectionString` method and pass it the actual connection string instead of just the name of one in the *Web.config* file.</span></span> <span data-ttu-id="e3dc4-403">Isso pode ser útil em situações em que, por algum motivo, você não tem acesso à cadeia de conexão (ou valores, como o nome do arquivo *. sdf* ) até que a página esteja em execução.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-403">This might be useful in situations where for some reason you don't have access to the connection string (or values in it, such as the *.sdf* file name) until the page is running.</span></span> <span data-ttu-id="e3dc4-404">No entanto, para a maioria dos cenários, você pode usar `Database.Open` conforme descrito neste artigo.</span><span class="sxs-lookup"><span data-stu-id="e3dc4-404">However, for most scenarios, you can use `Database.Open` as described in this article.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e3dc4-405">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="e3dc4-405">Additional Resources</span></span>

- [<span data-ttu-id="e3dc4-406">SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="e3dc4-406">SQL Server Compact</span></span>](https://www.microsoft.com/sqlserver/2008/en/us/compact.aspx)
- [<span data-ttu-id="e3dc4-407">Conectando-se a um banco de dados SQL Server ou MySQL no WebMatrix</span><span class="sxs-lookup"><span data-stu-id="e3dc4-407">Connecting to a SQL Server or MySQL Database in WebMatrix</span></span>](https://go.microsoft.com/fwlink/?LinkId=208661)
- [<span data-ttu-id="e3dc4-408">Validação da entrada do usuário em sites de Páginas da Web do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e3dc4-408">Validating User Input in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=253002)
